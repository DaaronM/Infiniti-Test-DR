var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}})();var Intelledox;(function(Intelledox){var Model;(function(Model){var ClauseType;(function(ClauseType){ClauseType[ClauseType["AllOf"]=0]="AllOf";ClauseType[ClauseType["AnyOf"]=1]="AnyOf";ClauseType[ClauseType["Comparison"]=2]="Comparison";ClauseType[ClauseType["Basic"]=3]="Basic"})(ClauseType=Model.ClauseType||(Model.ClauseType={}));var ComparisonType;(function(ComparisonType){ComparisonType[ComparisonType["None"]=0]="None";ComparisonType[ComparisonType["Equals"]=1]="Equals";ComparisonType[ComparisonType["BeginsWith"]=2]="BeginsWith";ComparisonType[ComparisonType["EndsWith"]=3]="EndsWith";ComparisonType[ComparisonType["Contains"]=4]="Contains";ComparisonType[ComparisonType["GreaterThan"]=5]="GreaterThan";ComparisonType[ComparisonType["GreaterThanOrEquals"]=6]="GreaterThanOrEquals";ComparisonType[ComparisonType["LessThan"]=7]="LessThan";ComparisonType[ComparisonType["LessThanOrEquals"]=8]="LessThanOrEquals";ComparisonType[ComparisonType["NotEqualTo"]=9]="NotEqualTo";ComparisonType[ComparisonType["NotContain"]=10]="NotContain";ComparisonType[ComparisonType["ContainedIn"]=11]="ContainedIn";ComparisonType[ComparisonType["NotContainedIn"]=12]="NotContainedIn"})(ComparisonType=Model.ComparisonType||(Model.ComparisonType={}));var ValidationType;(function(ValidationType){ValidationType[ValidationType["Text"]=0]="Text";ValidationType[ValidationType["Date"]=1]="Date";ValidationType[ValidationType["Numeric"]=2]="Numeric";ValidationType[ValidationType["Image"]=3]="Image";ValidationType[ValidationType["Email"]=4]="Email";ValidationType[ValidationType["Password"]=5]="Password";ValidationType[ValidationType["Currency"]=6]="Currency";ValidationType[ValidationType["PhoneNumber"]=7]="PhoneNumber";ValidationType[ValidationType["Time"]=8]="Time"})(ValidationType=Model.ValidationType||(Model.ValidationType={}));var QuestionDisplayType;(function(QuestionDisplayType){QuestionDisplayType[QuestionDisplayType["MultiChoice"]=0]="MultiChoice";QuestionDisplayType[QuestionDisplayType["MultiSelect"]=1]="MultiSelect";QuestionDisplayType[QuestionDisplayType["Dropdown"]=2]="Dropdown";QuestionDisplayType[QuestionDisplayType["List"]=3]="List";QuestionDisplayType[QuestionDisplayType["Search"]=4]="Search";QuestionDisplayType[QuestionDisplayType["Popup"]=5]="Popup";QuestionDisplayType[QuestionDisplayType["Upload"]=6]="Upload";QuestionDisplayType[QuestionDisplayType["UploadOrSearch"]=7]="UploadOrSearch";QuestionDisplayType[QuestionDisplayType["ExistingContentItem"]=8]="ExistingContentItem";QuestionDisplayType[QuestionDisplayType["AutoComplete"]=9]="AutoComplete";QuestionDisplayType[QuestionDisplayType["LikertScale"]=10]="LikertScale";QuestionDisplayType[QuestionDisplayType["MultiChoiceToggleButton"]=11]="MultiChoiceToggleButton";QuestionDisplayType[QuestionDisplayType["MultiSelectToggleButton"]=12]="MultiSelectToggleButton";QuestionDisplayType[QuestionDisplayType["MultiSelectDropdown"]=13]="MultiSelectDropdown";QuestionDisplayType[QuestionDisplayType["DataGrid"]=14]="DataGrid";QuestionDisplayType[QuestionDisplayType["TileButton"]=15]="TileButton";QuestionDisplayType[QuestionDisplayType["DatePicker"]=16]="DatePicker";QuestionDisplayType[QuestionDisplayType["DateFields"]=17]="DateFields"})(QuestionDisplayType=Model.QuestionDisplayType||(Model.QuestionDisplayType={}));var DefaultValueType;(function(DefaultValueType){DefaultValueType[DefaultValueType["None"]=0]="None";DefaultValueType[DefaultValueType["Index"]=1]="Index";DefaultValueType[DefaultValueType["Value"]=2]="Value"})(DefaultValueType=Model.DefaultValueType||(Model.DefaultValueType={}));var SelectionType;(function(SelectionType){SelectionType[SelectionType["Single"]=0]="Single";SelectionType[SelectionType["Multiple"]=1]="Multiple";SelectionType[SelectionType["None"]=2]="None"})(SelectionType=Model.SelectionType||(Model.SelectionType={}));var EscalationInitialisationType;(function(EscalationInitialisationType){EscalationInitialisationType[EscalationInitialisationType["Days"]=0]="Days";EscalationInitialisationType[EscalationInitialisationType["QuestionReference"]=1]="QuestionReference";EscalationInitialisationType[EscalationInitialisationType["Mins"]=2]="Mins";EscalationInitialisationType[EscalationInitialisationType["Hours"]=3]="Hours"})(EscalationInitialisationType=Model.EscalationInitialisationType||(Model.EscalationInitialisationType={}));var OutputType;(function(OutputType){OutputType[OutputType["None"]=0]="None";OutputType[OutputType["Doc"]=1]="Doc";OutputType[OutputType["Xml"]=2]="Xml";OutputType[OutputType["Docx"]=3]="Docx";OutputType[OutputType["Pdf"]=4]="Pdf";OutputType[OutputType["Rtf"]=5]="Rtf";OutputType[OutputType["Odt"]=6]="Odt";OutputType[OutputType["Xps"]=7]="Xps";OutputType[OutputType["Mht"]=8]="Mht";OutputType[OutputType["PdfA"]=10]="PdfA";OutputType[OutputType["Docx2010"]=11]="Docx2010";OutputType[OutputType["Pptx"]=12]="Pptx";OutputType[OutputType["PresPdf"]=14]="PresPdf";OutputType[OutputType["Odp"]=15]="Odp";OutputType[OutputType["PresXps"]=16]="PresXps";OutputType[OutputType["PresPdfA"]=17]="PresPdfA";OutputType[OutputType["Ps"]=18]="Ps";OutputType[OutputType["Xlsx"]=19]="Xlsx";OutputType[OutputType["Xls"]=20]="Xls";OutputType[OutputType["SpreadXps"]=21]="SpreadXps";OutputType[OutputType["SpreadPdf"]=22]="SpreadPdf";OutputType[OutputType["SpreadPdfA"]=23]="SpreadPdfA";OutputType[OutputType["Ods"]=24]="Ods";OutputType[OutputType["Txt"]=25]="Txt";OutputType[OutputType["Html"]=26]="Html";OutputType[OutputType["Csv"]=27]="Csv";OutputType[OutputType["Json"]=28]="Json"})(OutputType=Model.OutputType||(Model.OutputType={}));var UnitsOfMeasure;(function(UnitsOfMeasure){UnitsOfMeasure[UnitsOfMeasure["Inches"]=0]="Inches";UnitsOfMeasure[UnitsOfMeasure["Centimeters"]=1]="Centimeters";UnitsOfMeasure[UnitsOfMeasure["Millimeters"]=2]="Millimeters";UnitsOfMeasure[UnitsOfMeasure["Points"]=3]="Points";UnitsOfMeasure[UnitsOfMeasure["Picas"]=4]="Picas";UnitsOfMeasure[UnitsOfMeasure["Pixels"]=5]="Pixels"})(UnitsOfMeasure=Model.UnitsOfMeasure||(Model.UnitsOfMeasure={}));var ContentType;(function(ContentType){ContentType[ContentType["None"]=0]="None";ContentType[ContentType["Image"]=1]="Image";ContentType[ContentType["UnformattedText"]=2]="UnformattedText";ContentType[ContentType["DocumentFragment"]=3]="DocumentFragment";ContentType[ContentType["Attachment"]=4]="Attachment";ContentType[ContentType["Audio"]=5]="Audio"})(ContentType=Model.ContentType||(Model.ContentType={}));var MetadataElementType;(function(MetadataElementType){MetadataElementType[MetadataElementType["TypeNone"]=0]="TypeNone";MetadataElementType[MetadataElementType["TypeNumber"]=1]="TypeNumber";MetadataElementType[MetadataElementType["TypeBoolean"]=2]="TypeBoolean";MetadataElementType[MetadataElementType["TypeDate"]=3]="TypeDate";MetadataElementType[MetadataElementType["TypeString"]=4]="TypeString";MetadataElementType[MetadataElementType["TypeFloat"]=5]="TypeFloat"})(MetadataElementType=Model.MetadataElementType||(Model.MetadataElementType={}));var AccessCodeGeneration;(function(AccessCodeGeneration){AccessCodeGeneration[AccessCodeGeneration["None"]=0]="None";AccessCodeGeneration[AccessCodeGeneration["Auto"]=1]="Auto";AccessCodeGeneration[AccessCodeGeneration["QuestionReference"]=2]="QuestionReference"})(AccessCodeGeneration=Model.AccessCodeGeneration||(Model.AccessCodeGeneration={}));var RoutingSourceType;(function(RoutingSourceType){RoutingSourceType[RoutingSourceType["DataQuestion"]=0]="DataQuestion";RoutingSourceType[RoutingSourceType["AnswerValue"]=1]="AnswerValue";RoutingSourceType[RoutingSourceType["FixedValue"]=2]="FixedValue";RoutingSourceType[RoutingSourceType["TypeValue"]=3]="TypeValue";RoutingSourceType[RoutingSourceType["Repeat"]=4]="Repeat";RoutingSourceType[RoutingSourceType["InputValue"]=5]="InputValue";RoutingSourceType[RoutingSourceType["FragmentOutput"]=6]="FragmentOutput"})(RoutingSourceType=Model.RoutingSourceType||(Model.RoutingSourceType={}));var ValidationRuleType;(function(ValidationRuleType){ValidationRuleType[ValidationRuleType["Compare"]=0]="Compare";ValidationRuleType[ValidationRuleType["FieldLength"]=1]="FieldLength";ValidationRuleType[ValidationRuleType["RegularExpression"]=2]="RegularExpression";ValidationRuleType[ValidationRuleType["Mandatory"]=3]="Mandatory"})(ValidationRuleType=Model.ValidationRuleType||(Model.ValidationRuleType={}));var ProjectType;(function(ProjectType){ProjectType[ProjectType["None"]=0]="None";ProjectType[ProjectType["Content"]=1]="Content";ProjectType[ProjectType["Layout"]=2]="Layout";ProjectType[ProjectType["FragmentPage"]=4]="FragmentPage";ProjectType[ProjectType["FragmentPortion"]=5]="FragmentPortion";ProjectType[ProjectType["Dashboard"]=6]="Dashboard"})(ProjectType=Model.ProjectType||(Model.ProjectType={}));var IntelledoxModule;(function(IntelledoxModule){IntelledoxModule[IntelledoxModule["CustomProvisionTenant"]=1001]="CustomProvisionTenant";IntelledoxModule[IntelledoxModule["CustomImportProjectToTenant"]=1002]="CustomImportProjectToTenant";IntelledoxModule[IntelledoxModule["Analytics"]=1003]="Analytics";IntelledoxModule[IntelledoxModule["TemporaryUserSave"]=1004]="TemporaryUserSave";IntelledoxModule[IntelledoxModule["RunActionButton"]=1005]="RunActionButton";IntelledoxModule[IntelledoxModule["CreateLicense"]=2005]="CreateLicense";IntelledoxModule[IntelledoxModule["TIBCO"]=1320]="TIBCO";IntelledoxModule[IntelledoxModule["TRIM"]=4141]="TRIM";IntelledoxModule[IntelledoxModule["Workflow"]=5236]="Workflow";IntelledoxModule[IntelledoxModule["SharePoint"]=6123]="SharePoint";IntelledoxModule[IntelledoxModule["UnlimitedAnonymousProjects"]=1501]="UnlimitedAnonymousProjects";IntelledoxModule[IntelledoxModule["UnlimitedInternalProjects"]=1701]="UnlimitedInternalProjects";IntelledoxModule[IntelledoxModule["UnlimitedNamedUsers"]=1901]="UnlimitedNamedUsers";IntelledoxModule[IntelledoxModule["SupportContract"]=2001]="SupportContract";IntelledoxModule[IntelledoxModule["ContentLibrary"]=2628]="ContentLibrary";IntelledoxModule[IntelledoxModule["Contacts"]=6889]="Contacts";IntelledoxModule[IntelledoxModule["Summary"]=4723]="Summary";IntelledoxModule[IntelledoxModule["PDFStitch"]=7823]="PDFStitch"})(IntelledoxModule=Model.IntelledoxModule||(Model.IntelledoxModule={}));var DisplayDirection;(function(DisplayDirection){DisplayDirection[DisplayDirection["Vertical"]=0]="Vertical";DisplayDirection[DisplayDirection["Horizontal"]=1]="Horizontal";DisplayDirection[DisplayDirection["Column2"]=2]="Column2";DisplayDirection[DisplayDirection["Column3"]=3]="Column3";DisplayDirection[DisplayDirection["Column4"]=4]="Column4"})(DisplayDirection=Model.DisplayDirection||(Model.DisplayDirection={}));var TemplateFormatType;(function(TemplateFormatType){TemplateFormatType[TemplateFormatType["None"]=0]="None";TemplateFormatType[TemplateFormatType["WordBinary"]=1]="WordBinary";TemplateFormatType[TemplateFormatType["WordDocx"]=3]="WordDocx";TemplateFormatType[TemplateFormatType["WordDocm"]=4]="WordDocm";TemplateFormatType[TemplateFormatType["PowerPointPptx"]=5]="PowerPointPptx";TemplateFormatType[TemplateFormatType["Xsd"]=6]="Xsd";TemplateFormatType[TemplateFormatType["ExcelXlsx"]=7]="ExcelXlsx";TemplateFormatType[TemplateFormatType["Pdf"]=8]="Pdf";TemplateFormatType[TemplateFormatType["Txt"]=9]="Txt";TemplateFormatType[TemplateFormatType["Html"]=10]="Html";TemplateFormatType[TemplateFormatType["Csv"]=11]="Csv";TemplateFormatType[TemplateFormatType["Json"]=12]="Json";TemplateFormatType[TemplateFormatType["ExcelXlsm"]=13]="ExcelXlsm";TemplateFormatType[TemplateFormatType["ProjectResults"]=14]="ProjectResults"})(TemplateFormatType=Model.TemplateFormatType||(Model.TemplateFormatType={}));var ProviderType;(function(ProviderType){ProviderType[ProviderType["All"]=0]="All";ProviderType[ProviderType["Delivery"]=1]="Delivery";ProviderType[ProviderType["Submission"]=2]="Submission";ProviderType[ProviderType["State"]=3]="State";ProviderType[ProviderType["Action"]=4]="Action";ProviderType[ProviderType["Escalation"]=5]="Escalation"})(ProviderType=Model.ProviderType||(Model.ProviderType={}));var StyleDetail=(function(){function StyleDetail(){}return StyleDetail}());Model.StyleDetail=StyleDetail;var PlaceholderReference=(function(){function PlaceholderReference(){this.type=0}Object.defineProperty(PlaceholderReference.prototype,"purpose",{get:function(){if(this.type===PlaceholderType.Slide){return PlaceholderPurpose.Range|PlaceholderPurpose.Repeat}else if(this.type===PlaceholderType.NamedRange){return PlaceholderPurpose.Insert|PlaceholderPurpose.Range|PlaceholderPurpose.Repeat}else if(this.type===PlaceholderType.Worksheet){return PlaceholderPurpose.Range|PlaceholderPurpose.Repeat}else if(this.type===PlaceholderType.Mustache){return this.name===''?(Model.PlaceholderPurpose.Insert|Model.PlaceholderPurpose.Range|Model.PlaceholderPurpose.Repeat):System.String.StartsWith(this.name,"{{#")?PlaceholderPurpose.Range|PlaceholderPurpose.Repeat:PlaceholderPurpose.Insert}else if(this.type===PlaceholderType.Xml){return PlaceholderPurpose.Insert|PlaceholderPurpose.Range}else if(this.type===PlaceholderType.XmlRepeat){return PlaceholderPurpose.Repeat}else if(this.type===PlaceholderType.PdfField){return PlaceholderPurpose.Insert}else if(this.type===PlaceholderType.Json){return System.String.EndsWith(this.name,"[]")?PlaceholderPurpose.Repeat:PlaceholderPurpose.Range|PlaceholderPurpose.Insert}else if(this.type===PlaceholderType.Broken){return PlaceholderPurpose.Unknown}else{return PlaceholderPurpose.Insert|PlaceholderPurpose.Range|PlaceholderPurpose.Repeat}},enumerable:true,configurable:true});PlaceholderReference.prototype.equals=function(p){if(p==null){return false}return Intelledox.Common.Functions.EqualsIgnoreCase(this.name,p.name)&&this.type===p.type};return PlaceholderReference}());Model.PlaceholderReference=PlaceholderReference;var PlaceholderType;(function(PlaceholderType){PlaceholderType[PlaceholderType["Bookmark"]=0]="Bookmark";PlaceholderType[PlaceholderType["Mustache"]=1]="Mustache";PlaceholderType[PlaceholderType["Slide"]=2]="Slide";PlaceholderType[PlaceholderType["Xml"]=3]="Xml";PlaceholderType[PlaceholderType["XmlRepeat"]=4]="XmlRepeat";PlaceholderType[PlaceholderType["NamedRange"]=5]="NamedRange";PlaceholderType[PlaceholderType["Worksheet"]=6]="Worksheet";PlaceholderType[PlaceholderType["Broken"]=7]="Broken";PlaceholderType[PlaceholderType["PdfField"]=8]="PdfField";PlaceholderType[PlaceholderType["Json"]=9]="Json"})(PlaceholderType=Model.PlaceholderType||(Model.PlaceholderType={}));var PlaceholderPurpose;(function(PlaceholderPurpose){PlaceholderPurpose[PlaceholderPurpose["Unknown"]=0]="Unknown";PlaceholderPurpose[PlaceholderPurpose["Insert"]=1]="Insert";PlaceholderPurpose[PlaceholderPurpose["Range"]=2]="Range";PlaceholderPurpose[PlaceholderPurpose["Repeat"]=4]="Repeat"})(PlaceholderPurpose=Model.PlaceholderPurpose||(Model.PlaceholderPurpose={}));var ActionDocumentType;(function(ActionDocumentType){ActionDocumentType[ActionDocumentType["Document"]=0]="Document";ActionDocumentType[ActionDocumentType["ContentItem"]=1]="ContentItem";ActionDocumentType[ActionDocumentType["Question"]=2]="Question";ActionDocumentType[ActionDocumentType["Action"]=3]="Action"})(ActionDocumentType=Model.ActionDocumentType||(Model.ActionDocumentType={}));var RunActionWhen;(function(RunActionWhen){RunActionWhen[RunActionWhen["Always"]=0]="Always";RunActionWhen[RunActionWhen["Never"]=1]="Never";RunActionWhen[RunActionWhen["OnDocGenFail"]=2]="OnDocGenFail";RunActionWhen[RunActionWhen["OnDocGenSuccess"]=3]="OnDocGenSuccess"})(RunActionWhen=Model.RunActionWhen||(Model.RunActionWhen={}));var SubmissionStage;(function(SubmissionStage){SubmissionStage[SubmissionStage["Submit"]=1]="Submit";SubmissionStage[SubmissionStage["DocumentGeneration"]=2]="DocumentGeneration";SubmissionStage[SubmissionStage["WorkflowAssignment"]=3]="WorkflowAssignment";SubmissionStage[SubmissionStage["Finish"]=0]="Finish"})(SubmissionStage=Model.SubmissionStage||(Model.SubmissionStage={}));var WorkflowStateDueType;(function(WorkflowStateDueType){WorkflowStateDueType[WorkflowStateDueType["None"]=0]="None";WorkflowStateDueType[WorkflowStateDueType["Days"]=1]="Days";WorkflowStateDueType[WorkflowStateDueType["QuestionReference"]=2]="QuestionReference"})(WorkflowStateDueType=Model.WorkflowStateDueType||(Model.WorkflowStateDueType={}));var TabGroupDisplayType;(function(TabGroupDisplayType){TabGroupDisplayType[TabGroupDisplayType["Classic"]=0]="Classic";TabGroupDisplayType[TabGroupDisplayType["Accordion"]=1]="Accordion"})(TabGroupDisplayType=Model.TabGroupDisplayType||(Model.TabGroupDisplayType={}));var SortFieldDirection;(function(SortFieldDirection){SortFieldDirection[SortFieldDirection["Asc"]=0]="Asc";SortFieldDirection[SortFieldDirection["Desc"]=1]="Desc"})(SortFieldDirection=Model.SortFieldDirection||(Model.SortFieldDirection={}));var FrequencyEnum;(function(FrequencyEnum){FrequencyEnum[FrequencyEnum["Hourly"]=0]="Hourly";FrequencyEnum[FrequencyEnum["Daily"]=1]="Daily";FrequencyEnum[FrequencyEnum["Weekly"]=2]="Weekly";FrequencyEnum[FrequencyEnum["Monthly"]=3]="Monthly";FrequencyEnum[FrequencyEnum["Yearly"]=4]="Yearly"})(FrequencyEnum=Model.FrequencyEnum||(Model.FrequencyEnum={}));var DayOfWeekEnum;(function(DayOfWeekEnum){DayOfWeekEnum[DayOfWeekEnum["SU"]=0]="SU";DayOfWeekEnum[DayOfWeekEnum["MO"]=1]="MO";DayOfWeekEnum[DayOfWeekEnum["TU"]=2]="TU";DayOfWeekEnum[DayOfWeekEnum["WE"]=3]="WE";DayOfWeekEnum[DayOfWeekEnum["TH"]=4]="TH";DayOfWeekEnum[DayOfWeekEnum["FR"]=5]="FR";DayOfWeekEnum[DayOfWeekEnum["SA"]=6]="SA"})(DayOfWeekEnum=Model.DayOfWeekEnum||(Model.DayOfWeekEnum={}));var CustomQuestionOutputType;(function(CustomQuestionOutputType){CustomQuestionOutputType[CustomQuestionOutputType["Text"]=0]="Text";CustomQuestionOutputType[CustomQuestionOutputType["Image"]=1]="Image";CustomQuestionOutputType[CustomQuestionOutputType["Html"]=2]="Html"})(CustomQuestionOutputType=Model.CustomQuestionOutputType||(Model.CustomQuestionOutputType={}));var BackgroundSource;(function(BackgroundSource){BackgroundSource[BackgroundSource["StaticImage"]=0]="StaticImage";BackgroundSource[BackgroundSource["QuestionReference"]=1]="QuestionReference"})(BackgroundSource=Model.BackgroundSource||(Model.BackgroundSource={}));var ButtonType;(function(ButtonType){ButtonType[ButtonType["Toggle"]=0]="Toggle";ButtonType[ButtonType["OpenUrl"]=1]="OpenUrl";ButtonType[ButtonType["GoToPage"]=2]="GoToPage";ButtonType[ButtonType["GoToProject"]=3]="GoToProject";ButtonType[ButtonType["Refresh"]=4]="Refresh"})(ButtonType=Model.ButtonType||(Model.ButtonType={}));var ButtonSize;(function(ButtonSize){ButtonSize[ButtonSize["Medium"]=0]="Medium";ButtonSize[ButtonSize["Small"]=1]="Small";ButtonSize[ButtonSize["Wide"]=2]="Wide";ButtonSize[ButtonSize["Large"]=3]="Large"})(ButtonSize=Model.ButtonSize||(Model.ButtonSize={}));var LinkType;(function(LinkType){LinkType[LinkType["NoneWithBrackets"]=0]="NoneWithBrackets";LinkType[LinkType["LaunchGroupTask"]=1]="LaunchGroupTask";LinkType[LinkType["LaunchSavedAnswer"]=2]="LaunchSavedAnswer";LinkType[LinkType["LaunchHistory"]=3]="LaunchHistory";LinkType[LinkType["LaunchHistoryProject"]=4]="LaunchHistoryProject";LinkType[LinkType["DownloadDocument"]=5]="DownloadDocument";LinkType[LinkType["LaunchNewProject"]=6]="LaunchNewProject";LinkType[LinkType["LaunchTask"]=7]="LaunchTask";LinkType[LinkType["OpenUrl"]=8]="OpenUrl"})(LinkType=Model.LinkType||(Model.LinkType={}));var ValueTypes;(function(ValueTypes){ValueTypes[ValueTypes["Any"]=0]="Any";ValueTypes[ValueTypes["Boolean"]=1]="Boolean";ValueTypes[ValueTypes["Enum"]=2]="Enum";ValueTypes[ValueTypes["Document"]=3]="Document";ValueTypes[ValueTypes["None"]=4]="None";ValueTypes[ValueTypes["Repeat"]=5]="Repeat"})(ValueTypes=Model.ValueTypes||(Model.ValueTypes={}));var DocumentUsage;(function(DocumentUsage){DocumentUsage[DocumentUsage["Never"]=0]="Never";DocumentUsage[DocumentUsage["Sometimes"]=1]="Sometimes";DocumentUsage[DocumentUsage["Always"]=2]="Always"})(DocumentUsage=Model.DocumentUsage||(Model.DocumentUsage={}))})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var SelectDocumentsModalCtrl=(function(){function SelectDocumentsModalCtrl($scope,$modalInstance,$filter,editor,wizard,allDocuments,selectedDocuments){$scope.isAddEnabled=false;$scope.isRemoveEnabled=false;$scope.existingDocuments=[];$scope.availableDocuments=allDocuments;Object.defineProperty($scope,"selectedDocument",{get:function(){return this._selectedDocument},set:function(value){this._selectedDocument=value;$scope.updateButtons()},enumerable:true,configurable:true});var selectedDocumentsArr;if((!System.String.IsNullOrEmpty(selectedDocuments))&&(selectedDocuments==="ALL")){selectedDocuments="";for(var i=0;i<$scope.availableDocuments.length;i++){if(i<($scope.availableDocuments.length-1)){selectedDocuments+=$scope.availableDocuments[i].value+","}else{selectedDocuments+=$scope.availableDocuments[i].value}}}if(!System.String.IsNullOrEmpty(selectedDocuments)){selectedDocumentsArr=selectedDocuments.split(',');for(var i=0;i<selectedDocumentsArr.length;i++){for(var j=0;j<$scope.availableDocuments.length;j++){if(selectedDocumentsArr[i]===$scope.availableDocuments[j].value){$scope.existingDocuments.push({tag:$scope.availableDocuments[j],name:$scope.availableDocuments[j].name,value:$scope.availableDocuments[j].value,selected:false});$scope.availableDocuments.splice(j,1);break}}}}var getSelectedExistingDocument=function getSelectedExistingDocument(){for(var i=0;i<$scope.existingDocuments.length;i++){if($scope.existingDocuments[i].selected){return $scope.existingDocuments[i]}}return null};var getSelectedDocument=function getSelectedDocument(){for(var i=0;i<$scope.availableDocuments.length;i++){if($scope.availableDocuments[i].value===$scope.selectedDocument){return $scope.availableDocuments[i]}}return null};$scope.updateButtons=function updateButtons(){$scope.isAddEnabled=($scope.selectedDocument!=null);var selectedItem=getSelectedExistingDocument();$scope.isRemoveEnabled=(selectedItem!=null)};$scope.selectExistingDocument=function selectExistingDocument(doc){for(var i=0;i<$scope.existingDocuments.length;i++){if($scope.existingDocuments[i].value===doc){$scope.existingDocuments[i].selected=true;$scope.updateButtons()}else{$scope.existingDocuments[i].selected=false}}};$scope.add=function add(){if($scope.selectedDocument!=null){var selectedDoc=getSelectedDocument();$scope.existingDocuments.push({tag:selectedDoc,name:selectedDoc.name,value:selectedDoc.value,selected:false});$scope.availableDocuments.splice($scope.availableDocuments.indexOf(selectedDoc),1);$scope.updateButtons()}};$scope.remove=function remove(){var selectedItem=getSelectedExistingDocument();if(selectedItem!=null){$scope.availableDocuments.push(selectedItem);$scope.existingDocuments.splice($scope.existingDocuments.indexOf(selectedItem),1);$scope.updateButtons()}};$scope.ok=function ok(){var returnList=[];for(var i=0;i<$scope.existingDocuments.length;i++){returnList.push($scope.existingDocuments[i].value.toString())}$modalInstance.close(returnList.join())};$scope.cancel=function cancel(){$modalInstance.dismiss('cancel')}}return SelectDocumentsModalCtrl}());Design.SelectDocumentsModalCtrl=SelectDocumentsModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var ActionAvailableDocument=(function(){function ActionAvailableDocument(){this.documentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.format=Model.OutputType.None}return ActionAvailableDocument}());Model.ActionAvailableDocument=ActionAvailableDocument})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var Monitor=(function(){function Monitor(designApi,editorViewModel){this._templateEditMonitors=[];this._editor=editorViewModel;this._designApi=designApi}Monitor.prototype.watchTemplateEdit=function(id){for(var i=0;i<this._templateEditMonitors.length;i++){if(this._templateEditMonitors[i].id===id){return}}var vm=this;var templateMonitor={id:id,timestamp:null,timerId:0};templateMonitor.timerId=setInterval(function(){vm._designApi.pollTemplateEdit(id,templateMonitor.timestamp).then(function(newTimestamp){if(templateMonitor.timestamp!=newTimestamp){templateMonitor.timestamp=newTimestamp;vm.templateChangedCallback(id)}})},5000);this._templateEditMonitors.push(templateMonitor)};Monitor.prototype.clear=function(){for(var i=0;i<this._templateEditMonitors.length;i++){clearInterval(this._templateEditMonitors[i].timerId)}};return Monitor}());Design.Monitor=Monitor})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Common;(function(Common){var ConstantValues;(function(ConstantValues){ConstantValues.FINISHPAGETAG="finish";ConstantValues.INPUTSNODETAG="inputs";ConstantValues.OUTPUTSNODETAG="outputs";ConstantValues.LAYOUTNODETAG="layout";ConstantValues.XTFFILE_VERSION="2.5.0";ConstantValues.GUID_EMPTY="00000000-0000-0000-0000-000000000000";ConstantValues.DEFAULTLEFTQUESTIONWIDTH_PIXELS=150;ConstantValues.DEFAULTLEFTQUESTIONWIDTH_PERCENT=35;ConstantValues.PROJECTLINK="ProjectLink";ConstantValues.COMMENTS="Comments";ConstantValues.WORKFLOW_ID="WorkflowId";ConstantValues.PROJECTNAME="ProjectName";ConstantValues.STATENAME="StateName";ConstantValues.ASSIGNEEFULLNAME="AssigneeFullName";ConstantValues.ROW_COUNT="rowcount";ConstantValues.ROW_NUMBER="rownumber";ConstantValues.ROW_ID="rowid";ConstantValues.PRODUCE_URL="ProduceUrl";ConstantValues.PROJECT_URL="ProjectUrl";ConstantValues.LINK_TEXT="LinkText";ConstantValues.FILENAME="FileName";ConstantValues.INPUT="Input";ConstantValues.FRAGMENT="Fragment";ConstantValues.PREVIOUS="Previous";ConstantValues.PROTECT="Protect";ConstantValues.ACCESSCODE="AccessCode";ConstantValues.CHOICE="Choice";ConstantValues.QAREPEAT="6a4af944-0563-4c95-aba1-ddf2da4337b1";ConstantValues.EMAIL_ESCALATION_GUID="9b92350d-1673-473e-baef-219780cbb4bc";ConstantValues.FINISHED_STATE_GUID="99999999-9999-9999-9999-999999999999";ConstantValues.START_STATE_GUID="11111111-1111-1111-1111-111111111111";ConstantValues.COPY_TO_FRAGMENT_ALLPAGES_GUID="88888888-8888-8888-8888-888888888888";ConstantValues.REPEATED_SECTION="[RepeatedSection]";ConstantValues.REPEATED_PAGE="[RepeatedPage]";ConstantValues.RESULTS_USERNAME="_Username";ConstantValues.RESULTS_COMPLETIONDATE="_Completion_Time_UTC";ConstantValues.RESULTS_COMPLETED="_Completed";ConstantValues.RESULTS_WORKFLOWINPROGRESS="_WorkflowInProgress";ConstantValues.RESULTS_CURRENTSTATE="_CurrentState";ConstantValues.RESULTS_RUNID="_RunId";ConstantValues.RESULTS_UNIQUEFIELD="_UniqueField";ConstantValues.XTF_ANSWER="Answer";ConstantValues.XTF_BOOKMARKGROUP="BookmarkGroup";ConstantValues.XTF_COLUMN="Column";ConstantValues.XTF_CONTROL="Control";ConstantValues.XTF_INTELLEDOXTEMPLATEFILE="Intelledox_TemplateFile";ConstantValues.XTF_FRAGMENT="Fragment";ConstantValues.XTF_LAYOUT="Layout";ConstantValues.XTF_QUESTION="Question";ConstantValues.XTF_SECTION="Section";ConstantValues.XTF_TABGROUP="TabGroup";ConstantValues.XTF_TABPAGE="TabPage";ConstantValues.XTF_WIZARDINFO="WizardInfo";ConstantValues.XTF_HEADERINFO="HeaderInfo";ConstantValues.XTF_COMPLETIONINFO="CompletionInfo";ConstantValues.XTF_RULE="Rule";ConstantValues.XTF_STATE="State";ConstantValues.XTF_TRANSITION="Transition";ConstantValues.XTF_TRANSLATION="Trans";ConstantValues.XTF_ESCALATION="Escalation";ConstantValues.XTF_ESCALATIONINPUT="EscalationInput";ConstantValues.XTF_ACTIONINPUT="ActionInput";ConstantValues.XTF_DISPLAYFIELD="DisplayField";ConstantValues.XTF_ANSWERFILELABEL="AnswerFileLabel";ConstantValues.XTF_FRAGMENTGUID="FragmentGuid";ConstantValues.XTF_GUID="Guid";ConstantValues.XTF_ID="ID";ConstantValues.XTF_NAME="Name";ConstantValues.XTF_PROJECTGUID="ProjectGuid";ConstantValues.XTF_PROTECTEDFIELD="ProtectedField";ConstantValues.XTF_REFERENCE="Reference";ConstantValues.XTF_REPEATED="Repeated";ConstantValues.XTF_SAVETOANSWERFILE="SaveToAnswerFile";ConstantValues.XTF_SAVETOANSWERFILEBY="SaveToAnswerFileBy";ConstantValues.XTF_SELECTIONTYPE="SelectionType";ConstantValues.XTF_TEXT="Text";ConstantValues.XTF_TITLE="Title";ConstantValues.XTF_TYPEID="TypeId";ConstantValues.XTF_VALIDATIONTYPE="ValidationType";ConstantValues.XTF_VALUEFIELD="ValueField";ConstantValues.XTF_REPEATTITLE="RepeatTitle";ConstantValues.XTF_DESCRIPTION="Description";ConstantValues.XTF_HELPTEXT="HelpText";ConstantValues.XTF_FINISHTITLE="FinishTitle";ConstantValues.XTF_GENERATEBUTTONTEXT="GenerateButtonText";ConstantValues.XTF_GENERATINGTEXT="GeneratingText";ConstantValues.XTF_DOWNLOADPAGETITLE="DownloadPageTitle";ConstantValues.XTF_INVALIDPROJECTEXT="InvalidProjectText";ConstantValues.XTF_DEFAULTANSWERFILENAME="DefaultAnswerFileName";ConstantValues.XTF_DEFAULTINPROGRESSANSWERFILENAME="DefaultInProgressFileName";ConstantValues.XTF_DEFAULTVALUE="DefaultValue";ConstantValues.XTF_WATERMARK="Watermark";ConstantValues.XTF_MESSAGE="Message";ConstantValues.XTF_DISPLAYTEXT="DisplayText";ConstantValues.XTF_TAGVALUE="TagValue";ConstantValues.XTF_STATEID="StateId";ConstantValues.XTF_PAGETITLE="PageTitle";ConstantValues.XTF_DEFAULTCOMMENT="DefaultComment";ConstantValues.XTF_SUBMITBUTTONTEXT="SubmitButtonText";ConstantValues.XTF_SUBMITTINGTEXT="SubmittingText";ConstantValues.XTF_DOWNLOADABLEDOCUMENTS="DownloadableDocuments";ConstantValues.XTF_REDIRECTTOHOME="RedirectToHome";ConstantValues.XTF_WAITFORPROJECT="WaitForProject";ConstantValues.XTF_ONLINEREDIRECTMESSAGE="OnlineRedirectMessage";ConstantValues.XTF_OFFLINEREDIRECTMESSAGE="OfflineRedirectMessage";ConstantValues.XTF_RESPONSESUBMITTEDTEXT="ResponsesSubmittedText";ConstantValues.XTF_EMAILSUBJECT="EmailSubject";ConstantValues.XTF_EMAILTEXT="EmailText";ConstantValues.XTF_STARTPAGE="StartPageGuid";ConstantValues.XTF_LANGUAGE="Lang";ConstantValues.XTF_TRANSLATIONGUID="Trans_Guid";ConstantValues.XTF_TRANSLATIONDESCRIPTION="Trans_Description";ConstantValues.XTF_ESCALATIONINPUTGUID="EscalationInputGuid";ConstantValues.XTF_ESCALATIONINPUTVALUE="EscalationInputValue";ConstantValues.XTF_ACTIONATTRIBUTEFIXEDVALUE="ActionAttributeFixedValue";ConstantValues.XTF_ACTIONINPUTGUID="ActionInputGuid";ConstantValues.XTF_RESPONSEMETADATAFIELD="ResponseMetadataField";ConstantValues.XTF_ANONSAVEHELPTEXT="AnonSaveHelpText";ConstantValues.XTF_ANONSAVEEMAILSUBJECT="AnonSaveEmailSubject";ConstantValues.XTF_ANONSAVEEMAILBODY="AnonSaveEmailBody";ConstantValues.XTF_ANONSAVERESUMETEXT="AnonSaveResumeText";ConstantValues.XTF_ANONREASSIGNTEXT="AnonReassignText";ConstantValues.XTF_ANONRECIPIENTNAMETEXT="AnonRecipientNameText";ConstantValues.XTF_BADGE="Badge";ConstantValues.XTF_BACKCOLOUR="BackColour";ConstantValues.XTF_FOCUSRINGCOLOUR="FocusRingColour";ConstantValues.XTF_BACKTOGGLECOLOUR="BackToggleColour";ConstantValues.XTF_DISPLAYFIELDCOLUMNTITLE="ColumnTitle";ConstantValues.XTF_DISPLAYFIELDLINK="Link";ConstantValues.XTF_DISPLAYFIELDOPERATIONSDROPDOWN="OperationsDropdown";ConstantValues.XTF_REPEATNAME="RepeatName";ConstantValues.DATA_URI_PREFIX='data:image/png;base64,';ConstantValues.DATA_URI_BLANK='data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';ConstantValues.VARIABLE_CONNECTED="Connected (True / False)"})(ConstantValues=Common.ConstantValues||(Common.ConstantValues={}))})(Common=Intelledox.Common||(Intelledox.Common={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Common;(function(Common){var Functions=(function(){function Functions(){}Functions.Left=function(value,length){if(length===0||value==null){return""}else if(value.length<=length){return value}else{return System.String.Substring(value,0,length)}};Functions.IsNumeric=function(expression){if(expression===null||expression===undefined){return false}else if(typeof expression==='number'){return true}else{return!isNaN(parseFloat(expression.toString()))}};Functions.IsInt=function(expression){if(System.String.IsNullOrEmpty(expression)){return false}return this.m_IntRegex.test(expression)};Functions.IsUInt=function(expression){if(System.String.IsNullOrEmpty(expression)){return false}return this.m_UIntRegex.test(expression)};Functions.ExtractActionReference=function(refString){var dotPos=refString.indexOf('.');if(dotPos>-1){return System.String.Substring(refString,1,dotPos-1)}return''};Functions.ExtractFragmentReference=function(refString){var dotPos=refString.indexOf('.');if(dotPos>-1){return{fragmentRef:System.String.Substring(refString,1,dotPos-1),outputRef:System.String.Substring(refString,dotPos+1,refString.length-dotPos-2)}}return{fragmentRef:"",outputRef:""}};Functions.ParseExpressions=function(content){var expressions=new Array;if(!System.String.IsNullOrEmpty(content)){var index=content.indexOf('[');while(index>-1){var nextOpenIndex=content.indexOf('[',index+1);var nextCloseIndex=content.indexOf(']',index);if(nextCloseIndex===-1){break}if(nextOpenIndex!==-1&&nextOpenIndex<nextCloseIndex){index=nextOpenIndex}else{expressions.push(System.String.Substring(content,index,nextCloseIndex-index+1));index=content.indexOf('[',nextCloseIndex+1)}}}return expressions};Functions.ExtractQuestionReference=function(refString){if(System.String.StartsWithIgnoreCase(refString,'[q')){var dotPos=refString.indexOf('.');var pipePos=refString.indexOf('|');if(dotPos>-1&&(pipePos===-1||dotPos<pipePos)){return{questionRef:System.String.Substring(refString,2,dotPos-2),hasAnswerRef:true}}else{if(pipePos>-1){return{questionRef:System.String.Substring(refString,2,pipePos-2),hasAnswerRef:false}}else{return{questionRef:System.String.Substring(refString,2,refString.indexOf(']')-2),hasAnswerRef:false}}}}return{questionRef:"",hasAnswerRef:false}};Functions.EqualsIgnoreCase=function(value,compareValue){if(compareValue==null){return false}return value.toUpperCase()===compareValue.toUpperCase()};Functions.NotEqualsIgnoreCase=function(value,compareValue){return!this.EqualsIgnoreCase(value,compareValue)};Functions.ContainsIgnoreCase=function(value,compareValue){return value.toUpperCase().indexOf(compareValue.toUpperCase())>-1};Functions.EscapeHtml=function(value){var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':'&quot;',"'":'&#39;',"/":'&#x2F;'};return String(value).replace(/[&<>"'\/]/g,function(s){return entityMap[s]})};Functions.ColourList=function(filter,includeNoneItem){var availableColours=[];if(includeNoneItem){availableColours.push({name:filter('translate')('None'),value:0})}availableColours.push({name:filter('translate')('Aqua'),value:-16711681});availableColours.push({name:filter('translate')('Black'),value:-16777216});availableColours.push({name:filter('translate')('Blue'),value:-16776961});availableColours.push({name:filter('translate')('Brown'),value:-5952982});availableColours.push({name:filter('translate')('CornflowerBlue'),value:-10185235});availableColours.push({name:filter('translate')('DarkBlue'),value:-16777077});availableColours.push({name:filter('translate')('DarkGreen'),value:-16751616});availableColours.push({name:filter('translate')('DarkOliveGreen'),value:-11179217});availableColours.push({name:filter('translate')('DarkViolet'),value:-7077677});availableColours.push({name:filter('translate')('DimGray'),value:-9868951});availableColours.push({name:filter('translate')('Gray'),value:-8355712});availableColours.push({name:filter('translate')('Green'),value:-16744448});availableColours.push({name:filter('translate')('Gold'),value:-10496});availableColours.push({name:filter('translate')('HotPink'),value:-38476});availableColours.push({name:filter('translate')('Indigo'),value:-11861886});availableColours.push({name:filter('translate')('Khaki'),value:-989556});availableColours.push({name:filter('translate')('LightBlue'),value:-5383962});availableColours.push({name:filter('translate')('LightGray'),value:-2894893});availableColours.push({name:filter('translate')('LightGreen'),value:-7278960});availableColours.push({name:filter('translate')('LightSteelBlue'),value:-5192482});availableColours.push({name:filter('translate')('Lime'),value:-16711936});availableColours.push({name:filter('translate')('LimeGreen'),value:-13447886});availableColours.push({name:filter('translate')('Maroon'),value:-8388608});availableColours.push({name:filter('translate')('MidnightBlue'),value:-15132304});availableColours.push({name:filter('translate')('Olive'),value:-8355840});availableColours.push({name:filter('translate')('Orange'),value:-23296});availableColours.push({name:filter('translate')('PaleTurquoise'),value:-5247250});availableColours.push({name:filter('translate')('Pink'),value:-16181});availableColours.push({name:filter('translate')('Plum'),value:-2252579});availableColours.push({name:filter('translate')('Purple'),value:-8388480});availableColours.push({name:filter('translate')('Red'),value:-65536});availableColours.push({name:filter('translate')('SeaGreen'),value:-13726889});availableColours.push({name:filter('translate')('Silver'),value:-4144960});availableColours.push({name:filter('translate')('SlateBlue'),value:-9807155});availableColours.push({name:filter('translate')('Teal'),value:-16744320});availableColours.push({name:filter('translate')('Tomato'),value:-40121});availableColours.push({name:filter('translate')('Turquoise'),value:-12525360});availableColours.push({name:filter('translate')('Tan'),value:-2968436});availableColours.push({name:filter('translate')('White'),value:-1});availableColours.push({name:filter('translate')('Yellow'),value:-256});return availableColours};Functions.FastStringToInt=function(value){return parseInt(value,10)};Functions.FastPartialStringToInt=function(value,startIndex,length){var intValue=0;var endIndex=startIndex+length;for(var i=startIndex;i<endIndex;i++){intValue=(intValue*10)+(value.charCodeAt(i)-48)}return intValue};Functions.MakeValidFileName=function(name){var x=name.replace(/[<>:"\/\\|?*\&\%\.\+]+/g,"_");return x};Functions.m_IntRegex=new RegExp("^-*[0-9]+$");Functions.m_UIntRegex=new RegExp("^[0-9]+$");return Functions}());Common.Functions=Functions})(Common=Intelledox.Common||(Intelledox.Common={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Common;(function(Common){var Device=(function(){function Device(){}Device.GetFirstBrowserLanguage=function(){var nav=window.navigator,browserLanguagePropertyKeys=['language','browserLanguage','systemLanguage','userLanguage'],i,language;if(angular.isArray(nav.languages)){for(i=0;i<nav.languages.length;i++){language=nav.languages[i];if(language&&language.length){return language}}}for(i=0;i<browserLanguagePropertyKeys.length;i++){language=nav[browserLanguagePropertyKeys[i]];if(language&&language.length){return language}}return null};return Device}());Common.Device=Device})(Common=Intelledox.Common||(Intelledox.Common={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ClauseDesignerCtrl=(function(){function ClauseDesignerCtrl($scope){$scope.clauseCopy=function clauseCopy(){$scope.model.copy()};$scope.clausePaste=function clausePaste(){$scope.model.paste()};$scope.clauseMoveUp=function clauseMoveUp(){$scope.model.moveUp()};$scope.clauseMoveDown=function clauseMoveDown(){$scope.model.moveDown()};$scope.clauseConvert=function clauseConvert(){$scope.model.convert()};$scope.clauseAddAnd=function clauseAddAnd(){$scope.model.addAnd()};$scope.clauseAddOr=function clauseAddOr(){$scope.model.addOr()};$scope.clauseDelete=function clauseDelete(){$scope.model.deleteClause()};$scope.clauseSelected=function clauseSelect(node){$scope.model.clausesTreeView.selectedNode=node}}return ClauseDesignerCtrl}());Design.ClauseDesignerCtrl=ClauseDesignerCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var DataSourceModalCtrl=(function(){function DataSourceModalCtrl($scope,$modalInstance,vm){$scope.model=new DataSourceModalCtrlViewModel;$scope.model.dataSourcePropertiesVM=vm;$scope.ok=function(){if($scope.model.dataSourcePropertiesVM.hasSelectedDataSource()&&$scope.model.dataSourcePropertiesVM.hasSelectedDataObject()){$modalInstance.close({addAnswers:$scope.model.addAnswers})}else{$modalInstance.close({addAnswers:false})}}}return DataSourceModalCtrl}());Design.DataSourceModalCtrl=DataSourceModalCtrl;var DataSourceModalCtrlViewModel=(function(){function DataSourceModalCtrlViewModel(){this.addAnswers=false}return DataSourceModalCtrlViewModel}());Design.DataSourceModalCtrlViewModel=DataSourceModalCtrlViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ProjectPropertiesModalCtrl=(function(){function ProjectPropertiesModalCtrl($scope,$filter,$modalInstance,designApi,wizard,editorViewModel,listManager){$scope.currentTab='general';$scope.general=new Design.GeneralPropertiesModalCtrl($filter,designApi,wizard,editorViewModel);$scope.metadata=null;$scope.language=null;$scope.properties=null;$scope.ok=function(){$modalInstance.close()};$scope.switch=function(tab){if(tab==='metadata'&&$scope.metadata===null){$scope.metadata=new Design.MetadataModalCtrl($filter,wizard,editorViewModel)}if(tab==='language'&&$scope.language===null){$scope.language=new Design.LanguageTranslationsModalCtrl($scope,editorViewModel,$filter,listManager)}if(tab==='properties'&&$scope.properties===null){$scope.properties=new Design.PropertiesModalCtrl($filter,editorViewModel)}$scope.currentTab=tab}}return ProjectPropertiesModalCtrl}());Design.ProjectPropertiesModalCtrl=ProjectPropertiesModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var GeneralPropertiesModalCtrl=(function(){function GeneralPropertiesModalCtrl($filter,designApi,wizard,editorViewModel){this.isQuestionVisible=false;this.isAnswerVisible=false;this.isTempSaveVisible=false;this._filter=$filter;this._wizard=wizard;this._editor=editorViewModel;this._designApi=designApi;if(System.String.IsNullOrEmpty(wizard.DefaultAnswerFileName)){this._answerFileName=wizard.Name}else{this._answerFileName=wizard.DefaultAnswerFileName}if(System.String.IsNullOrEmpty(wizard.DefaultInProgressFileName)){this._inprogressFileName=wizard.Name}else{this._inprogressFileName=wizard.DefaultInProgressFileName}this.accessCodeGenerationOptions=[];this.accessCodeGenerationOptions.push({description:this.accessCodeGenerationTypeToString(Intelledox.Model.AccessCodeGeneration.None),value:Intelledox.Model.AccessCodeGeneration.None});this.accessCodeGenerationOptions.push({description:this.accessCodeGenerationTypeToString(Intelledox.Model.AccessCodeGeneration.Auto),value:Intelledox.Model.AccessCodeGeneration.Auto});this.accessCodeGenerationOptions.push({description:this.accessCodeGenerationTypeToString(Intelledox.Model.AccessCodeGeneration.QuestionReference),value:Intelledox.Model.AccessCodeGeneration.QuestionReference});this.availableQuestions=[];this.availableQuestions.push(new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,$filter('translate')('NoneWithBrackets')));for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var currentPage=wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<currentPage.Questions.length;questionIndex++){var allowQuestion=false;switch(currentPage.Questions[questionIndex].QuestionTypeID){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom:allowQuestion=true;break;default:allowQuestion=false;break}if(allowQuestion){this.availableQuestions.push(currentPage.Questions[questionIndex])}}}this.showHideAnonSaveOptions();this.listAnswers()}Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"isTemporarySaveAvailable",{get:function(){return this._wizard.TypeId===Intelledox.Model.ProjectType.Content&&this._editor.isTemporarySaveAvailable},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"projectName",{get:function(){return this._wizard.Name},set:function(value){if(value!==this._wizard.Name){if(this.answerFileName===this._wizard.Name){this.answerFileName=value}if(this.inprogressFileName===this._wizard.Name){this.inprogressFileName=value}}this._wizard.Name=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"isCompatibilityMode",{get:function(){return this._wizard.Compatibility===Intelledox.QAWizard.Design.CompatibilityLevel.Version2001},set:function(value){this._wizard.Compatibility=value?Intelledox.QAWizard.Design.CompatibilityLevel.Version2001:Intelledox.QAWizard.Design.CompatibilityLevel.Version2014;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"isContentProject",{get:function(){return this._wizard.TypeId===Intelledox.Model.ProjectType.Content},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"isDashboardProject",{get:function(){return this._wizard.TypeId===Intelledox.Model.ProjectType.Dashboard},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"answerFileName",{get:function(){return this._answerFileName},set:function(value){this._answerFileName=value;this._wizard.DefaultAnswerFileName=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"inprogressFileName",{get:function(){return this._inprogressFileName},set:function(value){this._inprogressFileName=value;this._wizard.DefaultInProgressFileName=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"accessCodeGeneration",{get:function(){return this._wizard.TemporaryUserSaveSettings.AccessCodeGeneration},set:function(value){this._wizard.TemporaryUserSaveSettings.AccessCodeGeneration=value;this.showHideAnonSaveOptions();this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"selectedQuestionGuid",{get:function(){return this._wizard.TemporaryUserSaveSettings.AccessCodeGenerationQuestion},set:function(value){this._wizard.TemporaryUserSaveSettings.AccessCodeGenerationQuestion=value;this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._wizard.TemporaryUserSaveSettings.AccessCodeGenerationAnswer=Intelledox.Common.ConstantValues.GUID_EMPTY;this.listAnswers();this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"selectedAnswerGuid",{get:function(){return this._wizard.TemporaryUserSaveSettings.AccessCodeGenerationAnswer},set:function(value){this._wizard.TemporaryUserSaveSettings.AccessCodeGenerationAnswer=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"accessCodeHelpText",{get:function(){return this._wizard.TemporaryUserSaveSettings.HelpText},set:function(value){this._wizard.TemporaryUserSaveSettings.HelpText=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"recipientName",{get:function(){return this._wizard.TemporaryUserSaveSettings.RecipientName},set:function(value){this._wizard.TemporaryUserSaveSettings.RecipientName=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"emailTo",{get:function(){return this._wizard.TemporaryUserSaveSettings.EmailTo},set:function(value){this._wizard.TemporaryUserSaveSettings.EmailTo=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"emailSubject",{get:function(){return this._wizard.TemporaryUserSaveSettings.EmailSubject},set:function(value){this._wizard.TemporaryUserSaveSettings.EmailSubject=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"emailBody",{get:function(){return this._wizard.TemporaryUserSaveSettings.EmailBody},set:function(value){this._wizard.TemporaryUserSaveSettings.EmailBody=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"resumeText",{get:function(){return this._wizard.TemporaryUserSaveSettings.ResumeText},set:function(value){this._wizard.TemporaryUserSaveSettings.ResumeText=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"reassignText",{get:function(){return this._wizard.TemporaryUserSaveSettings.ReassignText},set:function(value){this._wizard.TemporaryUserSaveSettings.ReassignText=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"showLiveRefresh",{get:function(){return this._wizard.TypeId===Intelledox.Model.ProjectType.Dashboard},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"liveRefresh",{get:function(){return this._wizard.LiveRefresh},set:function(value){this._wizard.LiveRefresh=value;if(value){this._wizard.RefreshPeriod=60}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GeneralPropertiesModalCtrl.prototype,"refreshPeriod",{get:function(){if(this._wizard.RefreshPeriod<1){return''}return this._wizard.RefreshPeriod.toString()},set:function(value){this._wizard.RefreshPeriod=parseInt(value,10);if(isNaN(this._wizard.RefreshPeriod)){this._wizard.RefreshPeriod=0}this._editor.wizChanged=true},enumerable:true,configurable:true});GeneralPropertiesModalCtrl.prototype.accessCodeGenerationTypeToString=function(codeType){switch(codeType){case Intelledox.Model.AccessCodeGeneration.None:return this._filter('translate')('NoneWithBrackets');case Intelledox.Model.AccessCodeGeneration.Auto:return this._filter('translate')('AutoGeneratedBrackets');case Intelledox.Model.AccessCodeGeneration.QuestionReference:return this._filter('translate')('QuestionReference');default:return"("+this._filter('translate')('NotSet')+")"}};GeneralPropertiesModalCtrl.prototype.findSelectedQuestion=function(questionGuid){for(var i=0;i<this.availableQuestions.length;i++){if(questionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};GeneralPropertiesModalCtrl.prototype.isAnswerRequired=function(questionType){switch(questionType){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label:return false;default:return true}};GeneralPropertiesModalCtrl.prototype.listAnswers=function(){var selectedQuestion=this.findSelectedQuestion(this.selectedQuestionGuid);this.isAnswerVisible=false;this.availableAnswers=[];this.availableAnswers.push(new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,"("+this._filter('translate')('NoAnswer')+")"));if(selectedQuestion!=null&&selectedQuestion.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var answerIndex=0;answerIndex<selectedQuestion.Answers.length;answerIndex++){this.availableAnswers.push(selectedQuestion.Answers[answerIndex])}if(this.isAnswerRequired(selectedQuestion.QuestionTypeID)&&selectedQuestion.Answers.length>0){this.isAnswerVisible=true}}};;GeneralPropertiesModalCtrl.prototype.showHideAnonSaveOptions=function(){if(this.accessCodeGeneration===Intelledox.Model.AccessCodeGeneration.None){this.isTempSaveVisible=false}else if(this.accessCodeGeneration===Intelledox.Model.AccessCodeGeneration.QuestionReference){this.isQuestionVisible=true;this.isTempSaveVisible=true;this.listAnswers()}else{this.isQuestionVisible=false;this.isAnswerVisible=false;this.isTempSaveVisible=true}};GeneralPropertiesModalCtrl.prototype.checkUniqueName=function(){var vm=this;this._designApi.getProjects(false).then(function(data){if(!vm.isNameUnique(data,vm._editor.wizard.Name)){alert(vm._filter('translate')('MsgProjectSameNameExists'));var i=1;var name=vm.projectName+'_';while(!vm.isNameUnique(data,name+i.toString())){i++}vm.projectName=name+i.toString()}})};GeneralPropertiesModalCtrl.prototype.isNameUnique=function(data,compareName){compareName=compareName.toUpperCase();for(var i=0;i<data.length;i++){var proj=data[i];if(proj.name.toUpperCase()===compareName&&this._editor.wizard.ProjectGuid!==proj.projectGuid){return false}}return true};return GeneralPropertiesModalCtrl}());Design.GeneralPropertiesModalCtrl=GeneralPropertiesModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var MetadataModalCtrl=(function(){function MetadataModalCtrl($filter,wizard,editorViewModel){this._filter=$filter;this._wizard=wizard;this._editor=editorViewModel;this.loadAllElements();this.types=[];this.types.push({description:this.elementTypeToString(Intelledox.Model.MetadataElementType.TypeNumber),value:Intelledox.Model.MetadataElementType.TypeNumber});this.types.push({description:this.elementTypeToString(Intelledox.Model.MetadataElementType.TypeBoolean),value:Intelledox.Model.MetadataElementType.TypeBoolean});this.types.push({description:this.elementTypeToString(Intelledox.Model.MetadataElementType.TypeDate),value:Intelledox.Model.MetadataElementType.TypeDate});this.types.push({description:this.elementTypeToString(Intelledox.Model.MetadataElementType.TypeString),value:Intelledox.Model.MetadataElementType.TypeString});this.types.push({description:this.elementTypeToString(Intelledox.Model.MetadataElementType.TypeFloat),value:Intelledox.Model.MetadataElementType.TypeFloat});this.availableQuestions=[];this.availableQuestions.push(new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,$filter('translate')('NoneWithBrackets')));for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var currentPage=wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<currentPage.Questions.length;questionIndex++){this.availableQuestions.push(currentPage.Questions[questionIndex])}}this.listAnswers();this.name='';this.selectedType=Intelledox.Model.MetadataElementType.TypeString;this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.fixed='';this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.checkAddUpdate(true)};Object.defineProperty(MetadataModalCtrl.prototype,"name",{get:function(){return this._name},set:function(value){this._name=value;this.checkAddUpdate(true)},enumerable:true,configurable:true});Object.defineProperty(MetadataModalCtrl.prototype,"selectedQuestionGuid",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.listAnswers()},enumerable:true,configurable:true});MetadataModalCtrl.prototype.elementTypeToString=function(elementType){switch(elementType){case Intelledox.Model.MetadataElementType.TypeBoolean:return this._filter('translate')('YesorNo');case Intelledox.Model.MetadataElementType.TypeDate:return this._filter('translate')('DateString');case Intelledox.Model.MetadataElementType.TypeFloat:return this._filter('translate')('DecimalNumber');case Intelledox.Model.MetadataElementType.TypeNumber:return this._filter('translate')('IntegerNumber');case Intelledox.Model.MetadataElementType.TypeString:return this._filter('translate')('Text');default:return"("+this._filter('translate')('NotSet')+")"}};MetadataModalCtrl.prototype.getQuestionName=function(answerGuid){if(answerGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return''}for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var p=this._wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<p.Questions.length;questionIndex++){var qn=p.Questions[questionIndex];for(var answerIndex=0;answerIndex<qn.Answers.length;answerIndex++){if(qn.Answers[answerIndex].AnswerGuid===answerGuid){return qn.Text}}}}return''};MetadataModalCtrl.prototype.getAnswerName=function(answerGuid){if(answerGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return''}for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var p=this._wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<p.Questions.length;questionIndex++){var qn=p.Questions[questionIndex];for(var answerIndex=0;answerIndex<qn.Answers.length;answerIndex++){if(qn.Answers[answerIndex].AnswerGuid===answerGuid){return qn.Answers[answerIndex].Name}}}}return''};MetadataModalCtrl.prototype.findSelectedQuestion=function(questionGuid){for(var i=0;i<this.availableQuestions.length;i++){if(questionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};MetadataModalCtrl.prototype.listAnswers=function(){var selectedQuestion=this.findSelectedQuestion(this.selectedQuestionGuid);this.availableAnswers=[];this.availableAnswers.push(new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,"("+this._filter('translate')('NoAnswer')+")"));if(selectedQuestion!=null&&selectedQuestion.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var answerIndex=0;answerIndex<selectedQuestion.Answers.length;answerIndex++){this.availableAnswers.push(selectedQuestion.Answers[answerIndex])}}};MetadataModalCtrl.prototype.loadAllElements=function(){this.existingMetadata=[];for(var i=0;i<this._wizard.MetadataElements.length;i++){var metadataItem=this._wizard.MetadataElements[i];this.existingMetadata.push({tag:metadataItem,name:Design.TranslationHelper.KeywordValueToTranslation(this._filter,metadataItem.Name),selected:false,elementType:this.elementTypeToString(metadataItem.ElementTypeId),fixedValue:Design.TranslationHelper.KeywordValueToTranslation(this._filter,metadataItem.FixedValue),questionName:this.getQuestionName(metadataItem.AnswerGuid),answerName:this.getAnswerName(metadataItem.AnswerGuid)})}};;MetadataModalCtrl.prototype.checkAddUpdate=function(autoSelect){var addState=false;var updateState=false;var removeState=false;var itemFound=false;var selectedIndex=-1;for(var i=0;i<this.existingMetadata.length;i++){if(this.existingMetadata[i].selected){selectedIndex=i}if(Intelledox.Common.Functions.EqualsIgnoreCase(this.existingMetadata[i].name,this.name)){if(autoSelect){this.existingMetadata[i].selected=true;selectedIndex=i}updateState=true;itemFound=true;break}}if(selectedIndex>-1){removeState=true;if(autoSelect){for(var i=0;i<this.existingMetadata.length;i++){if(i!==selectedIndex){this.existingMetadata[i].selected=false}}}}if(!itemFound){if(!System.String.IsNullOrWhiteSpace(this.name)){addState=true;if(selectedIndex>-1){updateState=true}}}this.isAddEnabled=addState;this.isUpdateEnabled=updateState;this.isRemoveEnabled=removeState};MetadataModalCtrl.prototype.checkSelectedItem=function(item){this.name=Design.TranslationHelper.KeywordValueToTranslation(this._filter,item.Name);this.selectedType=item.ElementTypeId;this.fixed=Design.TranslationHelper.KeywordValueToTranslation(this._filter,item.FixedValue);this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(item.AnswerGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(item.ElementTypeId!==Intelledox.Model.MetadataElementType.TypeString){item.FixedValue='';this.fixed=''}var stopCheck=false;for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var p=this._wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<p.Questions.length;questionIndex++){var qn=p.Questions[questionIndex];for(var answerIndex=0;answerIndex<qn.Answers.length;answerIndex++){if(qn.Answers[answerIndex].AnswerGuid===item.AnswerGuid){this.selectedQuestionGuid=qn.QuestionGuid;this.selectedAnswerGuid=item.AnswerGuid;stopCheck=true;break}}if(stopCheck){break};}if(stopCheck){break};}}this.checkAddUpdate(false)};MetadataModalCtrl.prototype.selectExistingMetadata=function(attr){for(var i=0;i<this.existingMetadata.length;i++){if(this.existingMetadata[i].tag===attr){this.existingMetadata[i].selected=true;this.checkSelectedItem(attr)}else{this.existingMetadata[i].selected=false}}};MetadataModalCtrl.prototype.add=function(){var newElement=new Intelledox.Model.MetadataElement;newElement.MetadataGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();newElement.Name=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.name);newElement.ElementTypeId=this.selectedType;newElement.FixedValue=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.fixed);newElement.AnswerGuid=this.selectedAnswerGuid;if(newElement.ElementTypeId!==Intelledox.Model.MetadataElementType.TypeString&&this.selectedAnswerGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){newElement.FixedValue='';this.fixed=''}this._wizard.MetadataElements.push(newElement);this.loadAllElements();this.selectExistingMetadata(newElement);this._editor.wizChanged=true};MetadataModalCtrl.prototype.update=function(){var foundItem;for(var i=0;i<this.existingMetadata.length;i++){if(this.existingMetadata[i].selected){foundItem=this.existingMetadata[i].tag;break}}foundItem.Name=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.name);foundItem.ElementTypeId=this.selectedType;foundItem.FixedValue=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.fixed);foundItem.AnswerGuid=this.selectedAnswerGuid;if(foundItem.ElementTypeId!==Intelledox.Model.MetadataElementType.TypeString&&foundItem.AnswerGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){foundItem.FixedValue='';this.fixed=''}this.loadAllElements();this.selectExistingMetadata(foundItem);this._editor.wizChanged=true};MetadataModalCtrl.prototype.remove=function(){if(confirm(System.String.Format(this._filter('translate')('RemoveMetadataPrompt'),this.name))){var foundItem;for(var i=0;i<this.existingMetadata.length;i++){if(this.existingMetadata[i].selected){foundItem=this.existingMetadata[i].tag;break}}for(var i=0;i<this._wizard.MetadataElements.length;i++){if(this._wizard.MetadataElements[i]===foundItem){this._wizard.MetadataElements.splice(i,1);break}}this.loadAllElements();this.checkAddUpdate(true);this.name="";this.fixed="";this.selectedType=Intelledox.Model.MetadataElementType.TypeString;this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._editor.wizChanged=true}};return MetadataModalCtrl}());Design.MetadataModalCtrl=MetadataModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var OpenImageModalCtrl=(function(){function OpenImageModalCtrl($scope,$modalInstance,$http){$scope.ok=function(){var content=new FormData;content.append("file",document.getElementById('selectImage').files[0]);$http.post('../api/v1/prepareImage',content,{transformRequest:angular.identity,headers:{'Content-Type':undefined}}).then(function(response){$modalInstance.close(response.data)})};$scope.cancel=function(){$modalInstance.dismiss('cancel')}}return OpenImageModalCtrl}());Design.OpenImageModalCtrl=OpenImageModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var FindModalCtrl=(function(){function FindModalCtrl($scope,$filter,$modalInstance){$scope.model={};$scope.model.itemType=FindModalCtrl.lastItemType==null?Design.findType.any:FindModalCtrl.lastItemType;$scope.model.findWhat='';$scope.model.replaceWith='';$scope.model.searchOn=FindModalCtrl.lastSearchOn==null?Design.findOn.text:FindModalCtrl.lastSearchOn;$scope.showFind=true;$scope.availableTypes=[];$scope.availableTypes.push({name:$filter('translate')('Any'),value:Design.findType.any});$scope.availableTypes.push({name:$filter('translate')('Placeholder'),value:Design.findType.placeholder});$scope.availableTypes.push({name:$filter('translate')('Question'),value:Design.findType.question});$scope.availableTypes.push({name:$filter('translate')('Answer'),value:Design.findType.answer});$scope.availableTypes.push({name:$filter('translate')('Layout'),value:Design.findType.layout});$scope.availableTypes.push({name:$filter('translate')('ContentItem'),value:Design.findType.contentItem});$scope.availableSearchOns=[];$scope.availableSearchOns.push({name:$filter('translate')('Name'),value:Design.findOn.text});$scope.availableSearchOns.push({name:$filter('translate')('Id'),value:Design.findOn.id});$scope.ok=function(){FindModalCtrl.lastItemType=$scope.model.itemType;FindModalCtrl.lastSearchOn=$scope.model.searchOn;$modalInstance.close({isFind:$scope.showFind,itemType:$scope.model.itemType,findWhat:$scope.model.findWhat,searchOn:$scope.model.searchOn,replaceWith:$scope.model.replaceWith})};$scope.cancel=function(){$modalInstance.dismiss('cancel')}}return FindModalCtrl}());Design.FindModalCtrl=FindModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var MultiChoiceAnswersModalCtrl=(function(){function MultiChoiceAnswersModalCtrl($scope,$modalInstance){$scope.model=new MultiChoiceAnswersViewModel;$scope.ok=function(){$modalInstance.close([$scope.model.answer1,$scope.model.answer2,$scope.model.answer3,$scope.model.answer4,$scope.model.answer5])}}return MultiChoiceAnswersModalCtrl}());Design.MultiChoiceAnswersModalCtrl=MultiChoiceAnswersModalCtrl;var MultiChoiceAnswersViewModel=(function(){function MultiChoiceAnswersViewModel(){this.answer1='';this.answer2='';this.answer3='';this.answer4='';this.answer5=''}return MultiChoiceAnswersViewModel}());Design.MultiChoiceAnswersViewModel=MultiChoiceAnswersViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var SelectContentItemModalCtrl=(function(){function SelectContentItemModalCtrl($scope,$modalInstance,$filter,designApi,lists,contentTypeId){$scope.contentItem=null;$scope.categories=[];$scope.folders=[];$scope.existingContentItems=[];$scope.name='';$scope.selectedCategory=0;$scope.selectedFolder=Intelledox.Common.ConstantValues.FINISHED_STATE_GUID;lists.contentCategories().then(function(categories){var categoriesClone=categories.slice(0);var all=new Intelledox.Model.Category;all.categoryId=0;all.name=$filter('translate')('All');categoriesClone.splice(0,0,all);$scope.categories=categoriesClone});lists.contentFolders().then(function(folders){var foldersClone=folders.slice(0);var allFolder=new Intelledox.Model.ContentFolder;allFolder.folderGuid=Intelledox.Common.ConstantValues.FINISHED_STATE_GUID;allFolder.name=$filter('translate')('All');var blankFolder=new Intelledox.Model.ContentFolder;blankFolder.folderGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;blankFolder.name=$filter('translate')('NoneWithBrackets');foldersClone.splice(0,0,blankFolder);foldersClone.splice(0,0,allFolder);$scope.folders=foldersClone});$scope.search=function(){var searchOptions=new Intelledox.Model.ContentItemSearchOptions;searchOptions.categoryId=$scope.selectedCategory;searchOptions.contentTypeId=contentTypeId;searchOptions.name=$scope.name;searchOptions.folderGuid=$scope.selectedFolder;if($scope.selectedFolder===Intelledox.Common.ConstantValues.GUID_EMPTY){searchOptions.noFolder=true}if($scope.selectedFolder===Intelledox.Common.ConstantValues.FINISHED_STATE_GUID){searchOptions.folderGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}$scope.existingContentItems=[];$scope.contentItem=null;designApi.getContentItemsWithOptions(searchOptions).then(function(items){for(var i=0;i<items.length;i++){$scope.existingContentItems.push({tag:items[i],name:items[i].name,selected:false})}})};$scope.selectExistingContentItem=function(item){$scope.contentItem=item;for(var i=0;i<$scope.existingContentItems.length;i++){if($scope.existingContentItems[i].tag===item){$scope.existingContentItems[i].selected=true}else{$scope.existingContentItems[i].selected=false}}};$scope.ok=function(){$modalInstance.close($scope.contentItem)};$scope.cancel=function(){$modalInstance.dismiss('cancel')}}return SelectContentItemModalCtrl}());Design.SelectContentItemModalCtrl=SelectContentItemModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var SelectTemplateModalCtrl=(function(){function SelectTemplateModalCtrl($scope,$modalInstance,$filter,extensionSuggestion){$scope.newTemplate=null;$scope.extensionSuggestion=extensionSuggestion;$scope.fileSelected=function(){};$scope.ok=function(){if(this.newTemplate==null||this.newTemplate.name==null){return}var extension=this.newTemplate.name.substring(this.newTemplate.name.lastIndexOf('.'));var formatType=Intelledox.Model.FormatType.GetID(extension);if(formatType===Intelledox.Model.TemplateFormatType.None){alert(System.String.Format($filter('translate')('ErrorMsg_InvalidFileType'),Intelledox.Model.FormatType.validExtensions()));return}var filename=this.newTemplate.name.substring(0,this.newTemplate.name.lastIndexOf('.'));var reader=new FileReader;reader.onloadend=function(){$modalInstance.close({binary:reader.result.split(",")[1],formatType:formatType,filename:filename})};reader.readAsDataURL(this.newTemplate)};$scope.cancel=function(){$modalInstance.dismiss('cancel')}}return SelectTemplateModalCtrl}());Design.SelectTemplateModalCtrl=SelectTemplateModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var SelectPlaceholdersModalCtrl=(function(){function SelectPlaceholdersModalCtrl($scope,$modalInstance,$filter,editor,singleSelect,placeholders,usedPlaceholders,unusedPlaceholders,additionalListItem,placeholderPurpose){$scope.singleSelect=singleSelect;$scope.isAddEnabled=false;$scope.isRemoveEnabled=false;$scope.types=[];$scope.existingPlaceholders=[];$scope.availablePlaceholders=[];editor.fillPlaceholderDropdownNoBlanks($scope.availablePlaceholders,placeholderPurpose);if(additionalListItem!=null){$scope.availablePlaceholders.push(additionalListItem)}Object.defineProperty($scope,"selectedPlaceholder",{get:function(){return this._selectedPlaceholder},set:function(value){this._selectedPlaceholder=value;$scope.updateButtons()},enumerable:true,configurable:true});var getSelectedExistingPlaceholder=function getSelectedExistingPlaceholder(){for(var i=0;i<$scope.existingPlaceholders.length;i++){if($scope.existingPlaceholders[i].selected){return $scope.existingPlaceholders[i]}}return null};$scope.types.push({name:$filter('translate')('Bookmark'),value:Intelledox.Model.PlaceholderType.Bookmark});$scope.types.push({name:$filter('translate')('Tag'),value:Intelledox.Model.PlaceholderType.Mustache});$scope.types.push({name:$filter('translate')('Slide'),value:Intelledox.Model.PlaceholderType.Slide});for(var i=0;i<placeholders.length;i++){var bm=placeholders[i];var listItem=new Design.PlaceholderListItem(bm,Intelledox.Common.ConstantValues.GUID_EMPTY);var found=false;for(var docGuid in usedPlaceholders){if(usedPlaceholders.hasOwnProperty(docGuid)){var docPlaceholders=usedPlaceholders[docGuid];for(var placeIndex=0;placeIndex<docPlaceholders.length;placeIndex++){if(docPlaceholders[placeIndex].equals(bm)){listItem.documentGuid=docGuid;found=true;break}}if(found){break}}}if(!found){for(var docGuid in unusedPlaceholders){if(unusedPlaceholders.hasOwnProperty(docGuid)){var docPlaceholders=unusedPlaceholders[docGuid];for(var placeIndex=0;placeIndex<docPlaceholders.length;placeIndex++){if(docPlaceholders[placeIndex].equals(bm)){listItem.documentGuid=docGuid;found=true;break}}if(found){break}}}}$scope.existingPlaceholders.push({tag:listItem,name:listItem.reference.name,selected:false})}$scope.updateButtons=function updateButtons(){if(singleSelect&&$scope.existingPlaceholders.length>0){$scope.isAddEnabled=false}else{$scope.isAddEnabled=($scope.selectedPlaceholder!=null)}var selectedItem=getSelectedExistingPlaceholder();$scope.isRemoveEnabled=(selectedItem!=null)};$scope.selectExistingPlaceholder=function selectExistingPlaceholder(attr){for(var i=0;i<$scope.existingPlaceholders.length;i++){if($scope.existingPlaceholders[i].tag===attr){$scope.existingPlaceholders[i].selected=true;$scope.updateButtons()}else{$scope.existingPlaceholders[i].selected=false}}};$scope.add=function add(){if($scope.selectedPlaceholder!=null){$scope.existingPlaceholders.push({tag:$scope.selectedPlaceholder,name:$scope.selectedPlaceholder.reference.name,selected:false});$scope.availablePlaceholders.splice($scope.availablePlaceholders.indexOf($scope.selectedPlaceholder),1);$scope.updateButtons()}};$scope.remove=function remove(){var selectedItem=getSelectedExistingPlaceholder();if(selectedItem!=null){$scope.availablePlaceholders.push(selectedItem.tag);$scope.existingPlaceholders.splice($scope.existingPlaceholders.indexOf(selectedItem),1);$scope.updateButtons()}};$scope.ok=function ok(){var returnList=[];for(var i=0;i<$scope.existingPlaceholders.length;i++){returnList.push($scope.existingPlaceholders[i].tag)}$modalInstance.close(returnList)};$scope.cancel=function cancel(){$modalInstance.dismiss('cancel')}}return SelectPlaceholdersModalCtrl}());Design.SelectPlaceholdersModalCtrl=SelectPlaceholdersModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var YesNoCancelModalCtrl=(function(){function YesNoCancelModalCtrl($scope,$modalInstance,$sce,htmlMessage){$scope.message=$sce.trustAsHtml(htmlMessage);$scope.yes=function(){$modalInstance.close(true)};$scope.no=function(){$modalInstance.close(false)};$scope.cancel=function(){$modalInstance.dismiss('cancel')}}return YesNoCancelModalCtrl}());Design.YesNoCancelModalCtrl=YesNoCancelModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ConfirmModalCtrl=(function(){function ConfirmModalCtrl($scope,$modalInstance,$sce,htmlMessage){$scope.message=$sce.trustAsHtml(htmlMessage);$scope.ok=function(){$modalInstance.close()};$scope.cancel=function(){$modalInstance.dismiss('cancel')}}return ConfirmModalCtrl}());Design.ConfirmModalCtrl=ConfirmModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ProjectVersionModalCtrl=(function(){function ProjectVersionModalCtrl($scope,$modalInstance){$scope.comment='';$scope.ok=function(){$modalInstance.close($scope.comment)};$scope.cancel=function(){$modalInstance.dismiss('cancel')}}return ProjectVersionModalCtrl}());Design.ProjectVersionModalCtrl=ProjectVersionModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var StartupCtrl=(function(){function StartupCtrl($scope,designApi,recentProjects){$scope.model=new StartupViewModel;var _app=this;$scope.showOpenExisting=function(){$scope.model.isOpenExisting=true;_app.getExistingProjects($scope,designApi)};$scope.showCreateNew=function(){$scope.model.isOpenExisting=false};this.login($scope,designApi,recentProjects)}StartupCtrl.prototype.login=function($scope,designApi,recentProjects){var _this=this;if(System.String.IsNullOrEmpty(sessionStorage.getItem("authorizationToken"))){designApi.login().success(function(data){sessionStorage.setItem("authorizationToken",data.authorizationToken);$scope.model.isLoggedIn=true;_this.getRecentProjects($scope,recentProjects)}).error(function(){window.location.replace('../')})}else{$scope.model.isLoggedIn=true;this.getRecentProjects($scope,recentProjects)}};StartupCtrl.prototype.getRecentProjects=function($scope,recentProjects){$scope.model.recentProjects=recentProjects.getList()};StartupCtrl.prototype.getExistingProjects=function($scope,designApi){designApi.getProjects(true).then(function(data){$scope.model.existingProjects=data;$scope.model.filteredExistingProjects=data})};return StartupCtrl}());Design.StartupCtrl=StartupCtrl;var StartupViewModel=(function(){function StartupViewModel(){this.isLoggedIn=false;this.isOpenExisting=false;this.recentProjects=[];this.existingProjects=[];this.filteredExistingProjects=[]}Object.defineProperty(StartupViewModel.prototype,"projectSearch",{get:function(){return this._projectSearch},set:function(value){this._projectSearch=value;this.filterProjects()},enumerable:true,configurable:true});StartupViewModel.prototype.filterProjects=function(){var name=(this._projectSearch+'').toUpperCase();this.filteredExistingProjects=this.existingProjects.filter(function(project){return project.name.toUpperCase().indexOf(name)>-1})};return StartupViewModel}());Design.StartupViewModel=StartupViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var SaveProjectModalCtrl=(function(){function SaveProjectModalCtrl($scope,$modalInstance,$filter,designApi,projectName,projectType,listManager,wizard){$scope.name=projectName;$scope.folders=[];$scope.publishFolders=[];$scope.ShowPublish=false;$scope.CanPublish=false;$scope.ShowConvert=false;$scope.CanConvert=true;$scope.ShowNodes=false;$scope.pages=[];$scope.selectedPortionNode=Intelledox.Common.ConstantValues.GUID_EMPTY;var allPages=new Intelledox.QAWizard.Design.Page(Intelledox.Common.ConstantValues.COPY_TO_FRAGMENT_ALLPAGES_GUID);allPages.Name=$filter('translate')('AllPages');$scope.pages=jQuery.extend(true,[],wizard.Pages);Object.defineProperty($scope,"selectedConvertType",{get:function(){return this._selectedConvertType},set:function(value){this._selectedConvertType=value;$scope.ShowNodes=true;if(value===Intelledox.Model.ProjectType.FragmentPage.toString()){$scope.pages.splice(0,0,allPages)}else if($scope.pages[0].PageGuid===Intelledox.Common.ConstantValues.COPY_TO_FRAGMENT_ALLPAGES_GUID){$scope.pages.splice(0,1)}}});listManager.canPublish().then(function(result){if(projectType===Intelledox.Model.ProjectType.Content||projectType===Intelledox.Model.ProjectType.Dashboard){$scope.CanPublish=result["canPublish"]}}).then(function(){listManager.contentFoldersByUser().then(function(folders){var foldersClone=folders.slice(0);var blankFolder=new Intelledox.Model.ContentFolder;blankFolder.folderGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;blankFolder.name=$filter('translate')('NoneWithBrackets');foldersClone.splice(0,0,blankFolder);$scope.folders=foldersClone;$scope.selectedFolder=Intelledox.Common.ConstantValues.GUID_EMPTY}).then(function(){$scope.selectedPublishFolder=Intelledox.Common.ConstantValues.GUID_EMPTY;if($scope.CanPublish){listManager.publishFolders().then(function(publishfolders){var publishClone=publishfolders["value"];$scope.publishFolders=publishClone})}})});$scope.ok=function(){designApi.getProjects(false).then(function(data){if($scope.ShowConvert){if($scope.selectedPortionNode==Intelledox.Common.ConstantValues.GUID_EMPTY){return}if($scope.selectedConvertType==Intelledox.Common.ConstantValues.GUID_EMPTY){return}}var compareName=$scope.name.toUpperCase();listManager.contentFolders().then(function(contentFolders){for(var i=0;i<data.length;i++){var proj=data[i];if(proj.name.toUpperCase()===compareName){if(proj.folderGuid!==null&&proj.folderGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&contentFolders.map(function(x){return x.folderGuid}).indexOf(proj.folderGuid)===-1){alert($filter('translate')('MsgProjectOverwriteDenied'));$modalInstance.dismiss('cancel')}else if(!$scope.ShowConvert&&confirm($filter('translate')('MsgProjectAlreadyExistsOverwite').replace("{0}",$scope.name))){$modalInstance.close({name:$scope.name,existingProjectGuid:proj.projectGuid,folderGuid:$scope.selectedFolder,publishGuid:$scope.selectedPublishFolder,convertType:$scope.selectedConvertType,layoutGuid:$scope.selectedPortionNode})}else if($scope.ShowConvert){alert($filter('translate')('MsgProjectOverwriteDenied'))}else{$modalInstance.dismiss('cancel')}return}}$modalInstance.close({name:$scope.name,existingProjectGuid:Intelledox.Common.ConstantValues.GUID_EMPTY,folderGuid:$scope.selectedFolder,publishGuid:$scope.selectedPublishFolder,convertType:$scope.selectedConvertType,layoutGuid:$scope.selectedPortionNode})})})};$scope.cancel=function(){$modalInstance.dismiss('cancel')}}return SaveProjectModalCtrl}());Design.SaveProjectModalCtrl=SaveProjectModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ProjectNameScope=(function(){function ProjectNameScope(){this.name='';this.projectType=Intelledox.Model.ProjectType.Content.toString();this.newTemplate=null;this.documentBinary=null;this.formatType=Intelledox.Model.TemplateFormatType.None;this.filename=null}Object.defineProperty(ProjectNameScope.prototype,"isValid",{get:function(){return!(this.name==''||(this.projectType==='2'&&this.documentBinary===null))},enumerable:true,configurable:true});return ProjectNameScope}());Design.ProjectNameScope=ProjectNameScope;var ProjectNameModalCtrl=(function(){function ProjectNameModalCtrl($scope,$modalInstance,$filter){$scope.model=new ProjectNameScope;$scope.fileSelected=function(){if($scope.model.newTemplate==null||$scope.model.newTemplate.name==null){return}var extension=$scope.model.newTemplate.name.substring($scope.model.newTemplate.name.lastIndexOf('.'));var formatType=Intelledox.Model.FormatType.GetID(extension);if(formatType!==Intelledox.Model.TemplateFormatType.WordBinary&&formatType!==Intelledox.Model.TemplateFormatType.WordDocx){alert(System.String.Format($filter('translate')('ErrorMsg_InvalidFileType'),'docx, doc'));return}var reader=new FileReader;reader.onloadend=function(){$scope.$apply(function(){$scope.model.documentBinary=reader.result.split(",")[1];$scope.model.formatType=formatType;$scope.model.filename=$scope.model.newTemplate.name})};reader.readAsDataURL($scope.model.newTemplate)};$scope.ok=function(){$modalInstance.close({name:$scope.model.name,projectType:parseInt($scope.model.projectType,10),binary:$scope.model.documentBinary,formatType:$scope.model.formatType,filename:$scope.model.filename})};$scope.cancel=function(){$modalInstance.dismiss('cancel')}}return ProjectNameModalCtrl}());Design.ProjectNameModalCtrl=ProjectNameModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var AppCtrl=(function(){function AppCtrl($scope,$location,$uibModal,$filter,$q,designApi,recentProjects,settings){var _app=this;this._filter=$filter;this._q=$q;this._designApi=designApi;$scope.tinymceHtml={plugins:'code hr link textcolor paste',browser_spellcheck:true,forced_root_block:false,trusted:true,menubar:false,statusbar:false,toolbar:['bold italic ',' forecolor ',' bullist numlist ',' superscript hr ',' link code ',' pastetext'],valid_elements:"+*[*]",valid_children:"+button[a]",width:"99%",convert_urls:false,relative_urls:false,remove_script_host:false,paste_as_text:true};$scope.tinymceHtmlWithPickRef={plugins:'code hr link textcolor paste',browser_spellcheck:true,forced_root_block:false,trusted:true,menubar:false,statusbar:false,toolbar:['bold italic ',' forecolor ',' bullist numlist ',' superscript hr ',' link code ',' pastetext pickRef'],valid_elements:"+*[*]",valid_children:"+button[a]",width:"99%",convert_urls:false,relative_urls:false,remove_script_host:false,paste_as_text:true};$scope.uiModel=new Design.UIViewModel(settings);$scope.model=new Design.EditorViewModel($filter,$uibModal,$q,$scope,designApi);$scope.nodeSelected=function(node){$scope.model.nodeSelected(node)};$scope.closeProject=function(){if($scope.model.currentPage instanceof Design.WorkflowPage){$scope.model.workflowSwitch();var $body=angular.element(document.body);var $rootScope=$body.injector().get('$rootScope');$rootScope.$emit('hideTempTreeView')}else{_app.saveCheck($scope,$uibModal,designApi,recentProjects).then(function(){$scope.model.wizChanged=false;$scope.model.monitor.clear();window.location.replace('index.html?v=106882799234227327')})}};$scope.save=function(){if($scope.model.isNewTemplate){_app.saveTemplateAs($scope,$uibModal,designApi,recentProjects)}else{_app.saveChanges($scope,designApi,Intelledox.Common.ConstantValues.GUID_EMPTY,recentProjects,$scope.model.wizard)}};$scope.saveAs=function(){_app.saveTemplateAs($scope,$uibModal,designApi,recentProjects)};$scope.editorDrop=function(mode,dropped,targetNode){$scope.$apply(function(){if(dropped instanceof Design.PlaceholderTreeNode){$scope.model.editorDropPlaceholder(dropped,targetNode)}else if(dropped.tag instanceof Intelledox.QAWizard.Design.ResponseMetadataField){$scope.model.editorDropResponseMetadataField(dropped.tag,targetNode)}else if(mode==='treeview'){$scope.model.editorMove(dropped,targetNode)}else{$scope.model.editorDrop(dropped,targetNode)}})};$scope.editorDelete=function(){$scope.model.editorDelete()};$scope.editorCopy=function(){$scope.model.editorCopy()};$scope.editorCut=function(){$scope.model.editorCut()};$scope.editorPaste=function(){$scope.model.editorPaste()};$scope.setFocus=function(id){var element=window.document.getElementById(id);if(element)element.focus()};$scope.colorPickerOptions={format:'hex',pos:'bottom left'};$scope.colorPickerEventApi={onBlur:function(api,color,$event){if(color.length>0){var isOk=/^#[0-9A-F]{6}$/i.test(color);if(!isOk){api.reset()}}}};this.ensureLogin(designApi,function(){if($location.search().id!=null){_app.getProjectDefinition($location.search().id,$scope,designApi,recentProjects)}else{_app.startNewProject($scope,$uibModal)}});$(window).on('beforeunload',function(e){if($scope.model.beginTemplateEdit){$scope.model.beginTemplateEdit=false}else if($scope.model.wizChanged){return _app._filter('translate')('ConfirmExit')}else if(!$scope.model.isNewTemplate&&$scope.model.versionChanged){setTimeout(function(){_app.userWantsToComment($scope,$uibModal,designApi)},10);return _app._filter('translate')('ConfirmCommentExit')}});$(window).on('unload',function(e){if($scope.model.locked){designApi.unlockProjectExit($scope.model.wizard.ProjectGuid,$scope.model.templateBinaries)}})}AppCtrl.prototype.userWantsToComment=function($scope,$uibModal,designApi){this.unlockProject($scope,$uibModal,designApi).then(function(){$scope.model.versionChanged=false;window.close()})};AppCtrl.prototype.ensureLogin=function(designApi,callback){if(System.String.IsNullOrEmpty(sessionStorage.getItem("authorizationToken"))){designApi.login().success(function(data){sessionStorage.setItem("authorizationToken",data.authorizationToken);callback()}).error(function(){window.location.replace('../')})}else{callback()}};AppCtrl.prototype.getProjectDefinition=function(projectGuid,$scope,designApi,recentProjects){var app=this;this.tryLockProject(projectGuid).then(function(){$scope.model.locked=true;designApi.getProjectDefinition(projectGuid).then(function(data){var importer=new Intelledox.QAWizard.Design.WizardController;var wizard=importer.CreateFromXTF(data.xml);recentProjects.addRecent(projectGuid,wizard.Name);app._wizard=wizard;var binaries=[];for(var i=0;i<wizard.Documents.length;i++){var docBinary=new Intelledox.Model.DocumentBinary;docBinary.documentGuid=wizard.Documents[i].DocumentGuid;docBinary.formatType=wizard.Documents[i].FormatType;binaries.push(docBinary)}$scope.model.templateBinaries=binaries;$scope.model.setWizard(wizard).then(function(){app.refreshWizardName($scope,app._wizard,wizard.Name,false);if(wizard.Pages.length>0){$scope.model.currentPage=wizard.Pages[0]}})}).catch(function(data){if(data.status===403||data.status===404){console.log('Project not found');designApi.unlockProject(projectGuid,"",null);if(confirm(app._filter('translate')('ErrorMsg_TemplateNotFound'))){recentProjects.removeRecent(projectGuid)}window.location.replace('index.html?v=106882799234227327');return}console.log(data)})},function(){document.location.replace('index.html?v=106882799234227327')})};AppCtrl.prototype.startNewProject=function($scope,$uibModal){var app=this;var modalInstance=$uibModal.open({templateUrl:'Views/Modal/projectName.html?v=106882799234227327',controller:['$scope','$modalInstance','$filter',Design.ProjectNameModalCtrl],backdrop:'static'});modalInstance.result.then(function(projectInfo){var newWizard=new Intelledox.QAWizard.Design.Wizard;newWizard.ProjectGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();newWizard.TypeId=projectInfo.projectType;newWizard.Name=projectInfo.name;newWizard.Compatibility=Intelledox.QAWizard.Design.CompatibilityLevel.Version2014;newWizard.FinishPageVisible=false;app._wizard=newWizard;$scope.model.setWizard(newWizard).then(function(){if(projectInfo.projectType===Intelledox.Model.ProjectType.Layout){$scope.model.processNewTemplate({binary:projectInfo.binary,formatType:projectInfo.formatType,filename:projectInfo.name},newWizard.ProjectGuid,null,false)}}).then(function(){$scope.model.createNewPage($scope.model.wizard);$scope.model.currentPage=newWizard.Pages[0];app.refreshWizardName($scope,app._wizard,projectInfo.name,false);$scope.model.isNewTemplate=true;$scope.model.wizChanged=true})},function(){document.location.replace('index.html?v=106882799234227327')})};AppCtrl.prototype.saveTemplateAs=function($scope,$uibModal,designApi,recentProjects){var app=this;var modalInstance=$uibModal.open({templateUrl:'Views/Modal/saveProject.html?v=106882799234227327',controller:['$scope','$modalInstance','$filter','designApi','projectName','projectType','listManager','wizard',Design.SaveProjectModalCtrl],backdrop:'static',resolve:{projectName:function(){return app._wizard.Name},projectType:function(){return app._wizard.TypeId},listManager:function(){return $scope.model.listManager},wizard:function(){return app._wizard}}});return modalInstance.result.then(function(result){var wizardCopy=app._wizard;var isConvert=false;if(result.convertType===Intelledox.Model.ProjectType.FragmentPage.toString()||result.convertType===Intelledox.Model.ProjectType.FragmentPortion.toString()){wizardCopy=jQuery.extend(true,{},app._wizard);if(result.convertType===Intelledox.Model.ProjectType.FragmentPage.toString()){wizardCopy.TypeId=Intelledox.Model.ProjectType.FragmentPage;app.StripProjectToFragment(wizardCopy,Intelledox.Model.ProjectType.FragmentPage,result.layoutGuid)}else if(result.convertType===Intelledox.Model.ProjectType.FragmentPortion.toString()){wizardCopy.TypeId=Intelledox.Model.ProjectType.FragmentPortion;app.StripProjectToFragment(wizardCopy,Intelledox.Model.ProjectType.FragmentPortion,result.layoutGuid)}result.existingProjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;isConvert=true}if(!$scope.model.isNewTemplate){var continueSave=true;var importGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(result.existingProjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){importGuid=result.existingProjectGuid;continueSave=(result.existingProjectGuid===wizardCopy.ProjectGuid)||true;app.tryLockProject(result.existingProjectGuid).then(function(){$scope.model.locked=true})}else{importGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid()}if(continueSave){var isNewVersion=true;var docs=new Array;if(result.existingProjectGuid!==wizardCopy.ProjectGuid){app.closeExistingProject($scope,designApi,result.name)}else{isNewVersion=!$scope.model.versionChanged}app.refreshWizardName($scope,wizardCopy,result.name,isConvert);for(var docIndex=0;docIndex<wizardCopy.Documents.length;docIndex++){var doc=wizardCopy.Documents[docIndex];if(doc.HasBinary){var docBin=new Intelledox.Model.DocumentBinary;var templateEditGuid=null;for(var binaryIndex=0;binaryIndex<$scope.model.templateBinaries.length;binaryIndex++){if($scope.model.templateBinaries[binaryIndex].documentGuid===wizardCopy.Documents[docIndex].DocumentGuid){templateEditGuid=$scope.model.templateBinaries[binaryIndex].templateEditGuid;break}}docBin.templateEditGuid=templateEditGuid;docBin.documentGuid=doc.DocumentGuid;docBin.formatType=doc.FormatType;docs.push(docBin)}}var originalProjectGuid=$scope.model.isNewTemplate?Intelledox.Common.ConstantValues.GUID_EMPTY:wizardCopy.ProjectGuid;wizardCopy.ProjectGuid=importGuid;if(wizardCopy.TypeId===Intelledox.Model.ProjectType.Layout){if(wizardCopy.Documents[0].DocumentGuid!==wizardCopy.ProjectGuid){Design.HelperFunctions.ForAllPlaceholders(wizardCopy,function(ph){if(ph.DocumentGuid===wizardCopy.Documents[0].DocumentGuid){ph.DocumentGuid=wizardCopy.ProjectGuid}});wizardCopy.Documents[0].DocumentGuid=wizardCopy.ProjectGuid;docs[0].documentGuid=wizardCopy.ProjectGuid}}app.updateProjectDefinition(designApi,$scope.model,wizardCopy,docs,isNewVersion,originalProjectGuid,result.folderGuid).then(function(){$scope.model.isNewTemplate=false;$scope.model.wizChanged=false;$scope.model.versionChanged=true;recentProjects.addRecent(wizardCopy.ProjectGuid,wizardCopy.Name);if(result.existingProjectGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){designApi.tryLockProject(wizardCopy.ProjectGuid).then(function(){$scope.model.locked=true})}if(result.publishGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){app.publish(result.publishGuid,wizardCopy.ProjectGuid)}if(isConvert){$scope.model.wizChanged=true;window.open('editor.html?v=106882799234227327#/?id='+wizardCopy.ProjectGuid,'_blank')}})}}else{if(result.existingProjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){app.tryLockProject(result.existingProjectGuid).then(function(){wizardCopy.ProjectGuid=result.existingProjectGuid;app.refreshWizardName($scope,wizardCopy,result.name,isConvert);app.saveChanges($scope,designApi,result.folderGuid,recentProjects,wizardCopy).then(function(){if(result.publishGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){app.publish(result.publishGuid,wizardCopy.ProjectGuid)}});$scope.model.locked=true})}else{app.refreshWizardName($scope,wizardCopy,result.name,isConvert);app.saveChanges($scope,designApi,result.folderGuid,recentProjects,wizardCopy).then(function(){if(isConvert){$scope.model.wizChanged=true;window.open('editor.html?v=106882799234227327#/?id='+wizardCopy.ProjectGuid,'_blank')}return designApi.tryLockProject(wizardCopy.ProjectGuid)}).then(function(){$scope.model.locked=true;if(result.publishGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){app.publish(result.publishGuid,wizardCopy.ProjectGuid);if(isConvert){$scope.model.wizChanged=true;window.open('editor.html?v=106882799234227327#/?id='+wizardCopy.ProjectGuid,'_blank')}}})}}})};AppCtrl.prototype.publish=function(folderId,projectId){var publishProject=new Infiniti.Model.Apis.PublishProject;publishProject.projectId=projectId;publishProject.folderId=folderId;var app=this;this._designApi.publishProject(publishProject).then(function(result){if(result.success){}else{if(result.code==="exists"){}else if(result.code==="licensing"){alert(app._filter('translate')('ErrorMsg_PublishLicense'))}else{alert(result.code)}}})};AppCtrl.prototype.saveChanges=function($scope,designApi,folderGuid,recentProjects,wizard){var editorViewModel=$scope.model;editorViewModel.treeView.isInPickMode=false;if(wizard.Name.trim()===""){alert(this._filter('translate')('ErrorMsg_InvalidProjectNameForSave'));return}var docs=new Array;for(var docIndex=0;docIndex<wizard.Documents.length;docIndex++){var doc=wizard.Documents[docIndex];if(doc.HasBinary){var docBin=new Intelledox.Model.DocumentBinary;var templateEditGuid=null;for(var binaryIndex=0;binaryIndex<editorViewModel.templateBinaries.length;binaryIndex++){if(editorViewModel.templateBinaries[binaryIndex].documentGuid===wizard.Documents[docIndex].DocumentGuid){templateEditGuid=editorViewModel.templateBinaries[binaryIndex].templateEditGuid;break}}docBin.documentGuid=doc.DocumentGuid;docBin.formatType=doc.FormatType;docBin.templateEditGuid=templateEditGuid;docs.push(docBin)}}return this.updateProjectDefinition(designApi,editorViewModel,wizard,docs,!editorViewModel.versionChanged,Intelledox.Common.ConstantValues.GUID_EMPTY,folderGuid).then(function(){editorViewModel.wizChanged=false;editorViewModel.versionChanged=true;editorViewModel.isNewTemplate=false;recentProjects.addRecent(wizard.ProjectGuid,wizard.Name)})};AppCtrl.prototype.updateProjectDefinition=function(designApi,editorViewModel,wizard,docs,isNewVersion,originalProjectGuid,folderGuid){var updateRequest=new Intelledox.Model.ProjectDefinitionRequest;var exporter=new Intelledox.QAWizard.Design.WizardController;var xml=exporter.SerializeToXTF(wizard);updateRequest.projectGuid=wizard.ProjectGuid;updateRequest.xml=xml;updateRequest.isNewVersion=isNewVersion;updateRequest.originalProjectGuid=originalProjectGuid;updateRequest.documents=docs;updateRequest.folderGuid=folderGuid;return designApi.updateProjectDefinition(updateRequest)};AppCtrl.prototype.tryLockProject=function(projectGuid,lockedByUsername){if(lockedByUsername===void 0){lockedByUsername=""}var app=this;var deferred=this._q.defer();this._designApi.tryLockProject(projectGuid).then(function(lockedByUsername){if(!System.String.IsNullOrEmpty(lockedByUsername)){alert(System.String.Format(app._filter('translate')('ProjectLockedMessage'),lockedByUsername));deferred.reject()}else{deferred.resolve()}});return deferred.promise};AppCtrl.prototype.closeExistingProject=function($scope,designApi,projectName){var projectVersionComment="";if($scope.model.versionChanged){projectVersionComment=System.String.Format(this._filter('translate')('SaveAsVersionComment'),projectName)}designApi.unlockProject($scope.model.wizard.ProjectGuid,projectVersionComment,null);$scope.model.locked=false;$scope.model.versionChanged=false};AppCtrl.prototype.refreshWizardName=function($scope,wizCopy,projectName,isConvert){wizCopy.Name=projectName;if(!isConvert){this.updateTitle($scope,wizCopy)}};AppCtrl.prototype.StripProjectToFragment=function(wizCopy,projectType,layoutGuid){wizCopy.Workflow=null;wizCopy.Actions=[];wizCopy.Documents=[];if(layoutGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&layoutGuid!==Intelledox.Common.ConstantValues.COPY_TO_FRAGMENT_ALLPAGES_GUID){var index=0;for(var i=0;i<wizCopy.Pages.length;i++){if(wizCopy.Pages[i].PageGuid===layoutGuid){index=i;break}}var page=wizCopy.Pages[index];if(projectType==Intelledox.Model.ProjectType.FragmentPortion){var pageChildren=page.Children;var newPage=new Intelledox.QAWizard.Design.Page(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());newPage.Name=this._filter('translate')('Layout');for(var i=0;i<pageChildren.length;i++){newPage.Children.push(pageChildren[i])}wizCopy.Pages.splice(0,wizCopy.Pages.length,newPage)}else{wizCopy.Pages.splice(0,wizCopy.Pages.length,page)}}};AppCtrl.prototype.updateTitle=function($scope,wizCopy){$scope.model.projectName=wizCopy.Name+($scope.model.wizard.Compatibility===Intelledox.QAWizard.Design.CompatibilityLevel.Version2014?"":this._filter('translate')('CompatibiltyMode'))};AppCtrl.prototype.saveCheck=function($scope,$uibModal,designApi,recentProjects){var vm=this;var deferred=this._q.defer();if(this._wizard==null){deferred.resolve()}else if($scope.model.wizChanged){var message=System.String.Format(this._filter('translate')('SaveCheckFormat'),Intelledox.Common.Functions.EscapeHtml($scope.model.wizard.Name));var modalInstance=$uibModal.open({templateUrl:'Views/Modal/confirmSave.html?v=106882799234227327',controller:['$scope','$modalInstance','$sce','htmlMessage',Design.YesNoCancelModalCtrl],backdrop:'static',resolve:{htmlMessage:function(){return message}}});modalInstance.result.then(function(yesSelected){if(yesSelected){if($scope.model.isNewTemplate){vm.saveTemplateAs($scope,$uibModal,designApi,recentProjects).then(function(){return vm.unlockProject($scope,$uibModal,designApi)}).then(function(){deferred.resolve()},function(){deferred.reject()})}else{vm.saveChanges($scope,designApi,Intelledox.Common.ConstantValues.GUID_EMPTY,recentProjects,$scope.model.wizard).then(function(){return vm.unlockProject($scope,$uibModal,designApi)}).then(function(){deferred.resolve()},function(){deferred.reject()})}}else{deferred.resolve()}},function(){deferred.reject()})}else{vm.unlockProject($scope,$uibModal,designApi).then(function(){deferred.resolve()},function(){deferred.reject()})}return deferred.promise};AppCtrl.prototype.unlockProject=function($scope,$uibModal,designApi){var deferred=this._q.defer();if($scope.model.isNewTemplate){deferred.resolve()}else{if($scope.model.versionChanged){var modalInstance=$uibModal.open({templateUrl:'Views/Modal/projectVersion.html?v=106882799234227327',controller:['$scope','$modalInstance',Design.ProjectVersionModalCtrl],backdrop:'static'});modalInstance.result.then(function(comment){return designApi.unlockProject($scope.model.wizard.ProjectGuid,comment,$scope.model.templateBinaries).then(function(){$scope.model.locked=false;$scope.model.versionChanged=false;deferred.resolve()})},function(){deferred.reject()})}else{$scope.model.locked=false;designApi.unlockProject($scope.model.wizard.ProjectGuid,"",$scope.model.templateBinaries).then(function(){deferred.resolve()})}}return deferred.promise};return AppCtrl}());Design.AppCtrl=AppCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Infiniti;(function(Infiniti){var Model;(function(Model){var Apis;(function(Apis){var PublishFolder=(function(){function PublishFolder(){this.id=Intelledox.Common.ConstantValues.GUID_EMPTY;this.name=null}return PublishFolder}());Apis.PublishFolder=PublishFolder})(Apis=Model.Apis||(Model.Apis={}))})(Model=Infiniti.Model||(Infiniti.Model={}))})(Infiniti||(Infiniti={}));var Infiniti;(function(Infiniti){var Model;(function(Model){var Apis;(function(Apis){var ProjectGroup=(function(){function ProjectGroup(){this.name=null;this.projectGroupGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.groupGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}return ProjectGroup}());Apis.ProjectGroup=ProjectGroup})(Apis=Model.Apis||(Model.Apis={}))})(Model=Infiniti.Model||(Infiniti.Model={}))})(Infiniti||(Infiniti={}));var Infiniti;(function(Infiniti){var Model;(function(Model){var Apis;(function(Apis){var Folder=(function(){function Folder(){this.name=null;this.providerName=null;this.projectGroups=null}return Folder}());Apis.Folder=Folder})(Apis=Model.Apis||(Model.Apis={}))})(Model=Infiniti.Model||(Infiniti.Model={}))})(Infiniti||(Infiniti={}));var Infiniti;(function(Infiniti){var Model;(function(Model){var Apis;(function(Apis){var PublishProjectResult=(function(){function PublishProjectResult(){this.success=true;this.code=null;this.url=null}return PublishProjectResult}());Apis.PublishProjectResult=PublishProjectResult})(Apis=Model.Apis||(Model.Apis={}))})(Model=Infiniti.Model||(Infiniti.Model={}))})(Infiniti||(Infiniti={}));var Infiniti;(function(Infiniti){var Model;(function(Model){var Apis;(function(Apis){var PublishProject=(function(){function PublishProject(){this.folderId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.projectId=Intelledox.Common.ConstantValues.GUID_EMPTY}return PublishProject}());Apis.PublishProject=PublishProject})(Apis=Model.Apis||(Model.Apis={}))})(Model=Infiniti.Model||(Infiniti.Model={}))})(Infiniti||(Infiniti={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var CssStyle=(function(){function CssStyle(){this.cssName=null;this.webClass=null}return CssStyle}());Model.CssStyle=CssStyle})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var ResponseMetadataField=(function(){function ResponseMetadataField(){this.responseMetadataFieldGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.name=null}return ResponseMetadataField}());Model.ResponseMetadataField=ResponseMetadataField})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var SchemaField=(function(){function SchemaField(){this.name=null;this.displayName=null;this.dataObjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.isRepeated=false;this.hierarchyParentName=null}return SchemaField}());Model.SchemaField=SchemaField})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var TemporaryUserSave=(function(){function TemporaryUserSave(){this.AccessCodeGeneration=Intelledox.Model.AccessCodeGeneration.None;this.AccessCodeGenerationQuestion=Intelledox.Common.ConstantValues.GUID_EMPTY;this.AccessCodeGenerationAnswer=Intelledox.Common.ConstantValues.GUID_EMPTY;this.HelpText=null;this.EmailTo=null;this.EmailSubject=null;this.EmailBody=null;this.ResumeText=null;this.ReassignText=null;this.RecipientName=null}return TemporaryUserSave}());Design.TemporaryUserSave=TemporaryUserSave})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var LanguageTranslation=(function(){function LanguageTranslation(){this.controlGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.parentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.lang=null;this.description=null;this.translations={}}return LanguageTranslation}());Design.LanguageTranslation=LanguageTranslation;var LanguageSummary=(function(){function LanguageSummary(){this.lang=null;this.count=null}return LanguageSummary}());Design.LanguageSummary=LanguageSummary})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var AlterProperty=(function(){function AlterProperty(){this.Id=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Value=''}return AlterProperty}());Design.AlterProperty=AlterProperty})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ProtectedField=(function(){function ProtectedField(){this.Name='';this.Reference=''}ProtectedField.prototype.Clone=function(){var result=new ProtectedField;result.Reference=this.Reference;result.Name=this.Name;return result};return ProtectedField}());Design.ProtectedField=ProtectedField})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Question=(function(){function Question(questionGuid,questionText){this.m_DefaultValue=null;this.ID=0;this.QuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Mandatory=Design.MandatoryType.No;this.AllowComments=false;this.DisplayType=Intelledox.Model.QuestionDisplayType.MultiChoice;this.SelectionType=Intelledox.Model.SelectionType.Single;this.TextPosition=Design.TextPosition.Top;this.CssStyle=null;this.WidthType=Design.WidthType.Pixel;this.LeftQuestionWidth=Intelledox.Common.ConstantValues.DEFAULTLEFTQUESTIONWIDTH_PIXELS;this.Visibility=false;this.SaveToAnswerFile=false;this.Watermark=null;this.RepeatParent=Intelledox.Common.ConstantValues.GUID_EMPTY;if(questionGuid){this.QuestionGuid=questionGuid;this.InitBase()}else{this.Visibility=true;this.DefaultValue="";this.HelpText="";this.AllowComments=false}if(questionText){this.Text=questionText}else{this.Text=null}}Object.defineProperty(Question.prototype,"DefaultValue",{get:function(){return this.m_DefaultValue},set:function(value){this.m_DefaultValue=value},enumerable:true,configurable:true});Object.defineProperty(Question.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.None},enumerable:true,configurable:true});Object.defineProperty(Question.prototype,"IsDisplayQuestionType",{get:function(){return true},enumerable:true,configurable:true});Object.defineProperty(Question.prototype,"HasValidationRules",{get:function(){return(this.m_Validations!=null&&this.m_Validations.length>0)},enumerable:true,configurable:true});Question.prototype.Clone=function(nextId,addQuestionsToPage){if(addQuestionsToPage===void 0){addQuestionsToPage=null}var result=this.CloneWithoutAnswers(nextId);for(var i=0;i<this.Answers.length;i++){var newAnswer=this.Answers[i].Clone();newAnswer.ID=nextId.nextAnswerId;newAnswer.Question=result;nextId.nextAnswerId+=1;result.Answers.push(newAnswer);if(this.Answers[i].AnswerGuid.toString()===this.DefaultValue){result.DefaultValue=newAnswer.AnswerGuid.toString()}}if(addQuestionsToPage!=null){result.Page=addQuestionsToPage;addQuestionsToPage.Questions.push(result)}return result};Question.prototype.CloneWithoutAnswers=function(nextId){var result=new Question(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());return this.CloneWithoutAnswersInternal(nextId,result)};Question.prototype.CloneWithoutAnswersInternal=function(nextId,result){result.Text=this.Text;result.Mandatory=this.Mandatory;result.HelpText=this.HelpText;result.AllowComments=this.AllowComments;result.DisplayType=this.DisplayType;result.TextPosition=this.TextPosition;result.CssStyle=this.CssStyle;result.WidthType=this.WidthType;result.LeftQuestionWidth=this.LeftQuestionWidth;result.DefaultValue=this.DefaultValue;result.SelectionType=this.SelectionType;result.Visibility=this.Visibility;result.SaveToAnswerFile=this.SaveToAnswerFile;result.SaveToAnswerFileLabel=this.SaveToAnswerFileLabel;result.RepeatParent=this.RepeatParent;result.Watermark=this.Watermark;if(this.ActiveConditions!=null){result.ActiveConditions=this.ActiveConditions.Clone()}if(this.VisibleConditions!=null){result.VisibleConditions=this.VisibleConditions.Clone()}if(this.EditableConditions!=null){result.EditableConditions=this.EditableConditions.Clone()}if(this.MandatoryConditions!=null){result.MandatoryConditions=this.MandatoryConditions.Clone()}if(this.HasValidationRules){for(var i=0;i<this.Validations.length;i++){result.Validations.push(this.Validations[i].Clone())}}if(this.Summary!=null){result.Summary=this.Summary.Clone()}result.ID=nextId.nextQuestionId;nextId.nextQuestionId+=1;return result};Question.prototype.InitBase=function(){this.Visibility=true;this.DefaultValue="";this.HelpText="";this.AllowComments=false;this.Answers=new Array;this.SelectionType=Intelledox.Model.SelectionType.Single;this.SaveToAnswerFileLabel=""};Object.defineProperty(Question.prototype,"ObjectId",{get:function(){return this.QuestionGuid},set:function(value){this.QuestionGuid=value},enumerable:true,configurable:true});Object.defineProperty(Question.prototype,"TranslatedText",{get:function(){return this.KeywordValueToTranslation(this.Text)},set:function(value){this.Text=this.TranslationToKeywordValue(value)},enumerable:true,configurable:true});Object.defineProperty(Question.prototype,"Validations",{get:function(){if(this.m_Validations==null){this.m_Validations=new Array}return this.m_Validations},enumerable:true,configurable:true});Question.prototype.HasChild=function(childGuid){if(childGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return false}return(this.QuestionGuid===childGuid)};Question.prototype.KeywordValueToTranslation=function(keywordValue){var result=keywordValue;result=result.replace(Intelledox.Common.ConstantValues.ROW_COUNT+"]",Design.Resources.Strings.RowCount+"]");result=result.replace(Intelledox.Common.ConstantValues.ROW_NUMBER+"]",Design.Resources.Strings.RowNumber+"]");result=result.replace(Intelledox.Common.ConstantValues.ROW_ID+"]",Design.Resources.Strings.RowId+"]");result=result.replace("."+Intelledox.Common.ConstantValues.FILENAME+"]","."+Design.Resources.Strings.FileNameWithoutBlanks+"]");return result};Question.prototype.TranslationToKeywordValue=function(translation){var result=translation;result=Design.GeneralFunctions.ReplaceIgnoreCase(result,Design.Resources.Strings.RowCount+"]",Intelledox.Common.ConstantValues.ROW_COUNT+"]");result=Design.GeneralFunctions.ReplaceIgnoreCase(result,Design.Resources.Strings.RowNumber+"]",Intelledox.Common.ConstantValues.ROW_NUMBER+"]");result=Design.GeneralFunctions.ReplaceIgnoreCase(result,Design.Resources.Strings.RowId+"]",Intelledox.Common.ConstantValues.ROW_ID+"]");result=Design.GeneralFunctions.ReplaceIgnoreCase(result,"."+Design.Resources.Strings.FileNameWithoutBlanks+"]","."+Intelledox.Common.ConstantValues.FILENAME+"]");return result};Question.prototype.FindAnswer=function(answerGuid){for(var i=0;i<this.Answers.length;i++){if(this.Answers[i].AnswerGuid===answerGuid){return this.Answers[i]}}return null};Question.prototype.HasLayoutInterface=function(){return true};return Question}());Design.Question=Question})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var RunActionButtonQuestion=(function(_super){__extends(RunActionButtonQuestion,_super);function RunActionButtonQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.Actions=[];_this.ClassName="";return _this}Object.defineProperty(RunActionButtonQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.RunActionButton},enumerable:true,configurable:true});RunActionButtonQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new RunActionButtonQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);for(var i=0;i<this.Actions.length;i++){var act=this.Actions[i].Clone(nextId);result.Actions.push(act)}result.ClassName=this.ClassName;return result};return RunActionButtonQuestion}(Design.Question));Design.RunActionButtonQuestion=RunActionButtonQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ButtonQuestion=(function(_super){__extends(ButtonQuestion,_super);function ButtonQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.ButtonType=Intelledox.Model.ButtonType.Toggle;_this.Title='';_this.Badge='';_this.BackColour='';_this.BackToggleColour='';_this.BackColourDark='';_this.BackToggleColourDark='';_this.FocusRingColour='';_this.Size=Intelledox.Model.ButtonSize.Medium;_this.Icon=null;_this.LaunchUrl=null;_this.NewTab=true;_this.GoToPageGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.GoToProjectGroupGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.DisplayType=Intelledox.Model.QuestionDisplayType.TileButton;return _this}Object.defineProperty(ButtonQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Button},enumerable:true,configurable:true});ButtonQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new ButtonQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);result.ButtonType=this.ButtonType;result.Title=this.Title;result.Badge=this.Badge;result.BackColour=this.BackColour;result.BackToggleColour=this.BackToggleColour;result.BackColourDark=this.BackColourDark;result.BackToggleColourDark=this.BackToggleColourDark;result.FocusRingColour=this.FocusRingColour;result.Size=this.Size;result.Icon=this.Icon;result.LaunchUrl=this.LaunchUrl;result.NewTab=this.NewTab;result.GoToPageGuid=this.GoToPageGuid;result.GoToProjectGroupGuid=this.GoToProjectGroupGuid;result.DisplayType=this.DisplayType;return result};Object.defineProperty(ButtonQuestion.prototype,"BackgroundImage",{get:function(){var style='';if(this.BackColour!==''){style="linear-gradient(to bottom,"+this.BackColour+" 0%,"+this.BackColourDark+" 100%)"}return style},enumerable:true,configurable:true});Object.defineProperty(ButtonQuestion.prototype,"DataUrlIcon",{get:function(){if(!System.String.IsNullOrEmpty(this.Icon)){return Intelledox.Common.ConstantValues.DATA_URI_PREFIX+this.Icon}return''},enumerable:true,configurable:true});return ButtonQuestion}(Design.Question));Design.ButtonQuestion=ButtonQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Summary;(function(Summary){var FormSummarySettings=(function(){function FormSummarySettings(){this.UpToCurrentPageOnly=false;this.CollapsiblePages=false;this.IncludePageLinks=false;this.IncludeComments=false;this.IncludeAllChoices=false;this.ShowPasswordText=false;this.ExcludedPages=null}FormSummarySettings.prototype.Clone=function(){var result=new FormSummarySettings;result.UpToCurrentPageOnly=this.UpToCurrentPageOnly;result.CollapsiblePages=this.CollapsiblePages;result.IncludePageLinks=this.IncludePageLinks;result.IncludeComments=this.IncludeComments;result.IncludeAllChoices=this.IncludeAllChoices;result.ShowPasswordText=this.ShowPasswordText;if(this.ExcludedPages!=null){result.ExcludedPages=[];for(var i=0;i<this.ExcludedPages.length;i++){result.ExcludedPages.push(this.ExcludedPages[i])}}return result};return FormSummarySettings}());Summary.FormSummarySettings=FormSummarySettings})(Summary=Design.Summary||(Design.Summary={}))})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var SummaryQuestion=(function(_super){__extends(SummaryQuestion,_super);function SummaryQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.Settings=new Design.Summary.FormSummarySettings;return _this}Object.defineProperty(SummaryQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Summary},enumerable:true,configurable:true});SummaryQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new SummaryQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());result.Settings=this.Settings.Clone();_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);return result};return SummaryQuestion}(Design.Question));Design.SummaryQuestion=SummaryQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ResponseMetadataField=(function(){function ResponseMetadataField(){this.ResponseMetadataFieldGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}return ResponseMetadataField}());Design.ResponseMetadataField=ResponseMetadataField})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ProjectProperty=(function(){function ProjectProperty(){this.Id=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Name='';this.InitialValue=''}return ProjectProperty}());Design.ProjectProperty=ProjectProperty})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Summary;(function(Summary){var QuestionSummarySettings=(function(){function QuestionSummarySettings(){this.Include=Design.QuestionSummaryInclude.Default;this.Title=null;this.ShowAll=null}QuestionSummarySettings.prototype.Clone=function(){var result=new QuestionSummarySettings;result.Include=this.Include;result.Title=this.Title;result.ShowAll=this.ShowAll;return result};return QuestionSummarySettings}());Summary.QuestionSummarySettings=QuestionSummarySettings})(Summary=Design.Summary||(Design.Summary={}))})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Summary;(function(Summary){var PageSummarySettings=(function(){function PageSummarySettings(){this.Include=null;this.Collapsible=null;this.Title=null}PageSummarySettings.prototype.Clone=function(){var result=new PageSummarySettings;result.Include=this.Include;result.Collapsible=this.Collapsible;result.Title=this.Title;return result};return PageSummarySettings}());Summary.PageSummarySettings=PageSummarySettings})(Summary=Design.Summary||(Design.Summary={}))})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));angular.module('ui.tinymce',[]).directive('uiTinymce',['$rootScope','$compile','$timeout','$window','$sce','$filter',function($rootScope,$compile,$timeout,$window,$sce,$filter){var generatedIds=0;var ID_ATTR='ui-tinymce';return{require:['ngModel','^?form'],scope:{uiTinymce:'=',pickRefEditor:'&',treeView:'='},link:function(scope,element,attrs,ctrls){var newObjectName=System.String.Format($filter('translate')('NewObjectFormat'),$filter('translate')('Question'),"");if(!$window.tinymce){return}var ngModel=ctrls[0],form=ctrls[1]||null;var expression,options={},tinyInstance,updateView=function(editor){var content=editor.getContent({format:options.format}).trim();if(System.String.StartsWith(content,"<div>")&&content.indexOf("</div>")===content.length-6){content=content.substring(5,content.length-6)}else if(System.String.StartsWith(content,"<p>")&&content.indexOf("</p>")===content.length-4){content=content.substring(3,content.length-4)}content=$sce.trustAsHtml(content);ngModel.$setViewValue(content);if(!$rootScope.$$phase){scope.$digest()}};function toggleDisable(disabled){if(disabled){ensureInstance();if(tinyInstance){tinyInstance.getBody().setAttribute('contenteditable',false)}}else{ensureInstance();if(tinyInstance&&!tinyInstance.settings.readonly){tinyInstance.getBody().setAttribute('contenteditable',true)}}}attrs.$set('id',ID_ATTR+'-'+generatedIds++);expression={};angular.extend(expression,scope.$eval(attrs.uiTinymce));var setupOptions={setup:function(ed){ed.on('init',function(){ngModel.$render();ngModel.$setPristine();ngModel.$setUntouched();if(form){form.$setPristine()}$(this.contentAreaContainer.parentElement).find("div.mce-toolbar-grp").hide();if(checkDefaultQText(ed)){ed.focus()}});ed.on('ExecCommand',function(){ed.save();updateView(ed)});ed.on('change NodeChange',function(){ed.save();updateView(ed)});ed.on('blur',function(){element[0].blur();ngModel.$setTouched();scope.$digest();var tv=scope.treeView;if(tv==null||!tv.isInPickMode){$(this.contentAreaContainer.parentElement).find("div.mce-toolbar-grp").hide()}});ed.on('ObjectResized',function(){ed.save();updateView(ed)});ed.on('remove',function(){element.remove()});if(expression.setup){expression.setup(ed,{updateView:updateView})}ed.on('focus',function(){$(this.contentAreaContainer.parentElement).find("div.mce-toolbar-grp").show();setTimeout(function(){if(checkDefaultQText(ed)){ed.selection.select(ed.getBody(),true)}},10)});if(scope.pickRefEditor){ed.addButton('pickRef',{text:'',icon:true,image:'Images/refPick.svg',onclick:function(){scope.pickRefEditor({ed:ed});$('.mce-ref').toggleClass('mce-active',scope.treeView.isInPickMode)},subtype:'ref',tooltip:$filter('translate')('QuestionReference')})}},format:expression.format||'html',selector:'#'+attrs.id};angular.extend(options,scope.uiTinymce,expression,setupOptions);$timeout(function(){if(options.baseURL){tinymce.baseURL=options.baseURL}tinymce.init(options);toggleDisable(scope.$eval(attrs.ngDisabled))});ngModel.$formatters.unshift(function(modelValue){return modelValue?$sce.trustAsHtml(modelValue):''});ngModel.$parsers.unshift(function(viewValue){return viewValue?$sce.getTrustedHtml(viewValue):''});ngModel.$render=function(){ensureInstance();var viewValue=ngModel.$viewValue?$sce.getTrustedHtml(ngModel.$viewValue):'';if(tinyInstance&&tinyInstance.getDoc()){var node=tinyInstance.getBody().parentNode;var body=tinyInstance.getBody();tinyInstance.setContent(viewValue);tinyInstance.fire('change')}};attrs.$observe('disabled',toggleDisable);scope.$on('$tinymce:refresh',function(e,id){var eid=attrs.id;if(angular.isUndefined(id)||id===eid){var parentElement=element.parent();var clonedElement=element.clone();clonedElement.removeAttr('id');clonedElement.removeAttr('style');clonedElement.removeAttr('aria-hidden');tinymce.execCommand('mceRemoveEditor',false,eid);parentElement.append($compile(clonedElement)(scope))}});scope.$on('$destroy',function(){ensureInstance();if(tinyInstance){tinyInstance.remove();tinyInstance=null}});function checkDefaultQText(ed){var elementValue=ed.getContent();if(elementValue!=null){return System.String.StartsWith(elementValue,newObjectName)}return false}function ensureInstance(){if(!tinyInstance){tinyInstance=tinymce.get(attrs.id)}}}}}]);var Intelledox;(function(Intelledox){var Design;(function(Design){angular.module('Design',['pascalprecht.translate','ui.bootstrap','ui.tinymce','ui.ace','color.picker']).config(['$translateProvider','$compileProvider',function($translateProvider,$compileProvider){var determineLang=function(){var lang=Intelledox.Common.Device.GetFirstBrowserLanguage()||"en";lang=lang.toLowerCase();if(lang==="zh-cn"||lang==="zh-sg"){return"zh-hans"}else if(lang==="zh-tw"||lang==="zh-hk"){return"zh-hant"}else if(lang==="en-us"||lang==="zh-hans"||lang==="zh-hant"){return lang}else{if(lang.indexOf("-")>-1){lang=lang.split("-")[0]}if(lang==="ar"||lang==="de"||lang==="en"||lang==="es"||lang==="fr"||lang==="ko"||lang==="nl"||lang==="pt"||lang==="th"){return lang}else{return"en"}}};$translateProvider.useSanitizeValueStrategy('escaped').useStaticFilesLoader({prefix:'Content/Design/Strings.',suffix:'.json?v=106882799234227327'}).fallbackLanguage('en').determinePreferredLanguage(determineLang);$compileProvider.debugInfoEnabled(false);var currentLang=determineLang();if(currentLang!=='en'){var langScript=document.createElement('script');langScript.setAttribute('src','Content/QAWizardDesign/Strings.'+currentLang+'.js?v=106882799234227327');document.head.appendChild(langScript)}}]).controller('appCtrl',['$scope','$location','$uibModal','$filter','$q','designApi','recentProjects','settings',Design.AppCtrl]).directive('previewNode',['$compile','$http','$templateCache',function($compile,$http,$templateCache){var getTemplate=function(node){var templateUrl='Views/Preview/unsupportedPreviewNode.html?v=106882799234227327';if(node instanceof Intelledox.QAWizard.Design.Page){templateUrl='Views/Preview/pagePreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.Question){templateUrl='Views/Preview/questionPreviewLayout.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.Section){templateUrl='Views/Preview/sectionPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.TabGroup){templateUrl='Views/Preview/tabGroupPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.TabPage){templateUrl='Views/Preview/tabPagePreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.FragmentReference){templateUrl='Views/Preview/fragmentPreviewNode.html?v=106882799234227327';if(node.Preview==null){window['listManager'].projectFragment(node.ProjectGuid).then(function(wizard){if(wizard!=null){node.Preview=wizard.Pages[0]}})}}var templateLoader=$http.get(templateUrl,{cache:$templateCache});return templateLoader};var linker=function(scope,element,attrs){var loader=getTemplate(scope.node);loader.success(function(html){element.replaceWith($compile(html)(scope))})};return{restrict:'E',scope:{node:'=',onNodeSelected:'&',topSelectedFunc:'=',onEditorDrop:'&',topEditorDropFunc:'='},link:linker}}]).directive('questionPreviewNode',['$compile','$http','$templateCache',function($compile,$http,$templateCache){var getTemplate=function(node){var templateUrl='Views/Preview/unsupportedPreviewNode.html?v=106882799234227327';if(node instanceof Intelledox.QAWizard.Design.UserPromptQuestion){templateUrl='Views/Preview/userPromptPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.RichTextQuestion){templateUrl='Views/Preview/richTextPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.GroupLogicQuestion){templateUrl='Views/Preview/groupLogicPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.LabelQuestion){templateUrl='Views/Preview/labelPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.DatasourceQuestion){templateUrl='Views/Preview/datasourcePreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.GeolocationQuestion){templateUrl='Views/Preview/geolocationPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.ContentLibraryQuestion){templateUrl='Views/Preview/contentLibraryPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.InkQuestion){templateUrl='Views/Preview/inkPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.NumericQuestion){templateUrl='Views/Preview/numericPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.ValidationQuestion){templateUrl='Views/Preview/validationPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.CustomQuestion){templateUrl='Views/Preview/customPreviewNode.html?v=106882799234227327';if(node.Preview==null){window['listManager'].customQuestionType(node.CustomQuestionTypeId).then(function(cq){if(System.String.IsNullOrEmpty(cq.previewHtml)){node.Preview=''}else{node.Preview=cq.previewHtml}})}}else if(node instanceof Intelledox.QAWizard.Design.AddressQuestion){templateUrl='Views/Preview/addressPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.ButtonQuestion){templateUrl='Views/Preview/buttonPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.SummaryQuestion){templateUrl='Views/Preview/summaryPreviewNode.html?v=106882799234227327'}else if(node instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){templateUrl='Views/Preview/runActionButtonPreviewNode.html?v=106882799234227327'}var templateLoader=$http.get(templateUrl,{cache:$templateCache});return templateLoader};var linker=function(scope,element,attrs){var loader=getTemplate(scope.node);loader.success(function(html){element.replaceWith($compile(html)(scope))})};return{restrict:'E',scope:{node:'=',onNodeSelected:'&',topSelectedFunc:'=',onEditorDrop:'&',topEditorDropFunc:'='},link:linker}}]).directive('treeNode',['$compile',function treeNodeDirective($compile){var linker=function treeNodeLinker(scope,element,attrs){var nodeImage='  <div class="tree-icon" ng-class="node.imageKey"></div>';if(scope.node.imageKey!=null&&scope.node.imageKey.indexOf('url(')===0){nodeImage='  <div class="tree-icon" ng-style="{\'background-image\': node.imageKey}"></div>'}element.html($compile('<div class="tree-node" tabindex="0" '+'   ng-keydown="node.keyPress($event)" '+'   ng-style="{\'padding-left\': (16 * (node.level + 1)) + \'px\'}" '+'   ng-class="{\'tree-expanded\' : node.isExpanded, \'tree-faded\' : node.isFaded, \'tree-selected\' : node.isSelected }" '+'   ng-click="node.treeView.doSelection(node); $event.stopPropagation()" '+'   editor-droppable="node" on-editor-drop="topEditorDropFunc(mode, dropped, targetNode)">'+' <div class="tree-content" treeview-draggable>'+'  <div class="tree-expander has-children" ng-click="node.toggle(); $event.stopPropagation()"'+'   ng-if="node.hasChildren"></div>'+nodeImage+'  <span ng-dblclick="node.toggle()">{{node.text}}</span></div></div>'+'<div ng-if="node.isExpanded">'+' <tree-node ng-repeat="childNode in node.nodes" node="childNode" top-editor-drop-func="topEditorDropFunc"></tree-node></div>')(scope))};return{restrict:'E',scope:{node:'=',topEditorDropFunc:'='},link:linker}}]).directive('xngFocus',['$timeout',function($timeout){return{restrict:'A',link:function($scope,$element,$attr){$scope.$watch($attr.xngFocus,function(_focusVal){$timeout(function(){if(_focusVal){$element[0].focus()}})})}}}]).directive('clauseDesigner',function(){return{scope:{model:'='},templateUrl:'Views/Properties/clauseDesigner.html?v=106882799234227327',replace:true,controller:['$scope',Design.ClauseDesignerCtrl]}}).directive('clauseNode',['$compile',function clauseNodeDirective($compile){var linker=function clauseNodeLinker(scope,element,attrs){var currentNode=scope.node;var parentNode=currentNode.parent;var currentClause=currentNode.tag;var decoration='';var level=0;if(currentClause!=null){if(currentClause.Type===Intelledox.Model.ClauseType.Comparison){decoration='<div class="tree-comparision"></div>'}else if(currentClause.Type===Intelledox.Model.ClauseType.AnyOf){decoration='<div class="tree-anyof-vert"></div><div class="tree-anyof"></div>'}else if(currentClause.Type===Intelledox.Model.ClauseType.AllOf){decoration='<div class="tree-allof-vert"></div><div class="tree-allof"></div>'}while(parentNode!=null){if(parentNode.tag.Type===Intelledox.Model.ClauseType.AnyOf){decoration='<div class="tree-anyof-parent" style="margin-left: -'+(16*(level+1)).toString()+'px">&nbsp;</div>'+decoration}else if(parentNode.tag.Type===Intelledox.Model.ClauseType.AllOf){decoration='<div class="tree-allof-parent" style="margin-left: -'+(16*(level+1)).toString()+'px">&nbsp;</div>'+decoration}parentNode=parentNode.parent;level+=1}}element.html($compile('<div class="tree-node" tabindex="0" '+'   ng-style="{\'padding-left\': (16 * (node.level + 1)) + \'px\'}" '+'   ng-class="{\'tree-selected\' : node.isSelected }" '+'   ng-click="onClauseSelected({ node: node }); $event.stopPropagation()" '+'   ng-keydown="node.keyPress($event)" '+'   clause-droppable="node"> '+' <div class="tree-content">'+decoration+'  <span treeview-draggable>{{node.text}}</span></div></div>'+'<div ng-if="node.hasChildren">'+' <clause-node ng-repeat="childNode in node.nodes" node="childNode" on-clause-selected="topSelectedFunc(node)" top-selected-func="topSelectedFunc"></tree-node></div>')(scope))};return{restrict:'E',scope:{node:'=',onClauseSelected:'&',topSelectedFunc:'='},link:linker}}]).directive('fileChange',function fileChangeDirective(){return{restrict:'A',require:'ngModel',scope:{fileChange:'&'},link:function link(scope,element,attrs,ctrl){element.on('change',onChange);scope.$on('destroy',function(){element.off('change',onChange)});function onChange(){ctrl.$setViewValue(element[0].files[0]);scope.fileChange()}}}}).directive('middleClickOpen',['$window',function middleClickOpen($window){return{return:"EA",replace:false,transclude:false,link:function(scope,element,attrs){element.on('mouseup',onMouseUp);function onMouseUp($event){if($event.which===2||($event.which===1&&$event.ctrlKey)){$window.open('editor.html?v=106882799234227327#/?id='+scope.node.ProjectGuid)}}}}}]).filter('divideLength',function(){return function(input,divide){if(!(input instanceof Array)){return[]}divide=parseInt(divide,10);var out=[];for(var i=0;i<input.length+(divide-1);i+=divide){out.push(i)}return out}}).filter('limitFromTo',function(){return function(input,offset,limit){if(!(input instanceof Array)){return input}limit=parseInt(limit,10);var out=[];if(limit>input.length){limit=input.length}for(var i=offset;i<limit;i++){out.push(input[i])}return out}})})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){angular.module("Design").filter('infinitiHtml',['$sce',function($sce){return function(htmlCode){return $sce.trustAsHtml(Infiniti.HtmlParsing.sanitize(htmlCode))}}]).filter('customQuestionHtml',['$sce',function($sce){return function(htmlCode){return $sce.trustAsHtml(Infiniti.HtmlParsing.sanitizePreview(htmlCode))}}])})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){angular.module("Design").directive('cytoscape',['$rootScope','$timeout',function($rootScope,$timeout){return{restrict:'E',template:'<div id="workflow-cy"></div>',replace:true,scope:{cyWorkflow:'=',cyClick:'&',cyRebuild:'&'},link:function(scope,element){scope.doCy=function(){var workflowPage=scope.cyWorkflow;var cyDiv=$('#workflow-cy');scope.elements={};scope.elements.nodes=workflowPage.nodes;scope.elements.edges=workflowPage.edges;cyDiv.height($("#preview-section").height());cyDiv.cytoscape({layout:{name:'dagre'},minZoom:0.1,maxZoom:5,wheelSensitivity:0.2,style:[{selector:'node',style:{content:'data(name)','text-valign':'center',shape:function(ele){return ele.data('special')===true?'roundrectangle':(ele.data('isAction')?'rhomboid':'rectangle')},'text-wrap':'wrap','border-width':function(ele){return(ele.data('special')===true||ele.data('isEscalation')||ele.data('isAction')?2:4)},'border-color':function(ele){return ele.selected()?'#FF40FF':(ele.data('special')===true?'#3c4260':(ele.data('isEscalation')||ele.data('isAction')?'#33685F':'#3c4260'))},'background-color':function(ele){return ele.data('special')===true?'#feb663':(ele.data('isEscalation')||ele.data('isAction')?'#31D0C6':'#dcd7d7')},color:function(ele){return(ele.data('isEscalation')||ele.data('isAction')?'white':'#3c4260')},width:"data(width)",'background-image':function(ele){return ele.data('isEscalation')?'url(Images/subProcess.png)':'url(Images/blank.png)'},'font-size':function(ele){return ele.data('isEscalation')||ele.data('isAction')?'12px':'14px'},'background-fit':'cover','background-width':'100%'}},{selector:'edge',style:{'target-arrow-shape':function(ele){return ele.data('isEscalation')||ele.data('isAction')?'none':'triangle'},'target-arrow-color':function(ele){return ele.selected()?'#FF40FF':(ele.data('isSectionTransition')?'#ADADAD':'#2D2D2D')},'line-color':function(ele){return ele.selected()?'#FF40FF':(ele.data('isSectionTransition')?'#ADADAD':'#222138')},'line-style':function(ele){return ele.data('isEscalation')?'dashed':'solid'},content:function(ele){return(ele.data('transType')===Design.TransitionType.Normal||ele.data('transType')===Design.TransitionType.MultipleExit||ele.data('transType')===Design.TransitionType.MultipleEntry)&&ele.data('name')!=null?ele.data('name'):''}}},{selector:'node:parent',style:{'background-color':'#ADDAFF','border-color':'#41719C','border-width':1}}],ready:function(){window['cy']=this;window['cy'].on('select','node, edge',function(e){var evtTarget=e.cyTarget;var nodeItem=evtTarget.data('tag');scope.$apply(function(){scope.cyClick({node:nodeItem})})});window['cy'].on('free','node, edge',function(e){var evtTarget=e.cyTarget;var nodeItem=evtTarget.data('tag');var dragAction=null;var dropAction=null;if(nodeItem instanceof Intelledox.QAWizard.Design.Action){dragAction=nodeItem;var parentDragTransition=workflowPage.findTransitionByAction(dragAction);var posX=evtTarget.renderedPosition('x');var posY=evtTarget.renderedPosition('y')}else{return}var cyNodes=window['cy'].nodes();var actionCounter=0;var transHeight=0;var dropActionIndex=-1;var isLastAction=false;for(var i=0;i<cyNodes.length;i++){nodeItem=cyNodes[i].data('tag');if(nodeItem instanceof Intelledox.QAWizard.Design.Action){var tmpAction=nodeItem;var parentDropTransition=workflowPage.findTransitionByAction(tmpAction);if(parentDragTransition.StateId===parentDropTransition.StateId&&parentDragTransition.Actions.length>1){actionCounter++;if(tmpAction.ActionGuid!=dragAction.ActionGuid){var pos=cyNodes[i].renderedPosition();var width=cyNodes[i].renderedOuterWidth();var height=cyNodes[i].renderedOuterHeight();if(pos.x-(width/2)<=posX&&pos.x+(width/2)>=posX&&pos.y-(height/2)<=posY&&pos.y+(height/2)>=posY){dropAction=tmpAction;break}var refPosY=0;if(actionCounter===1){var nextPos=cyNodes[i+1].renderedPosition();transHeight=nextPos.y-(pos.y+height);if(transHeight<0){transHeight=height*1.5}refPosY=pos.y-(transHeight+height)}else{var prevPos=cyNodes[i-1].renderedPosition();refPosY=prevPos.y}if(pos.x-(width/2)<=posX&&pos.x+(width/2)>=posX&&posY<=pos.y&&posY>=refPosY){dropAction=tmpAction;break}if(actionCounter===parentDropTransition.Actions.length){actionCounter=0;refPosY=pos.y+((height*2)+transHeight);if(pos.x-(width/2)<=posX&&pos.x+(width/2)>=posX&&posY>=(pos.y+height)&&posY<=refPosY){dropAction=tmpAction;dropActionIndex=parentDropTransition.Actions.length;isLastAction=true;break}}}}}}if(dropAction!=null&&!isLastAction){for(var i=0;i<parentDropTransition.Actions.length;i++){if(parentDropTransition.Actions[i].ActionGuid===dropAction.ActionGuid){dropActionIndex=i;break}}}if(dropActionIndex!=-1){if(workflowPage.reorderAction(parentDragTransition,dragAction,dropActionIndex)){scope.$emit('workflowChanged')}}});$('#workflow-cy')[0].addEventListener('drop',function(e){e.preventDefault();e.stopPropagation();var offset=$('#workflow-cy').offset();var dropX=e.pageX-offset.left;var dropY=e.pageY-offset.top;var foundNodes=[];var cyNodes=window['cy'].nodes();for(var i=0;i<cyNodes.length;i++){var pos=cyNodes[i].renderedPosition();var width=cyNodes[i].renderedOuterWidth();var height=cyNodes[i].renderedOuterHeight();if(pos.x-(width/2)<=dropX&&pos.x+(width/2)>dropX&&pos.y-(height/2)<=dropY&&pos.y+(height/2)>dropY){foundNodes.push(cyNodes[i])}}if(window['ix-dragObject']==='toolbox_workflow.parallel'||window['ix-dragObject']==='toolbox_workflow.state'){var parentParallel=null;var newObject=null;for(var i=foundNodes.length-1;i>=0;i--){var tag=foundNodes[i].data('tag');if(tag instanceof Intelledox.QAWizard.Design.Workflow){parentParallel=tag;break}}if(window['ix-dragObject']==='toolbox_workflow.parallel'){newObject=workflowPage.addNewParallel(parentParallel)}else{newObject=workflowPage.addNewState(parentParallel)}scope.$emit('workflowChanged');scope.$apply(function(){scope.cyClick({node:newObject})})}else if(window['ix-dragObject']==='toolbox_workflow.transition'){for(var i=foundNodes.length-1;i>=0;i--){var tag=foundNodes[i].data('tag');if(tag instanceof Intelledox.QAWizard.Design.WorkflowState){var newTrans=workflowPage.addNewTransition(tag);scope.$apply(function(){scope.cyClick({node:newTrans})});break}}}else if(System.String.StartsWith(window['ix-dragObject'],'toolbox_escalation')){for(var i=foundNodes.length-1;i>=0;i--){var tag=foundNodes[i].data('tag');if(tag instanceof Intelledox.QAWizard.Design.WorkflowState){workflowPage.addNewEscalation(tag,window['ix-dragObject'].split('.')[1]).then(function(newEscalation){scope.$emit('workflowChanged');scope.cyClick({node:newEscalation})});break}}}else if(System.String.StartsWith(window['ix-dragObject'],'toolbox_action')){var parentAction=null;var parentTransition=null;for(var i=foundNodes.length-1;i>=0;i--){var tag=foundNodes[i].data('tag');if(tag instanceof Intelledox.QAWizard.Design.Action){var targetAction=tag;if(targetAction.IsRepeated&&targetAction.RepeaterGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){parentAction=targetAction}else{parentTransition=workflowPage.findTransitionByAction(targetAction)}break}}if(parentTransition==null&&parentAction==null){var cyEdges=window['cy'].edges();for(var i=0;i<cyEdges.length;i++){if(cyEdges[i].selected()){var tag=cyEdges[i].data('tag');if(tag instanceof Design.WorkflowTransitionCollection&&tag.transitions[0].StateId!==Intelledox.QAWizard.Design.FinishWorkflowState.FixedId&&tag.transType!==Design.TransitionType.MultipleEntry&&tag.transType!==Design.TransitionType.SingleExit){parentTransition=tag.transitions[0]}break}}}if(parentTransition!=null||parentAction!=null){workflowPage.addNewAction(parentTransition,parentAction,window['ix-dragObject'].split('.')[1]).then(function(newAction){scope.$emit('workflowChanged');scope.cyClick({node:newAction})})}}window['ix-dragMode']='';window['ix-dragObject']=null},false);$('#workflow-cy')[0].addEventListener('dragover',function(e){e.stopPropagation();e.preventDefault();return false},false);window['cy'].load(scope.elements)}})};$rootScope.$on('workflowChanged',function(){scope.cyRebuild();scope.elements={};scope.elements.nodes=scope.cyWorkflow.nodes;scope.elements.edges=scope.cyWorkflow.edges;window['cy'].load(scope.elements)});$rootScope.$on('workflowSelectAndInitTransition',function(event,trans,isPriorityExitChange){var found=false;for(var edgeIndex=0;edgeIndex<scope.elements.edges.length;edgeIndex++){var currentEdge=scope.elements.edges[edgeIndex];var col=currentEdge.data.tag;if(col.transitions!=null&&col.transitions.length>1){for(var transIndex=0;transIndex<col.transitions.length;transIndex++){if(trans===col.transitions[transIndex]){var templateTran=null;for(var templateIndex=0;templateIndex<col.transitions.length;templateIndex++){if(trans!==col.transitions[templateIndex]){templateTran=col.transitions[templateIndex];break}}if(templateTran!=null){trans.SendToGroup=templateTran.SendToGroup;trans.SendToUser=templateTran.SendToUser;trans.SendToName=templateTran.SendToName;trans.SendToRestrictGroup=templateTran.SendToRestrictGroup;trans.SendToRestrictSearch=templateTran.SendToRestrictSearch;trans.SendToRestrictName=templateTran.SendToRestrictName;trans.SendEmail=templateTran.SendEmail;trans.ShowNextSteps=templateTran.ShowNextSteps;trans.ShowSendTo=templateTran.ShowSendTo;trans.ShowComment=templateTran.ShowComment;trans.DefaultComment=templateTran.DefaultComment;trans.CommentMandatory=templateTran.CommentMandatory;trans.SendTo=templateTran.SendTo;trans.SendToType=templateTran.SendToType;trans.AllowReassign=templateTran.AllowReassign;trans.EmailSubject=templateTran.EmailSubject;trans.EmailText=templateTran.EmailText;trans.QuestionGuid=templateTran.QuestionGuid;trans.AnswerGuid=templateTran.AnswerGuid;trans.Name=templateTran.Name;if(!isPriorityExitChange){trans.PageTitle=templateTran.PageTitle;trans.HelpText=templateTran.HelpText;trans.SubmitButtonText=templateTran.SubmitButtonText;trans.SubmittingText=templateTran.SubmittingText;trans.ResponsesSubmittedText=templateTran.ResponsesSubmittedText;trans.OfflineRedirectMessage=templateTran.OfflineRedirectMessage}if(col.transType!==Design.TransitionType.MultipleEntry){trans.Actions=templateTran.Actions;trans.Properties=templateTran.Properties}}found=true;break}}}if(found){break}}$rootScope.$emit('workflowSelectTransition',trans)});$rootScope.$on('workflowSelectTransition',function(event,trans){for(var edgeIndex=0;edgeIndex<scope.elements.edges.length;edgeIndex++){var currentEdge=scope.elements.edges[edgeIndex];var col=currentEdge.data.tag;if(col.transitions!=null){for(var transIndex=0;transIndex<col.transitions.length;transIndex++){if(trans===col.transitions[transIndex]){scope.cyClick({node:col});return}}}}var workflowPage=scope.cyWorkflow;scope.cyClick({node:workflowPage.Workflow.GetStartState()})});$timeout(function(){scope.doCy()})}}}])})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var DocumentInterface=(function(){function DocumentInterface(designApi,projectGuid){this._promise=null;this._results=null;this._designApi=designApi;this._projectGuid=projectGuid}DocumentInterface.prototype.init=function(){if(this._promise==null){var vm=this;this._promise=this._designApi.documentInterface(this._projectGuid).then(function(data){for(var prop in data.placeholders){if(data.placeholders.hasOwnProperty(prop)){var currentDoc=data.placeholders[prop];for(var i=0;i<currentDoc.length;i++){var clone=new Intelledox.Model.PlaceholderReference;var obj=currentDoc[i];for(var prop in obj){if(obj.hasOwnProperty(prop)){clone[prop]=obj[prop]}}currentDoc[i]=clone}}}vm._results=data})}return this._promise};DocumentInterface.prototype.getBookmarkDictionary=function(){return this._results.placeholders};DocumentInterface.prototype.getCustomStylesDetail=function(){return this._results.styles};DocumentInterface.prototype.findPlaceholder=function(placeholder){var result=[];for(var docGuid in this._results.placeholders){if(this._results.placeholders.hasOwnProperty(docGuid)){var docDict=this._results.placeholders[docGuid];for(var i=0;i<docDict.length;i++){if(docDict[i].equals(placeholder)){result.push(docGuid)}}}}return result};DocumentInterface.prototype.updatePlaceholders=function(docGuid,formatType,binary,templateEditGuid){var vm=this;return this._designApi.documentInterfaceRefresh(formatType,binary,templateEditGuid).then(function(data){for(var i=0;i<data.length;i++){var clone=new Intelledox.Model.PlaceholderReference;var obj=data[i];for(var prop in obj){if(obj.hasOwnProperty(prop)){clone[prop]=obj[prop]}}data[i]=clone}vm._results.placeholders[docGuid]=data})};DocumentInterface.prototype.updatePlaceholdersFromEdit=function(docGuid,templateEditGuid){var vm=this;return this._designApi.documentInterfaceRefreshFromEdit(templateEditGuid).then(function(data){for(var i=0;i<data.length;i++){var clone=new Intelledox.Model.PlaceholderReference;var obj=data[i];for(var prop in obj){if(obj.hasOwnProperty(prop)){clone[prop]=obj[prop]}}data[i]=clone}vm._results.placeholders[docGuid]=data})};DocumentInterface.prototype.getBinary=function(projectGuid,docGuid,templateEditGuid){return this._designApi.documentInterfaceDownload(projectGuid,docGuid,templateEditGuid)};DocumentInterface.prototype.prepareForEdit=function(model,projectGuid,listManager,formatType){var promise;if(model.templateEditGuid==null){model.templateEditGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();promise=this._designApi.prepareTemplateForEdit(projectGuid,model.documentGuid,model.templateEditGuid,formatType)}else{var defer=listManager.qservice.defer();defer.resolve();promise=defer.promise}return promise.then(function(){var a=document.createElement('a');a.href='../api/v1/documentwebdav/'+model.templateEditGuid.toString()+'/';return a.cloneNode(false).href})};return DocumentInterface}());Design.DocumentInterface=DocumentInterface})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var DragDropMatch=(function(){function DragDropMatch(){}DragDropMatch.canDropPlaceholder=function(wizard,dropNode,targetNode){if(targetNode!=null){if(targetNode.tag instanceof Intelledox.QAWizard.Design.FragmentDocument){if(targetNode.tag.IsAttachment){return false}var targetFormatType=targetNode.tag.FormatType;var dropFormatType=dropNode.tag==null?Intelledox.Model.TemplateFormatType.None:dropNode.tag.FormatType;if(!(((targetFormatType===Intelledox.Model.TemplateFormatType.WordBinary||targetFormatType===Intelledox.Model.TemplateFormatType.WordDocx)&&(dropFormatType===Intelledox.Model.TemplateFormatType.WordBinary||dropFormatType===Intelledox.Model.TemplateFormatType.WordDocx))||(targetFormatType===Intelledox.Model.TemplateFormatType.Txt&&dropFormatType===Intelledox.Model.TemplateFormatType.Txt)||(targetFormatType===Intelledox.Model.TemplateFormatType.Html&&dropFormatType===Intelledox.Model.TemplateFormatType.Html)||(targetFormatType===Intelledox.Model.TemplateFormatType.Json&&dropFormatType===Intelledox.Model.TemplateFormatType.Json))){return false}if((dropNode.tag==null&&Design.HelperFunctions.isPlaceholderNameAllowed(wizard,dropNode.reference,targetNode,Intelledox.Common.ConstantValues.GUID_EMPTY))||(dropNode.tag!=null&&Design.HelperFunctions.isPlaceholderNameAllowed(wizard,dropNode.reference,targetNode,dropNode.tag.DocumentGuid))){return true}}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){if((dropNode.tag==null&&Design.HelperFunctions.isPlaceholderNameAllowed(wizard,dropNode.reference,targetNode,Intelledox.Common.ConstantValues.GUID_EMPTY))||(dropNode.tag!=null&&Design.HelperFunctions.isPlaceholderNameAllowed(wizard,dropNode.reference,targetNode,dropNode.tag.DocumentGuid))){return true}}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){if((dropNode.tag==null&&Design.HelperFunctions.isPlaceholderNameAllowed(wizard,dropNode.reference,targetNode,Intelledox.Common.ConstantValues.GUID_EMPTY))||(dropNode.tag!=null&&Design.HelperFunctions.isPlaceholderNameAllowed(wizard,dropNode.reference,targetNode,dropNode.tag.DocumentGuid))){return true}}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer&&targetNode.tag.Question instanceof Intelledox.QAWizard.Design.LogicQuestion&&(dropNode.reference.purpose&Intelledox.Model.PlaceholderPurpose.Range)===Intelledox.Model.PlaceholderPurpose.Range){return true}else{var passedQuestionCheck=false;if((targetNode.tag instanceof Intelledox.QAWizard.Design.ContentItem&&targetNode.tag.ContentTypeId!==Intelledox.Model.ContentType.Attachment)){passedQuestionCheck=true}if(targetNode.tag instanceof Intelledox.QAWizard.Design.Placeholder||targetNode.tag instanceof Intelledox.QAWizard.Design.ResponseMetadataField||targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){var questionNode=targetNode.treeView.findAncestorOrSelf(targetNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Question});if(questionNode==null){passedQuestionCheck=true}else{var question=questionNode.tag;if((!(question instanceof Intelledox.QAWizard.Design.ContentLibraryQuestion&&question.ContentTypeRestriction===Intelledox.Model.ContentType.Attachment))&&((question instanceof Intelledox.QAWizard.Design.LogicQuestion)||((dropNode.reference.purpose&Intelledox.Model.PlaceholderPurpose.Insert)===Intelledox.Model.PlaceholderPurpose.Insert))){passedQuestionCheck=true}}}if(passedQuestionCheck){if((dropNode.tag==null&&Design.HelperFunctions.isPlaceholderNameAllowed(wizard,dropNode.reference,targetNode,Intelledox.Common.ConstantValues.GUID_EMPTY))||(dropNode.tag!=null&&Design.HelperFunctions.isPlaceholderNameAllowed(wizard,dropNode.reference,targetNode,dropNode.tag.DocumentGuid))){return true}}}}return false};DragDropMatch.canDropItem=function(wizard,mode,dragObject,targetNode){if(mode==="treeview"){if(dragObject==null){return false}var dragNode=dragObject;var dragQANode=dragNode.tag;var targetQANode=(targetNode==null?null:targetNode.tag);var repeatingDocumentSection=null;if(dragQANode instanceof Intelledox.QAWizard.Design.FinishPage){return false}if(dragNode instanceof Design.PlaceholderTreeNode){return(DragDropMatch.canDropPlaceholder(wizard,dragNode,targetNode))}if(dragNode.tag instanceof Intelledox.QAWizard.Design.ResponseMetadataField){var passedQuestionCheck=false;if(targetQANode instanceof Intelledox.QAWizard.Design.FragmentOutput){passedQuestionCheck=true}else if(targetQANode instanceof Intelledox.QAWizard.Design.ResponseMetadataField){passedQuestionCheck=true}else if(targetQANode instanceof Intelledox.QAWizard.Design.Placeholder){passedQuestionCheck=DragDropMatch.canDropItem(wizard,mode,dragObject,targetNode.parent)}else if(targetQANode instanceof Intelledox.QAWizard.Design.Answer){var question=targetQANode.Question;if(question instanceof Intelledox.QAWizard.Design.UserPromptQuestion||question instanceof Intelledox.QAWizard.Design.NumericQuestion||question instanceof Intelledox.QAWizard.Design.GeolocationQuestion||question instanceof Intelledox.QAWizard.Design.VariableQuestion||(question instanceof Intelledox.QAWizard.Design.DatasourceQuestion&&question.SelectionType==Intelledox.Model.SelectionType.Single)||question instanceof Intelledox.QAWizard.Design.CustomQuestion){passedQuestionCheck=true}}if(passedQuestionCheck){var targetNodeParents=targetNode.treeView.getAncestorsAndSelfUntil(targetNode,function(parentNode){return(parentNode=null)});for(var i=0;i<targetNodeParents.length;i++){if((targetNodeParents[i].tag instanceof Intelledox.QAWizard.Design.Section&&targetNodeParents[i].tag.IsRepeated)||(targetNodeParents[i].tag instanceof Intelledox.QAWizard.Design.Page&&targetNodeParents[i].tag.IsRepeated)){passedQuestionCheck=false;break}}}return passedQuestionCheck}if(targetQANode instanceof Intelledox.QAWizard.Design.FinishPage){return(dragQANode instanceof Intelledox.QAWizard.Design.Action)||(dragQANode instanceof Intelledox.QAWizard.Design.FragmentPage)}if(dragQANode instanceof Intelledox.QAWizard.Design.FragmentPage||dragQANode instanceof Intelledox.QAWizard.Design.Page){if(targetQANode==null||targetQANode instanceof Intelledox.QAWizard.Design.FragmentPage||targetQANode instanceof Intelledox.QAWizard.Design.Page){return true}}else if(dragQANode instanceof Intelledox.QAWizard.Design.Section){if(targetQANode instanceof Intelledox.QAWizard.Design.Page||targetQANode instanceof Intelledox.QAWizard.Design.Section||targetQANode instanceof Intelledox.QAWizard.Design.Column||targetQANode instanceof Intelledox.QAWizard.Design.TabPage||targetQANode instanceof Intelledox.QAWizard.Design.Question||targetQANode instanceof Intelledox.QAWizard.Design.TabGroup){if(!dragNode.isDecendantOf(targetNode)){return true}}}else if(dragQANode instanceof Intelledox.QAWizard.Design.Column){if(targetQANode instanceof Intelledox.QAWizard.Design.Section||targetQANode instanceof Intelledox.QAWizard.Design.Column){if(!dragNode.isDecendantOf(targetNode)){return true}}}else if(dragQANode instanceof Intelledox.QAWizard.Design.TabGroup){if(targetQANode instanceof Intelledox.QAWizard.Design.Page){return true}else if(targetQANode instanceof Intelledox.QAWizard.Design.TabGroup||targetQANode instanceof Intelledox.QAWizard.Design.Column||targetQANode instanceof Intelledox.QAWizard.Design.TabPage||targetQANode instanceof Intelledox.QAWizard.Design.Question||targetQANode instanceof Intelledox.QAWizard.Design.Section){if(!dragNode.isDecendantOf(targetNode)){return true}}}else if(dragQANode instanceof Intelledox.QAWizard.Design.TabPage){if(targetQANode instanceof Intelledox.QAWizard.Design.TabGroup||targetQANode instanceof Intelledox.QAWizard.Design.TabPage){if(!dragNode.isDecendantOf(targetNode)){return true}}}else if(dragQANode instanceof Intelledox.QAWizard.Design.Question){if(targetQANode instanceof Intelledox.QAWizard.Design.Page||targetQANode instanceof Intelledox.QAWizard.Design.Column||targetQANode instanceof Intelledox.QAWizard.Design.TabPage||targetQANode instanceof Intelledox.QAWizard.Design.Section||targetQANode instanceof Intelledox.QAWizard.Design.TabGroup||targetQANode instanceof Intelledox.QAWizard.Design.Question||targetQANode instanceof Intelledox.QAWizard.Design.FragmentReference){return true}}else if(dragQANode instanceof Intelledox.QAWizard.Design.Answer){if(targetQANode instanceof Intelledox.QAWizard.Design.Question){if(targetQANode===dragQANode.Question){return true}}else if(targetQANode instanceof Intelledox.QAWizard.Design.Answer){if(targetQANode.Question===dragQANode.Question){return true}}}else if(dragQANode instanceof Intelledox.QAWizard.Design.Placeholder){if((targetQANode instanceof Intelledox.QAWizard.Design.Placeholder||targetQANode instanceof Intelledox.QAWizard.Design.Answer||targetQANode instanceof Intelledox.QAWizard.Design.ContentItem||targetQANode instanceof Intelledox.QAWizard.Design.FragmentOutput||(targetQANode instanceof Intelledox.QAWizard.Design.FragmentDocument&&!targetQANode.IsAttachment))&&Design.HelperFunctions.isPlaceholderNameAllowed(wizard,dragQANode.Reference,targetNode,dragQANode.DocumentGuid,dragNode)){return true}}else if(dragQANode instanceof Intelledox.QAWizard.Design.ContentItem){if(targetQANode instanceof Intelledox.QAWizard.Design.Answer){var typeId=targetQANode.Question.QuestionTypeID;if(typeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary||typeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic){return true}}}else if(dragQANode instanceof Intelledox.QAWizard.Design.Action){if(targetQANode instanceof Intelledox.QAWizard.Design.Action){if(!dragQANode.HasChild(targetQANode.ActionGuid)){return true}}else if(targetQANode instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){return true}}else if(dragQANode instanceof Intelledox.QAWizard.Design.DocumentTemplate){if(targetQANode instanceof Intelledox.QAWizard.Design.DocumentTemplate){return true}}else if(dragQANode instanceof Intelledox.QAWizard.Design.FragmentReference){if(targetQANode instanceof Intelledox.QAWizard.Design.Page||targetQANode instanceof Intelledox.QAWizard.Design.Column||targetQANode instanceof Intelledox.QAWizard.Design.TabPage||targetQANode instanceof Intelledox.QAWizard.Design.Section||targetQANode instanceof Intelledox.QAWizard.Design.TabGroup||targetQANode instanceof Intelledox.QAWizard.Design.Question){return true}}else if(dragQANode instanceof Intelledox.QAWizard.Design.AvailableOutput){if((typeof targetQANode==='string'&&targetQANode===Intelledox.Common.ConstantValues.OUTPUTSNODETAG)||targetQANode instanceof Intelledox.QAWizard.Design.AvailableOutput){return true}}return false}else{var dragId=dragObject;if(dragId===''){return false}if(targetNode instanceof Design.TreeNode){targetNode=targetNode.tag}var dragItem=dragId.split('_')[1];var dragType=dragItem.split('.')[0];var dragName=dragItem.split('.')[1];if(targetNode==null||targetNode instanceof Intelledox.QAWizard.Design.FinishPage||targetNode instanceof Intelledox.QAWizard.Design.FragmentPage||targetNode instanceof Intelledox.QAWizard.Design.Action||targetNode instanceof Intelledox.Model.ActionOutput||targetNode instanceof Intelledox.QAWizard.Design.FragmentDocument||targetNode instanceof Intelledox.QAWizard.Design.FragmentOutput||targetNode instanceof Intelledox.QAWizard.Design.DocumentTemplate){if(dragType==='fragment'){if(Number(dragItem.split('.')[2])===Intelledox.Model.ProjectType.FragmentPage){return true}else{return false}}else if(dragName==='page'||dragType==='action'||dragName==='templateword'||dragName==='templateexcel'||dragName==='templatepowerpoint'||dragName==='templatepdf'||dragName==='templatejson'||dragName==='templatehtml'||dragName==='templatexsd'||dragName==='templatecsv'||dragName==='templatetxt'||dragName==='projectresults'){return true}return false}if(targetNode instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){if(dragType==='action'){return true}}if(dragName==='page'){if(targetNode instanceof Intelledox.QAWizard.Design.Page){return true}return false}if(dragName==='column'){if(targetNode instanceof Intelledox.QAWizard.Design.Section||targetNode instanceof Intelledox.QAWizard.Design.Column){return true}return false}if(dragName==='tabpage'){if(targetNode instanceof Intelledox.QAWizard.Design.TabGroup||targetNode instanceof Intelledox.QAWizard.Design.TabPage){return true}return false}if(dragName==='answer'){if((targetNode instanceof Intelledox.QAWizard.Design.Question||targetNode instanceof Intelledox.QAWizard.Design.Answer)&&!(targetNode instanceof Intelledox.QAWizard.Design.ValidationQuestion)&&!(targetNode instanceof Intelledox.QAWizard.Design.SummaryQuestion)&&!(targetNode instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion)){return true}return false}if(dragName==='fragmentinput'){if((typeof targetNode==='string'&&targetNode===Intelledox.Common.ConstantValues.INPUTSNODETAG)||targetNode instanceof Intelledox.QAWizard.Design.AvailableInput){return true}return false}if(dragName==='fragmentoutput'){if((typeof targetNode==='string'&&targetNode===Intelledox.Common.ConstantValues.OUTPUTSNODETAG)||targetNode instanceof Intelledox.QAWizard.Design.AvailableOutput){return true}return false}if(dragType==='contentitem'){if(targetNode instanceof Intelledox.QAWizard.Design.Answer){var targetQuestion=targetNode.Question;if(targetQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||targetQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary||targetQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic||targetQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic){return true}}return false}return true}};return DragDropMatch}());Design.DragDropMatch=DragDropMatch})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var EscalationsFlyout=(function(){function EscalationsFlyout(lists){this.availableEscalations=[];this.filteredEscalations=[];this.searchValue='';var vm=this;lists.licensedEscalationTypes().then(function(escalations){var clonedEscalations=[];for(var i=0;i<escalations.length;i++){var clone=new Intelledox.Model.RoutingType;var obj=escalations[i];for(var prop in obj){if(obj.hasOwnProperty(prop)){clone[prop]=obj[prop]}}clone.description=lists.nameToTranslation(clone.description);clonedEscalations.push(clone)}vm.availableEscalations=clonedEscalations;vm.filteredEscalations=clonedEscalations})}EscalationsFlyout.prototype.searchEscalations=function(){var searchString=this.searchValue.toLowerCase();this.filteredEscalations=[];for(var i=0;i<this.availableEscalations.length;i++){var currentEscalations=this.availableEscalations[i];if(currentEscalations.description.toLowerCase().indexOf(searchString)>-1){this.filteredEscalations.push(currentEscalations)}}};return EscalationsFlyout}());Design.EscalationsFlyout=EscalationsFlyout})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ContentLibraryFlyout=(function(){function ContentLibraryFlyout(lists){this.availableContentItems=[];this.filteredContentItems=[];this.searchValue='';var vm=this;lists.getContentItems().then(function(contentItems){var imageKey;vm.availableContentItems=[];for(var i=0;i<contentItems.length;i++){switch(contentItems[i].contentTypeId){case Intelledox.Model.ContentType.UnformattedText:imageKey='li-contenttext';break;case Intelledox.Model.ContentType.Image:imageKey='li-contentimage';break;case Intelledox.Model.ContentType.DocumentFragment:imageKey='li-contentfragment';break;case Intelledox.Model.ContentType.Attachment:imageKey='li-contentattachment';break}vm.availableContentItems.push({imageKey:imageKey,contentItem:contentItems[i]})}vm.filteredContentItems=vm.availableContentItems})}ContentLibraryFlyout.prototype.searchContentItems=function(){var searchString=this.searchValue.toLowerCase();this.filteredContentItems=[];for(var i=0;i<this.availableContentItems.length;i++){var currentContentItem=this.availableContentItems[i];if(currentContentItem.contentItem.name.toLowerCase().indexOf(searchString)===0){this.filteredContentItems.push(currentContentItem)}}};return ContentLibraryFlyout}());Design.ContentLibraryFlyout=ContentLibraryFlyout})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Wizard=(function(){function Wizard(){this.m_FinishTitle=null;this.m_GenerateButtonText=null;this.m_GeneratingText=null;this.m_DownloadPageTitle=null;this.m_InvalidProjectText=null;this.m_OnlineRedirectMessage=null;this.m_OfflineRedirectMessage=null;this.ProjectGroupId=0;this.ProjectGroupGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.BusinessUnitGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.TypeId=Intelledox.Model.ProjectType.None;this.ProjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.LayoutQuestionsFirst=false;this.AllowPreview=false;this.EnforceValidation=false;this.HideNavigationPane=false;this.FinishPageVisible=true;this.AllowDocumentDownload=true;this.RedirectToHome=false;this.WaitForProject=true;this.GenerateButtonLocation=Design.GenerateButtonLocation.BottomMiddle_Default;this.Compatibility=Design.CompatibilityLevel.Version2001;this.LiveRefresh=false;this.RefreshPeriod=0;this.Pages=[];this.Documents=[];this.Actions=[];this.FinishPageConditions=new Design.Condition;this.Workflow=new Design.Workflow;this.Workflow.ParallelSectionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.ProtectedFields=[];this.LanguageTranslations=[];this.TemporaryUserSaveSettings=new Design.TemporaryUserSave;this.DownloadableDocuments="ALL";this.Properties=[]}Object.defineProperty(Wizard.prototype,"ProjectGroupName",{get:function(){if(System.String.IsNullOrEmpty(this.m_ProjectGroupName)){return""}else{return this.m_ProjectGroupName}},set:function(value){this.m_ProjectGroupName=value},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"FinishTitle",{get:function(){if(this.m_FinishTitle==null){return Design.Resources.Strings.DefaultFinishTitle}else{return this.m_FinishTitle}},set:function(value){this.m_FinishTitle=value},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"GenerateButtonText",{get:function(){if(this.m_GenerateButtonText==null){return Design.Resources.Strings.FormDefaultGenerateButtonText}else{return this.m_GenerateButtonText}},set:function(value){this.m_GenerateButtonText=value},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"GeneratingText",{get:function(){if(this.m_GeneratingText==null){if(this.Documents.length===0){return Design.Resources.Strings.FormDefaultGeneratingText}else{return Design.Resources.Strings.DefaultGeneratingText}}else{return this.m_GeneratingText}},set:function(value){this.m_GeneratingText=value},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"DownloadPageTitle",{get:function(){if(this.m_DownloadPageTitle==null){if(this.Documents.length===0){return Design.Resources.Strings.FormDefaultDownloadPageTitle}else{return Design.Resources.Strings.DefaultDownloadPageTitle}}else{return this.m_DownloadPageTitle}},set:function(value){this.m_DownloadPageTitle=value},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"OnlineRedirectMessage",{get:function(){if(this.m_OnlineRedirectMessage==null){return this.DefaultOnlineRedirectMessage}else{return this.m_OnlineRedirectMessage}},set:function(value){this.m_OnlineRedirectMessage=value},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"DefaultOnlineRedirectMessage",{get:function(){return Design.Resources.Strings.DefaultOnlineRedirectMessage},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"OfflineRedirectMessage",{get:function(){if(this.m_OfflineRedirectMessage==null){return this.DefaultOfflineRedirectMessage}else{return this.m_OfflineRedirectMessage}},set:function(value){this.m_OfflineRedirectMessage=value},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"DefaultOfflineRedirectMessage",{get:function(){return Design.Resources.Strings.FormQueueMessage},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"InvalidProjectText",{get:function(){if(this.m_InvalidProjectText==null){return Design.Resources.Strings.DefaultInvalidProjectText}else{return this.m_InvalidProjectText}},set:function(value){this.m_InvalidProjectText=value},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"MetadataElements",{get:function(){if(this.m_MetadataElements==null){this.m_MetadataElements=new Array}return this.m_MetadataElements},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"AvailableInputs",{get:function(){if(this.m_AvailableInputs==null){this.m_AvailableInputs=new Array}return this.m_AvailableInputs},enumerable:true,configurable:true});Object.defineProperty(Wizard.prototype,"AvailableOutputs",{get:function(){if(this.m_AvailableOutputs==null){this.m_AvailableOutputs=new Array}return this.m_AvailableOutputs},enumerable:true,configurable:true});Wizard.prototype.FindDocumentByGuid=function(docGuid){for(var i=0;i<this.Documents.length;i++){if(this.Documents[i].DocumentGuid===docGuid){return this.Documents[i]}}return null};Wizard.prototype.GetChildrenOfType=function(node,compareFunction){var result=new Array;for(var childIndex=0;childIndex<node.Children.length;childIndex++){var child=node.Children[childIndex];if(compareFunction(child)){result.push(child)}if(typeof(child.HasContainerInterface)!=="undefined"){var childResults=this.GetChildrenOfType(child,compareFunction);for(var childResultIndex=0;childResultIndex<childResults.length;childResultIndex++){result.push(childResults[childResultIndex])}}}return result};Wizard.prototype.IsUniqueFragmentName=function(fragmentName,currentFragmentGuid){for(var pageIndex=0;pageIndex<this.Pages.length;pageIndex++){var p=this.Pages[pageIndex];if(p instanceof Design.FragmentPage&&Intelledox.Common.Functions.EqualsIgnoreCase(p.Name,fragmentName)&&p.PageGuid!==currentFragmentGuid){return false}var childReferences=this.GetChildrenOfType(p,function(child){return child instanceof Design.FragmentReference});for(var fragIndex=0;fragIndex<childReferences.length;fragIndex++){var frag=childReferences[fragIndex];if(Intelledox.Common.Functions.EqualsIgnoreCase(frag.Name,fragmentName)&&frag.ObjectId!==currentFragmentGuid){return false}}}return true};Wizard.prototype.FindQuestion=function(questionGuid){if(questionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return null}for(var pageIndex=0;pageIndex<this.Pages.length;pageIndex++){var grp=this.Pages[pageIndex];for(var questionIndex=0;questionIndex<grp.Questions.length;questionIndex++){var qn=grp.Questions[questionIndex];if(qn.QuestionGuid===questionGuid){return qn}}}return null};Wizard.prototype.FindQuestionById=function(id,stopQuestionGuid,currentAnswer){if(currentAnswer===void 0){currentAnswer=null}var foundQuestion=null;if(!Intelledox.Common.Functions.IsUInt(id)){return null}var intId=parseInt(id,10);if(currentAnswer!=null){if(currentAnswer.Question.ID===intId){return currentAnswer.Question}if(stopQuestionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){var pageQuestions=currentAnswer.Question.Page.Questions;for(var questionIndex=0;questionIndex<pageQuestions.length;questionIndex++){var q=pageQuestions[questionIndex];if(q.ID===intId){return q}}}}for(var pageIndex=0;pageIndex<this.Pages.length;pageIndex++){var g=this.Pages[pageIndex];for(var questionIndex=0;questionIndex<g.Questions.length;questionIndex++){var q=g.Questions[questionIndex];var isStopQuestion=(stopQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&stopQuestionGuid===q.QuestionGuid);if(isStopQuestion&&!(q.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Datasource||q.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Variable)){return null}if(q.ID===intId){foundQuestion=q;break}if(isStopQuestion){return null}}if(foundQuestion!=null){break}}return foundQuestion};Wizard.prototype.FindAction=function(actionGuid,findActionButton){var result={action:null,stateTransition:null,actionButtonQuestion:null};if(actionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return result}for(var actionIndex=0;actionIndex<this.Actions.length;actionIndex++){var a=this.Actions[actionIndex];if(a.ActionGuid===actionGuid){result.action=a;return result}}if(this.Workflow!=null&&this.Workflow.HasWorkflow){var fullStates=this.Workflow.FullStateList;for(var stateIndex=0;stateIndex<fullStates.length;stateIndex++){var state=fullStates[stateIndex];for(var transIndex=0;transIndex<state.Transitions.length;transIndex++){var transition=state.Transitions[transIndex];for(var transActionIndex=0;transActionIndex<transition.Actions.length;transActionIndex++){var a=transition.Actions[transActionIndex];if(a.ActionGuid===actionGuid){result.stateTransition=transition;result.action=a;return result}}}}}var actionsInActionQuestions=this.getAllActionQuestionActions();for(var actionIndex=0;actionIndex<actionsInActionQuestions.length;actionIndex++){var a=actionsInActionQuestions[actionIndex];if(a.ActionGuid===actionGuid){result.action=a;if(findActionButton){result.actionButtonQuestion=this.getActionButtonQuestionFromAction(a)}return result}}return result};Wizard.prototype.getActionQuestions=function(){var allActionQuestions=[];for(var pageIndex=0;pageIndex<this.Pages.length;pageIndex++){var grp=this.Pages[pageIndex];for(var questionIndex=0;questionIndex<grp.Questions.length;questionIndex++){var qn=grp.Questions[questionIndex];if(qn instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){allActionQuestions.push(qn)}}}return allActionQuestions};Wizard.prototype.nestedChildActions=function(action){var ret=[];for(var i=0;i<action.Children.length;i++){ret.push(action.Children[i]);if(action.Children[i].Children.length>0){var actions=this.nestedChildActions(action.Children[i]);for(var j=0;j<actions.length;j++){ret.push(actions[j])}}}return ret};Wizard.prototype.getAllActionQuestionActions=function(){var ret=[];var actionQuestions=this.getActionQuestions();for(var questionIndex=0;questionIndex<actionQuestions.length;questionIndex++){var aq=actionQuestions[questionIndex];var actions=this.getAllActionsForActionButtonQuestion(aq);for(var a=0;a<actions.length;a++){ret.push(actions[a])}}return ret};Wizard.prototype.getActionButtonQuestionFromAction=function(action){var actionQuestions=this.getActionQuestions();for(var questionIndex=0;questionIndex<actionQuestions.length;questionIndex++){var aq=actionQuestions[questionIndex];var actions=this.getAllActionsForActionButtonQuestion(aq);for(var a=0;a<actions.length;a++){if(actions[a].ActionGuid===action.ActionGuid){return aq}}}};Wizard.prototype.getAllActionsForActionButtonQuestion=function(aq){var ret=[];for(var actionIndex=0;actionIndex<aq.Actions.length;actionIndex++){var a=aq.Actions[actionIndex];ret.push(a);var childActions=this.nestedChildActions(a);for(var i=0;i<childActions.length;i++){ret.push(childActions[i])}}return ret};Wizard.prototype.FindRepeater=function(repeatGuid){for(var i=0;i<this.Pages.length;i++){var p=this.Pages[i];if(p.ObjectId===repeatGuid){return p}else{var childRepeater=p.FindChildObject(repeatGuid);if(childRepeater!=null){return childRepeater}}}return null};Wizard.prototype.FindLayoutNode=function(nodeGuid){for(var i=0;i<this.Pages.length;i++){var p=this.Pages[i];if(p.ObjectId===nodeGuid){return p}else{var childObject=p.FindChildObject(nodeGuid);if(childObject!=null){return childObject}}}return null};Wizard.prototype.FindPageOfLayout=function(node){for(var i=0;i<this.Pages.length;i++){if(this.Pages[i].HasChild(node.ObjectId)){return this.Pages[i]}}return null};Wizard.prototype.GetNonRepeatedQuestions=function(currentNodeGuid){var result=new Array;for(var i=0;i<this.Pages.length;i++){if(!this.Pages[i].IsRepeated||this.Pages[i].HasChild(currentNodeGuid)){this.GetNonRepeatedQuestionsRecursive(this.Pages[i],result,currentNodeGuid)}}return result};Wizard.prototype.GetNonRepeatedQuestionsRecursive=function(node,result,currentNodeGuid){for(var i=0;i<node.Children.length;i++){var child=node.Children[i];if(child instanceof Design.Section){if(!child.IsRepeated||child.HasChild(currentNodeGuid)){this.GetNonRepeatedQuestionsRecursive(child,result,currentNodeGuid)}}else if(child instanceof Design.Question){result.push(child)}else if(typeof(child.HasContainerInterface)!=="undefined"){this.GetNonRepeatedQuestionsRecursive(child,result,currentNodeGuid)}}};Wizard.prototype.FindFragment=function(fragmentName,stopQuestionGuid){for(var i=0;i<this.Pages.length;i++){var p=this.Pages[i];if(p instanceof Design.FragmentPage&&Intelledox.Common.Functions.EqualsIgnoreCase(p.Name,fragmentName)){return p}else{var result=this.FindFragmentRecursive(fragmentName,stopQuestionGuid,p);if(result!=null){return result}}}return null};Wizard.prototype.FindFragmentRecursive=function(fragmentName,stopQuestionGuid,currentNode){for(var i=0;i<currentNode.Children.length;i++){var child=currentNode.Children[i];if(child instanceof Design.Question&&child.QuestionGuid===stopQuestionGuid){return null}else if(child instanceof Design.FragmentReference&&Intelledox.Common.Functions.EqualsIgnoreCase(child.Name,fragmentName)){return child}else if(typeof child.HasContainerInterface!=="undefined"){var result=this.FindFragmentRecursive(fragmentName,stopQuestionGuid,child);if(result!=null){return result}}}return null};return Wizard}());Design.Wizard=Wizard})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var EditorViewModel=(function(){function EditorViewModel($filter,$uibModal,$q,$rootScope,designApi){var _this=this;this._displayPages=[];this._lastPageId=0;this._lastQuestionId=0;this._lastAnswerId=0;this._flyoutActions=null;this._flyoutFragments=null;this._flyoutContentItems=null;this._flyoutEscalations=null;this._previouslySelected=null;this._isContentLibraryAvailable=false;this._isContactsAvailable=false;this._isAnalyticsAvailable=false;this._isSummaryAvailable=false;this._isRunActionButtonAvailable=false;this._projectName='';this._enableOfficeEdit=true;this.documentInterface=null;this.templateBinaries=[];this.locked=false;this.wizChanged=false;this.beginTemplateEdit=false;this.isNewTemplate=false;this.panelCode='properties';this.flyoutPanelCode='';this.propertiesPanelCode='';this.hasActionDocuments=false;this.hasConditions=false;this.hasProjectProperties=false;this.hasDataFilters=false;this.hasDisplayFields=false;this.hasRules=false;this.hasSorting=false;this.hasValidations=false;this.hasSeries=false;this.hasAnswerFileOptions=false;this.hasProtectedFields=false;this.hasSummarySettings=false;this.versionChanged=false;this.isFinishPage=false;this.isWorkflowPage=false;this.copyObject=null;this.isFirstCut=false;this.toolboxItems=null;this.workflowToolboxItems=null;this.flyoutPanel=null;this.isWorkflowAvailable=false;this.isTemporarySaveAvailable=false;this.showFoundResults=false;this.foundItemsTitle='';this.listManager=null;this.helpUrl='';var vm=this;this._filter=$filter;this._modal=$uibModal;this._rootScope=$rootScope;this._designApi=designApi;this.monitor=new Design.Monitor(designApi,this);this.monitor.templateChangedCallback=function(templateEditGuid){_this.templateChanged(templateEditGuid)};this.listManager=new Design.ListManager($filter,$q,this._designApi);window['listManager']=this.listManager;this.flyoutPlaceholders=new Design.PlaceholdersFlyout($filter,this._designApi,this.listManager);this.treeView=new Design.TreeView;this.treeView.beforeExpand=function(node){return _this.loadQuestionSetPage(node)};this.treeView.selectionEvent=function(node){return _this.nodeSelected(node)};this.treeView.copyEvent=function(node){if(vm.canCutCopy){_this.editorCopy()}};this.treeView.cutEvent=function(node){if(vm.canCutCopy){_this.editorCut()}};this.treeView.pasteEvent=function(node){if(vm.canPaste){_this.editorPaste()}};this.treeView.deleteEvent=function(node){if(vm.canDeleteItem){_this.editorDelete()}};this.actionDocumentsPanelModel=new Design.ActionDocumentPanelViewModel($q,this._filter,this,this.listManager);this.conditionsPanelModel=new Design.ConditionPanelViewModel(this._filter,this);this.dataFiltersPanelModel=new Design.DataFilterPanelViewModel(this._filter,this);this.displayFieldsPanelModel=new Design.DisplayFieldsPanelViewModel(this._filter,this,this.listManager);this.rulesPanelModel=new Design.RulePanelViewModel(this._filter,this);this.sortPanelModel=new Design.SortPanelViewModel(this._filter,this,this.listManager);this.validationsPanelModel=new Design.ValidationPanelViewModel(this._filter,this);this.seriesPanelModel=new Design.SeriesPanelViewModel(this._filter,this);this.answerFileOptionsPanelModel=new Design.AnswerFileOptionsPanelViewModel(this._filter,this);this.protectedFieldsPanelModel=new Design.ProtectedFieldsPanelViewModel(this._filter,this);this.projectPropertiesModel=new Design.ProjectPropertiesPanelViewModel(this._filter,this);this.summarySettingsPanelModel=new Design.SummarySettingsPanelViewModel(this._filter,this)}Object.defineProperty(EditorViewModel.prototype,"projectName",{get:function(){return this._projectName},set:function(value){this._projectName=value;if(System.String.IsNullOrEmpty(value)){window.document.title='Infiniti Design'}else{window.document.title='Infiniti Design - '+value}},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"wizard",{get:function(){return this._wizard},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"isContentItemsAvailable",{get:function(){return this._wizard!=null&&!this.isWorkflowPage&&this._isContentLibraryAvailable},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"isProjectFragmentsAvailable",{get:function(){return this._wizard!=null&&!this.isWorkflowPage},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"isPlaceholdersAvailable",{get:function(){return this._wizard!=null&&!this.isWorkflowPage&&this.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"isEscalationsAvailable",{get:function(){return this.isWorkflowPage},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"isActionsAvailable",{get:function(){return this.wizard!=null&&(this.wizard.TypeId===Intelledox.Model.ProjectType.Content||this._isRunActionButtonAvailable)},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"isTemplatesAvailable",{get:function(){return this.wizard!=null&&this.wizard.TypeId!==Intelledox.Model.ProjectType.Layout&&this.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"isRunActionButtonAvailable",{get:function(){return this._isRunActionButtonAvailable},enumerable:true,configurable:true});EditorViewModel.prototype.setWizard=function(value){var vm=this;var promise=null;window['ix-wiz']=value;this._wizard=value;this.documentInterface=new Design.DocumentInterface(this._designApi,value.ProjectGuid);return vm.getAppSettings().then(function(){return vm._designApi.moduleLicenses().then(function(results){for(var i=0;i<results.length;i++){switch(results[i]){case Intelledox.Model.IntelledoxModule.Workflow.toString():if(value.TypeId===Intelledox.Model.ProjectType.Content){vm.isWorkflowAvailable=true}break;case Intelledox.Model.IntelledoxModule.ContentLibrary.toString():vm._isContentLibraryAvailable=true;break;case Intelledox.Model.IntelledoxModule.TemporaryUserSave.toString():vm.isTemporarySaveAvailable=true;break;case Intelledox.Model.IntelledoxModule.Contacts.toString():vm._isContactsAvailable=true;break;case Intelledox.Model.IntelledoxModule.Analytics.toString():vm._isAnalyticsAvailable=true;break;case Intelledox.Model.IntelledoxModule.Summary.toString():vm._isSummaryAvailable=true;break;case Intelledox.Model.IntelledoxModule.RunActionButton.toString():vm._isRunActionButtonAvailable=true;break}}})}).then(function(){vm.loadToolbox();vm.loadTreeView();vm.flyoutPlaceholders.init(value);vm.flyoutPlaceholders.createPlaceholderTree();vm.documentInterface.init().then(function(){vm.flyoutPlaceholders.resetState(vm.documentInterface.getBookmarkDictionary())})})};Object.defineProperty(EditorViewModel.prototype,"currentPage",{get:function(){return this._currentPage},set:function(value){this._currentPage=value;this.isFinishPage=(value instanceof Intelledox.QAWizard.Design.FinishPage);this.isWorkflowPage=(value instanceof Design.WorkflowPage);if(this.isFinishPage){this.selectedNode=value;this.propertiesPanelModel=new Design.AnswerFilePropertiesViewModel(this,this._filter,this._rootScope,this._modal,this._wizard);this.propertiesPanelCode='answerFile'}},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"displayPages",{get:function(){if(this.wizard==null){return this._displayPages}else{this._displayPages.length=0;for(var i=0;i<this.wizard.Pages.length;i++){this._displayPages.push(this.wizard.Pages[i])}if(this._finishPage==null){this._finishPage=new Intelledox.QAWizard.Design.FinishPage(this.wizard,Intelledox.Common.ConstantValues.GUID_EMPTY)}this._displayPages.push(this._finishPage);return this._displayPages}},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"canDeleteItem",{get:function(){if(this.selectedNode==null||(typeof this.selectedNode==='string'&&(this.selectedNode===Intelledox.Common.ConstantValues.INPUTSNODETAG||this.selectedNode===Intelledox.Common.ConstantValues.OUTPUTSNODETAG||this.selectedNode===Intelledox.Common.ConstantValues.LAYOUTNODETAG))||(this.selectedNode instanceof Intelledox.QAWizard.Design.Page&&(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion||this._wizard.TypeId===Intelledox.Model.ProjectType.Dashboard))||this.selectedNode instanceof Intelledox.QAWizard.Design.FinishPage||this.selectedNode instanceof Intelledox.QAWizard.Design.StartWorkflowState||this.selectedNode instanceof Intelledox.QAWizard.Design.FinishWorkflowState||(this.selectedNode instanceof Design.WorkflowTransitionCollection&&(this.selectedNode.transType===Design.TransitionType.MultipleEntry||this.selectedNode.transType===Design.TransitionType.MultipleExit||this.selectedNode.transType===Design.TransitionType.Creation))||(this.selectedNode instanceof Intelledox.QAWizard.Design.DocumentTemplate&&this._wizard.TypeId===Intelledox.Model.ProjectType.Layout)){return false}return true},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"canCutCopy",{get:function(){if(this.selectedNode==null||!this.canBeCopied(this.treeView.selectedNode)){return false}return true},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"canPaste",{get:function(){if(this.copyObject!=null&&this.canDropExisting(this.copyObject,this.treeView.selectedNode,true)){return true}return false},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"canAddAnswer",{get:function(){if(this.treeView.selectedNode!=null){return Design.DragDropMatch.canDropItem(this._wizard,'toolbox','toolbox_misc.answer',this.treeView.selectedNode)}return false},enumerable:true,configurable:true});Object.defineProperty(EditorViewModel.prototype,"canToggleState",{get:function(){return this.currentPage instanceof Design.WorkflowPage},enumerable:true,configurable:true});EditorViewModel.prototype.collapseSelected=function(){if(this.treeView.selectedNode!=null){this.treeView.selectedNode.collapse()}};EditorViewModel.prototype.expandSelected=function(){if(this.treeView.selectedNode!=null){this.treeView.expandAllFromNode(this.treeView.selectedNode);this.treeView.selectedNode.expand()}};EditorViewModel.prototype.nodeSelected=function(node,isNewQuestion){if(isNewQuestion===void 0){isNewQuestion=false}var treenode=null;var item=null;this.hasActionDocuments=false;this.hasConditions=false;this.hasDataFilters=false;this.hasDisplayFields=false;this.hasRules=false;this.hasSorting=false;this.hasValidations=false;this.hasSeries=false;this.hasAnswerFileOptions=false;this.hasProtectedFields=false;this.hasSummarySettings=false;this.hasProjectProperties=false;if(node==null){this.treeView.selectedNode=null;this.selectedNode=null;this.panelCode='properties';this.propertiesPanelCode='noProperties';return}else if(node instanceof Design.TreeNode){treenode=node;item=treenode.tag;var containingPage=treenode.treeView.findAncestorOrSelf(treenode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Page});if(containingPage!=null){this.currentPage=containingPage.tag}}else if(node instanceof Intelledox.QAWizard.Design.Workflow||node instanceof Intelledox.QAWizard.Design.WorkflowState||node instanceof Design.WorkflowTransitionCollection||node instanceof Intelledox.QAWizard.Design.Escalation){item=node}else{treenode=this.getTreeNodeFromQA(this.currentPage,node);if(treenode==null){item=node}else{item=treenode.tag}}if(item instanceof Intelledox.Model.ActionOutput){treenode=treenode.parent;item=treenode.tag}this.treeView.selectedNode=treenode;this.selectedNode=item;if(item instanceof Intelledox.QAWizard.Design.FinishPage){this.propertiesPanelModel=new Design.AnswerFilePropertiesViewModel(this,this._filter,this._rootScope,this._modal,this._wizard);this.propertiesPanelCode='answerFile';this.addConditionsTab()}else if(typeof item.HasFragmentInterface!=="undefined"){this.propertiesPanelModel=new Design.FragmentPropertiesViewModel(this,item,this._wizard,this._filter,this.listManager);this.propertiesPanelCode='fragment';this.addConditionsTab()}else if(item instanceof Intelledox.QAWizard.Design.Page){if(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){this.propertiesPanelCode='noProperties'}else{this.propertiesPanelModel=new Design.PagePropertiesViewModel(this,item,this._filter,this._modal,this.listManager);this.propertiesPanelCode='page';this.addSummarySettingsTab()}this.addConditionsTab()}else if(item instanceof Intelledox.QAWizard.Design.Question){if(item instanceof Intelledox.QAWizard.Design.UserPromptQuestion){this.propertiesPanelModel=new Design.UserPromptPropertiesViewModel(this,item,this._designApi,this._filter,this.listManager);this.addValidationsTab()}else if(item instanceof Intelledox.QAWizard.Design.GeolocationQuestion){this.propertiesPanelModel=new Design.GeolocationPropertiesViewModel(this,item,this._filter,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.GroupLogicQuestion){this.propertiesPanelModel=new Design.GroupLogicPropertiesViewModel(this,item,this._filter,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.DatasourceQuestion){this.propertiesPanelModel=new Design.DatasourcePropertiesViewModel(this,item,this.wizard,this._filter,this._modal,this.listManager,isNewQuestion,node);this.addDataFiltersTab();this.addDisplayFieldsTab();if(item.DisplayType!==Intelledox.Model.QuestionDisplayType.Popup&&item.DisplayType!==Intelledox.Model.QuestionDisplayType.Search&&item.DisplayType!==Intelledox.Model.QuestionDisplayType.DataGrid){this.hasDisplayFields=false}this.addSortingTab()}else if(item instanceof Intelledox.QAWizard.Design.NumericQuestion){this.propertiesPanelModel=new Design.NumericPropertiesViewModel(this,item,this._filter,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.RichTextQuestion){this.propertiesPanelModel=new Design.RichTextPropertiesViewModel(this,item,this.wizard,this._filter,this.listManager);this.addProtectedFieldsTab()}else if(item instanceof Intelledox.QAWizard.Design.ValidationQuestion){this.propertiesPanelModel=new Design.ValidatorPropertiesViewModel(this,item,this.currentPage,this.wizard,this._filter,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.BarcodeQuestion){this.propertiesPanelModel=new Design.BarcodePropertiesViewModel(this,item,this._filter,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.InkQuestion){this.propertiesPanelModel=new Design.InkPropertiesViewModel(this,item,this.wizard,this._filter,this._modal,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.CustomQuestion){this.propertiesPanelModel=new Design.CustomPropertiesViewModel(this,item,this.wizard,this._filter,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.AutoLogicQuestion){this.propertiesPanelModel=new Design.AutoLogicPropertiesViewModel(this,item,this.wizard,this._filter,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.ContentLibraryQuestion){var clQuestion=item;if(clQuestion.IsFileSelection){this.propertiesPanelModel=new Design.FileSelectionPropertiesViewModel(this,item,this._designApi,this._filter,this.listManager,this._isContentLibraryAvailable);this.addAnswerFileOptionsTab()}else{this.propertiesPanelModel=new Design.ContentLibraryPropertiesViewModel(this,item,this._wizard,this._filter,this._modal,this.listManager,this._designApi);if(clQuestion.Visibility&&!((clQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.Image||clQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.Attachment)&&clQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.ExistingContentItem)){this.addAnswerFileOptionsTab()}}}else if(item instanceof Intelledox.QAWizard.Design.ChartQuestion){this.propertiesPanelModel=new Design.ChartPropertiesViewModel(this,item,this.wizard,this._filter,this.listManager);this.addSeriesTab()}else if(item instanceof Intelledox.QAWizard.Design.ButtonQuestion){this.propertiesPanelModel=new Design.ButtonPropertiesViewModel(this,item,this._filter,this._modal,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.SummaryQuestion){this.propertiesPanelModel=new Design.SummaryPropertiesViewModel(this,item,this.currentPage,this.wizard,this._filter,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){this.propertiesPanelModel=new Design.RunActionButtonPropertiesViewModel(this,item,this._filter,this._modal,this.listManager)}else{this.propertiesPanelModel=new Design.QuestionPropertiesViewModel(this,item,this._filter,this.listManager)}this.propertiesPanelCode='question';this.addConditionsTab();if(!(item instanceof Intelledox.QAWizard.Design.AddressQuestion||item instanceof Intelledox.QAWizard.Design.AutoLogicQuestion||item instanceof Intelledox.QAWizard.Design.BarcodeQuestion||item instanceof Intelledox.QAWizard.Design.ChartQuestion||item instanceof Intelledox.QAWizard.Design.SummaryQuestion||item instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion||item instanceof Intelledox.QAWizard.Design.ValidationQuestion)){this.addSummarySettingsTab()}}else if(item instanceof Intelledox.QAWizard.Design.Answer){if(item instanceof Intelledox.QAWizard.Design.GeolocationAnswer){this.propertiesPanelModel=new Design.GeolocationAnswerPropertiesViewModel(this,item.Question,item,this._filter,this.listManager);this.addAnswerFileOptionsTab()}else if(item instanceof Intelledox.QAWizard.Design.GroupLogicAnswer){this.propertiesPanelModel=new Design.GroupLogicAnswerPropertiesViewModel(this,item.Question,item,this._filter,this.listManager);this.addConditionsTab();this.addAnswerFileOptionsTab()}else if(item instanceof Intelledox.QAWizard.Design.DatasourceAnswer){this.propertiesPanelModel=new Design.DataSourceAnswerPropertiesViewModel(this,this._wizard,item.Question,item,this._filter,this.listManager);if(item.Question.Visibility){this.addValidationsTab()}this.addAnswerFileOptionsTab()}else if(item instanceof Intelledox.QAWizard.Design.VariableAnswer){this.propertiesPanelModel=new Design.VariableAnswerPropertiesViewModel(this,item.Question,item,this._filter,this._designApi,this.listManager);this.addAnswerFileOptionsTab()}else if(item instanceof Intelledox.QAWizard.Design.BarcodeAnswer){this.propertiesPanelModel=new Design.BarcodeAnswerPropertiesViewModel(this,item.Question,item,this._filter,this.listManager)}else if(item instanceof Intelledox.QAWizard.Design.CustomAnswer){this.propertiesPanelModel=new Design.CustomAnswerPropertiesViewModel(this,item.Question,item,this._filter,this.listManager);this.addAnswerFileOptionsTab()}else if(item instanceof Intelledox.QAWizard.Design.AutoLogicAnswer){this.propertiesPanelModel=new Design.AnswerPropertiesViewModel(this,item.Question,item,this._filter,this.listManager);this.addRulesTab();this.addAnswerFileOptionsTab()}else if(item instanceof Intelledox.QAWizard.Design.AddressAnswer){this.propertiesPanelModel=new Design.AddressAnswerPropertiesViewModel(this,item.Question,item,this._filter,this._designApi,this.listManager);this.addAnswerFileOptionsTab()}else{var currentQuestion=item.Question;if(currentQuestion instanceof Intelledox.QAWizard.Design.ContentLibraryQuestion){this.propertiesPanelModel=new Design.ContentLibraryAnswerPropertiesViewModel(this,item.Question,item,this._filter,this.listManager)}else if(currentQuestion instanceof Intelledox.QAWizard.Design.InkQuestion){this.propertiesPanelModel=new Design.InkAnswerPropertiesViewModel(this,item.Question,item,this._filter,this.listManager);this.addAnswerFileOptionsTab()}else if(currentQuestion instanceof Intelledox.QAWizard.Design.ChartQuestion){this.propertiesPanelModel=new Design.ChartAnswerPropertiesViewModel(this,item.Question,item,this._filter,this.listManager)}else if(currentQuestion instanceof Intelledox.QAWizard.Design.ButtonQuestion){var tQuestion=currentQuestion;this.propertiesPanelModel=new Design.AnswerPropertiesViewModel(this,tQuestion,item,this._filter,this.listManager);if(tQuestion.ButtonType===Intelledox.Model.ButtonType.Toggle){this.addAnswerFileOptionsTab()}}else{this.propertiesPanelModel=new Design.AnswerPropertiesViewModel(this,item.Question,item,this._filter,this.listManager);if(currentQuestion instanceof Intelledox.QAWizard.Design.UserPromptQuestion||currentQuestion instanceof Intelledox.QAWizard.Design.LabelQuestion||currentQuestion instanceof Intelledox.QAWizard.Design.NumericQuestion||currentQuestion instanceof Intelledox.QAWizard.Design.RichTextQuestion){this.addAnswerFileOptionsTab()}}}this.propertiesPanelCode='answer'}else if(item instanceof Intelledox.QAWizard.Design.Section){this.propertiesPanelModel=new Design.SectionPropertiesViewModel(this,item,this._filter,this._modal,this.listManager);this.propertiesPanelCode='section';this.addConditionsTab()}else if(item instanceof Intelledox.QAWizard.Design.Column){this.propertiesPanelModel=new Design.ColumnPropertiesViewModel(this,treenode.parent.tag,item,this._filter,this.listManager);this.propertiesPanelCode='column';this.addConditionsTab()}else if(item instanceof Intelledox.QAWizard.Design.TabGroup){this.propertiesPanelModel=new Design.TabGroupPropertiesViewModel(this,item,this._filter,this.listManager);this.propertiesPanelCode='tabGroup';this.addConditionsTab()}else if(item instanceof Intelledox.QAWizard.Design.TabPage){this.propertiesPanelModel=new Design.TabPagePropertiesViewModel(this,item,this._filter,this.listManager);this.propertiesPanelCode='tabPage';this.addConditionsTab()}else if(item instanceof Intelledox.QAWizard.Design.Action){this.propertiesPanelModel=new Design.ActionPropertiesViewModel(this,item,this._wizard,this._filter,this.listManager,this._rootScope,this.isWorkflowPage);this.propertiesPanelCode='action';this.addActionDocumentsTab(item);this.addConditionsTab()}else if(item instanceof Intelledox.QAWizard.Design.AvailableInput){this.propertiesPanelModel=new Design.AvailableInputPropertiesViewModel(this._filter,this,item,this._wizard);this.propertiesPanelCode='availableInput'}else if(item instanceof Intelledox.QAWizard.Design.AvailableOutput){this.propertiesPanelModel=new Design.FragmentOutputPropertiesViewModel(this._filter,this,item,this._wizard,this.listManager);this.propertiesPanelCode='fragmentOutput'}else if(item instanceof Intelledox.QAWizard.Design.FragmentDocument){this.propertiesPanelModel=new Design.FragmentDocumentPropertiesViewModel(this._filter,this,item);this.propertiesPanelCode='fragmentDocument'}else if(item instanceof Intelledox.QAWizard.Design.ContentItem){this.propertiesPanelModel=new Design.ContentItemPropertiesViewModel(this._filter,this,item,this.listManager);this.propertiesPanelCode='contentItem'}else if(item instanceof Intelledox.QAWizard.Design.Workflow){this.propertiesPanelModel=new Design.WorkflowParallelPropertiesViewModel(this._filter,this._rootScope,this,item,this._wizard);this.propertiesPanelCode='workflowParallel'}else if(item instanceof Intelledox.QAWizard.Design.WorkflowState){this.propertiesPanelModel=new Design.WorkflowStatePropertiesViewModel(this._filter,this._rootScope,this,item,this._wizard);this.propertiesPanelCode='workflowState'}else if(item instanceof Design.WorkflowTransitionCollection){this.propertiesPanelModel=new Design.WorkflowTransitionPropertiesViewModel(this._filter,this._rootScope,this,item,this._wizard,this.listManager,this._modal);this.propertiesPanelCode='workflowTransition';switch(item.transType){case Design.TransitionType.Normal:case Design.TransitionType.SingleEntry:case Design.TransitionType.SingleExit:this.addConditionsTab();this.addProjectPropertiesTab();break}}else if(item instanceof Intelledox.QAWizard.Design.Placeholder){var vm=this;var parentQuestionNode=this.treeView.findAncestorOrSelf(treenode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Question});var parentAnswerNode=this.treeView.findAncestorOrSelf(treenode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Answer});this.propertiesPanelModel=new Design.PlaceholderPropertiesViewModel(this,this._filter,this._modal,this.documentInterface,this._wizard,parentQuestionNode==null?null:parentQuestionNode.tag,parentAnswerNode==null?null:parentAnswerNode.tag,item,this.flyoutPlaceholders,function(placeholderName,parentNode,docGuid,dragPlaceholder){return Design.HelperFunctions.isPlaceholderNameAllowed(vm._wizard,placeholderName,parentNode,docGuid,dragPlaceholder)});this.propertiesPanelCode='placeholder'}else if(item instanceof Intelledox.QAWizard.Design.DocumentTemplate){var binary=null;var documentTemplate=item;if(documentTemplate.HasBinary){for(var i=0;i<this.templateBinaries.length;i++){if(documentTemplate.DocumentGuid===this.templateBinaries[i].documentGuid){binary=this.templateBinaries[i];break}}}this.propertiesPanelModel=new Design.TemplatePropertiesViewModel(this,this._filter,this._designApi,this.documentInterface,this._wizard,item,binary,this.flyoutPlaceholders,this.listManager,this._enableOfficeEdit);this.propertiesPanelCode='template';if(this._wizard.TypeId!==Intelledox.Model.ProjectType.Layout){this.addConditionsTab()}}else if(item instanceof Intelledox.QAWizard.Design.Escalation){this.propertiesPanelModel=new Design.EscalationPropertiesViewModel(this,item,this._wizard,this._filter,this.listManager,this._rootScope);this.propertiesPanelCode='escalation';this.addConditionsTab()}else{this.propertiesPanelCode='noProperties'}if((this.panelCode==='conditions'&&!this.hasConditions)||(this.panelCode==='dataFilters'&&!this.hasDataFilters)||(this.panelCode==='displayFields'&&!this.hasDisplayFields)||(this.panelCode==='rules'&&!this.hasRules)||(this.panelCode==='sorting'&&!this.hasSorting)||(this.panelCode==='actionDocuments'&&!this.hasActionDocuments)||(this.panelCode==='validations'&&!this.hasValidations)||(this.panelCode==='series'&&!this.hasSeries)||(this.panelCode==='answerFileOptions'&&!this.hasAnswerFileOptions)||(this.panelCode==='protectedFields'&&!this.hasProtectedFields)||(this.panelCode==='projectProperties'&&!this.hasProjectProperties)||(this.panelCode==='summarySettings'&&!this.hasSummarySettings)){this.panelCode='properties'}};EditorViewModel.prototype.editorMove=function(dragNode,targetNode){this.removeNode(dragNode);this.insertNode(dragNode,targetNode);this.wizChanged=true};EditorViewModel.prototype.editorDrop=function(id,targetNode){var dragItem=id.split('_')[1];var itemNameSplit=dragItem.split('.');var dragType=itemNameSplit[0];var dragObject=itemNameSplit[1];var configuration=null;var droppedOnPreview=false;if(itemNameSplit.length===3){configuration=itemNameSplit[2]}if(targetNode!=null&&!(targetNode instanceof Design.TreeNode)){droppedOnPreview=true;targetNode=this.getTreeNodeFromQA(this.currentPage,targetNode)}switch(dragType){case'question':this.createNewQuestion(this._wizard,targetNode,parseInt(dragObject,10),configuration,null);break;case'custom':this.createNewQuestion(this._wizard,targetNode,Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom,configuration,dragObject);break;case'layout':this.createNewLayout(this._wizard,dragObject,targetNode,droppedOnPreview);break;case'fragment':this.createNewLayout(this._wizard,'fragment',targetNode,droppedOnPreview,dragObject);break;case'misc':if(dragObject==='answer'){this.createNewAnswer(this._wizard,targetNode,true)}else if(dragObject==='templateword'){this.createNewTemplate(targetNode,".docx,.docm,.doc,.dotx,.dot")}else if(dragObject==='templateexcel'){this.createNewTemplate(targetNode,".xlsx,.xlxm")}else if(dragObject==='templatepowerpoint'){this.createNewTemplate(targetNode,".pptx")}else if(dragObject==='templatepdf'){this.createNewTemplate(targetNode,".pdf")}else if(dragObject==='templatejson'){this.createNewTemplate(targetNode,".json")}else if(dragObject==='templatexsd'){this.createNewTemplate(targetNode,".xsd")}else if(dragObject==='templatecsv'){this.createNewTemplate(targetNode,".csv,.txt")}else if(dragObject==='templatetxt'){this.createNewTemplate(targetNode,".txt")}else if(dragObject==='templatehtml'){this.createNewTemplate(targetNode,".html")}else if(dragObject==='projectresults'){this.createBuiltInTemplate(targetNode,Intelledox.Model.TemplateFormatType.ProjectResults,true)}break;case'action':this.createNewAction(this._wizard,targetNode,dragObject);break;case'contentitem':this.createNewContentItem(this._wizard,targetNode,dragObject);break}};EditorViewModel.prototype.editorDropResponseMetadataField=function(responseMetaField,targetNode){this.addResponseMetadataField(responseMetaField,targetNode)};EditorViewModel.prototype.editorDropPlaceholder=function(dragNode,targetNode){if(targetNode==null||targetNode.treeView===this.treeView){if(dragNode.documentGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){this.addPlaceholder(dragNode.reference,targetNode,Intelledox.Common.ConstantValues.GUID_EMPTY,true)}else{this.addPlaceholder(dragNode.reference,targetNode,dragNode.documentGuid,false)}}};EditorViewModel.prototype.editorCopy=function(){this.copyObject=this.treeView.selectedNode;this.isFirstCut=false};EditorViewModel.prototype.editorCut=function(){this.copyObject=this.treeView.selectedNode;var nextSelectedNode=null;if(this.copyObject.prevNode!=null){nextSelectedNode=this.copyObject.prevNode}else if(this.copyObject.nextNode!=null){nextSelectedNode=this.copyObject.nextNode}else if(this.copyObject.parent!=null){nextSelectedNode=this.copyObject.parent}this.colourChildPlaceholders(this.treeView.selectedNode,false);this.removeNode(this.treeView.selectedNode);this.isFirstCut=true;if(nextSelectedNode==null){this.currentPage=null}this.nodeSelected(nextSelectedNode)};EditorViewModel.prototype.editorPaste=function(){var pasteObject=null;var pasteNode=null;try{if(this.isFirstCut){pasteNode=this.copyObject}else{this.incrementLastAnswerId(this.wizard);this.incrementLastQuestionId(this.wizard);if(this.copyObject.tag instanceof Intelledox.QAWizard.Design.AvailableOutput){pasteObject=this.copyObject.tag.Copy(this.wizard)}else{var nextId=new Intelledox.QAWizard.Design.NextId(this._lastQuestionId,this._lastAnswerId);pasteObject=this.copyObject.tag.Clone(nextId);this._lastQuestionId=nextId.nextQuestionId;this._lastAnswerId=nextId.nextAnswerId;if(typeof this.copyObject.tag.HasFragmentInterface!=="undefined"){var fragment=pasteObject;var nameCounter=2;while(!this.wizard.IsUniqueFragmentName(fragment.Name,Intelledox.Common.ConstantValues.GUID_EMPTY)){fragment.Name=this.copyObject.tag.Name+" "+nameCounter.toString();nameCounter+=1}}}this._lastQuestionId-=1;this._lastAnswerId-=1;if(pasteObject instanceof Intelledox.QAWizard.Design.Page){this.incrementLastPageId(this.wizard);pasteObject.ID=this._lastPageId}pasteNode=Design.QuestionSetDesignerFactory.getQuestionSetTreenode(this._filter,this.treeView,pasteObject,this.wizard,this.listManager);if(typeof pasteObject.HasContainerInterface!=="undefined"){this.loadQuestionSetLayout(pasteObject.Children,pasteNode)}else if(pasteObject instanceof Intelledox.QAWizard.Design.Action){this.loadQuestionSetLayout(pasteObject.Children,pasteNode);pasteNode.tag.Name=this.uniqueActionName(this.wizard,pasteNode.tag.Name);pasteNode.text=pasteNode.tag.Name}}this.insertNode(pasteNode,this.treeView.selectedNode);if(this.isFirstCut){this.isFirstCut=false;this.colourChildPlaceholders(pasteNode,true)}}catch(ex){console.log(ex)}};EditorViewModel.prototype.editorDelete=function(){var wizard=this.wizard;var vm=this;if(this.selectedNode instanceof Intelledox.QAWizard.Design.WorkflowState||this.selectedNode instanceof Intelledox.QAWizard.Design.Workflow||this.selectedNode instanceof Design.WorkflowTransitionCollection||this.selectedNode instanceof Intelledox.QAWizard.Design.Escalation){var hasSubItems=false;if(this.selectedNode instanceof Intelledox.QAWizard.Design.WorkflowState){var state=this.selectedNode;if(state.EscalationList.length>0||state.Transitions.length>0){hasSubItems=true}}else if(this.selectedNode instanceof Intelledox.QAWizard.Design.Workflow){hasSubItems=true}else if(this.selectedNode instanceof Design.WorkflowTransitionCollection){var workflowTransitionCollection=this.selectedNode;if(workflowTransitionCollection.transitions.length>0&&workflowTransitionCollection.transitions[0].Actions.length>0){hasSubItems=true}}var modalInstance=this._modal.open({templateUrl:'Views/Modal/confirmDelete.html?v=106882799234227327',controller:['$scope','$modalInstance','$sce','htmlMessage',Design.ConfirmModalCtrl],backdrop:'static',resolve:{htmlMessage:function(){var nodeName=Design.QuestionSetDesignerFactory.getWorkflowTypeName(vm._filter,vm.selectedNode);return(hasSubItems?System.String.Format(vm._filter('translate')('ConfirmDeleteQuestionSetSubitems'),nodeName):System.String.Format(vm._filter('translate')('ConfirmDeleteQuestionSetItem'),nodeName))}}});modalInstance.result.then(function(){if(vm.selectedNode instanceof Intelledox.QAWizard.Design.WorkflowState){vm.deleteState(vm.selectedNode)}else if(vm.selectedNode instanceof Design.WorkflowTransitionCollection){var parentState=vm.selectedNode.state;parentState.Transitions.splice(parentState.Transitions.indexOf(vm.selectedNode.transitions[0]),1)}else if(vm.selectedNode instanceof Intelledox.QAWizard.Design.Workflow){vm.deleteParallelSection(vm.selectedNode)}else if(vm.selectedNode instanceof Intelledox.QAWizard.Design.Escalation){vm.deleteEscalation(vm.selectedNode)}vm._rootScope.$emit('workflowChanged');vm.nodeSelected(wizard.Workflow.GetStartState())});return}var node=this.treeView.selectedNode;if(node==null){if(this.selectedNode instanceof Intelledox.QAWizard.Design.Action){this.deleteTransitionAction(this.selectedNode);this._rootScope.$emit('workflowChanged');vm.nodeSelected(wizard.Workflow.GetStartState())}return}try{var message;var containsParent=false;var docDelete=false;var placeholderNodes;if(this.selectedNode instanceof Intelledox.QAWizard.Design.DocumentTemplate){var doc=this.selectedNode;placeholderNodes=this.getDocumentPlaceholderNodes(doc.DocumentGuid);message=this._filter('translate')('ConfirmDeleteDocument');if(placeholderNodes.length>0){message+='<br><br>'+this._filter('translate')('ProjectHasDocumentPlaceholders');containsParent=true}docDelete=true}else{if(node.nodes.length>0){message=System.String.Format(this._filter('translate')('ConfirmDeleteQuestionSetSubitems'),Design.QuestionSetDesignerFactory.getQuestionSetTypeName(this._filter,node))}else{message=System.String.Format(this._filter('translate')('ConfirmDeleteQuestionSetItem'),Design.QuestionSetDesignerFactory.getQuestionSetTypeName(this._filter,node))}message+="<br><br>  - "+Intelledox.Common.Functions.EscapeHtml(node.text);if(node.tag instanceof Intelledox.QAWizard.Design.Page&&this.isPageNotLoaded(node)){this.treeView.beforeExpand(node)}containsParent=(Design.DependencyHelper.getLogicDependencies(this.wizard,node,false).length>0);if(containsParent){message+="<br><br>"+this._filter('translate')('ConfirmDeleteQuestionSetDependency')}if(node.tag instanceof Intelledox.QAWizard.Design.Answer){var answer=node.tag;if(answer.Question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic&&answer.Question.DefaultValue===answer.AnswerGuid.toString()){message+='<br><br>'+this._filter('translate')('ConfirmDeleteDefaultAnswer')}}}var modalInstance=this._modal.open({templateUrl:'Views/Modal/confirmDelete.html?v=106882799234227327',controller:['$scope','$modalInstance','$sce','htmlMessage',Design.ConfirmModalCtrl],backdrop:'static',resolve:{htmlMessage:function(){return message}}});modalInstance.result.then(function(){var nextSelectedNode=null;vm.treeView.isInPickMode=false;vm.removeQuestionSetItem(wizard,node);if(node.prevNode!=null){nextSelectedNode=node.prevNode}else if(node.nextNode!=null){nextSelectedNode=node.nextNode}else if(node.parent!=null){nextSelectedNode=node.parent}node.remove();if(nextSelectedNode==null&&node.tag instanceof Intelledox.QAWizard.Design.Page){vm.currentPage=null}vm.nodeSelected(nextSelectedNode);if(containsParent){var modalConfirm=vm._modal.open({templateUrl:'Views/Modal/confirmDelete.html?v=106882799234227327',controller:['$scope','$modalInstance','$sce','htmlMessage',Design.ConfirmModalCtrl],backdrop:'static',resolve:{htmlMessage:function(){if(docDelete){return vm._filter('translate')('DeletePlaceholders')}return vm._filter('translate')('ConfirmDeleteChildren')}}});modalConfirm.result.then(function(){if(docDelete){for(var i=0;i<placeholderNodes.length;i++){vm.removeNode(placeholderNodes[i])}}else{Design.DependencyHelper.getLogicDependencies(vm.wizard,node,true)}},function(){if(docDelete){for(var i=0;i<placeholderNodes.length;i++){placeholderNodes[i].imageKey="icon-bookmarkblack"}}})}if(node.tag instanceof Intelledox.QAWizard.Design.ContentItem){var contentItemGuid=node.tag.ContentItemGuid;var foundItems=[];Design.FindAndReplace.find(vm._wizard,foundItems,vm.treeView,vm.treeView.nodes,Design.findType.contentItem,Design.findOn.id,contentItemGuid,true);if(foundItems.length===0){vm.flyoutPlaceholders.removeContentItemReference(contentItemGuid)}}vm.wizChanged=true})}catch(ex){console.log("Error check remove question set item"+ex)}};Object.defineProperty(EditorViewModel.prototype,"isToggleStateOn",{get:function(){var workflowPage=this.currentPage;return workflowPage.OnlyShowStates},enumerable:true,configurable:true});EditorViewModel.prototype.toggleState=function(){var workflowPage=this.currentPage;workflowPage.OnlyShowStates=!workflowPage.OnlyShowStates;this._rootScope.$emit('workflowChanged')};EditorViewModel.prototype.getAppSettings=function(){var vm=this;return this._designApi.getAppSettings().then(function(data){vm.helpUrl=data.helpUrl;vm._enableOfficeEdit=data.enableOfficeEdit})};EditorViewModel.prototype.help=function(){var win=window.open(this.helpUrl,'_blank');win.focus()};EditorViewModel.prototype.editorFind=function(){var vm=this;var modalInstance=this._modal.open({templateUrl:'Views/Modal/find.html?v=106882799234227327',controller:['$scope','$filter','$modalInstance',Design.FindModalCtrl],backdrop:'static'});modalInstance.result.then(function(result){if(result.isFind){var foundItems=[];vm.forceTreeLoad();Design.FindAndReplace.find(vm.wizard,foundItems,vm.treeView,vm.treeView.nodes,result.itemType,result.searchOn,result.findWhat,false);vm.displayFoundNodes(foundItems,System.String.Format(vm._filter('translate')('Msg_QANotFoundFormat'),result.findWhat))}else{var foundReplaceItems=Design.FindAndReplace.findAndReplaceText(vm.wizard,result.findWhat,result.replaceWith);if(foundReplaceItems.length>0){vm.wizChanged=true;vm.loadTreeView()}vm.displayFoundItems(foundReplaceItems,false,result.findWhat,result.replaceWith)}})};EditorViewModel.prototype.editorRefreshLists=function(){if(this.isWorkflowPage){var currentSelectedNode=this.selectedNode;this.listManager.clear();this.nodeSelected(null);this.nodeSelected(currentSelectedNode)}else{var currentNode=this.treeView.selectedNode;this.listManager.clear();this.treeView.selectedNode=null;this.nodeSelected(currentNode)}};EditorViewModel.prototype.deleteState=function(stateToDelete){var fullList=this._wizard.Workflow.FullStateList;for(var stateIndex=0;stateIndex<fullList.length;stateIndex++){var state=fullList[stateIndex];if(state.Transitions!=null){for(var i=state.Transitions.length-1;i>=0;i--){if(state.Transitions[i].StateId===stateToDelete.Id){state.Transitions.splice(i,1);break}}}}this._wizard.Workflow.RemoveState(stateToDelete);this.wizChanged=true};EditorViewModel.prototype.deleteParallelSection=function(parallelToDelete){for(var i=parallelToDelete.States.length-1;i>=0;i--){this.deleteState(parallelToDelete.States[i])}for(var i=parallelToDelete.ParallelSections.length-1;i>=0;i--){this.deleteParallelSection(parallelToDelete.ParallelSections[i])}this.wizard.Workflow.RemoveParallel(parallelToDelete);this.wizChanged=true};EditorViewModel.prototype.deleteEscalation=function(escalationToDelete){var fullList=this._wizard.Workflow.FullStateList;for(var stateIndex=0;stateIndex<fullList.length;stateIndex++){for(var escalationIndex=0;escalationIndex<fullList[stateIndex].EscalationList.length;escalationIndex++){if(fullList[stateIndex].EscalationList[escalationIndex]===escalationToDelete){fullList[stateIndex].EscalationList.splice(escalationIndex,1);this.wizChanged=true;return}}}};EditorViewModel.prototype.deleteTransitionAction=function(actionToDelete){var fullList=this._wizard.Workflow.FullStateList;for(var stateIndex=0;stateIndex<fullList.length;stateIndex++){for(var transitionsIndex=0;transitionsIndex<fullList[stateIndex].Transitions.length;transitionsIndex++){if(this.deleteTransitionActionRecursive(fullList[stateIndex].Transitions[transitionsIndex].Actions,actionToDelete)){return}}}};EditorViewModel.prototype.deleteTransitionActionRecursive=function(actions,actionToDelete){for(var actionIndex=0;actionIndex<actions.length;actionIndex++){if(actions[actionIndex]===actionToDelete){actions.splice(actionIndex,1);this.wizChanged=true;return true}if(actions[actionIndex].Children.length>0){if(this.deleteTransitionActionRecursive(actions[actionIndex].Children,actionToDelete)){return true}}}return false};EditorViewModel.prototype.addConditionsTab=function(){if(this.selectedNode instanceof Design.WorkflowTransitionCollection){this.conditionsPanelModel.init(this._wizard,this.currentPage,this.selectedNode.transitions[0],this.listManager)}else{this.conditionsPanelModel.init(this._wizard,this.currentPage,this.selectedNode,this.listManager)}this.hasConditions=true};EditorViewModel.prototype.addProjectPropertiesTab=function(){this.projectPropertiesModel.init(this._wizard,this.selectedNode.transitions[0]);this.hasProjectProperties=(this._wizard.Properties.length>0)};EditorViewModel.prototype.addValidationsTab=function(){this.validationsPanelModel.init(this.selectedNode);this.hasValidations=true};EditorViewModel.prototype.addDataFiltersTab=function(){this.dataFiltersPanelModel.init(this._wizard,this.selectedNode,this.listManager);this.hasDataFilters=true};EditorViewModel.prototype.addDisplayFieldsTab=function(){this.displayFieldsPanelModel.init(this._wizard,this.selectedNode);this.hasDisplayFields=true};EditorViewModel.prototype.addSortingTab=function(){this.sortPanelModel.init(this._wizard,this.selectedNode);this.hasSorting=true};EditorViewModel.prototype.addRulesTab=function(){this.rulesPanelModel.init(this._wizard,this.currentPage,this.selectedNode,this.listManager);this.hasRules=true};EditorViewModel.prototype.addActionDocumentsTab=function(action){this.actionDocumentsPanelModel.init(this._wizard,this.selectedNode);this.hasActionDocuments=(action.SubmissionStage!==Intelledox.Model.SubmissionStage.Submit)};EditorViewModel.prototype.addSeriesTab=function(){this.seriesPanelModel.init(this._wizard,this.selectedNode);this.hasSeries=true};EditorViewModel.prototype.addAnswerFileOptionsTab=function(){if(this.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard){this.answerFileOptionsPanelModel.init(this._wizard,this.selectedNode);this.hasAnswerFileOptions=true}};EditorViewModel.prototype.addProtectedFieldsTab=function(){this.protectedFieldsPanelModel.init(this._wizard);this.hasProtectedFields=true};EditorViewModel.prototype.addSummarySettingsTab=function(){if(this._isSummaryAvailable&&this._wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard){this.summarySettingsPanelModel.init(this._wizard,this.selectedNode);this.hasSummarySettings=true}};EditorViewModel.prototype.removeNode=function(node){if(node.tag instanceof Intelledox.QAWizard.Design.FragmentPage||node.tag instanceof Intelledox.QAWizard.Design.Page){this._wizard.Pages.splice(this._wizard.Pages.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.Section||node.tag instanceof Intelledox.QAWizard.Design.TabGroup||node.tag instanceof Intelledox.QAWizard.Design.FragmentReference){node.parent.tag.Children.splice(node.parent.tag.Children.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.Column){node.parent.tag.Columns.splice(node.parent.tag.Columns.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.TabPage){node.parent.tag.TabPages.splice(node.parent.tag.TabPages.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.Question){node.parent.tag.Children.splice(node.parent.tag.Children.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.Answer){var parentQuestion=node.treeView.findAncestorOrSelf(node,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Question}).tag;parentQuestion.Answers.splice(parentQuestion.Answers.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.Placeholder){if(node.parent.tag instanceof Intelledox.QAWizard.Design.FragmentDocument){node.parent.tag.Placeholders.splice(node.parent.tag.Placeholders.indexOf(node.tag),1)}else if(node.parent.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){node.parent.tag.Placeholders.splice(node.parent.tag.Placeholders.indexOf(node.tag),1)}else if(node.parent.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){node.parent.tag.Placeholders.splice(node.parent.tag.Placeholders.indexOf(node.tag),1)}else{var parentAnswer=node.treeView.findAncestorOrSelf(node,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Answer}).tag;parentAnswer.Placeholders.splice(parentAnswer.Placeholders.indexOf(node.tag),1)}}else if(node.tag instanceof Intelledox.QAWizard.Design.ContentItem){return}else if(node.tag instanceof Intelledox.QAWizard.Design.Action){var actionSetQuestion=Intelledox.Design.EditorViewModel.getParentActionButtonQuestion(node);if(actionSetQuestion!==null){this.removeAction(node.tag,actionSetQuestion.tag.Actions)}else{this.removeAction(node.tag,this._wizard.Actions)}}else if(node.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){this.removeDocument(node.tag,this._wizard.Documents)}else if(node.tag instanceof Intelledox.QAWizard.Design.AvailableOutput){this._wizard.AvailableOutputs.splice(this._wizard.AvailableOutputs.indexOf(node.tag),1)}this.removeChildQuestions(node);node.remove();this.nodeSelected(null);this.wizChanged=true};EditorViewModel.prototype.removeChildQuestions=function(node){if(!(node.tag instanceof Intelledox.QAWizard.Design.Page)){var parentPage=node.treeView.findAncestorOrSelf(node,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Page}).tag;var childQuestions=node.getSelfAndChildTags(function(node){return node.tag instanceof Intelledox.QAWizard.Design.Question});for(var i=0;i<childQuestions.length;i++){parentPage.Questions.splice(parentPage.Questions.indexOf(childQuestions[i]),1)}}};EditorViewModel.prototype.removeAction=function(o,actions){if(actions.indexOf(o)>-1){actions.splice(actions.indexOf(o),1)}else{for(var i=0;i<actions.length;i++){this.removeAction(o,actions[i].Children)}}};EditorViewModel.prototype.removeDocument=function(o,documents){if(documents.indexOf(o)>-1){documents.splice(documents.indexOf(o),1)}};EditorViewModel.prototype.forceTreeLoad=function(){for(var i=0;i<this.treeView.nodes.length;i++){if(this.isPageNotLoaded(this.treeView.nodes[i])){this.loadQuestionSetPage(this.treeView.nodes[i])}}};EditorViewModel.prototype.removeQuestionSetItem=function(wizard,node){this.forceTreeLoad();this.removeQuestionSetItemRecursive(wizard,node)};EditorViewModel.prototype.removeQuestionSetItemRecursive=function(wizard,node){if(this.copyObject!=null&&node.tag===this.copyObject.tag){this.copyObject=null}for(var nodeChildren=0;nodeChildren<node.nodes.length;nodeChildren++){this.removeQuestionSetItemRecursive(wizard,node.nodes[nodeChildren])}if(node.tag instanceof Intelledox.QAWizard.Design.FragmentPage){wizard.Pages.splice(wizard.Pages.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.Page){wizard.Pages.splice(wizard.Pages.indexOf(node.tag),1);if(node.tag.IsRepeated){this.flyoutPlaceholders.colourPlaceholders(node.tag.RepeatPlaceholders,false)}}else if(node.tag instanceof Intelledox.QAWizard.Design.Section){if(node.tag.IsRepeated){this.flyoutPlaceholders.colourPlaceholders(node.tag.RepeatPlaceholders,false)}node.parent.tag.Children.splice(node.parent.tag.Children.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.TabGroup||node.tag instanceof Intelledox.QAWizard.Design.FragmentReference){node.parent.tag.Children.splice(node.parent.tag.Children.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.Column){node.parent.tag.Columns.splice(node.parent.tag.Columns.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.TabPage){node.parent.tag.TabPages.splice(node.parent.tag.TabPages.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.Question){if(node.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&node.tag.SelectionType===Intelledox.Model.SelectionType.Multiple){this.flyoutPlaceholders.colourPlaceholders(node.tag.RepeatPlaceholders,false)}node.parent.tag.Children.splice(node.parent.tag.Children.indexOf(node.tag),1);var parentPageNode=node.treeView.findAncestorOrSelf(node,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Page});parentPageNode.tag.Questions.splice(parentPageNode.tag.Questions.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.Answer){var parentQuestionNode=node.treeView.findAncestorOrSelf(node,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Question});parentQuestionNode.tag.Answers.splice(parentQuestionNode.tag.Answers.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.ContentItem){var parentAnswerNode=node.treeView.findAncestorOrSelf(node,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Answer});parentAnswerNode.tag.ContentItems.splice(parentAnswerNode.tag.ContentItems.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.Placeholder){var placeholder=node.tag;if(!this.placeholderIsBlank(placeholder.CloseGapPlaceholder)&&!placeholder.CloseGapPlaceholder.equals(placeholder.Reference)){this.flyoutPlaceholders.colourPlaceholder(placeholder.CloseGapPlaceholder,false,false,placeholder.DocumentGuid)}this.flyoutPlaceholders.colourPlaceholder(placeholder.Reference,placeholder.External,false,placeholder.DocumentGuid);if(node.parent.tag instanceof Intelledox.QAWizard.Design.FragmentDocument){node.parent.tag.Placeholders.splice(node.parent.tag.Placeholders.indexOf(node.tag),1)}else if(node.parent.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){node.parent.tag.Placeholders.splice(node.parent.tag.Placeholders.indexOf(node.tag),1)}else if(node.parent.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){node.parent.tag.Placeholders.splice(node.parent.tag.Placeholders.indexOf(node.tag),1)}else{var parentAnswerNode=node.treeView.findAncestorOrSelf(node,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Answer});parentAnswerNode.tag.Placeholders.splice(parentAnswerNode.tag.Placeholders.indexOf(node.tag),1)}}else if(node.tag instanceof Intelledox.QAWizard.Design.ResponseMetadataField){if(node.parent.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){node.parent.tag.ResponseMetadataFields.splice(node.parent.tag.ResponseMetadataFields.indexOf(node.tag),1);this.flyoutPlaceholders.colourResponseMetdataField(node.tag,false)}else if(node.parent.tag instanceof Intelledox.QAWizard.Design.Answer){node.parent.tag.ResponseMetadataFields.splice(node.parent.tag.ResponseMetadataFields.indexOf(node.tag),1);this.flyoutPlaceholders.colourResponseMetdataField(node.tag,false)}}else if(node.tag instanceof Intelledox.QAWizard.Design.Action){var runActionButtonQuestion=Intelledox.Design.EditorViewModel.getParentActionButtonQuestion(node);if(runActionButtonQuestion!==null){this.removeAction(node.tag,runActionButtonQuestion.tag.Actions)}else{this.removeAction(node.tag,wizard.Actions)}}else if(node.tag instanceof Intelledox.QAWizard.Design.AvailableInput){wizard.AvailableInputs.splice(wizard.AvailableInputs.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.AvailableOutput){wizard.AvailableOutputs.splice(wizard.AvailableOutputs.indexOf(node.tag),1)}else if(node.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){wizard.Documents.splice(this._wizard.Documents.indexOf(node.tag),1);this.flyoutPlaceholders.removeDocument(node.tag.DocumentGuid);if(node.tag.HasBinary){for(var docIndex=0;docIndex<this.templateBinaries.length;docIndex++){if(this.templateBinaries[docIndex].documentGuid===node.tag.DocumentGuid){this.templateBinaries.splice(docIndex,1);break}}}}};EditorViewModel.prototype.isLastNodeFixed=function(treeview){return treeview.nodes.length>0&&this.isFixedNode(treeview.nodes[treeview.nodes.length-1])};EditorViewModel.prototype.isPageNotLoaded=function(pageNode){return(!pageNode.isExpanded)&&pageNode.nodes.length>0&&this.isTempPlaceHolder(pageNode.nodes[0])};EditorViewModel.prototype.isTempPlaceHolder=function(node){if(node==null){return false}else{if(typeof node.tag==='string'&&node.tag==="placeholder"){return true}else{return false}}};EditorViewModel.prototype.loadTreeView=function(){var i=0;this.treeView.clear();if(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPage||this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){var inputsNode=new Design.TreeNode(this._filter('translate')('Inputs'),Intelledox.Common.ConstantValues.INPUTSNODETAG);inputsNode.treeView=this.treeView;inputsNode.imageKey="icon-inputsnode";for(i=0;i<this._wizard.AvailableInputs.length;i++){var inputNode=Design.QuestionSetDesignerFactory.prepareFragmentInputTreeNode(this.treeView,this._wizard.AvailableInputs[i]);inputsNode.addChild(inputNode)}this.treeView.addChild(inputsNode)}for(i=0;i<this._wizard.Pages.length;i++){var page=this._wizard.Pages[i];var n=Design.QuestionSetDesignerFactory.getQuestionSetTreenode(this._filter,this.treeView,page,this._wizard,this.listManager);this.treeView.addChild(n);if(page.Children.length>0){var loading=new Design.TreeNode(this._filter('translate')('Loading'),"placeholder");loading.treeView=this.treeView;n.addChild(loading)}}if(this._wizard.TypeId===Intelledox.Model.ProjectType.Content){if(this._finishPage==null){this._finishPage=new Intelledox.QAWizard.Design.FinishPage(this.wizard,Intelledox.Common.ConstantValues.GUID_EMPTY)}var finishNode=new Design.TreeNode(this._wizard.FinishTitle,this._finishPage);finishNode.treeView=this.treeView;finishNode.imageKey="icon-finishpage";for(i=0;i<this._wizard.Documents.length;i++){var docNode=Design.QuestionSetDesignerFactory.prepareTemplateTreeNode(this.treeView,this._wizard.Documents[i],this._wizard);finishNode.addChild(docNode)}for(i=0;i<this._wizard.Actions.length;i++){this.loadAction(finishNode,this._wizard.Actions[i])}this.treeView.addChild(finishNode)}else if(this._wizard.TypeId===Intelledox.Model.ProjectType.Layout){var finishNode=new Design.TreeNode(this._filter('translate')('Layout'),Intelledox.Common.ConstantValues.LAYOUTNODETAG);finishNode.treeView=this.treeView;finishNode.imageKey="icon-finishpage";for(i=0;i<this._wizard.Documents.length;i++){var docNode=Design.QuestionSetDesignerFactory.prepareTemplateTreeNode(this.treeView,this._wizard.Documents[i],this._wizard);finishNode.addChild(docNode)}this.treeView.addChild(finishNode)}else if(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPage||this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){var outputsNode=new Design.TreeNode(this._filter('translate')('Outputs'),Intelledox.Common.ConstantValues.OUTPUTSNODETAG);outputsNode.treeView=this.treeView;outputsNode.imageKey="icon-outputsnode";for(i=0;i<this._wizard.Documents.length;i++){var docNode=Design.QuestionSetDesignerFactory.prepareTemplateTreeNode(this.treeView,this._wizard.Documents[i],this._wizard);outputsNode.addChild(docNode)}for(i=0;i<this._wizard.AvailableOutputs.length;i++){var outputNode=Design.QuestionSetDesignerFactory.prepareAvailableOutputTreeNode(this.treeView,this._wizard.AvailableOutputs[i]);outputsNode.addChild(outputNode)}this.treeView.addChild(outputsNode)}};EditorViewModel.prototype.loadQuestionSetPage=function(node){if((node.tag instanceof Intelledox.QAWizard.Design.Page)&&node.nodes.length>0&&(typeof node.nodes[0].tag==='string'||node.nodes[0].tag instanceof String)&&node.nodes[0].tag==="placeholder"){node.clear();this.loadQuestionSetLayout(node.tag.Children,node)}};EditorViewModel.prototype.loadQuestionSetLayout=function(layout,parentNode){for(var i=0;i<layout.length;i++){var l=layout[i];if(l!=null){var n=Design.QuestionSetDesignerFactory.getQuestionSetTreenode(this._filter,this.treeView,l,this._wizard,this.listManager);parentNode.addChild(n);if(typeof(l.HasContainerInterface)!=="undefined"){this.loadQuestionSetLayout(l.Children,n)}}}};EditorViewModel.prototype.loadAction=function(currentNode,a){var vm=this;var actionTreeNode=Design.QuestionSetDesignerFactory.prepareActionTreeNode(this._filter,this.treeView,a,this.listManager);currentNode.addChild(actionTreeNode)};EditorViewModel.prototype.getTreeNodeFromQA=function(currentPage,findItem){var currentPageNode;for(var i=0;i<this.treeView.nodes.length;i++){if(this.treeView.nodes[i].tag===currentPage){currentPageNode=this.treeView.nodes[i];break}}if(currentPageNode==null){return null}this.loadQuestionSetPage(currentPageNode);return this.treeView.findNodeByTag(currentPageNode,findItem)};EditorViewModel.prototype.canBeCopied=function(node){return node!=null&&((typeof node.tag.ObjectId!=='undefined'&&(!(node.tag instanceof Intelledox.QAWizard.Design.Page&&(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion||this._wizard.TypeId===Intelledox.Model.ProjectType.Dashboard)))&&(!(node.tag instanceof Intelledox.QAWizard.Design.FinishPage)))||node.tag instanceof Intelledox.Model.ActionOutput)};EditorViewModel.prototype.isFixedNode=function(node){return node==null||node.tag instanceof Intelledox.QAWizard.Design.FinishPage||(typeof node.tag==='string'&&(node.tag===Intelledox.Common.ConstantValues.OUTPUTSNODETAG||node.tag===Intelledox.Common.ConstantValues.LAYOUTNODETAG))||(node.tag instanceof Intelledox.QAWizard.Design.Page&&(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion||this._wizard.TypeId===Intelledox.Model.ProjectType.Dashboard))};EditorViewModel.prototype.canDropExisting=function(dropNode,targetNode,forPaste){if(targetNode!=null&&targetNode.tag instanceof Intelledox.QAWizard.Design.FinishPage){return(dropNode.tag instanceof Intelledox.QAWizard.Design.Action||dropNode.tag instanceof Intelledox.QAWizard.Design.FragmentPage||dropNode.tag instanceof Intelledox.QAWizard.Design.Page)}if(dropNode.tag instanceof Intelledox.QAWizard.Design.FragmentPage||dropNode.tag instanceof Intelledox.QAWizard.Design.Page){if(targetNode==null||targetNode.tag instanceof Intelledox.QAWizard.Design.FragmentPage||targetNode.tag instanceof Intelledox.QAWizard.Design.Page){return true}}else if(targetNode==null){return false}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.Section){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Page||targetNode.tag instanceof Intelledox.QAWizard.Design.Section||targetNode.tag instanceof Intelledox.QAWizard.Design.Column||targetNode.tag instanceof Intelledox.QAWizard.Design.TabPage||targetNode.tag instanceof Intelledox.QAWizard.Design.Question||targetNode.tag instanceof Intelledox.QAWizard.Design.TabGroup){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Page){if(!forPaste&&this.isPageNotLoaded(targetNode)){this.loadQuestionSetPage(targetNode)}}if(forPaste||!dropNode.isDecendantOf(targetNode)){return true}}}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.Column){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Section||targetNode.tag instanceof Intelledox.QAWizard.Design.Column){if(forPaste||!dropNode.isDecendantOf(targetNode)){return true}}}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.TabGroup){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Page){return true}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.TabGroup||targetNode.tag instanceof Intelledox.QAWizard.Design.Column||targetNode.tag instanceof Intelledox.QAWizard.Design.TabPage||targetNode.tag instanceof Intelledox.QAWizard.Design.Question||targetNode.tag instanceof Intelledox.QAWizard.Design.Section){if(forPaste||!dropNode.isDecendantOf(targetNode)){return true}}}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.TabPage){if(targetNode.tag instanceof Intelledox.QAWizard.Design.TabGroup||targetNode.tag instanceof Intelledox.QAWizard.Design.TabPage){if(forPaste||!dropNode.isDecendantOf(targetNode)){return true}}}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.Question){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Page||targetNode.tag instanceof Intelledox.QAWizard.Design.Column||targetNode.tag instanceof Intelledox.QAWizard.Design.TabPage||targetNode.tag instanceof Intelledox.QAWizard.Design.Section||targetNode.tag instanceof Intelledox.QAWizard.Design.TabGroup||targetNode.tag instanceof Intelledox.QAWizard.Design.Question||targetNode.tag instanceof Intelledox.QAWizard.Design.FragmentReference){return true}}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.Answer){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Question){if(targetNode.tag===dropNode.parent.tag){return true}}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){if(targetNode.parent.tag===dropNode.parent.tag){return true}}}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.Placeholder){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Placeholder||targetNode.tag instanceof Intelledox.QAWizard.Design.Answer||targetNode.tag instanceof Intelledox.QAWizard.Design.ContentItem||targetNode.tag instanceof Intelledox.QAWizard.Design.FragmentOutput||(targetNode.tag instanceof Intelledox.QAWizard.Design.FragmentDocument&&!targetNode.tag.IsAttachment)&&Design.HelperFunctions.isPlaceholderNameAllowed(this._wizard,dropNode.tag.Reference,targetNode,dropNode.tag.DocumentGuid,dropNode)){return true}}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.ContentItem){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){var typeId=targetNode.tag.Question.QuestionTypeID;if(typeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary||typeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic){return true}}}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.Action){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Action){if(!dropNode.tag.HasChild(targetNode.tag.ActionGuid)){return true}}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){return true}}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.FragmentReference){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Page||targetNode.tag instanceof Intelledox.QAWizard.Design.Column||targetNode.tag instanceof Intelledox.QAWizard.Design.TabPage||targetNode.tag instanceof Intelledox.QAWizard.Design.Section||targetNode.tag instanceof Intelledox.QAWizard.Design.TabGroup||targetNode.tag instanceof Intelledox.QAWizard.Design.Question){return true}}else if(dropNode.tag instanceof Intelledox.QAWizard.Design.AvailableOutput){if(targetNode.tag===Intelledox.Common.ConstantValues.OUTPUTSNODETAG||targetNode.tag instanceof Intelledox.QAWizard.Design.AvailableOutput){return true}}return false};EditorViewModel.prototype.insertNode=function(newNode,targetNode){if(newNode.tag instanceof Intelledox.QAWizard.Design.FragmentPage||newNode.tag instanceof Intelledox.QAWizard.Design.Page){if(targetNode==null||targetNode.tag instanceof Intelledox.QAWizard.Design.FinishPage||targetNode.tag===Intelledox.Common.ConstantValues.OUTPUTSNODETAG){this._wizard.Pages.push(newNode.tag);if(this.treeView.nodes.length>0&&(this.treeView.nodes[this.treeView.nodes.length-1].tag instanceof Intelledox.QAWizard.Design.FinishPage||this.treeView.nodes[this.treeView.nodes.length-1].tag===Intelledox.Common.ConstantValues.OUTPUTSNODETAG)){this.treeView.insertChild(this.treeView.nodes.length-1,newNode)}else{this.treeView.addChild(newNode)}}else if(targetNode.tag===Intelledox.Common.ConstantValues.INPUTSNODETAG){this._wizard.Pages.splice(0,0,newNode.tag);this.treeView.insertChild(1,newNode)}else{targetNode=targetNode.treeView.findAncestorOrSelf(targetNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Page});var targetPage=targetNode.tag;this._wizard.Pages.splice(this._wizard.Pages.indexOf(targetPage),0,newNode.tag);this.treeView.insertChild(this.treeView.nodes.indexOf(targetNode),newNode)}}else if(newNode.tag instanceof Intelledox.QAWizard.Design.Section||newNode.tag instanceof Intelledox.QAWizard.Design.TabGroup||newNode.tag instanceof Intelledox.QAWizard.Design.FragmentReference){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Question){targetNode.parent.tag.Children.splice(targetNode.parent.tag.Children.indexOf(targetNode.tag),0,newNode.tag);targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode),newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Section||targetNode.tag instanceof Intelledox.QAWizard.Design.TabGroup){targetNode.parent.tag.Children.splice(targetNode.parent.tag.Children.indexOf(targetNode.tag),0,newNode.tag);targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode),newNode)}else if(typeof targetNode.tag.HasContainerInterface!=="undefined"){targetNode.tag.Children.push(newNode.tag);targetNode.addChild(newNode)}}else if(newNode.tag instanceof Intelledox.QAWizard.Design.Column){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Section){targetNode.tag.Columns.push(newNode.tag);targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Column){targetNode.parent.tag.Columns.splice(targetNode.parent.tag.Columns.indexOf(targetNode.tag),0,newNode.tag);targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode),newNode)}}else if(newNode.tag instanceof Intelledox.QAWizard.Design.TabPage){if(targetNode.tag instanceof Intelledox.QAWizard.Design.TabGroup){targetNode.tag.TabPages.push(newNode.tag);targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.TabPage){targetNode.parent.tag.TabPages.splice(targetNode.parent.tag.TabPages.indexOf(targetNode.tag),0,newNode.tag);targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode),newNode)}}else if(newNode.tag instanceof Intelledox.QAWizard.Design.Question){var containerNode;if(targetNode.tag instanceof Intelledox.QAWizard.Design.Question||targetNode.tag instanceof Intelledox.QAWizard.Design.Section||targetNode.tag instanceof Intelledox.QAWizard.Design.TabGroup||targetNode.tag instanceof Intelledox.QAWizard.Design.FragmentReference){containerNode=targetNode.parent.tag;containerNode.Children.splice(containerNode.Children.indexOf(targetNode.tag),0,newNode.tag);targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode),newNode)}else if(typeof targetNode.tag.HasContainerInterface!=="undefined"){containerNode=targetNode.tag;containerNode.Children.push(newNode.tag);targetNode.addChild(newNode)}}else if(newNode.tag instanceof Intelledox.QAWizard.Design.Answer){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Question){targetNode.tag.Answers.push(newNode.tag);targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){var parentQuestion=targetNode.treeView.findAncestorOrSelf(targetNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Question}).tag;parentQuestion.Answers.splice(parentQuestion.Answers.indexOf(targetNode.tag),0,newNode.tag);targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode),newNode)}}else if(newNode.tag instanceof Intelledox.QAWizard.Design.Placeholder){var newPlaceholder=newNode.tag;newPlaceholder.ContentId=Intelledox.Common.ConstantValues.GUID_EMPTY;if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){targetNode.tag.Placeholders.push(newPlaceholder);targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.ContentItem){targetNode.parent.tag.Placeholders.push(newPlaceholder);if(targetNode.tag instanceof Intelledox.QAWizard.Design.ContentItem){newPlaceholder.ContentId=targetNode.tag.ContentInstanceId}targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.FragmentDocument){targetNode.tag.Placeholders.push(newPlaceholder);targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){targetNode.tag.Placeholders.push(newPlaceholder);targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){targetNode.tag.Placeholders.push(newPlaceholder);targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Placeholder){if(targetNode.parent.tag instanceof Intelledox.QAWizard.Design.FragmentDocument){var currentFragment=targetNode.parent.tag;currentFragment.Placeholders.splice(currentFragment.Placeholders.indexOf(targetNode.tag),0,newPlaceholder)}else if(targetNode.parent.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){var currentOutput=targetNode.parent.tag;currentOutput.Placeholders.splice(currentOutput.Placeholders.indexOf(targetNode.tag),0,newPlaceholder)}else if(targetNode.parent.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){var currentTemplate=targetNode.parent.tag;currentTemplate.Placeholders.splice(currentTemplate.Placeholders.indexOf(targetNode.tag),0,newPlaceholder)}else{var currentAnswer=targetNode.treeView.findAncestorOrSelf(targetNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Answer}).tag;currentAnswer.Placeholders.splice(currentAnswer.Placeholders.indexOf(targetNode.tag),0,newPlaceholder);if(targetNode.parent.tag instanceof Intelledox.QAWizard.Design.ContentItem){newPlaceholder.ContentId=targetNode.parent.tag.ContentInstanceId}}targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode),newNode)}}else if(newNode.tag instanceof Intelledox.QAWizard.Design.ContentItem){if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){var contentId=Intelledox.Common.ConstantValues.GUID_EMPTY;if(newNode.tag instanceof Intelledox.QAWizard.Design.ContentItem){contentId=newNode.tag.ContentInstanceId}for(var i=newNode.parent.tag.Placeholders.length-1;i>=0;i--){var copyPlaceholder=newNode.parent.tag.Placeholders[i];if(copyPlaceholder.ContentId===contentId){newNode.parent.tag.Placeholders.splice(i,1);targetNode.tag.Placeholders.push(copyPlaceholder)}}if(newNode.tag instanceof Intelledox.QAWizard.Design.ContentItem){newNode.parent.tag.ContentItems.splice(newNode.parent.tag.ContentItems.indexOf(newNode.tag),1);targetNode.tag.ContentItems.push(newNode.tag)}newNode.parent.nodes.splice(newNode.parent.nodes.indexOf(newNode),1);targetNode.addChild(newNode)}}else if(newNode.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){if(targetNode.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){this._wizard.Documents.splice(this._wizard.Documents.indexOf(targetNode.tag),0,newNode.tag);targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode),newNode)}}else if(newNode.tag instanceof Intelledox.QAWizard.Design.Action){if(targetNode.tag instanceof Intelledox.QAWizard.Design.FinishPage){this._wizard.Actions.push(newNode.tag);targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){var aq=targetNode.tag;aq.Actions.push(newNode.tag);targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Action){var a=targetNode.tag;if(a.IsRepeated&&a.RepeaterGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&confirm(System.String.Format(this._filter('translate')('MsgNestAction'),newNode.text,targetNode.text))){a.Children.push(newNode.tag);targetNode.addChild(newNode)}else{var rootActionNode=targetNode;var foundRoot=false;var isQuestion=false;while(!foundRoot){if(rootActionNode.parent.tag instanceof Intelledox.QAWizard.Design.FinishPage){foundRoot=true}else if(rootActionNode.parent.tag instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){foundRoot=true;isQuestion=true}else{rootActionNode=rootActionNode.parent}}if(isQuestion){rootActionNode.parent.tag.Actions.splice(rootActionNode.parent.tag.Actions.indexOf(rootActionNode.tag),0,newNode.tag)}else{this._wizard.Actions.splice(this._wizard.Actions.indexOf(rootActionNode.tag),0,newNode.tag)}rootActionNode.parent.insertChild(rootActionNode.parent.nodes.indexOf(rootActionNode),newNode)}}}else if(newNode.tag instanceof Intelledox.QAWizard.Design.AvailableOutput){if(targetNode.tag===Intelledox.Common.ConstantValues.OUTPUTSNODETAG){this._wizard.AvailableOutputs.push(newNode.tag);targetNode.addChild(newNode)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.AvailableOutput){this._wizard.AvailableOutputs.splice(this._wizard.AvailableOutputs.indexOf(targetNode.tag),0,newNode.tag);targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode),newNode)}}if(!(newNode.tag instanceof Intelledox.QAWizard.Design.FragmentPage||newNode.tag instanceof Intelledox.QAWizard.Design.Page)){this.addQuestions(this.treeView,newNode,targetNode,false)}this.nodeSelected(newNode);this.wizChanged=true};EditorViewModel.prototype.addQuestions=function(treeview,dropNode,targetNode,isNewNode){var insertBeforeQn;var targetPage;var questions=dropNode.getSelfAndChildTags(function(node){return(node.tag instanceof Intelledox.QAWizard.Design.Question)});if(targetNode.tag instanceof Intelledox.QAWizard.Design.Page&&!(dropNode.tag instanceof Intelledox.QAWizard.Design.Page)){this.AddAllQuestions(questions,targetNode.tag)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Column){targetPage=treeview.findAncestorOrSelf(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Page)}).tag;if(dropNode.tag instanceof Intelledox.QAWizard.Design.Column){insertBeforeQn=this.GetNextQuestionInLayout(targetNode.tag.Children,null,true);if(insertBeforeQn==null){insertBeforeQn=this.GetNextQuestionInLayout(targetPage.Children,targetNode.tag)}}else{insertBeforeQn=this.GetNextQuestionInLayout(targetPage.Children,targetNode.tag)}if(insertBeforeQn==null){this.AddAllQuestions(questions,targetPage)}else{this.InsertAllQuestions(questions,targetPage,targetPage.Questions.indexOf(insertBeforeQn))}}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.TabPage){targetPage=treeview.findAncestorOrSelf(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Page)}).tag;if(dropNode.tag instanceof Intelledox.QAWizard.Design.TabPage){insertBeforeQn=this.GetNextQuestionInLayout(targetNode.tag.Children,null,true);if(insertBeforeQn==null){insertBeforeQn=this.GetNextQuestionInLayout(targetPage.Children,targetNode.tag)}}else{insertBeforeQn=this.GetNextQuestionInLayout(targetPage.Children,targetNode.tag)}if(insertBeforeQn==null){this.AddAllQuestions(questions,targetPage)}else{this.InsertAllQuestions(questions,targetPage,targetPage.Questions.indexOf(insertBeforeQn))}}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Question){targetPage=treeview.findAncestorOrSelf(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Page)}).tag;if(!isNewNode){this.InsertAllQuestions(questions,targetPage,targetPage.Questions.indexOf(targetNode.tag))}else{this.InsertAllQuestions(questions,targetPage,targetPage.Questions.indexOf(targetNode.tag)+1)}}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){targetPage=treeview.findAncestorOrSelf(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Page)}).tag;this.InsertAllQuestions(questions,targetPage,targetPage.Questions.indexOf(targetNode.tag.Question)+1)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Section){targetPage=treeview.findAncestorOrSelf(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Page)}).tag;if(dropNode.tag instanceof Intelledox.QAWizard.Design.Column){insertBeforeQn=this.GetNextQuestionInLayout(targetPage.Children,targetNode.tag)}else{insertBeforeQn=this.GetNextQuestionInLayout(targetNode.tag.Children,null,true);if(insertBeforeQn==null){insertBeforeQn=this.GetNextQuestionInLayout(targetPage.Children,targetNode.tag)}}if(insertBeforeQn==null){this.AddAllQuestions(questions,targetPage)}else{this.InsertAllQuestions(questions,targetPage,targetPage.Questions.indexOf(insertBeforeQn))}}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.TabGroup){targetPage=treeview.findAncestorOrSelf(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Page)}).tag;if(dropNode.tag instanceof Intelledox.QAWizard.Design.TabPage){insertBeforeQn=this.GetNextQuestionInLayout(targetPage.Children,targetNode.tag)}else{insertBeforeQn=this.GetNextQuestionInLayout(targetNode.tag.Children,null,true);if(insertBeforeQn==null){insertBeforeQn=this.GetNextQuestionInLayout(targetPage.Children,targetNode.tag)}}if(insertBeforeQn==null){this.AddAllQuestions(questions,targetPage)}else{this.InsertAllQuestions(questions,targetPage,targetPage.Questions.indexOf(insertBeforeQn))}}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.FragmentReference){targetPage=treeview.findAncestorOrSelf(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Page)}).tag;insertBeforeQn=this.GetNextQuestionInLayout(targetPage.Children,targetNode.tag);if(insertBeforeQn==null){this.AddAllQuestions(questions,targetPage)}else{this.InsertAllQuestions(questions,targetPage,targetPage.Questions.indexOf(insertBeforeQn))}}};EditorViewModel.prototype.AddAllQuestions=function(questions,page){for(var i=0;i<questions.length;i++){questions[i].Page=page;page.Questions.push(questions[i])}};EditorViewModel.prototype.InsertAllQuestions=function(questions,page,index){for(var i=0;i<questions.length;i++){questions[i].Page=page;page.Questions.splice(index+i,0,questions[i])}};EditorViewModel.prototype.GetNextQuestionInLayout=function(layout,startContainer,foundStart){if(foundStart===void 0){foundStart=false}var results={foundStart:foundStart,question:null};this.GetNextQuestionInLayoutRecursive(layout,startContainer,results);return results.question};EditorViewModel.prototype.GetNextQuestionInLayoutRecursive=function(layout,startContainer,results){for(var i=0;i<layout.length;i++){var n=layout[i];if(n instanceof Intelledox.QAWizard.Design.Question){if(results.foundStart){results.question=n;return}}else if(n instanceof Intelledox.QAWizard.Design.FragmentReference&&n===startContainer){results.foundStart=true}else if(typeof(n.HasContainerInterface)!=="undefined"){if(n===startContainer){results.foundStart=true}else{this.GetNextQuestionInLayoutRecursive(n.Children,startContainer,results)}}if(results.question!=null){break}}};EditorViewModel.prototype.createNewPage=function(wizard,targetNode){if(targetNode===void 0){targetNode=null}var newNode;this.incrementLastPageId(wizard);var newPage=new Intelledox.QAWizard.Design.Page(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());newPage.ID=this._lastPageId;newPage.AllowSorting=false;if(wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){newPage.Name=this._filter('translate')('Layout')}else if(wizard.TypeId===Intelledox.Model.ProjectType.Dashboard){newPage.Name=wizard.Name}else{newPage.Name=System.String.Format(this._filter('translate')('NewObjectFormat'),this._filter('translate')('Page'),this._lastPageId.toString())}newNode=Design.QuestionSetDesignerFactory.getQuestionSetTreenode(this._filter,this.treeView,newPage,wizard,this.listManager);targetNode=this.treeView.findAncestorOrSelf(targetNode,function(node){return node.tag instanceof Intelledox.QAWizard.Design.Page});if(targetNode==null||targetNode.tag instanceof Intelledox.QAWizard.Design.FinishPage){wizard.Pages.push(newPage);if(this.isLastNodeFixed(this.treeView)){this.treeView.insertChild(this.treeView.nodes.length-1,newNode)}else{this.treeView.addChild(newNode)}}else{wizard.Pages.splice(wizard.Pages.indexOf(targetNode.tag)+1,0,newPage);this.treeView.insertChild(this.treeView.nodes.indexOf(targetNode)+1,newNode)}this.currentPage=newPage;this.nodeSelected(newNode)};EditorViewModel.prototype.createNewQuestion=function(wizard,targetNode,questionType,configuration,customQuestionTypeID){this.incrementLastQuestionId(wizard);var newQuestion=Intelledox.QAWizard.Design.QuestionFactory.Create(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid(),questionType);newQuestion.ID=this._lastQuestionId;if(questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart){var chartQuestion=newQuestion;chartQuestion.Chart=new Intelledox.QAWizard.Design.ChartProperties;chartQuestion.Chart.Series.push(new Intelledox.QAWizard.Design.Series);chartQuestion.Chart.Series[0].Name=this._filter('translate')('Series');chartQuestion.Chart.Legend=new Intelledox.QAWizard.Design.Legend;chartQuestion.Chart.ChartArea=new Intelledox.QAWizard.Design.ChartArea;chartQuestion.Chart.AxisX=new Intelledox.QAWizard.Design.Axis;chartQuestion.Chart.AxisY=new Intelledox.QAWizard.Design.Axis}else if(questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom){newQuestion.CustomQuestionTypeId=customQuestionTypeID}else if(questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label){newQuestion.DefaultValue=this._filter('translate')('Label')}else if(questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary){if(configuration==='upload'){newQuestion.Visibility=true;newQuestion.DisplayType=Intelledox.Model.QuestionDisplayType.Upload;newQuestion.ContentTypeRestriction=Intelledox.Model.ContentType.Attachment}else{newQuestion.AllowEdit=true}}else if(questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button||questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary||questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton){newQuestion.TextPosition=Intelledox.QAWizard.Design.TextPosition.None}if(questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator){newQuestion.Text=this._filter('translate')('ErrorOnPage')}else{newQuestion.Text=System.String.Format(this._filter('translate')('NewObjectFormat'),this._filter('translate')('Question'),this._lastQuestionId.toString())}var addToNode=targetNode;var insertionIndex=0;if(targetNode.tag instanceof Intelledox.QAWizard.Design.Page){if(this.isPageNotLoaded(targetNode)){this.loadQuestionSetPage(targetNode)}targetNode.tag.Children.push(newQuestion)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Column){targetNode.tag.Children.push(newQuestion)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.TabPage){targetNode.tag.Children.push(newQuestion)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){var parent=targetNode.parent.parent.tag;insertionIndex=parent.Children.indexOf(targetNode.tag.Question)+1;parent.Children.splice(insertionIndex,0,newQuestion);addToNode=targetNode.parent.parent}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Placeholder||targetNode.tag instanceof Intelledox.QAWizard.Design.ResponseMetadataField){var nodePath=this.treeView.getAncestorsAndSelfUntil(targetNode,function(parentNode){return(typeof(parentNode.tag.HasQAContainerInterface)!=="undefined")});var targetNode=nodePath[nodePath.length-2];var parent=targetNode.parent.tag;if(parent instanceof Intelledox.QAWizard.Design.FragmentPage){return}else{insertionIndex=parent.Children.indexOf(targetNode.tag)+1;parent.Children.splice(insertionIndex,0,newQuestion);addToNode=targetNode.parent}}else{var parentNodes=this.treeView.getAncestorsAndSelfUntil(targetNode,function(parentNode){return(typeof(parentNode.tag.HasQAContainerInterface)!=="undefined")});addToNode=parentNodes[parentNodes.length-1];if(parentNodes.length===1){parentNodes[0].tag.Children.push(newQuestion)}else{insertionIndex=parentNodes[parentNodes.length-1].tag.Children.indexOf(parentNodes[parentNodes.length-2].tag)+1;parentNodes[parentNodes.length-1].tag.Children.splice(insertionIndex,0,newQuestion)}}this.wizChanged=true;var qNode=Design.QuestionSetDesignerFactory.getQuestionSetTreenode(this._filter,this.treeView,newQuestion,wizard,this.listManager);if(insertionIndex===0){addToNode.addChild(qNode)}else{addToNode.insertChild(insertionIndex,qNode)}newQuestion.Page=addToNode.treeView.findAncestorOrSelf(addToNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Page}).tag;this.addQuestions(this.treeView,qNode,targetNode,true);if(newQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation){var aNode=this.createNewAnswer(wizard,qNode,false);newQuestion.Answers[0].Name=this._filter('translate')('Latitude');newQuestion.Answers[0].DataField='latitude';aNode.text=newQuestion.Answers[0].Name;aNode=this.createNewAnswer(wizard,qNode,false);newQuestion.Answers[1].Name=this._filter('translate')('Longitude');newQuestion.Answers[1].DataField='longitude';aNode.text=newQuestion.Answers[1].Name}else if(newQuestion.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic&&newQuestion.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&newQuestion.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton){this.createNewAnswer(wizard,qNode,false);if(questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button){if(newQuestion.Answers.length>0){newQuestion.Answers[0].SaveToAnswerFileBy=Intelledox.QAWizard.Design.SaveAnswerByEnum.SaveById}}}this.nodeSelected(qNode,true);qNode.expand();if(newQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic){var vm=this;var modalInstance=this._modal.open({templateUrl:'Views/Modal/multiChoiceAnswers.html?v=106882799234227327',controller:['$scope','$modalInstance','$filter',Design.MultiChoiceAnswersModalCtrl],backdrop:'static'});modalInstance.result.then(function(result){for(var i=0;i<result.length;i++){if(!System.String.IsNullOrWhiteSpace(result[i])){var aNode=vm.createNewAnswer(wizard,qNode,false);aNode.tag.Name=result[i];aNode.tag.DisplayText=result[i];aNode.text=result[i]}}if(!qNode.hasChildren){vm.createNewAnswer(wizard,qNode,false)}})}};EditorViewModel.prototype.createNewLayout=function(wizard,layoutType,targetNode,ensureVisible,layoutId){if(layoutId===void 0){layoutId=''}var nodePath=null;var insertIndex=0;if(layoutType==="page"){this.createNewPage(wizard,targetNode)}else{var parentNode=null;var newQAItem=null;switch(layoutType){case"tabgroup":newQAItem=new Intelledox.QAWizard.Design.TabGroup;nodePath=this.treeView.getAncestorsAndSelfUntil(targetNode,function(parentNode){return(typeof(parentNode.tag.HasQAContainerInterface)!=="undefined")});parentNode=this.treeView.findAncestorOrSelf(targetNode,function(parentNode){return(typeof(parentNode.tag.HasQAContainerInterface)!=="undefined")});break;case"tabpage":newQAItem=new Intelledox.QAWizard.Design.TabPage;if(ensureVisible){newQAItem.Title=this._filter('translate')('TabPage')}nodePath=this.treeView.getAncestorsAndSelfUntil(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.TabGroup)});parentNode=this.treeView.findAncestorOrSelf(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.TabGroup)});break;case"section":newQAItem=new Intelledox.QAWizard.Design.Section;newQAItem.DisplayImportOptions=false;newQAItem.AllowSorting=false;if(ensureVisible){newQAItem.Title=this._filter('translate')('Section')}nodePath=this.treeView.getAncestorsAndSelfUntil(targetNode,function(parentNode){return(typeof(parentNode.tag.HasQAContainerInterface)!=="undefined")});parentNode=this.treeView.findAncestorOrSelf(targetNode,function(parentNode){return(typeof(parentNode.tag.HasQAContainerInterface)!=="undefined")});break;case"column":newQAItem=new Intelledox.QAWizard.Design.Column;if(ensureVisible){newQAItem.Title=this._filter('translate')('Column')}nodePath=this.treeView.getAncestorsAndSelfUntil(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Section)});parentNode=this.treeView.findAncestorOrSelf(targetNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Section)});break;case"fragmentinput":this.addAvailableInput(targetNode,true,true);this.wizChanged=true;return;case"fragmentoutput":this.addAvailableOutput(targetNode,true,true);this.wizChanged=true;return;case"fragment":var project;for(var i=0;i<this._flyoutFragments.availableFragments.length;i++){if(this._flyoutFragments.availableFragments[i].projectGuid===layoutId){project=this._flyoutFragments.availableFragments[i];break}}if(project.projectTypeId===Intelledox.Model.ProjectType.FragmentPage){var newFragItem=new Intelledox.QAWizard.Design.FragmentPage(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());newFragItem.ProjectGuid=project.projectGuid;newFragItem.Name=project.name;newQAItem=newFragItem;if(targetNode!==null){nodePath=this.treeView.getAncestorsAndSelfUntil(targetNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Page||parentNode.tag instanceof Intelledox.QAWizard.Design.FinishPage});parentNode=this.treeView.findAncestorOrSelf(targetNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Page||parentNode.tag instanceof Intelledox.QAWizard.Design.FinishPage})}}else{var newFragRefItem=new Intelledox.QAWizard.Design.FragmentReference;newFragRefItem.ProjectGuid=project.projectGuid;newFragRefItem.Name=project.name;newFragRefItem.FragmentGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();newQAItem=newFragRefItem;nodePath=this.treeView.getAncestorsAndSelfUntil(targetNode,function(parentNode){return(typeof(parentNode.tag.HasQAContainerInterface)!=="undefined")});parentNode=this.treeView.findAncestorOrSelf(targetNode,function(parentNode){return(typeof(parentNode.tag.HasQAContainerInterface)!=="undefined")})}var nameCounter=2;while(!this.wizard.IsUniqueFragmentName(newQAItem.Name,Intelledox.Common.ConstantValues.GUID_EMPTY)){newQAItem.Name=project.name+" "+nameCounter.toString();nameCounter+=1}break}var newNode=Design.QuestionSetDesignerFactory.getQuestionSetTreenode(this._filter,this.treeView,newQAItem,wizard,this.listManager);if(newQAItem instanceof Intelledox.QAWizard.Design.FragmentPage){if(parentNode==null||parentNode.tag instanceof Intelledox.QAWizard.Design.FinishPage){wizard.Pages.push(newQAItem);if(this.isLastNodeFixed(this.treeView)){this.treeView.insertChild(this.treeView.nodes.length-1,newNode)}else{this.treeView.addChild(newNode)}}else{wizard.Pages.splice(wizard.Pages.indexOf(parentNode.tag)+1,0,newQAItem);this.treeView.insertChild(this.treeView.nodes.indexOf(nodePath[nodePath.length-1])+1,newNode)}}else{if(parentNode==null){return}if(nodePath.length>1){insertIndex=nodePath[nodePath.length-1].nodes.indexOf(nodePath[nodePath.length-2])+1}else{insertIndex=parentNode.nodes.length}if(parentNode.tag instanceof Intelledox.QAWizard.Design.TabGroup){parentNode.tag.TabPages.splice(insertIndex,0,newQAItem)}else if(parentNode.tag instanceof Intelledox.QAWizard.Design.Section){parentNode.tag.Columns.splice(insertIndex,0,newQAItem)}else{parentNode.tag.Children.splice(insertIndex,0,newQAItem)}parentNode.insertChild(insertIndex,newNode)}switch(layoutType){case"tabgroup":this.createNewLayout(wizard,'tabpage',newNode,ensureVisible);break;case"section":this.createNewLayout(wizard,'column',newNode,ensureVisible);break}this.nodeSelected(newNode)}this.wizChanged=true};EditorViewModel.prototype.createNewAnswer=function(wizard,targetNode,autoSelect){this.incrementLastAnswerId(wizard);var q;var n=null;if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){q=targetNode.tag.Question}else{q=targetNode.tag}var a=Intelledox.QAWizard.Design.AnswerFactory.Create(q.QuestionTypeID);a.ID=this._lastAnswerId;a.AnswerGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();a.Question=q;if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){q.Answers.splice(q.Answers.indexOf(targetNode.tag)+1,0,a)}else{q.Answers.push(a)}a.Name=System.String.Format(this._filter('translate')('NewObjectFormat'),this._filter('translate')('Answer'),this._lastAnswerId.toString());this.setAnswerFileProperties(a);if(q.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator&&q.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary){n=Design.QuestionSetDesignerFactory.prepareAnswerTreeNode(this.treeView,a);if(targetNode.tag instanceof Intelledox.QAWizard.Design.Question){targetNode.addChild(n)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.Answer){targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode)+1,n)}if(autoSelect){this.nodeSelected(n)}}this.wizChanged=true;return n};EditorViewModel.prototype.createBuiltInTemplate=function(targetNode,templateFormatType,autoSelect){var vm=this;var doc=new Intelledox.QAWizard.Design.DocumentTemplate;doc.DocumentGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();doc.FormatType=templateFormatType;doc.Name=this.getBuiltInTemplateName(templateFormatType);doc.FileName="";doc.AllowNameChange=true;doc.Colour=null;doc.Conditions=new Intelledox.QAWizard.Design.Condition;var n=Design.QuestionSetDesignerFactory.prepareTemplateTreeNode(this.treeView,doc,this._wizard);this.insertTemplateTreeNode(targetNode,n,true);this.wizChanged=true};EditorViewModel.prototype.insertTemplateTreeNode=function(targetNode,templateTreeNode,autoSelect){if(targetNode!=null&&targetNode.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){this._wizard.Documents.splice(this._wizard.Documents.indexOf(targetNode.tag),0,templateTreeNode.tag);targetNode.parent.insertChild(targetNode.parent.nodes.indexOf(targetNode),templateTreeNode)}else if(this._wizard.Documents.length==0){this._wizard.Documents.push(templateTreeNode.tag);this.treeView.nodes[this.treeView.nodes.length-1].insertChild(0,templateTreeNode)}else{var lastDoc=this._wizard.Documents[this._wizard.Documents.length-1];this._wizard.Documents.push(templateTreeNode.tag);var finishNode=this.treeView.nodes[this.treeView.nodes.length-1];for(var i=0;i<finishNode.nodes.length;i++){var node=finishNode.nodes[i];if(node.tag===lastDoc){finishNode.insertChild(i+1,templateTreeNode);break}}}if(autoSelect){this.nodeSelected(templateTreeNode)}};EditorViewModel.prototype.getBuiltInTemplateName=function(templateFormatType){if(templateFormatType===Intelledox.Model.TemplateFormatType.ProjectResults){return this._filter('translate')('ProjectResults')}else{return Intelledox.Model.TemplateFormatType[templateFormatType]}};EditorViewModel.prototype.createNewTemplate=function(targetNode,extensionSuggestion){var vm=this;var modalInstance=this._modal.open({templateUrl:'Views/Modal/selectTemplate.html?v=106882799234227327',controller:['$scope','$modalInstance','$filter','extensionSuggestion',Design.SelectTemplateModalCtrl],backdrop:'static',resolve:{extensionSuggestion:function(){return extensionSuggestion}}});modalInstance.result.then(function(result){vm.processNewTemplate(result,Intelledox.QAWizard.Design.GeneralFunctions.NewGuid(),targetNode,true)})};EditorViewModel.prototype.processNewTemplate=function(result,newDocGuid,targetNode,autoSelect){var vm=this;var doc=new Intelledox.QAWizard.Design.DocumentTemplate;doc.DocumentGuid=newDocGuid;doc.FormatType=result.formatType;doc.Name=result.filename;doc.FileName="";doc.AllowNameChange=true;doc.Colour=this.getFreeColours()[0];doc.Conditions=new Intelledox.QAWizard.Design.Condition;var n=Design.QuestionSetDesignerFactory.prepareTemplateTreeNode(this.treeView,doc,this._wizard);var docBin=new Intelledox.Model.DocumentBinary;docBin.documentGuid=doc.DocumentGuid;docBin.formatType=result.formatType;docBin.templateEditGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();this.templateBinaries.push(docBin);this.insertTemplateTreeNode(targetNode,n,autoSelect);this.wizChanged=true;this.flyoutPlaceholders.addDocument(doc);this.documentInterface.updatePlaceholders(doc.DocumentGuid,doc.FormatType,result.binary,docBin.templateEditGuid).then(function(){vm.flyoutPlaceholders.resetState(vm.documentInterface.getBookmarkDictionary())})};EditorViewModel.prototype.createNewAction=function(wizard,targetNode,routingTypeId){var newAction=new Intelledox.QAWizard.Design.Action;var selectedActionType;for(var i=0;i<this._flyoutActions.availableActions.length;i++){if(this._flyoutActions.availableActions[i].routingTypeId===routingTypeId){selectedActionType=this._flyoutActions.availableActions[i];break}}newAction.Type=selectedActionType;switch(selectedActionType.usesDocuments){case Intelledox.Model.DocumentUsage.Sometimes:case Intelledox.Model.DocumentUsage.Never:newAction.HasCustomDocuments=true;break}var actionName=this.listManager.nameToTranslation(selectedActionType.description);newAction.Name=this.uniqueActionName(wizard,actionName);var n=Design.QuestionSetDesignerFactory.prepareActionTreeNode(this._filter,this.treeView,newAction,this.listManager);var targetActionNode=this.treeView.findAncestorOrSelf(targetNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Action});var runActionButtonQuestion=this.treeView.findAncestorOrSelf(targetNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion});if(runActionButtonQuestion!=null){if(!selectedActionType.supportsRun){alert(System.String.Format(this._filter('translate')('ErrorMsg_ActionDoesntSupportButton'),actionName));return}}if(targetNode!=null&&targetNode.tag instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){targetNode.tag.Actions.push(newAction);targetNode.addChild(n)}else if(targetActionNode==null){if(wizard.TypeId===Intelledox.Model.ProjectType.Content||wizard.TypeId===Intelledox.Model.ProjectType.Layout){wizard.Actions.push(newAction);this.treeView.nodes[this.treeView.nodes.length-1].addChild(n)}else{return}}else{var targetAction=targetActionNode.tag;if(targetAction.IsRepeated&&targetAction.RepeaterGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&confirm(System.String.Format(this._filter('translate')('MsgNestAction'),newAction.Name,targetAction.Name))){targetAction.Children.push(newAction);targetActionNode.addChild(n)}else{if(runActionButtonQuestion!==null){runActionButtonQuestion.tag.Actions.splice(runActionButtonQuestion.tag.Actions.indexOf(targetAction),0,newAction);runActionButtonQuestion.insertChild(runActionButtonQuestion.nodes.indexOf(targetActionNode),n)}else{var targetList=this.treeView.getAncestorsAndSelfUntil(targetNode,function(parentNode){return false});var referenceNode=targetList[targetList.length-2].tag;var targetIndex=wizard.Actions.indexOf(referenceNode.tag)+1;wizard.Actions.splice(targetIndex,0,newAction);targetIndex=this.treeView.nodes[this.treeView.nodes.length-1].nodes.indexOf(referenceNode)+1;this.treeView.nodes[this.treeView.nodes.length-1].insertChild(targetIndex,n)}}}this.wizChanged=true;this.nodeSelected(n)};EditorViewModel.prototype.nestedChildActions=function(action){var ret=[];for(var i=0;i<action.Children.length;i++){ret.push(action.Children[i]);if(action.Children[i].Children.length>0){var actions=this.nestedChildActions(action.Children[i]);for(var j=0;j<actions.length;j++){ret.push(actions[j])}}}return ret};EditorViewModel.prototype.uniqueActionName=function(wizard,actionName){var foundMatch=false;var actionCounter=2;var uniqueName=actionName;var allActionsinQuestions=[];allActionsinQuestions=wizard.getAllActionQuestionActions();do{foundMatch=false;for(var i=0;i<wizard.Actions.length;i++){if(wizard.Actions[i].Name===uniqueName){uniqueName=actionName+" "+actionCounter.toString();foundMatch=true;actionCounter+=1;break}}if(!foundMatch){for(var j=0;j<allActionsinQuestions.length;j++){if(allActionsinQuestions[j].Name===uniqueName){uniqueName=actionName+" "+actionCounter.toString();foundMatch=true;actionCounter+=1;break}}if(!foundMatch){var fullList=this._wizard.Workflow.FullStateList;for(var i=0;i<fullList.length;i++){var state=fullList[i];for(var tranIndex=0;tranIndex<state.Transitions.length;tranIndex++){var transition=state.Transitions[tranIndex];for(var actionIndex=0;actionIndex<transition.Actions.length;actionIndex++){if(transition.Actions[actionIndex].Name===uniqueName){uniqueName=actionName+" "+actionCounter.toString();foundMatch=true;actionCounter+=1;break}}}}}}}while(foundMatch);return uniqueName};EditorViewModel.findActionName=function(wizard,actionName){for(var i=0;i<wizard.Actions.length;i++){if(wizard.Actions[i].Name.toUpperCase()===actionName.toUpperCase()){return true}if(wizard.Actions[i].Children.length>0){var result=Intelledox.Design.EditorViewModel.findActionChildrenName(wizard.Actions[i],actionName);if(result){return result}}}var allActionsinQuestions=wizard.getAllActionQuestionActions();for(var i=0;i<allActionsinQuestions.length;i++){if(allActionsinQuestions[i].Name===actionName){return true}}var fullList=wizard.Workflow.FullStateList;for(var i=0;i<fullList.length;i++){var state=fullList[i];for(var tranIndex=0;tranIndex<state.Transitions.length;tranIndex++){var transition=state.Transitions[tranIndex];if(transition.Actions.length>0){for(var actionIndex=0;actionIndex<transition.Actions.length;actionIndex++){if(transition.Actions[actionIndex].Name.toUpperCase()===actionName.toUpperCase()){return true}}if(transition.Actions[i].Children.length>0){var result=Intelledox.Design.EditorViewModel.findActionChildrenName(transition.Actions[i],actionName);if(result){return result}}}}}return false};EditorViewModel.findActionChildrenName=function(action,actionName){var ret=false;for(var i=0;i<action.Children.length;i++){if(action.Children[i].Name.toUpperCase()===actionName.toUpperCase()){ret=true;break}if(action.Children[i].Children.length>0){ret=Intelledox.Design.EditorViewModel.findActionChildrenName(action.Children[i],actionName);if(ret){break}}}return ret};EditorViewModel.prototype.createNewContentItem=function(wizard,targetNode,contentItemGuid){var ans=targetNode.treeView.findAncestorOrSelf(targetNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Answer}).tag;var selectedContentItem;for(var i=0;i<this._flyoutContentItems.availableContentItems.length;i++){if(this._flyoutContentItems.availableContentItems[i].contentItem.contentItemGuid===contentItemGuid){selectedContentItem=this._flyoutContentItems.availableContentItems[i];break}}var newContent=ans.AddContent(selectedContentItem.contentItem);if(newContent!=null){this.wizChanged=true;var newNode=new Design.TreeNode(selectedContentItem.contentItem.name,newContent);targetNode.addChild(newNode);newNode.imageKey=selectedContentItem.imageKey.replace('li-','icon-');this.nodeSelected(newNode);this.flyoutPlaceholders.addContentItemReference(newContent)}};EditorViewModel.prototype.setAnswerFileProperties=function(answer){switch(answer.Question.QuestionTypeID){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RichText:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Ink:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric:answer.SaveToAnswerFileBy=Intelledox.QAWizard.Design.SaveAnswerByEnum.SaveById;answer.SaveToAnswerFileLabel="";break;default:answer.SaveToAnswerFileBy=Intelledox.QAWizard.Design.SaveAnswerByEnum.None;answer.SaveToAnswerFileLabel="";break}};EditorViewModel.prototype.incrementLastPageId=function(wizard){if(this._lastPageId===0){this._lastPageId=1;for(var i=0;i<wizard.Pages.length;i++){var pg=wizard.Pages[i];if(pg.ID>=this._lastPageId){this._lastPageId=pg.ID+1}}}else{this._lastPageId+=1}};EditorViewModel.prototype.incrementLastQuestionId=function(wizard){if(this._lastQuestionId===0){this._lastQuestionId=1;for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pg=wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<pg.Questions.length;questionIndex++){var qn=pg.Questions[questionIndex];if(qn.ID>=this._lastQuestionId){this._lastQuestionId=qn.ID+1}}}}else{this._lastQuestionId+=1}};EditorViewModel.prototype.incrementLastAnswerId=function(wizard){if(this._lastAnswerId===0){for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pg=wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<pg.Questions.length;questionIndex++){var qn=pg.Questions[questionIndex];for(var answerIndex=0;answerIndex<qn.Answers.length;answerIndex++){var an=qn.Answers[answerIndex];if(an.ID>=this._lastAnswerId){this._lastAnswerId=an.ID+1}}}}if(this._lastAnswerId===0){this._lastAnswerId=1}}else{this._lastAnswerId+=1}};EditorViewModel.prototype.activatePanel=function(code){switch(code){case'dataFilters':this.dataFiltersPanelModel.activate();break;case'sorting':this.sortPanelModel.activate();break;case'displayFields':this.displayFieldsPanelModel.activate();break}this.panelCode=code;this.hideFlyout()};EditorViewModel.prototype.hideFlyout=function(){var panel=$('#panel-flyout');if(panel.hasClass("visible")){panel.removeClass('visible').css({right:'-250px'}).hide()}};EditorViewModel.prototype.activateFlyout=function(code){var panel=$('#panel-flyout');if(this.flyoutPanelCode===code&&panel.hasClass("visible")){panel.removeClass('visible').animate({right:'-250px'},300,function(){panel.hide()});return}if(code==='placeholders'){this.flyoutPanel=this.flyoutPlaceholders}else if(code==='actions'){if(this._flyoutActions==null){this._flyoutActions=new Design.ActionsFlyout(this.listManager,this._filter)}this._flyoutActions.forWorkflow=this.isWorkflowPage;this.flyoutPanel=this._flyoutActions}else if(code==='projectFragments'){if(this._flyoutFragments==null){this._flyoutFragments=new Design.FragmentsFlyout(this._designApi,this.wizard.ProjectGuid,(this.wizard.TypeId!==Intelledox.Model.ProjectType.FragmentPortion&&this.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard))}this.flyoutPanel=this._flyoutFragments}else if(code==='contentItems'){if(this._flyoutContentItems==null){this._flyoutContentItems=new Design.ContentLibraryFlyout(this.listManager)}this.flyoutPanel=this._flyoutContentItems}else if(code==='escalations'){if(this._flyoutEscalations==null){this._flyoutEscalations=new Design.EscalationsFlyout(this.listManager)}this.flyoutPanel=this._flyoutEscalations}this.flyoutPanelCode=code;if(panel.hasClass("visible")){panel.animate({right:'-250px'},300,function(){panel.animate({right:'50px'},300)})}else{panel.show().addClass('visible').animate({right:'50px'},300)}};EditorViewModel.prototype.loadToolbox=function(){var vm=this;vm.listManager.licensedCustomQuestionTypes().then(function(customQuestions){var allQuestions=[];if(vm.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard){if(vm._isContactsAvailable){allQuestions.push({name:vm._filter('translate')('Address'),id:'toolbox_question.1',imageKey:'tool-addressprompt',group:'|question|all|'})}allQuestions.push({name:vm._filter('translate')('AutoLogic'),id:'toolbox_question.16',imageKey:'tool-autologic',group:'|question|all|'});allQuestions.push({name:vm._filter('translate')('Barcode'),id:'toolbox_question.18',imageKey:'tool-barcode',group:'|question|all|'});allQuestions.push({name:vm._filter('translate')('Chart'),id:'toolbox_question.17',imageKey:'tool-chart',group:'|question|all|'});allQuestions.push({name:vm._filter('translate')('FileSelection'),id:'toolbox_question.11.upload',imageKey:'tool-fileselection',group:'|question|all|'});allQuestions.push({name:vm._filter('translate')('Geolocation'),id:'toolbox_question.23',imageKey:'tool-geolocation',group:'|question|all|'});allQuestions.push({name:vm._filter('translate')('Ink'),id:'toolbox_question.20',imageKey:'tool-ink',group:'|question|all|'});allQuestions.push({name:vm._filter('translate')('RichText'),id:'toolbox_question.19',imageKey:'tool-richtext',group:'|question|all|'});if(vm._isSummaryAvailable){allQuestions.push({name:vm._filter('translate')('Summary'),id:'toolbox_question.26',imageKey:'tool-summary',group:'|question|all|'})}allQuestions.push({name:vm._filter('translate')('Validator'),id:'toolbox_question.21',imageKey:'tool-validator',group:'|question|all|'})}allQuestions.push({name:vm._filter('translate')('Datasource'),id:'toolbox_question.14',imageKey:'tool-datasource',group:'|question|common|all|'});if(vm._isContentLibraryAvailable){allQuestions.push({name:vm._filter('translate')('ContentLibrary'),id:'toolbox_question.11',imageKey:'tool-contentlibrary',group:'|question|all|'})}allQuestions.push({name:vm._filter('translate')('GroupLogic'),id:'toolbox_question.3',imageKey:'tool-grouplogic',group:'|question|common|all|'});allQuestions.push({name:vm._filter('translate')('Label'),id:'toolbox_question.15',imageKey:'tool-label',group:'|question|common|all|'});allQuestions.push({name:vm._filter('translate')('Numeric'),id:'toolbox_question.24',imageKey:'tool-numeric',group:'|question|all|'});allQuestions.push({name:vm._filter('translate')('Button'),id:'toolbox_question.25',imageKey:'tool-button',group:'|question|all|'});allQuestions.push({name:vm._filter('translate')('UserPrompt'),id:'toolbox_question.7',imageKey:'tool-userprompt',group:'|question|common|all|'});allQuestions.push({name:vm._filter('translate')('Variable'),id:'toolbox_question.8',imageKey:'tool-variable',group:'|question|common|all|'});if(vm._isRunActionButtonAvailable){allQuestions.push({name:vm._filter('translate')('RunActionButton'),id:'toolbox_question.27',imageKey:'tool-runactionbutton',group:'|question|all|'})}for(var i=0;i<customQuestions.length;i++){allQuestions.push({name:customQuestions[i].description,id:'toolbox_custom.'+customQuestions[i].customQuestionTypeId,imageKey:'',style:{'background-image':'url('+Intelledox.Common.ConstantValues.DATA_URI_PREFIX+customQuestions[i].icon48+')','background-size':'48px 48px'},group:'|question|all|'})}allQuestions.sort(function(a,b){if(a.name>b.name){return 1}if(a.name<b.name){return-1}return 0});vm.toolboxItems=[];if(vm.wizard.TypeId!==Intelledox.Model.ProjectType.FragmentPortion&&vm.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard){vm.toolboxItems.push({name:vm._filter('translate')('Page'),id:'toolbox_layout.page',imageKey:'tool-page',group:'|layout|common|all|'})}vm.toolboxItems.push({name:vm._filter('translate')('Section'),id:'toolbox_layout.section',imageKey:'tool-section',group:'|layout|common|all|'});vm.toolboxItems.push({name:vm._filter('translate')('Column'),id:'toolbox_layout.column',imageKey:'tool-column',group:'|layout|common|all|'});vm.toolboxItems.push({name:vm._filter('translate')('TabGroup'),id:'toolbox_layout.tabgroup',imageKey:'tool-tabgroup',group:'|layout|all|'});vm.toolboxItems.push({name:vm._filter('translate')('TabPage'),id:'toolbox_layout.tabpage',imageKey:'tool-tabpage',group:'|layout|all|'});vm.toolboxItems.push.apply(vm.toolboxItems,allQuestions);vm.toolboxItems.push({name:vm._filter('translate')('Answer'),id:'toolbox_misc.answer',imageKey:'tool-answer',group:'|question|common|all|'});if(vm.wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion||vm.wizard.TypeId===Intelledox.Model.ProjectType.FragmentPage){vm.toolboxItems.push({name:vm._filter('translate')('Input'),id:'toolbox_layout.fragmentinput',imageKey:'tool-fragment-input',group:'|common|all|'});vm.toolboxItems.push({name:vm._filter('translate')('Output'),id:'toolbox_layout.fragmentoutput',imageKey:'tool-fragment-output',group:'|common|all|'})}if(vm.wizard.TypeId!==Intelledox.Model.ProjectType.Layout&&vm.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard){vm.toolboxItems.push({name:vm._filter('translate')('Word'),id:'toolbox_misc.templateword',imageKey:'tool-word',group:'|template|all|'});vm.toolboxItems.push({name:vm._filter('translate')('Excel'),id:'toolbox_misc.templateexcel',imageKey:'tool-excel',group:'|template|all|'});vm.toolboxItems.push({name:vm._filter('translate')('Powerpoint'),id:'toolbox_misc.templatepowerpoint',imageKey:'tool-powerpoint',group:'|template|all|'});vm.toolboxItems.push({name:vm._filter('translate')('Pdf'),id:'toolbox_misc.templatepdf',imageKey:'tool-pdf',group:'|template|all|'});vm.toolboxItems.push({name:vm._filter('translate')('Json'),id:'toolbox_misc.templatejson',imageKey:'tool-json',group:'|template|all|'});vm.toolboxItems.push({name:vm._filter('translate')('Xsd'),id:'toolbox_misc.templatexsd',imageKey:'tool-xsd',group:'|template|all|'});vm.toolboxItems.push({name:vm._filter('translate')('Csv'),id:'toolbox_misc.templatecsv',imageKey:'tool-csv',group:'|template|all|'});vm.toolboxItems.push({name:vm._filter('translate')('Txt'),id:'toolbox_misc.templatetxt',imageKey:'tool-txt',group:'|template|all|'});vm.toolboxItems.push({name:vm._filter('translate')('Html'),id:'toolbox_misc.templatehtml',imageKey:'tool-html',group:'|template|all|'});if(vm._isAnalyticsAvailable){vm.toolboxItems.push({name:vm._filter('translate')('ProjectResults'),id:'toolbox_misc.projectresults',imageKey:'tool-projectresults',group:'|template|all|'})}}vm.workflowToolboxItems=[];vm.workflowToolboxItems.push({name:vm._filter('translate')('State'),id:'toolbox_workflow.state',imageKey:'tool-workflow-state'});vm.workflowToolboxItems.push({name:vm._filter('translate')('Transition'),id:'toolbox_workflow.transition',imageKey:'tool-workflow-transition'});vm.workflowToolboxItems.push({name:vm._filter('translate')('ParallelSection'),id:'toolbox_workflow.parallel',imageKey:'tool-workflow-parallel'})})};EditorViewModel.prototype.toolboxFilter=function(query){return function(item){return item.group.indexOf(query)>-1}};EditorViewModel.prototype.addAvailableInput=function(targetNode,autoSelect,editTextMode){var newInput=new Intelledox.QAWizard.Design.AvailableInput;newInput.description=this._filter('translate')('Input');newInput.routingElementTypeId=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();newInput.routingTypeId=newInput.routingElementTypeId;var inputCounter=2;var foundMatch;do{foundMatch=false;for(var i=0;i<this.wizard.AvailableInputs.length;i++){if(this.wizard.AvailableInputs[i].description===newInput.description){newInput.description=this._filter('translate')('Input')+" "+inputCounter.toString();inputCounter+=1;foundMatch=true;break}}}while(foundMatch);var n=Design.QuestionSetDesignerFactory.prepareFragmentInputTreeNode(this.treeView,newInput);if(targetNode.tag instanceof Intelledox.QAWizard.Design.AvailableInput){this._wizard.AvailableInputs.splice(this._wizard.AvailableInputs.indexOf(targetNode.tag)+1,0,newInput);targetNode.parent.insertChild(this._wizard.AvailableInputs.indexOf(targetNode.tag)+1,n)}else{this._wizard.AvailableInputs.push(newInput);targetNode.addChild(n)}if(autoSelect){this.nodeSelected(n)}this.wizChanged=true};EditorViewModel.prototype.addAvailableOutput=function(targetNode,autoSelect,editTextMode){var newOutput=new Intelledox.QAWizard.Design.AvailableOutput;newOutput.RoutingOptionGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();newOutput.Name=this._filter('translate')('Output');newOutput.SourceType=Intelledox.Model.RoutingSourceType.AnswerValue;var outputCounter=2;var foundMatch;do{foundMatch=false;for(var i=0;i<this.wizard.AvailableOutputs.length;i++){if(this.wizard.AvailableOutputs[i].Name===newOutput.Name){newOutput.Name=this._filter('translate')('Output')+" "+outputCounter.toString();outputCounter+=1;foundMatch=true;break}}}while(foundMatch);var n=Design.QuestionSetDesignerFactory.prepareAvailableOutputTreeNode(this.treeView,newOutput);if(targetNode.tag instanceof Intelledox.QAWizard.Design.AvailableOutput){this._wizard.AvailableOutputs.splice(this._wizard.AvailableOutputs.indexOf(targetNode.tag)+1,0,newOutput);targetNode.parent.insertChild(this._wizard.AvailableOutputs.indexOf(targetNode.tag)+1,n)}else{this._wizard.AvailableOutputs.push(newOutput);targetNode.addChild(n)}if(autoSelect){this.nodeSelected(n)}this.wizChanged=true};EditorViewModel.prototype.workflowSwitch=function(){if(this.currentPage instanceof Design.WorkflowPage){if(this._previouslySelected==null){this.currentPage=this._wizard.Pages[0];this.nodeSelected(this._wizard.Pages[0])}else{this.nodeSelected(this._previouslySelected)}this._previouslySelected=null}else{if(this._workflowPage==null){this._workflowPage=new Design.WorkflowPage(this._filter,this.wizard,this.listManager,Intelledox.Common.ConstantValues.GUID_EMPTY,this)}this._previouslySelected=this.treeView.selectedNode;this.currentPage=this._workflowPage;this.nodeSelected(this._workflowPage.Workflow.GetStartState())}};EditorViewModel.prototype.validateProject=function(){var vm=this;var validating=new Design.ValidationHelper(this.listManager.qservice,this._filter,this.listManager);validating.wizard=this._wizard;validating.documentInterface=this.documentInterface;var fragNodes=this.flyoutPlaceholders.documentFragmentNodes;for(var i=0;i<fragNodes.length;i++){for(var contentIndex=0;contentIndex<fragNodes[i].nodes.length;contentIndex++){var bookmrkNode=fragNodes[i].nodes[contentIndex];validating.contentItemPlaceholders.push(bookmrkNode.reference)}}validating.validationErrorCallback=function(result){vm.foundItems.push(result)};validating.progressCallback=function(percentage){};validating.validationCompleteCallback=function(){if(vm.foundItems.length===0){alert(this._filter('translate')('Validate_NoIssues'));vm.showFoundResults=false}};this.foundItems=[];this.foundItemsTitle=this._filter('translate')('ValidationResults');this.showFoundResults=true;validating.runWorker()};EditorViewModel.prototype.projectProperties=function(){var vm=this;var modalInstance=this._modal.open({templateUrl:'Views/Modal/projectProperties.html?v=106882799234227327',controller:['$scope','$filter','$modalInstance','designApi','wizard','editorViewModel','listManager',Design.ProjectPropertiesModalCtrl],backdrop:'static',size:'lg',resolve:{wizard:function(){return vm._wizard},editorViewModel:function(){return vm},listManager:function(){return vm.listManager},designApi:function(){return vm._designApi}}});modalInstance.result.then(function(){vm.projectName=vm._wizard.Name+(vm._wizard.Compatibility===Intelledox.QAWizard.Design.CompatibilityLevel.Version2014?"":vm._filter('translate')('CompatibiltyMode'))})};EditorViewModel.prototype.selectFoundItem=function(item){var foundItem=false;this.forceTreeLoad();var selectedItem=null;var selectedSubItem=null;var selectedSubItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(item.tag instanceof Design.ValidationError){selectedItem=item.tag.item;selectedSubItem=item.tag.subItem}else{selectedItem=item.tag}if(selectedSubItem!=null){if(selectedSubItem instanceof Intelledox.Model.RoutingOption){selectedSubItemGuid=selectedSubItem.RoutingOptionGuid}}if(!this.selectTreeNode(this.treeView.nodes,selectedItem,selectedSubItemGuid)){if(this._wizard.Workflow!=null){var fullList=this._wizard.Workflow.FullStateList;for(var i=0;i<fullList.length;i++){var state=fullList[i];if(state===selectedItem){foundItem=true;break}for(var escIndex=0;escIndex<state.EscalationList.length;escIndex++){if(state.EscalationList[escIndex]===selectedItem){foundItem=true;break}}for(var tranIndex=0;tranIndex<state.Transitions.length;tranIndex++){var transition=state.Transitions[tranIndex];if(transition===selectedItem){foundItem=true;break}for(var actionIndex=0;actionIndex<transition.Actions.length;actionIndex++){if(transition.Actions[actionIndex]===selectedItem){foundItem=true;break}}if(foundItem){break}}if(foundItem){break}}if(foundItem){if(!this.isWorkflowPage){this.workflowSwitch()}}}}else{this.scrollSelectedNodeIntoView()}};EditorViewModel.prototype.selectTreeNode=function(nodes,tagObject,subItem){var found=false;if(nodes==null){return false}for(var i=0;i<nodes.length;i++){var n=nodes[i];if(n.tag===tagObject){this.nodeSelected(n);this.selectAttribute(tagObject,subItem);return true}else if(n.tag instanceof Intelledox.QAWizard.Design.RichTextQuestion&&tagObject instanceof Intelledox.QAWizard.Design.ProtectedField){this.nodeSelected(n);this.activatePanel('protectedFields');this.protectedFieldsPanelModel.selectProtectedField(tagObject);return true}found=this.selectTreeNode(n.nodes,tagObject,subItem);if(found){break}}return found};EditorViewModel.prototype.selectAttribute=function(tagObject,subItem){if(subItem!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(tagObject instanceof Intelledox.QAWizard.Design.Action){this.activatePanel('properties');if(this.propertiesPanelModel instanceof Design.ActionPropertiesViewModel){this.propertiesPanelModel.inputsPanelModel.selectRow(subItem)}}else if(tagObject instanceof Intelledox.QAWizard.Design.Question){this.activatePanel('properties');if(this.propertiesPanelModel instanceof Design.CustomPropertiesViewModel){this.propertiesPanelModel.inputsPanelModel.selectRow(subItem)}}}};EditorViewModel.prototype.displayFoundNodes=function(foundItems,noResultsMessage){if(foundItems.length===0){this.showFoundResults=false;if(!System.String.IsNullOrEmpty(noResultsMessage)){alert(noResultsMessage)}}else if(foundItems.length===1){this.showFoundResults=false;this.nodeSelected(foundItems[0]);this.scrollSelectedNodeIntoView()}else{this.showFoundResults=true;this.foundItemsTitle=this._filter('translate')('FindResults');this.nodeSelected(foundItems[0]);this.foundItems=[];for(var i=0;i<foundItems.length;i++){var result=foundItems[i];var resultRow=new Design.FoundItem;resultRow.message=result.text;resultRow.icon=null;resultRow.tag=result.tag;if(result.tag instanceof Intelledox.QAWizard.Design.Answer){resultRow.type=this._filter('translate')('Answer')}else if(result.tag instanceof Intelledox.QAWizard.Design.Question){resultRow.type=this._filter('translate')('Question')}else if(result.tag instanceof Intelledox.QAWizard.Design.Placeholder){resultRow.type=this._filter('translate')('Placeholder')}else if(result.tag instanceof Intelledox.QAWizard.Design.ContentItem){resultRow.type=this._filter('translate')('ContentItem')}else if(result.tag instanceof Intelledox.QAWizard.Design.Page){resultRow.type=this._filter('translate')('Page')}else if(result.tag instanceof Intelledox.QAWizard.Design.Section){resultRow.message=result.tag.Title;resultRow.type=this._filter('translate')('Section')}else if(result.tag instanceof Intelledox.QAWizard.Design.Column){resultRow.message=result.tag.Title;resultRow.type=this._filter('translate')('Column')}else if(result.tag instanceof Intelledox.QAWizard.Design.TabPage){resultRow.message=result.tag.Title;resultRow.type=this._filter('translate')('TabPage')}else{resultRow.type=""}this.foundItems.push(resultRow)}this.scrollSelectedNodeIntoView()}};EditorViewModel.prototype.displayFoundItems=function(foundItems,isFindDependencies,findWhat,replaceWith){var name;if(foundItems.length===0){this.showFoundResults=false;alert(isFindDependencies?this._filter('translate')('NoDependenciesFound'):this._filter('translate')('NoMatchesFound'))}else{this.showFoundResults=true;this.foundItemsTitle=isFindDependencies?this._filter('translate')('FindResults'):System.String.Format(this._filter('translate')('FindAndReplaceResults'),findWhat,replaceWith);this.foundItems=[];for(var i=0;i<foundItems.length;i++){var result=foundItems[i];var resultRow=new Design.FoundItem;resultRow.message='';resultRow.icon=null;resultRow.tag=result.item;if(result.item instanceof Intelledox.QAWizard.Design.Question){name=result.item.Text}else if(result.item instanceof Intelledox.QAWizard.Design.Answer){name=result.item.Name}else if(result.item instanceof Intelledox.QAWizard.Design.Page){name=result.item.Name}else if(result.item instanceof Intelledox.QAWizard.Design.DocumentTemplate){name=result.item.Name}else if(result.item instanceof Intelledox.QAWizard.Design.Action){name=result.item.Name}else if(result.item instanceof Intelledox.QAWizard.Design.StateTransition){var fullList=this._wizard.Workflow.FullStateList;for(var stateIndex=0;stateIndex<fullList.length;stateIndex++){if(fullList[stateIndex].Transitions.indexOf(result.item)>-1){name=fullList[stateIndex].Name;break}}}else if(result.item instanceof Intelledox.QAWizard.Design.Escalation){name=result.item.Name}else if(typeof result.item==='string'&&result.item===Intelledox.Common.ConstantValues.FINISHPAGETAG){name=this._filter('translate')('FinishPage')}else if(result.item instanceof Intelledox.QAWizard.Design.Page){name=result.item.Name}else if(result.item instanceof Intelledox.QAWizard.Design.Section){name=result.item.Title}else if(result.item instanceof Intelledox.QAWizard.Design.Column){name=result.item.Title}else if(result.item instanceof Intelledox.QAWizard.Design.TabGroup){name=System.String.Format(this._filter('translate')('LayoutDefaultFormat'),this._filter('translate')('TabGroup'))}else if(result.item instanceof Intelledox.QAWizard.Design.TabPage){name=result.item.Title}else if(result.item instanceof Intelledox.QAWizard.Design.FragmentReference){name=result.item.Name}else if(result.item instanceof Intelledox.QAWizard.Design.AvailableOutput){name=result.item.Name}else if(result.item instanceof Intelledox.QAWizard.Design.ProtectedField){name=result.item.Name}else{name=""}switch(result.dependencyType){case Design.DependencyType.AutoAnswer:switch(result.item.QuestionTypeID){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic:resultRow.type=this._filter('translate')('Parent');break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource:resultRow.type=this._filter('translate')('DataFilterTab');break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart:resultRow.type=this._filter('translate')('Chart');break;default:resultRow.type=this._filter('translate')('AutoAnswerTab');break}break;case Design.DependencyType.Condition:resultRow.type=this._filter('translate')('Condition');break;case Design.DependencyType.Rule:resultRow.type=this._filter('translate')('Rule');break;case Design.DependencyType.QuestionReference:resultRow.type=this._filter('translate')('QuestionReference');break;case Design.DependencyType.ActionAttribute:resultRow.type=this._filter('translate')('ActionInput');break;case Design.DependencyType.EscalationAttribute:resultRow.type=this._filter('translate')('EscalationInput');break;case Design.DependencyType.CustomQuestionInput:resultRow.type=this._filter('translate')('Input');break;case Design.DependencyType.ValidationRule:resultRow.type=this._filter('translate')('ValidationRule');break;case Design.DependencyType.FragmentInput:resultRow.type=this._filter('translate')('FragmentInput');break;case Design.DependencyType.AvailableOutput:resultRow.type=this._filter('translate')('Output');break;case Design.DependencyType.Properties:resultRow.type=this._filter('translate')('Properties');break;case Design.DependencyType.ProtectedField:resultRow.type=this._filter('translate')('ProtectedField');break;case Design.DependencyType.Template:resultRow.type=this._filter('translate')('Template');break}resultRow.message=Design.TranslationHelper.KeywordValueToTranslation(this._filter,name);this.foundItems.push(resultRow)}}};EditorViewModel.prototype.placeholderIsBlank=function(placeholderName){return(placeholderName==null||System.String.IsNullOrEmpty(placeholderName.name)||placeholderName.name===this._filter('translate')('NoneWithBrackets'))};EditorViewModel.prototype.colourChildPlaceholders=function(parentNode,used){var childPlaceholders=parentNode.getSelfAndChildTags(function(node){return node.tag instanceof Intelledox.QAWizard.Design.Placeholder});for(var i=0;i<childPlaceholders.length;i++){var bm=childPlaceholders[i];this.flyoutPlaceholders.colourPlaceholder(bm.Reference,bm.External,used,bm.DocumentGuid);if(!this.placeholderIsBlank(bm.CloseGapPlaceholder)){this.flyoutPlaceholders.colourPlaceholder(bm.CloseGapPlaceholder,false,used,bm.DocumentGuid)}}var childDatasources=parentNode.getSelfAndChildTags(function(node){return node.tag instanceof Intelledox.QAWizard.Design.DatasourceQuestion&&node.tag.SelectionType===Intelledox.Model.SelectionType.Multiple});for(var i=0;i<childDatasources.length;i++){var q=childDatasources[i];this.flyoutPlaceholders.colourPlaceholders(q.RepeatPlaceholders,used)}var childRepeatedSections=parentNode.getSelfAndChildTags(function(node){return node.tag instanceof Intelledox.QAWizard.Design.Section&&node.tag.IsRepeated});for(var i=0;i<childRepeatedSections.length;i++){var s=childRepeatedSections[i];this.flyoutPlaceholders.colourPlaceholders(s.RepeatPlaceholders,false)}};EditorViewModel.prototype.getDocumentPlaceholderNodes=function(docGuid){var result=[];this.forceTreeLoad();for(var i=0;i<this.treeView.nodes.length;i++){this.getPlaceholderNodes(result,docGuid,this.treeView.nodes[i])}return result};EditorViewModel.prototype.getPlaceholderNodes=function(result,docGuid,parent){if(parent!=null){for(var i=0;i<parent.nodes.length;i++){if(parent.nodes[i].tag instanceof Intelledox.QAWizard.Design.Placeholder){if(parent.nodes[i].tag.DocumentGuid===docGuid){result.push(parent.nodes[i])}}else{this.getPlaceholderNodes(result,docGuid,parent.nodes[i])}}}};EditorViewModel.prototype.addResponseMetadataField=function(responseMetadataField,parentNode){var addBefore=null;if(parentNode.tag instanceof Intelledox.QAWizard.Design.ResponseMetadataField||parentNode.tag instanceof Intelledox.QAWizard.Design.Placeholder){addBefore=parentNode;parentNode=parentNode.parent}if(parentNode.tag instanceof Intelledox.QAWizard.Design.Answer){if(parentNode.tag.ResponseMetadataFields.filter(function(e){return e.ResponseMetadataFieldGuid===responseMetadataField.ResponseMetadataFieldGuid}).length>0){return}if(addBefore==null){parentNode.tag.ResponseMetadataFields.push(responseMetadataField)}else{parentNode.tag.ResponseMetadataFields.splice(parentNode.tag.Placeholders.indexOf(addBefore.tag),0,responseMetadataField)}}else if(parentNode.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){if(parentNode.tag.ResponseMetadataFields.filter(function(e){return e.ResponseMetadataFieldGuid===responseMetadataField.ResponseMetadataFieldGuid}).length>0){return}if(addBefore==null){parentNode.tag.ResponseMetadataFields.push(responseMetadataField)}else{parentNode.tag.ResponseMetadataFields.splice(parentNode.tag.ResponseMetadataFields.indexOf(addBefore.tag),0,responseMetadataField)}}var responseMetadataNode=Design.QuestionSetDesignerFactory.prepareResponseMetadataTreeNode(this._filter,this.treeView,responseMetadataField,this.listManager);if(addBefore==null){parentNode.addChild(responseMetadataNode)}else{parentNode.insertChild(addBefore.parent.nodes.indexOf(addBefore),responseMetadataNode)}this.wizChanged=true;this.nodeSelected(responseMetadataNode);this.flyoutPlaceholders.colourResponseMetdataField(responseMetadataField,true)};EditorViewModel.prototype.addPlaceholder=function(placeholderReference,parentNode,documentGuid,external){var addBefore=null;if(parentNode.tag instanceof Intelledox.QAWizard.Design.Placeholder||parentNode.tag instanceof Intelledox.QAWizard.Design.ResponseMetadataField){addBefore=parentNode;parentNode=parentNode.parent}if(!Design.HelperFunctions.isPlaceholderNameAllowed(this._wizard,placeholderReference,parentNode,documentGuid)){alert(this._filter('translate')('ErrorMsg_DuplicatePlaceholder'));return}if(System.String.IsNullOrEmpty(placeholderReference.name)){var newPlaceholder=new Intelledox.Model.PlaceholderReference;newPlaceholder.name=System.String.Format(this._filter('translate')('NewObjectFormat'),this._filter('translate')('Placeholder'),"");newPlaceholder.type=placeholderReference.type;placeholderReference=newPlaceholder}var newBm=new Intelledox.QAWizard.Design.Placeholder;newBm.Name=placeholderReference.name;newBm.External=external;newBm.DocumentGuid=documentGuid;newBm.PlaceholderType=placeholderReference.type;newBm.XmlNamespace=placeholderReference.schemaNamespace;var bmnode=Design.QuestionSetDesignerFactory.prepareBookmarkTreeNode(this.treeView,newBm,this._wizard,placeholderReference.schemaNamespace);if(parentNode.tag instanceof Intelledox.QAWizard.Design.FragmentDocument){if(addBefore==null){parentNode.tag.Placeholders.push(newBm)}else{parentNode.tag.Placeholders.splice(parentNode.tag.Placeholders.indexOf(addBefore.tag),0,newBm)}}else if(parentNode.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){if(addBefore==null){parentNode.tag.Placeholders.push(newBm)}else{parentNode.tag.Placeholders.splice(parentNode.tag.Placeholders.indexOf(addBefore.tag),0,newBm)}}else if(parentNode.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){if(addBefore==null){parentNode.tag.Placeholders.push(newBm)}else{parentNode.tag.Placeholders.splice(parentNode.tag.Placeholders.indexOf(addBefore.tag),0,newBm)}}else{var a=parentNode.treeView.findAncestorOrSelf(parentNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Answer}).tag;if(parentNode.tag instanceof Intelledox.QAWizard.Design.ContentItem){newBm.ContentId=parentNode.tag.ContentInstanceId}if(a instanceof Intelledox.QAWizard.Design.GroupLogicAnswer&&newBm.Reference.purpose===Intelledox.Model.PlaceholderPurpose.Insert){newBm.Behaviour=Intelledox.QAWizard.Design.PlaceholderBehaviour.InsertDisplayText}else if(a instanceof Intelledox.QAWizard.Design.AutoLogicAnswer&&newBm.Reference.purpose===Intelledox.Model.PlaceholderPurpose.Insert){newBm.Behaviour=Intelledox.QAWizard.Design.PlaceholderBehaviour.InsertCheckbox}if(addBefore==null){a.Placeholders.push(newBm)}else{a.Placeholders.splice(a.Placeholders.indexOf(addBefore.tag),0,newBm)}}if(addBefore==null){parentNode.addChild(bmnode)}else{parentNode.insertChild(addBefore.parent.nodes.indexOf(addBefore),bmnode)}this.wizChanged=true;this.nodeSelected(bmnode);this.flyoutPlaceholders.colourPlaceholder(newBm.Reference,external,true,documentGuid)};EditorViewModel.prototype.fillPlaceholderDropdown=function(listBox,value,docGuid,purpose){var foundGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;var listItem;var reference=new Intelledox.Model.PlaceholderReference;reference.name=this._filter('translate')('NoneWithBrackets');listBox.length=0;listBox.push(new Design.PlaceholderListItem(reference,Intelledox.Common.ConstantValues.GUID_EMPTY));if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){var foundUsedPlaceholder=false;for(var loopGuid in this.flyoutPlaceholders.unusedPlaceholders){if(this.flyoutPlaceholders.unusedPlaceholders.hasOwnProperty(loopGuid)){var docPlaceholders=this.flyoutPlaceholders.unusedPlaceholders[loopGuid];var foundValue=false;for(var i=0;i<docPlaceholders.length;i++){var placeholder=docPlaceholders[i];if((placeholder.purpose&purpose)===purpose){listItem=new Design.PlaceholderListItem(placeholder,loopGuid);listBox.push(listItem)}if(!foundValue&&value!=null&&!System.String.IsNullOrEmpty(value.name)&&value.equals(placeholder)){foundValue=true}}if(value!=null&&!System.String.IsNullOrEmpty(value.name)&&!foundValue){foundUsedPlaceholder=true;foundGuid=loopGuid}}}if(!this.placeholderIsBlank(value)){if(foundUsedPlaceholder){listItem=new Design.PlaceholderListItem(value,foundGuid);listBox.push(listItem)}}}else{if(this.flyoutPlaceholders.unusedPlaceholders.hasOwnProperty(docGuid)){var docPlaceholders=this.flyoutPlaceholders.unusedPlaceholders[docGuid];for(var i=0;i<docPlaceholders.length;i++){var placeholder=docPlaceholders[i];if((placeholder.purpose&purpose)===purpose){listItem=new Design.PlaceholderListItem(placeholder,docGuid);listBox.push(listItem)}}if(!this.placeholderIsBlank(value)){if(this.flyoutPlaceholders.isPlaceholderUnused(docGuid,value)){listItem=new Design.PlaceholderListItem(value,docGuid);listBox.push(listItem)}}}}};EditorViewModel.prototype.fillPlaceholderDropdownNoBlanks=function(listBox,purpose){this.fillPlaceholderDropdown(listBox,null,Intelledox.Common.ConstantValues.GUID_EMPTY,purpose);listBox.splice(0,1)};EditorViewModel.prototype.getFreeColours=function(){var takenColours=[];var result=[];for(var i=0;i<this._wizard.Documents.length;i++){takenColours.push(this._wizard.Documents[i].Colour)}for(var i=0;i<=4;i++){if(takenColours.indexOf(i)===-1){result.push(i)}}if(result.length===0){result.push(Intelledox.QAWizard.Design.PlaceholderColour.Green)}return result};EditorViewModel.prototype.pickRefEditor=function(ed){var _this=this;this.treeView.pickEvent=function(node){ed.insertContent(Design.HelperFunctions.createReferenceText(_this._filter,node));$('.mce-ref').toggleClass('mce-active',false)};this.treeView.togglePickMode()};EditorViewModel.prototype.scrollSelectedNodeIntoView=function(){setTimeout(function(){var selectedNode=$('#treeview-section .tree-selected');if(selectedNode.length>0){selectedNode[0].scrollIntoView()}},1000)};EditorViewModel.prototype.hasDefaultValue=function(id,element){switch(id){case'answerName':return(System.String.StartsWith(element.value,System.String.Format(this._filter('translate')('NewObjectFormat'),this._filter('translate')('Answer'),"")));case'pageName':return(System.String.StartsWith(element.value,System.String.Format(this._filter('translate')('NewObjectFormat'),this._filter('translate')('Page'),"")));case'stateTitle':return(System.String.StartsWith(element.value,this._filter('translate')('State')))}};EditorViewModel.prototype.hasDefaultText=function(id){var element=(document.getElementById(id));return this.hasDefaultValue(id,element)};EditorViewModel.prototype.highlightText=function(id){var element=(document.getElementById(id));if(this.hasDefaultValue(id,element)){element.select();element.focus()}};EditorViewModel.prototype.templateChanged=function(templateEditGuid){var vm=this;this.wizChanged=true;for(var i=0;i<this.templateBinaries.length;i++){if(this.templateBinaries[i].templateEditGuid===templateEditGuid){this.documentInterface.updatePlaceholdersFromEdit(this.templateBinaries[i].documentGuid,templateEditGuid).then(function(){vm.flyoutPlaceholders.resetState(vm.documentInterface.getBookmarkDictionary())});return}}};EditorViewModel.prototype.findContentLibQuestionDownloadableDocuments=function(contentLibQuestion,availableDocuments,parentFragmentGuids,parentFragmentNames){for(var answerIndex=0;answerIndex<contentLibQuestion.Answers.length;answerIndex++){for(var contentIndex=0;contentIndex<contentLibQuestion.Answers[answerIndex].ContentItems.length;contentIndex++){var content=contentLibQuestion.Answers[answerIndex].ContentItems[contentIndex];if(content.ContentTypeId===Intelledox.Model.ContentType.Attachment||content.ContentTypeId===Intelledox.Model.ContentType.Audio){var docValue=content.ContentItemGuid.toString();var docName=content.AttachmentName;if(!System.String.IsNullOrEmpty(parentFragmentNames)){docValue=docValue+":"+parentFragmentGuids;docName=System.String.Format(this._filter('translate')('DocumentNameOfFragment'),docName,parentFragmentNames)}availableDocuments.push({tag:content,name:docName,value:docValue})}}}if(contentLibQuestion.Visibility===true&&(contentLibQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.Attachment||contentLibQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.Audio)){var docValue=contentLibQuestion.QuestionGuid.toString();var docName=(System.String.IsNullOrEmpty(contentLibQuestion.AttachmentFileName)?contentLibQuestion.TranslatedText:contentLibQuestion.AttachmentFileName);if(!System.String.IsNullOrEmpty(parentFragmentNames)){docValue=docValue+":"+parentFragmentGuids;docName=System.String.Format(this._filter('translate')('DocumentNameOfFragment'),docName,parentFragmentNames)}availableDocuments.push({tag:contentLibQuestion,name:docName,value:docValue})}else if(contentLibQuestion.RepeatParent!==Intelledox.Common.ConstantValues.GUID_EMPTY){var hasPlaceholders=false;for(var answerIndex=0;answerIndex<contentLibQuestion.Answers.length;answerIndex++){hasPlaceholders=contentLibQuestion.Answers[answerIndex].HasPlaceholders;if(hasPlaceholders){break}}if(!hasPlaceholders){var docValue=contentLibQuestion.QuestionGuid.toString();var docName=contentLibQuestion.TranslatedText;if(!System.String.IsNullOrEmpty(parentFragmentNames)){docValue=contentLibQuestion.QuestionGuid+":"+parentFragmentGuids;docName=System.String.Format(this._filter('translate')('DocumentNameOfFragment'),contentLibQuestion.TranslatedText,parentFragmentNames)}availableDocuments.push({tag:contentLibQuestion,name:docName,value:docValue})}}};EditorViewModel.prototype.findDownloadableDocuments=function(availableDocuments){for(var i=0;i<this._wizard.Documents.length;i++){var doc=this._wizard.Documents[i];availableDocuments.push({tag:doc,name:doc.Name,value:doc.DocumentGuid.toString()})}for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var pageNode=this._wizard.Pages[pageIndex];this.findLayoutDownloadableDocuments(availableDocuments,pageNode,"","")}return availableDocuments};EditorViewModel.prototype.findFragmentDownloadableDocuments=function(availableDocuments,parentFragmentGuids,parentFragmentNames,fragment){var fragmentGuids=parentFragmentGuids+fragment.ObjectId;var fragmentNames=fragment.Name;if(parentFragmentNames!=""){fragmentNames=parentFragmentNames+", "+fragment.Name}var vm=this;if(fragment.Documents!=null){for(var i=0;i<fragment.Documents.length;i++){var fragDoc=fragment.Documents[i];if(fragDoc.IsAttachment&&fragDoc.AttachmentFormat!==Intelledox.Model.OutputType.None){this.listManager.projectFragment(fragment.ProjectGuid).then(function(fragWiz){if(fragWiz!=null){for(var fragDocIndex=0;fragDocIndex<fragWiz.Documents.length;fragDocIndex++){if(fragWiz.Documents[fragDocIndex].DocumentGuid==fragDoc.DocumentGuid){availableDocuments.push({tag:fragDoc,name:System.String.Format(vm._filter('translate')('DocumentNameOfFragment'),fragWiz.Documents[fragDocIndex].Name,fragmentNames),value:fragDoc.DocumentGuid+":"+fragmentGuids})}}}})}}}this.listManager.projectFragment(fragment.ProjectGuid).then(function(fragWiz){if(fragWiz!=null){for(var pageIndexFrag=0;pageIndexFrag<fragWiz.Pages.length;pageIndexFrag++){vm.findLayoutDownloadableDocuments(availableDocuments,fragWiz.Pages[pageIndexFrag],fragmentGuids,fragmentNames)}}})};EditorViewModel.prototype.findLayoutDownloadableDocuments=function(availableDocuments,node,fragmentGuids,fragmentNames){if(typeof node.HasFragmentInterface!=="undefined"){this.findFragmentDownloadableDocuments(availableDocuments,fragmentGuids,fragmentNames,node)}else{for(var nodeIndex=0;nodeIndex<node.Children.length;nodeIndex++){var itemNode=node.Children[nodeIndex];if(itemNode instanceof Intelledox.QAWizard.Design.ContentLibraryQuestion){this.findContentLibQuestionDownloadableDocuments(itemNode,availableDocuments,fragmentGuids,fragmentNames)}else if(typeof(itemNode.HasContainerInterface)!=="undefined"){this.findLayoutDownloadableDocuments(availableDocuments,itemNode,fragmentGuids,fragmentNames)}else if(itemNode instanceof Intelledox.QAWizard.Design.FragmentReference){this.findFragmentDownloadableDocuments(availableDocuments,fragmentGuids,fragmentNames,itemNode)}}}};EditorViewModel.getParentActionButtonQuestion=function(node){if(node.tag instanceof Intelledox.QAWizard.Design.FinishPage){return null}else if(node.tag instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){return node}if(node.parent==null){return null}var foundRoot=false;while(!foundRoot){if(node.parent.tag instanceof Intelledox.QAWizard.Design.FinishPage){return null}else if(node.parent.tag instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){return node.parent}else{node=node.parent}}};return EditorViewModel}());Design.EditorViewModel=EditorViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var TreeNode=(function(){function TreeNode(text,tag){this.text=text;this.tag=tag}Object.defineProperty(TreeNode.prototype,"isExpanded",{get:function(){return this._expanded},enumerable:true,configurable:true});Object.defineProperty(TreeNode.prototype,"isSelected",{get:function(){return(this.treeView.selectedNode===this)},enumerable:true,configurable:true});Object.defineProperty(TreeNode.prototype,"hasChildren",{get:function(){return(this._childNodes!=null&&this._childNodes.length>0)},enumerable:true,configurable:true});Object.defineProperty(TreeNode.prototype,"level",{get:function(){if(this.parent==null){return 0}else{return this.parent.level+1}},enumerable:true,configurable:true});Object.defineProperty(TreeNode.prototype,"nodes",{get:function(){if(this._childNodes==null){this._childNodes=[]}return this._childNodes},enumerable:true,configurable:true});Object.defineProperty(TreeNode.prototype,"prevNode",{get:function(){if(this.parent!=null){var index=this.parent.nodes.indexOf(this);if(index===0){return null}else{return this.parent.nodes[index-1]}}else{var index=this.treeView.nodes.indexOf(this);if(index===0){return null}else{return this.treeView.nodes[index-1]}}},enumerable:true,configurable:true});Object.defineProperty(TreeNode.prototype,"nextNode",{get:function(){if(this.parent!=null){var index=this.parent.nodes.indexOf(this);if(index===this.parent.nodes.length-1){return null}else{return this.parent.nodes[index+1]}}else{var index=this.treeView.nodes.indexOf(this);if(index===this.treeView.nodes.length-1){return null}else{return this.treeView.nodes[index+1]}}},enumerable:true,configurable:true});TreeNode.prototype.toggle=function(){if(!this._expanded&&this.treeView.beforeExpand!=null){this.treeView.beforeExpand(this)}this._expanded=!this._expanded;if(this._expanded&&this.treeView.afterExpand!=null){this.treeView.afterExpand(this)}};TreeNode.prototype.clear=function(){this._childNodes=[]};TreeNode.prototype.expand=function(){if(this.treeView.beforeExpand!=null){this.treeView.beforeExpand(this)}this._expanded=true;if(this.treeView.afterExpand!=null){this.treeView.afterExpand(this)}};TreeNode.prototype.collapse=function(){this._expanded=false};TreeNode.prototype.addChild=function(child){child.treeView=this.treeView;child.parent=this;this.nodes.push(child)};TreeNode.prototype.insertChild=function(index,child){child.treeView=this.treeView;child.parent=this;this.nodes.splice(index,0,child)};TreeNode.prototype.getSelfAndChildTags=function(compareFunction){return this.getSelfAndChildTagsInternal(this,compareFunction)};TreeNode.prototype.getSelfAndChildTagsInternal=function(childNode,compareFunction){var returnList=new Array;if(compareFunction(childNode)){returnList.push(childNode.tag)}for(var i=0;i<childNode.nodes.length;i++){returnList.push.apply(returnList,this.getSelfAndChildTagsInternal(childNode.nodes[i],compareFunction))}return returnList};TreeNode.prototype.remove=function(){if(this.parent!=null){var index=this.parent.nodes.indexOf(this);this.parent.nodes.splice(index,1)}else{var index=this.treeView.nodes.indexOf(this);this.treeView.nodes.splice(index,1)}};TreeNode.prototype.isDecendantOf=function(childNode){var currentNode=childNode.parent;while(currentNode!=null){if(currentNode===this){return true}currentNode=currentNode.parent}return false};TreeNode.prototype.keyPress=function($event){var nextSelection=null;var keyCode=$event.keyCode;var ctrlDown=$event.ctrlKey||$event.metaKey;var shiftDown=$event.shiftKey;if(shiftDown&&keyCode===9){if(this.treeView.selectionEvent){nextSelection=this.prevNode;if(nextSelection!=null){while(nextSelection.isExpanded&&nextSelection.hasChildren){nextSelection=nextSelection.nodes[nextSelection.nodes.length-1]}this.treeView.selectionEvent(nextSelection)}else if(this.parent!=null){this.treeView.selectionEvent(this.parent)}}}else if(keyCode===9){if(this.treeView.selectionEvent){if(this.isExpanded&&this.hasChildren){this.treeView.selectionEvent(this._childNodes[0])}else{nextSelection=this.nextNode;if(nextSelection!=null){this.treeView.selectionEvent(nextSelection)}else{nextSelection=this.parent;while(nextSelection!=null){if(nextSelection.nextNode!=null){this.treeView.selectionEvent(nextSelection.nextNode);break}nextSelection=nextSelection.parent}}}}}else if(keyCode===13||keyCode===32){if(this.treeView.selectionEvent){this.treeView.selectionEvent(this);$event.preventDefault()}}else if(keyCode===37&&this.treeView.canExpandCollapse){if(this.isExpanded){this.collapse()}if(ctrlDown){this.treeView.collapseAllFromNode(this)}$event.preventDefault()}else if(keyCode===39&&this.treeView.canExpandCollapse){if(!this.isExpanded){this.expand()}if(ctrlDown){this.treeView.expandAllFromNode(this)}$event.preventDefault()}else if(keyCode===46){if(this.treeView.deleteEvent){this.treeView.deleteEvent(this)}$event.preventDefault()}else if(keyCode===113){var inputObject=$('input.f2-rename,textarea.f2-rename');if(inputObject.length>0){if(inputObject.attr('ui-tinymce')!==undefined){tinymce.get(inputObject.attr('id')).focus()}else{inputObject.focus()}}}else if(ctrlDown){if(keyCode===67){if(this.treeView.copyEvent){this.treeView.copyEvent(this)}}else if(keyCode===88){if(this.treeView.cutEvent){this.treeView.cutEvent(this)}}else if(keyCode===86){if(this.treeView.pasteEvent){this.treeView.pasteEvent(this)}}$event.preventDefault()}};TreeNode.prototype.sort=function(){this.nodes.sort(function(a,b){if(a.text>b.text){return 1}if(a.text<b.text){return-1}return 0})};return TreeNode}());Design.TreeNode=TreeNode})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var TreeView=(function(){function TreeView(){this.isInPickMode=false;this.canExpandCollapse=true;this._rootNode=new Design.TreeNode("",null);this._rootNode.treeView=this;this._rootNode.expand()}Object.defineProperty(TreeView.prototype,"nodes",{get:function(){return this._rootNode.nodes},enumerable:true,configurable:true});Object.defineProperty(TreeView.prototype,"selectedNode",{get:function(){return this._selectedNode},set:function(node){this._selectedNode=node;if(node!=null){node=node.parent}while(node!=null){node.expand();node=node.parent}if(this._selectedNode!=null&&this.afterSelect){this.afterSelect()}},enumerable:true,configurable:true});TreeView.prototype.clear=function(){this._rootNode.clear();this._selectedNode=null};TreeView.prototype.collapseAll=function(){this.collapseAllFromNode(this._rootNode)};TreeView.prototype.collapseAllFromNode=function(node){for(var i=0;i<node.nodes.length;i++){node.nodes[i].collapse();this.collapseAllFromNode(node.nodes[i])}};TreeView.prototype.expandAll=function(){this.expandAllFromNode(this._rootNode)};TreeView.prototype.expandAllFromNode=function(node){for(var i=0;i<node.nodes.length;i++){node.nodes[i].expand();this.expandAllFromNode(node.nodes[i])}};TreeView.prototype.addChild=function(child){child.treeView=this;child.parent=null;this._rootNode.nodes.push(child)};TreeView.prototype.insertChild=function(index,child){child.treeView=this;child.parent=null;this._rootNode.nodes.splice(index,0,child)};TreeView.prototype.findAncestorOrSelf=function(childNode,compareFunction){if(childNode==null){return null}do{if(compareFunction(childNode)){return childNode}childNode=childNode.parent}while(childNode!=null);return null};TreeView.prototype.getAncestorsAndSelfUntil=function(childNode,compareFunction){var results=[];if(childNode==null){return results}do{results.push(childNode);if(compareFunction(childNode)){return results}childNode=childNode.parent}while(childNode!=null);return results};TreeView.prototype.findNodeByTag=function(startNode,tag){var results={found:false,node:null};if(startNode==null){for(var i=0;i<this._rootNode.nodes.length;i++){this.findNodeByTagRecursive(this._rootNode.nodes[i],tag,results);if(results.found){return results.node}}return null}else{this.findNodeByTagRecursive(startNode,tag,results);return results.node}};TreeView.prototype.findNodeByKey=function(startNode,key,searchAllChildren){var foundNodes=[];if(startNode==null){for(var i=0;i<this._rootNode.nodes.length;i++){this.findNodeByKeyRecursive(this._rootNode.nodes[i],key,searchAllChildren,foundNodes)}}else{for(var i=0;i<startNode.nodes.length;i++){this.findNodeByKeyRecursive(startNode.nodes[i],key,searchAllChildren,foundNodes)}}return foundNodes};TreeView.prototype.doSelection=function(node){if(this.isInPickMode){this.pickEvent(node);this.togglePickMode()}else if(this.selectionEvent){this.selectionEvent(node)}};TreeView.prototype.togglePickMode=function(){this.isInPickMode=!this.isInPickMode;var $body=angular.element(document.body);var $rootScope=$body.injector().get('$rootScope');if(!this.isInPickMode){$rootScope.$emit('hideTempTreeView');this.pickEvent=null}else{$rootScope.$emit('showTempTreeView')}};TreeView.prototype.findTreeNodes=function(compareFunction){var foundNodes=[];for(var i=0;i<this._rootNode.nodes.length;i++){this.findTreeNodesRecursive(this._rootNode.nodes[i],compareFunction,foundNodes)}return foundNodes};TreeView.prototype.findTreeNodesRecursive=function(currentNode,compareFunction,foundNodes){if(compareFunction(currentNode)){foundNodes.push(currentNode)}if(currentNode.hasChildren){for(var i=0;i<currentNode.nodes.length;i++){this.findTreeNodesRecursive(currentNode.nodes[i],compareFunction,foundNodes)}}};TreeView.prototype.firstOrDefault=function(compareFunction){var results={found:false,node:null};for(var i=0;i<this._rootNode.nodes.length;i++){this.firstOrDefaultRecursive(this._rootNode.nodes[i],compareFunction,results);if(results.found){return results.node}}return null};TreeView.prototype.firstOrDefaultRecursive=function(currentNode,compareFunction,results){if(compareFunction(currentNode)){results.found=true;results.node=currentNode;return}if(currentNode.hasChildren){for(var i=0;i<currentNode.nodes.length;i++){this.firstOrDefaultRecursive(currentNode.nodes[i],compareFunction,results);if(results.found){return}}}};TreeView.prototype.findNodeByTagRecursive=function(currentNode,tag,results){if(tag===currentNode.tag){results.found=true;results.node=currentNode;return}if(currentNode.hasChildren){for(var i=0;i<currentNode.nodes.length;i++){this.findNodeByTagRecursive(currentNode.nodes[i],tag,results);if(results.found){return}}}};TreeView.prototype.findNodeByKeyRecursive=function(currentNode,key,searchAllChildren,foundNodes){if(Intelledox.Common.Functions.EqualsIgnoreCase(key,currentNode.key)){foundNodes.push(currentNode)}if(searchAllChildren&&currentNode.hasChildren){for(var i=0;i<currentNode.nodes.length;i++){this.findNodeByKeyRecursive(currentNode.nodes[i],key,searchAllChildren,foundNodes)}}};return TreeView}());Design.TreeView=TreeView})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){angular.module('Startup',['pascalprecht.translate']).config(['$translateProvider','$compileProvider',function($translateProvider,$compileProvider){$translateProvider.useSanitizeValueStrategy('escaped').useStaticFilesLoader({prefix:'Content/Design/Strings.',suffix:'.json?v=106882799234227327'}).fallbackLanguage('en').determinePreferredLanguage(function(){var lang=Intelledox.Common.Device.GetFirstBrowserLanguage()||"en";lang=lang.toLowerCase();if(lang==="zh-cn"||lang==="zh-sg"){return"zh-hans"}else if(lang==="zh-tw"||lang==="zh-hk"){return"zh-hant"}else if(lang==="en-us"||lang==="zh-hans"||lang==="zh-hant"){return lang}else{if(lang.indexOf("-")>-1){lang=lang.split("-")[0]}if(lang==="ar"||lang==="de"||lang==="en"||lang==="es"||lang==="fr"||lang==="ko"||lang==="nl"||lang==="pt"||lang==="th"){return lang}else{return"en"}}});$compileProvider.debugInfoEnabled(false)}]).controller('startupCtrl',['$scope','designApi','recentProjects',Design.StartupCtrl])})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var DesignApi=(function(){function DesignApi($http){this.$http=$http}DesignApi.prototype.login=function(){return this.$http.get('../api/v1/admin/login/cookietosession?design=true&tokenExpiryHours=720')};DesignApi.prototype.getCurrencySymbols=function(){return this.$http.get('../api/v1/currencysymbols',{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")},cache:true}).then(function(response){return response.data})};DesignApi.prototype.getProjectDefinition=function(projectGuid){return this.$http.get('../api/v1/projectdefinition/'+projectGuid+'?upgradeXtf=true',{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.updateProjectDefinition=function(updateRequest){return this.$http.post('../api/v1/projectdefinition/',JSON.stringify(updateRequest),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getProjects=function(editableOnly){return this.$http.get('../api/v1/projects?editableonly='+(editableOnly?'True':'False'),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.tryLockProject=function(projectGuid){return this.$http.get('../api/v1/projectlock/'+projectGuid,{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.unlockProject=function(id,projectVersionComment,templateBinaries){return this.$http.post('../api/v1/projectLock/'+id+'?projectVersionComment='+encodeURIComponent(projectVersionComment)+'&forceUnlock=False',this.getTemplateEditList(templateBinaries),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken"),'Content-Type':'application/json; charset=utf-8'}})};DesignApi.prototype.unlockProjectExit=function(id,templateBinaries){var client=new XMLHttpRequest;client.open("POST",'../api/v1/projectLock/'+id+'?projectVersionComment=&forceUnlock=False',false);client.setRequestHeader("Authorization-Token",sessionStorage.getItem("authorizationToken"));client.setRequestHeader('Content-Type','application/json; charset=utf-8');client.send(JSON.stringify(this.getTemplateEditList(templateBinaries)))};DesignApi.prototype.getTemplateEditList=function(templateBinaries){if(templateBinaries==null){return null}return templateBinaries.filter(function(value){return value.templateEditGuid!=null}).map(function(value){return value.templateEditGuid})};DesignApi.prototype.getVariables=function(){return this.$http.get('../api/v1/variables',{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")},cache:true}).then(function(response){return response.data})};DesignApi.prototype.getRoutingTypes=function(providerType,checkLicence){return this.$http.get("../api/v1/routingTypes?providerType="+providerType.toString()+"&checkLicence="+(checkLicence?"True":"False"),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getRoutingElementTypes=function(routingTypeId){return this.$http.get("../api/v1/routingElementTypes?routingTypeId="+routingTypeId.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getActionOutputs=function(actionTypeId){return this.$http.get("../api/v1/actionOutputs?actionTypeId="+actionTypeId.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getActionAvailableDocuments=function(actionTypeId){return this.$http.get("../api/v1/actionAvailableDocuments?actionTypeId="+actionTypeId.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getContentItems=function(){return this.$http.get("../api/v1/contentItems?categoryId=0"+"&contentTypeId=-1"+"&folderGuid="+Intelledox.Common.ConstantValues.GUID_EMPTY+"&noFolder=False"+"&userId="+Intelledox.Common.ConstantValues.GUID_EMPTY,{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getContentItemsWithOptions=function(options){return this.$http.get("../api/v1/contentItems?categoryId="+options.categoryId.toString()+(System.String.IsNullOrEmpty(options.name)?"":"&name="+encodeURIComponent(options.name))+"&contentTypeId="+options.contentTypeId.toString()+"&folderGuid="+options.folderGuid+"&noFolder="+(options.noFolder?'True':'False')+"&userId="+Intelledox.Common.ConstantValues.GUID_EMPTY,{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getDataFields=function(dataObjectGuid){return this.$http.get("../api/v1/dataFields?dataObjectGuid="+dataObjectGuid.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getDataServices=function(){return this.$http.get("../api/v1/dataServices",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getDataProviders=function(){return this.$http.get("../api/v1/dataProviders",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getDataObjects=function(dataServiceGuid){return this.$http.get("../api/v1/dataObjects?dataServiceGuid="+dataServiceGuid.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getCustomQuestionTypes=function(checkLicense){return this.$http.get("../api/v1/customQuestionTypes?checkLicence="+(checkLicense?'True':'False'),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getCustomQuestionInputTypes=function(customQuestionID){return this.$http.get("../api/v1/customQuestionInputTypes?customQuestionId="+customQuestionID.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getCustomQuestionOutputTypes=function(customQuestionID){return this.$http.get("../api/v1/customQuestionOutputTypes?customQuestionId="+customQuestionID.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getDataKeyFields=function(dataObjectGuid){return this.$http.get("../api/v1/dataKeyFields?dataObjectGuid="+dataObjectGuid.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getDataLinks=function(dataObjectTypeGuid){return this.$http.get("../api/v1/dataLinks?dataObjectTypeGuid="+dataObjectTypeGuid.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getSuppportedFilterComparisions=function(dataServiceGuid,dataObjectGuid){return this.$http.get("../api/v1/supportedFilterComparisions"+"?dataServiceGuid="+dataServiceGuid.toString()+"&dataObjectGuid="+dataObjectGuid.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getSupportedHierarchicalFilterComparisons=function(dataServiceGuid,dataObjectGuid){return this.$http.get("../api/v1/supportedHierarchicalFilterComparisons"+"?dataServiceGuid="+dataServiceGuid.toString()+"&dataObjectGuid="+dataObjectGuid.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getAddressFields=function(){return this.$http.get("../api/v1/addressFields",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getContentCategories=function(){return this.$http.get("../api/v1/categories",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getContentFolders=function(editableOnly){return this.$http.get("../api/v1/contentfolders?editableOnly="+(editableOnly?'True':'False'),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getPublishFolders=function(){return this.$http.get("../api/v1/admin/publishfolders",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getPublishedProjects=function(){return this.$http.get("../api/v1/publishedprojects",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getCanPublish=function(){return this.$http.get("../api/v1/admin/publishedprojects/canpublish",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.publishProject=function(project){return this.$http.post("../api/v1/admin/publishedprojects",JSON.stringify(project),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken"),'Content-Type':'application/json; charset=utf-8'}}).then(function(response){return new Infiniti.Model.Apis.PublishProjectResult}).catch(function(response){var result=new Infiniti.Model.Apis.PublishProjectResult;result.success=false;if(response.data.innererror!==null){result.code=response.data.innererror.code}else{result.code=response.data.message}return result})};DesignApi.prototype.getUsers=function(){return this.$http.get("../api/v1/users",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getGroups=function(){return this.$http.get("../api/v1/groups",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.documentInterface=function(projectGuid){return this.$http.get("../api/v1/documentInterface?projectGuid="+projectGuid.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.documentInterfaceRefresh=function(formatType,binary,templateEditGuid){return this.$http.post("../api/v1/documentInterface?formatType="+formatType.toString()+'&templateEditGuid='+templateEditGuid.toString(),JSON.stringify(binary),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken"),'Content-Type':'application/json; charset=utf-8'}}).then(function(response){return response.data})};DesignApi.prototype.documentInterfaceRefreshFromEdit=function(templateEditGuid){return this.$http.get('../api/v1/documentInterface/fromedit/?templateEditGuid='+templateEditGuid.toString(),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.documentInterfaceDownload=function(projectGuid,fileGuid,templateEditGuid){return this.$http.get("../api/v1/documentInterface/download?projectGuid="+projectGuid.toString()+'&fileguid='+fileGuid.toString()+(templateEditGuid==null?'':'&templateEditGuid='+templateEditGuid.toString()),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getContentItemPlaceholders=function(contentItems){return this.$http.post("../api/v1/contentItemPlaceholders",JSON.stringify(contentItems),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken"),'Content-Type':'application/json; charset=utf-8'}}).then(function(response){return response.data})};DesignApi.prototype.getResponseMetadataFields=function(){return this.$http.get("../api/v1/responseMetadata",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getCssStyles=function(appliesTo){return this.$http.get("../api/v1/webcssstyles?appliesTo="+encodeURIComponent(appliesTo),{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.getAppSettings=function(){return this.$http.get("../api/v1/appsettings",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};DesignApi.prototype.prepareTemplateForEdit=function(projectGuid,documentGuid,templateEditGuid,formatType){return this.$http.get('../api/v1/documentinterface/prepareforedit/?projectGuid='+projectGuid.toString()+'&fileGuid='+documentGuid.toString()+'&templateEditGuid='+templateEditGuid.toString()+'&formatType='+formatType,{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}})};DesignApi.prototype.pollTemplateEdit=function(id,timestamp){var headers={'Authorization-Token':sessionStorage.getItem("authorizationToken")};if(timestamp!=null){headers['If-Modified-Since']=timestamp}return this.$http.get('../api/v1/documentinterface/pollforedit/?templateEditGuid='+id.toString(),{headers:headers}).then(function(response){if(response.status===200){return response.headers('Last-Modified')}else{return timestamp}})};DesignApi.prototype.moduleLicenses=function(){return this.$http.get("../api/v1/modulelicenses",{headers:{'Authorization-Token':sessionStorage.getItem("authorizationToken")}}).then(function(response){return response.data})};return DesignApi}());Design.DesignApi=DesignApi;angular.module("Design").service("designApi",['$http',DesignApi]);angular.module("Startup").service("designApi",['$http',DesignApi])})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var PlaceholdersFlyout=(function(){function PlaceholdersFlyout(filter,designApi,lists){this._usedExternalPlaceholders=[];this.searchValue='';this.usedPlaceholders={};this.unusedPlaceholders={};var vm=this;this._filter=filter;this._designApi=designApi;this._lists=lists;this.placeholdersTreeview=new Design.TreeView;this.placeholdersTreeview.afterExpand=function(node){vm.loadContentPlaceholders(node);vm.loadResponseMetadataFields(node)}}Object.defineProperty(PlaceholdersFlyout.prototype,"documentFragmentNodes",{get:function(){this.loadContentPlaceholders(this._docFragNode);return this._docFragNode.nodes},enumerable:true,configurable:true});PlaceholdersFlyout.prototype.init=function(wizard){this._wizard=wizard};PlaceholdersFlyout.prototype.colourResponseMetdataField=function(responseMetadataField,isAdd){for(var nodeIndex=0;nodeIndex<this._responseMetadataNode.nodes.length;nodeIndex++){if(isAdd||this.isResponseMetdataFieldUsed(responseMetadataField.ResponseMetadataFieldGuid)){this._responseMetadataNode.nodes[nodeIndex].imageKey="icon-responsemetadataused"}else{this._responseMetadataNode.nodes[nodeIndex].imageKey="icon-responsemetadata"}break}};PlaceholdersFlyout.prototype.isResponseMetdataFieldUsed=function(responseMetadataFieldGuid){for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var page=this._wizard.Pages[pageIndex];if(page instanceof Intelledox.QAWizard.Design.FragmentPage){for(var outIndex=0;outIndex<page.Outputs.length;outIndex++){if(this.isResponseMetadataFieldInArray(page.Outputs[outIndex].ResponseMetadataFields,responseMetadataFieldGuid)){return true}}}else if(this.isResponseMetdataFieldInContainer(responseMetadataFieldGuid,page)){return true}}return false};PlaceholdersFlyout.prototype.isResponseMetdataFieldInContainer=function(responseMetadataFieldGuid,node){for(var childIndex=0;childIndex<node.Children.length;childIndex++){var child=node.Children[childIndex];if(child instanceof Intelledox.QAWizard.Design.Question){for(var answerIndex=0;answerIndex<child.Answers.length;answerIndex++){if(this.isResponseMetadataFieldInArray(child.Answers[answerIndex].ResponseMetadataFields,responseMetadataFieldGuid)){return true}}}else if(child instanceof Intelledox.QAWizard.Design.FragmentReference){for(var outIndex=0;outIndex<child.Outputs.length;outIndex++){if(this.isResponseMetadataFieldInArray(child.Outputs[outIndex].ResponseMetadataFields,responseMetadataFieldGuid)){return true}}}else if(typeof(child.HasContainerInterface)!=="undefined"){if(this.isResponseMetdataFieldInContainer(responseMetadataFieldGuid,child)){return true}}}return false};PlaceholdersFlyout.prototype.isResponseMetadataFieldInArray=function(responseMetadataFields,responseMetadataFieldGuid){return responseMetadataFields.length>0&&responseMetadataFields.map(function(f){return f.ResponseMetadataFieldGuid}).indexOf(responseMetadataFieldGuid)!==-1};PlaceholdersFlyout.prototype.colourPlaceholder=function(placeholderName,isExternal,isUsed,docGuid){var foundNodes=null;if((isExternal&&!this.documentFragmentsFilled())||this.placeholderIsBlank(placeholderName)){return}if(!isExternal&&docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){foundNodes=this.placeholdersTreeview.findNodeByKey(null,placeholderName.name+"~"+placeholderName.type.toString(),true)}else{if(isExternal){foundNodes=this.placeholdersTreeview.findNodeByKey(this._docFragNode,placeholderName.name+"~"+placeholderName.type.toString(),true)}else{for(var i=0;i<this.placeholdersTreeview.nodes.length;i++){var docNode=this.placeholdersTreeview.nodes[i];if(docNode.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate&&docNode.tag.DocumentGuid===docGuid){foundNodes=this.placeholdersTreeview.findNodeByKey(docNode,placeholderName.name+"~"+placeholderName.type.toString(),true);break}}}}if(foundNodes!=null&&foundNodes.length>0){if(isExternal){if(isUsed){this.markExternalBookmarkAsUsed(foundNodes[0])}else{this.markExternalBookmarkAsUnused(foundNodes[0])}}else{for(var i=0;i<foundNodes.length;i++){var placeholderNode=foundNodes[i];if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||placeholderNode.tag.DocumentGuid===docGuid){if(isUsed){this.markBookmarkAsUsed(placeholderNode)}else{this.markBookmarkAsUnused(placeholderNode)}}}}}if(isExternal){if(isUsed){if(!this.arrayContains(this._usedExternalPlaceholders,placeholderName)){this._usedExternalPlaceholders.push(placeholderName)}}else{this.arrayRemove(this._usedExternalPlaceholders,placeholderName)}}else if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){for(var existingDocGuid in this.usedPlaceholders){if(this.usedPlaceholders.hasOwnProperty(existingDocGuid)){if(isUsed){this.usedPlaceholders[existingDocGuid].push(placeholderName);this.arrayRemove(this.unusedPlaceholders[existingDocGuid],placeholderName)}else{this.arrayRemove(this.usedPlaceholders[existingDocGuid],placeholderName);if(!this.arrayContains(this.unusedPlaceholders[existingDocGuid],placeholderName)){this.unusedPlaceholders[existingDocGuid].push(placeholderName)}}}}}else if(this.unusedPlaceholders.hasOwnProperty(docGuid)){if(isUsed){this.usedPlaceholders[docGuid].push(placeholderName);this.arrayRemove(this.unusedPlaceholders[docGuid],placeholderName)}else if(this.usedPlaceholders.hasOwnProperty(docGuid)){this.arrayRemove(this.usedPlaceholders[docGuid],placeholderName);if(!this.arrayContains(this.unusedPlaceholders[docGuid],placeholderName)){this.unusedPlaceholders[docGuid].push(placeholderName)}}}};PlaceholdersFlyout.prototype.colourPlaceholders=function(placeholders,used){for(var i=0;i<placeholders.length;i++){var bm=placeholders[i];var found=false;for(var docGuid in this.usedPlaceholders){if(this.usedPlaceholders.hasOwnProperty(docGuid)){if(this.arrayContains(this.usedPlaceholders[docGuid],bm)||this.arrayContains(this.unusedPlaceholders[docGuid],bm)){this.colourPlaceholder(bm,false,used,docGuid);found=true;break}}}if(!found){this.colourPlaceholder(bm,true,used,Intelledox.Common.ConstantValues.GUID_EMPTY)}}};PlaceholdersFlyout.prototype.isPlaceholderUsed=function(documentGuid,placeholderName){if(this.usedPlaceholders.hasOwnProperty(documentGuid)&&this.arrayContains(this.usedPlaceholders[documentGuid],placeholderName)){return true}else{return false}};PlaceholdersFlyout.prototype.isPlaceholderUnused=function(documentGuid,placeholderName){if(this.unusedPlaceholders.hasOwnProperty(documentGuid)&&this.arrayContains(this.unusedPlaceholders[documentGuid],placeholderName)){return true}else{return false}};PlaceholdersFlyout.prototype.resetState=function(placeholders,schemaNamespace){if(schemaNamespace===void 0){schemaNamespace=""}var usedPlaceholders={};var hasMatch=false;var found=false;var vm=this;this._sourcePlaceholders=placeholders;this.usedPlaceholders={};this.unusedPlaceholders={};for(var i=0;i<this._wizard.Documents.length;i++){usedPlaceholders[this._wizard.Documents[i].DocumentGuid]=[]}Design.HelperFunctions.ForAllPlaceholders(this._wizard,function(b){if(usedPlaceholders.hasOwnProperty(b.DocumentGuid)){usedPlaceholders[b.DocumentGuid].push(b.Reference);if(!vm.placeholderIsBlank(b.CloseGapPlaceholder)){usedPlaceholders[b.DocumentGuid].push(b.CloseGapPlaceholder)}}});for(var i=0;i<this._wizard.Pages.length;i++){var g=this._wizard.Pages[i];if(g.IsRepeated){for(var repeatIndex=0;repeatIndex<g.RepeatPlaceholders.length;repeatIndex++){for(var docGuid in usedPlaceholders){if(usedPlaceholders.hasOwnProperty(docGuid)){usedPlaceholders[docGuid].push(g.RepeatPlaceholders[repeatIndex])}}}}this.findSectionPlaceholders(g.Children,usedPlaceholders);for(var questionIndex=0;questionIndex<g.Questions.length;questionIndex++){var q=g.Questions[questionIndex];if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){for(var repeatIndex=0;repeatIndex<q.RepeatPlaceholders.length;repeatIndex++){for(var docGuid in usedPlaceholders){if(usedPlaceholders.hasOwnProperty(docGuid)){usedPlaceholders[docGuid].push(q.RepeatPlaceholders[repeatIndex])}}}}}}if(this._wizard.TypeId===Intelledox.Model.ProjectType.Layout&&!this.placeholderIsBlank(this._wizard.ContentPlaceholder)){usedPlaceholders[this._wizard.Documents[0].DocumentGuid].push(this._wizard.ContentPlaceholder)}for(var docIndex=0;docIndex<this._wizard.Documents.length;docIndex++){var doc=this._wizard.Documents[docIndex];if(doc.FormatType!==Intelledox.Model.TemplateFormatType.ProjectResults){var bmImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Bookmark,doc.DocumentGuid,this._wizard);var msImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Mustache,doc.DocumentGuid,this._wizard);var slImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Slide,doc.DocumentGuid,this._wizard);var xmlImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Xml,doc.DocumentGuid,this._wizard);var wbSheetImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Worksheet,doc.DocumentGuid,this._wizard);var wbNamedRangeImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.NamedRange,doc.DocumentGuid,this._wizard);var xmlRangeImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.XmlRepeat,doc.DocumentGuid,this._wizard);var msBrokenImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Broken,doc.DocumentGuid,this._wizard);var pdfImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.PdfField,doc.DocumentGuid,this._wizard);var jsonImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Json,doc.DocumentGuid,this._wizard);var docBookmarks=placeholders[doc.DocumentGuid];var currentUnusedPlaceholders=usedPlaceholders[doc.DocumentGuid];var docNode;for(var nodeIndex=0;nodeIndex<this.placeholdersTreeview.nodes.length;nodeIndex++){if(this.placeholdersTreeview.nodes[nodeIndex].tag===doc){docNode=this.placeholdersTreeview.nodes[nodeIndex];break}}this.usedPlaceholders[doc.DocumentGuid]=[];this.unusedPlaceholders[doc.DocumentGuid]=[];docNode.clear();currentUnusedPlaceholders.sort(function(a,b){if(a.name>b.name){return 1}if(a.name<b.name){return-1}if(a.type>b.type){return 1}if(a.type<b.type){return-1}return 0});var test='';if(test.localeCompare){docBookmarks.sort(function(a,b){var result=a.name.localeCompare(b.name,undefined,{sensitivity:'base'});if(result!==0){return result}if(a.type>b.type){return 1}if(a.type<b.type){return-1}return 0})}else{docBookmarks.sort(function(a,b){var upperA=a.name.toUpperCase();var upperB=b.name.toUpperCase();if(upperA>upperB){return 1}if(upperA<upperB){return-1}if(a.type>b.type){return 1}if(a.type<b.type){return-1}return 0})}hasMatch=false;for(var placeIndex=0;placeIndex<docBookmarks.length;placeIndex++){var bMark=docBookmarks[placeIndex];if(Intelledox.Common.Functions.ContainsIgnoreCase(bMark.name,this.searchValue)){var n;var name=bMark.name;if(!System.String.IsNullOrEmpty(bMark.schemaNamespace)){name=name.replace(bMark.schemaNamespace,"ns")}n=new Design.PlaceholderTreeNode(name,docNode.tag);n.key=bMark.name+"~"+bMark.type.toString();n.reference=bMark;n.documentGuid=doc.DocumentGuid;if(bMark.type===Intelledox.Model.PlaceholderType.Bookmark){n.imageKey=bmImage}else if(bMark.type===Intelledox.Model.PlaceholderType.Slide){n.imageKey=slImage}else if(bMark.type===Intelledox.Model.PlaceholderType.Xml){n.imageKey=xmlImage}else if(bMark.type===Intelledox.Model.PlaceholderType.XmlRepeat){n.imageKey=xmlRangeImage}else if(bMark.type===Intelledox.Model.PlaceholderType.Worksheet){n.imageKey=wbSheetImage}else if(bMark.type===Intelledox.Model.PlaceholderType.NamedRange){n.imageKey=wbNamedRangeImage}else if(bMark.type===Intelledox.Model.PlaceholderType.Broken){n.imageKey=msBrokenImage}else if(bMark.type===Intelledox.Model.PlaceholderType.PdfField){n.imageKey=pdfImage}else if(bMark.type===Intelledox.Model.PlaceholderType.Json){n.imageKey=jsonImage}else{n.imageKey=msImage}docNode.addChild(n);found=false;for(var unusedIndex=0;unusedIndex<currentUnusedPlaceholders.length;unusedIndex++){if(currentUnusedPlaceholders[unusedIndex].equals(bMark)){this.markBookmarkAsUsed(n);this.usedPlaceholders[doc.DocumentGuid].push(bMark);found=true;break}}if(!found){this.unusedPlaceholders[doc.DocumentGuid].push(bMark)}hasMatch=true}}}}};PlaceholdersFlyout.prototype.createPlaceholderTree=function(){this.placeholdersTreeview.clear();this.addExternals();for(var i=0;i<this._wizard.Documents.length;i++){if(this._wizard.Documents[i].FormatType!==Intelledox.Model.TemplateFormatType.ProjectResults){var bmNode=new Design.TreeNode(Design.TranslationHelper.KeywordValueToTranslation(this._filter,this._wizard.Documents[i].Name),this._wizard.Documents[i]);bmNode.key=this._wizard.Documents[i].DocumentGuid;bmNode.imageKey="icon-template";this.placeholdersTreeview.addChild(bmNode)}}this._docFragNode=new Design.TreeNode(this._filter('translate')('DocumentFragments'),null);this._docFragNode.key="docfrag";this._docFragNode.imageKey="icon-template";this.placeholdersTreeview.addChild(this._docFragNode);var docFragLoadingNode=new Design.TreeNode(this._filter('translate')('Loading'),"placeholder");docFragLoadingNode.imageKey='';this._docFragNode.addChild(docFragLoadingNode);this._responseMetadataNode=new Design.TreeNode(this._filter('translate')('ResponseMetadataFields'),null);this._responseMetadataNode.key="responseMetadata";this._responseMetadataNode.imageKey="icon-responsemetadataroot";this.placeholdersTreeview.addChild(this._responseMetadataNode);var responseMetadataLoadingNode=new Design.TreeNode(this._filter('translate')('Loading'),"placeholder");responseMetadataLoadingNode.imageKey='';this._responseMetadataNode.addChild(responseMetadataLoadingNode)};PlaceholdersFlyout.prototype.addContentItemReference=function(newContent){if(this.documentFragmentsFilled()){var contentNode;var contentGuids=[];contentGuids.push(newContent.ContentItemGuid);contentNode=this.appendContentItemReference(newContent);if(contentNode!=null){this.fillContentItemReference(contentGuids)}}};PlaceholdersFlyout.prototype.removeContentItemReference=function(contentItemGuid){for(var i=0;i<this._docFragNode.nodes.length;i++){if(this._docFragNode.nodes[i].tag===contentItemGuid){this._docFragNode.nodes[i].remove();break}}};PlaceholdersFlyout.prototype.changePlaceholderImage=function(node,oldBookmarkImage,oldMustacheImage,oldXmlImage,oldXmlRepeatImage,oldNamedRangeImage,oldWorksheetImage,oldPdfImage,oldJsonImage,newBookmarkImage,newMustacheImage,newXmlImage,newXmlRepeatImage,newNamedRangeImage,newWorksheetImage,newPdfImage,newJsonImage,docGuid){if(node==null){node=this.findDocumentNode(docGuid)}if(node.imageKey===oldBookmarkImage){node.imageKey=newBookmarkImage}else if(node.imageKey===oldMustacheImage){node.imageKey=newMustacheImage}else if(node.imageKey===oldXmlImage){node.imageKey=newXmlImage}else if(node.imageKey===oldXmlRepeatImage){node.imageKey=newXmlRepeatImage}else if(node.imageKey===oldNamedRangeImage){node.imageKey=newNamedRangeImage}else if(node.imageKey===oldWorksheetImage){node.imageKey=newWorksheetImage}else if(node.imageKey===oldPdfImage){node.imageKey=newPdfImage}else if(node.imageKey===oldJsonImage){node.imageKey=newJsonImage}for(var i=0;i<node.nodes.length;i++){this.changePlaceholderImage(node.nodes[i],oldBookmarkImage,oldMustacheImage,oldXmlImage,oldXmlRepeatImage,oldNamedRangeImage,oldWorksheetImage,oldPdfImage,oldJsonImage,newBookmarkImage,newMustacheImage,newXmlImage,newXmlRepeatImage,newNamedRangeImage,newWorksheetImage,newPdfImage,newJsonImage,docGuid)}};PlaceholdersFlyout.prototype.changeDocumentProperties=function(documentGuid,displayName){var docNode=this.findDocumentNode(documentGuid);docNode.text=displayName};PlaceholdersFlyout.prototype.addDocument=function(doc){var bmNode=new Design.TreeNode(Design.TranslationHelper.KeywordValueToTranslation(this._filter,doc.Name),doc);bmNode.key=doc.DocumentGuid;bmNode.imageKey="icon-template";this.placeholdersTreeview.insertChild(this.placeholdersTreeview.nodes.length-1,bmNode)};PlaceholdersFlyout.prototype.removeDocument=function(documentGuid){this.placeholdersTreeview.nodes.splice(this.placeholdersTreeview.nodes.indexOf(this.findDocumentNode(documentGuid)),1)};PlaceholdersFlyout.prototype.searchPlaceholders=function(){this.createPlaceholderTree();this.resetState(this._sourcePlaceholders);this.loadContentPlaceholders(this._docFragNode);if(!System.String.IsNullOrEmpty(this.searchValue)){this.placeholdersTreeview.expandAll();this.placeholdersTreeview.nodes[0].collapse();this.placeholdersTreeview.nodes[1].collapse()}};PlaceholdersFlyout.prototype.findPossibleCloseGap=function(placeholder){var results;var placeholderName;var nodes=this.documentFragmentNodes;if(placeholder.type===Intelledox.Model.PlaceholderType.Bookmark||placeholder.type===Intelledox.Model.PlaceholderType.Slide){placeholderName=placeholder.name}else{placeholderName=System.String.Trim(placeholder.name,"{}")}results=this.placeholdersTreeview.findNodeByKey(null,placeholderName+"_gap~"+Intelledox.Model.PlaceholderType.Bookmark.toString(),true);if(results.length>0){return results[0].reference}results=this.placeholdersTreeview.findNodeByKey(null,placeholderName+"_cg~"+Intelledox.Model.PlaceholderType.Bookmark.toString(),true);if(results.length>0){return results[0].reference}results=this.placeholdersTreeview.findNodeByKey(null,"{{#"+placeholderName+"_gap}}~"+Intelledox.Model.PlaceholderType.Mustache.toString(),true);if(results.length>0){return results[0].reference}results=this.placeholdersTreeview.findNodeByKey(null,"{{#"+placeholderName+"_cg}}~"+Intelledox.Model.PlaceholderType.Mustache.toString(),true);if(results.length>0){return results[0].reference}results=this.placeholdersTreeview.findNodeByKey(null,"{{#"+placeholderName+"}}~"+Intelledox.Model.PlaceholderType.Mustache.toString(),true);if(results.length>0){return results[0].reference}return null};PlaceholdersFlyout.prototype.colourPlaceholdersFromList=function(placeholders,used){for(var i=0;i<placeholders.length;i++){var bm=placeholders[i];var external=false;this.colourPlaceholder(bm.reference,external,used,bm.documentGuid)}};PlaceholdersFlyout.prototype.doPlaceholderColouringFromDropdown=function(dropDown,newValue,oldValue,colourAll,placeholder){var external=true;var docGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;for(var i=0;i<dropDown.length;i++){var itm=dropDown[i];if(itm.reference.equals(oldValue)){external=false;if(!colourAll){docGuid=itm.documentGuid}break}}if(placeholder==null||!placeholder.Reference.equals(oldValue)){this.colourPlaceholder(oldValue,external,false,docGuid)}external=true;docGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;for(var i=0;i<dropDown.length;i++){var itm=dropDown[i];if(itm.reference.equals(newValue)){external=false;if(!colourAll){docGuid=itm.documentGuid}break}}if(placeholder==null||!placeholder.Reference.equals(newValue)){this.colourPlaceholder(newValue,external,true,docGuid)}return external};PlaceholdersFlyout.prototype.markBookmarkAsUsed=function(placeholderNode){var bmImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(placeholderNode.reference.type,placeholderNode.tag.DocumentGuid,this._wizard);placeholderNode.imageKey=bmImage;placeholderNode.isFaded=true};PlaceholdersFlyout.prototype.markBookmarkAsUnused=function(placeholderNode){var bmImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(placeholderNode.reference.type,placeholderNode.tag.DocumentGuid,this._wizard);placeholderNode.imageKey=bmImage;placeholderNode.isFaded=false};PlaceholdersFlyout.prototype.loadResponseMetadataFields=function(tree){if(tree.key==="responseMetadata"){var vm=this;tree.clear();vm._lists.responseMetadataFields().then(function(responseMetadatafields){var usedResponseMetadataFields=[];Design.HelperFunctions.ForAllResponseMetadataFields(vm._wizard,function(rmf){usedResponseMetadataFields.push(rmf)});for(var i=0;i<responseMetadatafields.length;i++){if(Intelledox.Common.Functions.ContainsIgnoreCase(responseMetadatafields[i].name,vm.searchValue)){var responseMetadataField=new Intelledox.QAWizard.Design.ResponseMetadataField;responseMetadataField.ResponseMetadataFieldGuid=responseMetadatafields[i].responseMetadataFieldGuid;var responseMetadataPlaceholderNode=new Design.TreeNode(responseMetadatafields[i].name,responseMetadataField);if(usedResponseMetadataFields.filter(function(used){return used.ResponseMetadataFieldGuid===responseMetadataField.ResponseMetadataFieldGuid}).length===0){responseMetadataPlaceholderNode.imageKey="icon-responsemetadata"}else{responseMetadataPlaceholderNode.imageKey="icon-responsemetadataused"}vm._responseMetadataNode.addChild(responseMetadataPlaceholderNode)}}vm._responseMetadataNode.sort()})}};PlaceholdersFlyout.prototype.appendContentItemReference=function(content){var contentNode=null;if(content.ContentTypeId===Intelledox.Model.ContentType.DocumentFragment){for(var i=0;i<this._docFragNode.nodes.length;i++){if(this._docFragNode.nodes[i].tag===content.ContentItemGuid){contentNode=this._docFragNode.nodes[i]}}if(contentNode==null){contentNode=new Design.TreeNode(this._filter('translate')('ContentItem'),content.ContentItemGuid);contentNode.key=content.ContentItemGuid;contentNode.imageKey="icon-contentfragment";this._docFragNode.addChild(contentNode);this._lists.getContentItems().then(function(contentItems){for(var i=0;i<contentItems.length;i++){if(contentItems[i].contentItemGuid===content.ContentItemGuid){contentNode.text=contentItems[i].name;break}}})}}return contentNode};PlaceholdersFlyout.prototype.markExternalBookmarkAsUsed=function(placeholderNode){if(placeholderNode.reference.type===Intelledox.Model.PlaceholderType.Bookmark){placeholderNode.imageKey="icon-externalbookmarkused"}else if(placeholderNode.reference.type===Intelledox.Model.PlaceholderType.Slide){placeholderNode.imageKey=""}else{placeholderNode.imageKey="icon-externalmustacheused"}placeholderNode.isFaded=true};PlaceholdersFlyout.prototype.markExternalBookmarkAsUnused=function(placeholderNode){if(placeholderNode.reference.type===Intelledox.Model.PlaceholderType.Bookmark){placeholderNode.imageKey="icon-externalbookmark"}else if(placeholderNode.reference.type===Intelledox.Model.PlaceholderType.Slide){placeholderNode.imageKey=""}else{placeholderNode.imageKey="icon-externalmustache"}placeholderNode.isFaded=false};PlaceholdersFlyout.prototype.loadContentPlaceholders=function(tree){if(tree.nodes.length>0&&typeof tree.nodes[0].tag==='string'&&tree.nodes[0].tag==="placeholder"){var contentItems=[];var contentNode;var vm=this;tree.clear();this._usedExternalPlaceholders=[];Design.HelperFunctions.ForAllPlaceholders(this._wizard,function(b){if(b.External){vm._usedExternalPlaceholders.push(b.Reference)}});for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var page=this._wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<page.Questions.length;questionIndex++){var q=page.Questions[questionIndex];if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic){for(var answerIndex=0;answerIndex<q.Answers.length;answerIndex++){var a=q.Answers[answerIndex];for(var contentIndex=0;contentIndex<a.ContentItems.length;contentIndex++){var content=a.ContentItems[contentIndex];contentNode=this.appendContentItemReference(content);if(contentNode!=null){contentItems.push(content.ContentItemGuid)}}}}}}this.fillContentItemReference(contentItems);this._docFragNode.sort();this.placeholdersTreeview.selectedNode=this._docFragNode}};PlaceholdersFlyout.prototype.fillContentItemReference=function(contentItems){var vm=this;this._designApi.getContentItemPlaceholders(contentItems).then(function(contentPlaceholders){var contentNode=null;var newNode;var hasMatch=false;for(var i=0;i<contentPlaceholders.length;i++){var item=contentPlaceholders[i];for(var nodeIndex=0;nodeIndex<vm._docFragNode.nodes.length;nodeIndex++){if(vm._docFragNode.nodes[nodeIndex].tag===item.contentItemGuid){contentNode=vm._docFragNode.nodes[nodeIndex]}}if(contentNode==null){continue}var cloneArray=new Array;for(var p=0;p<item.placeholders.length;p++){var clone=new Intelledox.Model.PlaceholderReference;var obj=item.placeholders[p];for(var prop in obj){if(obj.hasOwnProperty(prop)){clone[prop]=obj[prop]}}cloneArray.push(clone)}hasMatch=false;var filteredPlaceholders;if(System.String.IsNullOrEmpty(vm.searchValue)){filteredPlaceholders=cloneArray}else{filteredPlaceholders=[];for(var placeIndex=0;placeIndex<cloneArray.length;placeIndex++){if(Intelledox.Common.Functions.ContainsIgnoreCase(cloneArray[placeIndex].name,vm.searchValue)){filteredPlaceholders.push(cloneArray[placeIndex])}}}for(var placeIndex=0;placeIndex<filteredPlaceholders.length;placeIndex++){var pl=filteredPlaceholders[placeIndex];newNode=new Design.PlaceholderTreeNode(pl.name,null);newNode.key=pl.name+"~"+pl.type.toString();newNode.reference=pl;newNode.documentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(pl.type===Intelledox.Model.PlaceholderType.Bookmark){newNode.imageKey="icon-externalbookmark"}else if(pl.type===Intelledox.Model.PlaceholderType.Slide){newNode.imageKey=""}else{newNode.imageKey="icon-externalmustache"}contentNode.addChild(newNode);if(vm.arrayContains(vm._usedExternalPlaceholders,pl)){vm.markExternalBookmarkAsUsed(newNode)}hasMatch=true}}})};PlaceholdersFlyout.prototype.findSectionPlaceholders=function(layout,placeholders){for(var i=0;i<layout.length;i++){var l=layout[i];if(l!=null){if(l instanceof Intelledox.QAWizard.Design.Section){var s=l;if(s.IsRepeated){for(var placeIndex=0;placeIndex<s.RepeatPlaceholders.length;placeIndex++){var bm=s.RepeatPlaceholders[placeIndex];for(var docGuid in placeholders){if(placeholders.hasOwnProperty(docGuid)){placeholders[docGuid].push(bm)}}}}}if(typeof l.HasContainerInterface!=="undefined"){this.findSectionPlaceholders(l.Children,placeholders)}}}};PlaceholdersFlyout.prototype.arrayContains=function(placeholderArray,placeholder){for(var i=0;i<placeholderArray.length;i++){if(placeholderArray[i].equals(placeholder)){return true}}return false};PlaceholdersFlyout.prototype.arrayRemove=function(placeholderArray,placeholder){for(var i=0;i<placeholderArray.length;i++){if(placeholderArray[i].equals(placeholder)){placeholderArray.splice(i,1)}}};PlaceholdersFlyout.prototype.placeholderIsBlank=function(placeholderName){return(placeholderName==null||System.String.IsNullOrEmpty(placeholderName.name)||placeholderName.name===this._filter('translate')('NoneWithBrackets'))};PlaceholdersFlyout.prototype.documentFragmentsFilled=function(){return(!(this._docFragNode.nodes.length===1&&this._docFragNode.nodes[0].tag==="placeholder"))};PlaceholdersFlyout.prototype.findDocumentNode=function(docGuid){for(var i=0;i<this.placeholdersTreeview.nodes.length;i++){if(this.placeholdersTreeview.nodes[i].tag instanceof Intelledox.QAWizard.Design.DocumentTemplate&&this.placeholdersTreeview.nodes[i].tag.DocumentGuid===docGuid){return this.placeholdersTreeview.nodes[i]}}return null};PlaceholdersFlyout.prototype.addExternals=function(){var bMark=new Intelledox.Model.PlaceholderReference;bMark.name='';bMark.type=Intelledox.Model.PlaceholderType.Bookmark;var bookmarkExternal=new Design.PlaceholderTreeNode(this._filter('translate')('ExternalPlaceholder'),null);bookmarkExternal.reference=bMark;bookmarkExternal.documentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;bookmarkExternal.imageKey='icon-externalbookmark';this.placeholdersTreeview.addChild(bookmarkExternal);bMark=new Intelledox.Model.PlaceholderReference;bMark.name='';bMark.type=Intelledox.Model.PlaceholderType.Mustache;bookmarkExternal=new Design.PlaceholderTreeNode(this._filter('translate')('ExternalMustache'),null);bookmarkExternal.reference=bMark;bookmarkExternal.documentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;bookmarkExternal.imageKey='icon-externalmustache';this.placeholdersTreeview.addChild(bookmarkExternal)};return PlaceholdersFlyout}());Design.PlaceholdersFlyout=PlaceholdersFlyout})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var ContentItemSearchOptions=(function(){function ContentItemSearchOptions(){this.name='';this.description='';this.contentTypeId=-1;this.categoryId=null;this.fullText='';this.folderGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.noFolder=false;this.userId=Intelledox.Common.ConstantValues.GUID_EMPTY}return ContentItemSearchOptions}());Model.ContentItemSearchOptions=ContentItemSearchOptions})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var FormatType=(function(){function FormatType(){this.formatTypeId=Model.TemplateFormatType.None;this.name=null}FormatType.GetID=function(name){switch(name.toLowerCase()){case".doc":case".dot":return Model.TemplateFormatType.WordBinary;case".docx":case".dotx":return Model.TemplateFormatType.WordDocx;case".docm":return Model.TemplateFormatType.WordDocm;case".pptx":return Model.TemplateFormatType.PowerPointPptx;case".xsd":return Model.TemplateFormatType.Xsd;case".xlsx":return Model.TemplateFormatType.ExcelXlsx;case".xlsm":return Model.TemplateFormatType.ExcelXlsm;case".pdf":return Model.TemplateFormatType.Pdf;case".txt":return Model.TemplateFormatType.Txt;case".html":return Model.TemplateFormatType.Html;case".csv":return Model.TemplateFormatType.Csv;case".json":return Model.TemplateFormatType.Json;default:return Model.TemplateFormatType.None}};FormatType.GetExtension=function(formatTypeId){switch(formatTypeId){case Model.TemplateFormatType.WordBinary:return".doc";case Model.TemplateFormatType.WordDocx:return".docx";case Model.TemplateFormatType.WordDocm:return".docm";case Model.TemplateFormatType.PowerPointPptx:return".pptx";case Model.TemplateFormatType.Xsd:return".xsd";case Model.TemplateFormatType.ExcelXlsx:return".xlsx";case Model.TemplateFormatType.ExcelXlsm:return".xlsm";case Model.TemplateFormatType.Pdf:return".pdf";case Model.TemplateFormatType.Txt:return".txt";case Model.TemplateFormatType.Html:return".html";case Model.TemplateFormatType.Csv:return".csv";case Model.TemplateFormatType.Json:return".json";default:return""}};FormatType.validExtensions=function(){return'docx, docm, doc, dotx, dot, pptx, xlsx, xlsm, xsd, pdf, txt, html, csv, json'};return FormatType}());Model.FormatType=FormatType})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var Category=(function(){function Category(){this.categoryId=0;this.name=null}return Category}());Model.Category=Category})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var ProjectDefinitionResponse=(function(){function ProjectDefinitionResponse(){}return ProjectDefinitionResponse}());Model.ProjectDefinitionResponse=ProjectDefinitionResponse})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var PlaceholderListItem=(function(){function PlaceholderListItem(reference,documentGuid){this.documentGuid=documentGuid;this.reference=reference}Object.defineProperty(PlaceholderListItem.prototype,"displayString",{get:function(){var ret=this.reference.name;if(!System.String.IsNullOrEmpty(this.reference.schemaNamespace)){ret=ret.replace(this.reference.schemaNamespace,"")}return ret},enumerable:true,configurable:true});return PlaceholderListItem}());Design.PlaceholderListItem=PlaceholderListItem})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var DocumentInterfaceResults=(function(){function DocumentInterfaceResults(){this.placeholders=null;this.styles=null}return DocumentInterfaceResults}());Model.DocumentInterfaceResults=DocumentInterfaceResults})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var ContentPlaceholderResult=(function(){function ContentPlaceholderResult(){this.contentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.placeholders=null}return ContentPlaceholderResult}());Model.ContentPlaceholderResult=ContentPlaceholderResult})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var SearchResults=(function(){function SearchResults(){this.id=Intelledox.Common.ConstantValues.GUID_EMPTY;this.name=null}return SearchResults}());Model.SearchResults=SearchResults})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var CalcEngine;(function(CalcEngine_1){var Design;(function(Design){var CalcEngine=(function(){function CalcEngine(){this.m_VariableStack=null}CalcEngine.prototype.ParseQuotedStrings=function(calculateFormula){var i=calculateFormula.indexOf('"');if(i>-1){var openQuote=true;var openQuoteIndex=i;while(i<calculateFormula.length){i=calculateFormula.indexOf('"',i+1);if(i>-1){if(openQuote){if(i<calculateFormula.length-1&&calculateFormula[i+1]==='"'){i++}else{openQuote=false;var replacementString=this.AddVariableString(System.String.Substring(calculateFormula,openQuoteIndex+1,i-openQuoteIndex-1).replace("\"\"","\""));calculateFormula=System.String.Remove(calculateFormula,openQuoteIndex,i-openQuoteIndex+1);calculateFormula=System.String.Insert(calculateFormula,openQuoteIndex,replacementString);i=openQuoteIndex+replacementString.length-1}}else{openQuote=true;openQuoteIndex=i}}else{break}}if(openQuote){throw"Invalid formula";}}return calculateFormula};CalcEngine.prototype.ExtractNumber=function(formula,startIndex,isLeft){var i=0;var leftPosition=-1;var rightPosition=-1;var returnValue=-1;var returnPosition=-1;var decimalSymbol='.';var positiveSymbol='+';var negativeSymbol='-';if(isLeft){i=startIndex-1;while(true){if(i<0){break}var currentChar=formula[i];if(currentChar==='}'){var refIndex=i;i=formula.lastIndexOf('{',i);if(i===-1){throw"Expected number";}var stackValue=this.m_VariableStack[Intelledox.Common.Functions.FastPartialStringToInt(formula,i+2,refIndex-i-2)].Value;returnPosition=i;returnValue=parseFloat(stackValue);if(!isNaN(returnValue)){return{num:returnValue,returnPosition:returnPosition}}else{throw"Expected number";}}if(System.Char.IsDigit(currentChar)||currentChar===decimalSymbol){leftPosition=i;if(rightPosition===-1){rightPosition=i}i--}else if(currentChar===' '){i--}else if(currentChar===positiveSymbol||currentChar===negativeSymbol){var includeSign=false;if(i===0){includeSign=true}else{var prevChar=formula[i-1];includeSign=(prevChar==='+'||prevChar==='-'||prevChar==='*'||prevChar==='/')}if(includeSign){leftPosition=i;if(rightPosition===-1){rightPosition=i}i--;break}else{break}}else{break}}}else{var hasSign=false;var formulaLength=formula.length;i=startIndex+1;while(true){if(i>=formulaLength){break}var currentChar=formula[i];if(currentChar==='{'){var refIndex=formula.indexOf('}',i);if(refIndex===-1){throw"Expected number";}var stackValue=this.m_VariableStack[Intelledox.Common.Functions.FastPartialStringToInt(formula,i+2,refIndex-i-2)].Value;returnPosition=refIndex;returnValue=parseFloat(stackValue);if(!isNaN(returnValue)){return{num:returnValue,returnPosition:returnPosition}}else{throw"Expected number";}}if(System.Char.IsDigit(currentChar)||currentChar===decimalSymbol){rightPosition=i;if(leftPosition===-1){leftPosition=i}i++}else if(currentChar===' '){i++}else if(!hasSign&&(currentChar===positiveSymbol||currentChar===negativeSymbol)){if(rightPosition===-1){rightPosition=i;if(leftPosition===-1){leftPosition=i}hasSign=true;i++}else{break}}else{break}}}var value=System.String.Substring(formula,leftPosition,rightPosition-leftPosition+1);var decValue=parseFloat(value);if(!isNaN(decValue)){returnPosition=i+(isLeft?1:-1);return{num:decValue,returnPosition:returnPosition}}else{throw"Expected number";}};CalcEngine.prototype.ContainsFunction=function(formula,exactMatch){if(exactMatch){for(var i=0;i<CalcEngine.m_FunctionList.length;i++){if(Intelledox.Common.Functions.EqualsIgnoreCase(CalcEngine.m_FunctionList[i],formula)){return true}}return false}else{for(var i=0;i<CalcEngine.m_FunctionList.length;i++){{if(Intelledox.Common.Functions.ContainsIgnoreCase(formula,CalcEngine.m_FunctionList[i])){return true}}return false}}};CalcEngine.prototype.IsValidFormula=function(formula){var resultDecimal=0;var i=0;var leftNum=0;var rightNum=0;var leftPos=0;var rightPos=0;var numResult;try{if(System.String.IsNullOrEmpty(formula)){return true}if(formula==="\"VALIDATED\""||formula==="=\"VALIDATED\""){return true}if(!Intelledox.Common.Functions.IsNumeric(formula)){var testOperators=new RegExp("[(*+-/\\^]|mod");if(!testOperators.test(formula)){return false}}formula=this.ParseQuotedStrings(formula);while(formula.indexOf('(')>-1){var lastFormula=formula;formula=this.ParseQuotedStrings(formula);if(formula.indexOf('(')===-1){if(System.String.StartsWith(formula,"{s")&&System.String.EndsWith(formula,'}')){formula=this.m_VariableStack[Intelledox.Common.Functions.FastPartialStringToInt(formula,2,formula.length-3)].Value.toString();formula=System.String.Substring(formula,1,formula.length-2);formula=formula.replace("\"\"","\"")}break}i=formula.lastIndexOf('(');var subFormula=System.String.Substring(formula,i+1,formula.substring(i+1).indexOf(')'));var functionResult=this.ValidateFunction(formula,i,subFormula);formula=functionResult.formula;if(!functionResult.valid){if(!this.IsValidFormula(subFormula)){return false}formula=Intelledox.Common.Functions.Left(formula,i)+this.ReplaceFirst(formula,"("+subFormula+")","\"VALIDATED\"",i)}if(lastFormula===formula){break}}var formulaWithNumbers=formula.replace("\"VALIDATED\"","1");if(this.m_VariableStack!=null){for(var quotedStringIndex=0;quotedStringIndex<this.m_VariableStack.length;quotedStringIndex++){if(this.m_VariableStack[quotedStringIndex].Value.toString()==="VALIDATED"){formulaWithNumbers=formulaWithNumbers.replace("{s"+quotedStringIndex.toString()+"}","1")}}}if(formulaWithNumbers.indexOf('#')===-1&&formulaWithNumbers.indexOf('"')===-1){while(formulaWithNumbers.indexOf('^')>-1||formulaWithNumbers.indexOf("mod")>-1){var lastFormula=formulaWithNumbers;if(formulaWithNumbers.indexOf('^')>-1){i=formulaWithNumbers.indexOf('^');numResult=this.ExtractNumber(formulaWithNumbers,i,false);rightNum=numResult.num;rightPos=numResult.returnPosition}else{i=formulaWithNumbers.indexOf("mod");numResult=this.ExtractNumber(formulaWithNumbers,i+2,false);rightNum=numResult.num;rightPos=numResult.returnPosition}numResult=this.ExtractNumber(formulaWithNumbers,i,true);leftNum=numResult.num;leftPos=numResult.returnPosition;formulaWithNumbers=Intelledox.Common.Functions.Left(formulaWithNumbers,leftPos)+this.ReplaceFirst(formulaWithNumbers,System.String.Substring(formulaWithNumbers,leftPos,rightPos-leftPos+1),"1",leftPos);if(lastFormula===formulaWithNumbers){break}}while(formulaWithNumbers.indexOf('*')>-1||formulaWithNumbers.indexOf('/')>-1){var lastFormula=formulaWithNumbers;if((formulaWithNumbers.indexOf('*')>-1&&(formulaWithNumbers.indexOf('*')<formulaWithNumbers.indexOf('/')))||formulaWithNumbers.indexOf('/')===-1){i=formulaWithNumbers.indexOf('*')}else{i=formulaWithNumbers.indexOf('/')}numResult=this.ExtractNumber(formulaWithNumbers,i,true);leftNum=numResult.num;leftPos=numResult.returnPosition;numResult=this.ExtractNumber(formulaWithNumbers,i,false);rightNum=numResult.num;rightPos=numResult.returnPosition;if((formulaWithNumbers.indexOf('*')>-1&&(formulaWithNumbers.indexOf('*')<formulaWithNumbers.indexOf('/')))||formulaWithNumbers.indexOf('/')===-1){resultDecimal=(leftNum*rightNum)}else{if(rightNum===0){return false}resultDecimal=(leftNum/rightNum)}formulaWithNumbers=Intelledox.Common.Functions.Left(formulaWithNumbers,leftPos)+this.ReplaceFirst(formulaWithNumbers,System.String.Substring(formulaWithNumbers,leftPos,rightPos-leftPos+1),"1",leftPos);if(lastFormula===formulaWithNumbers){break}}while(formulaWithNumbers.indexOf('+',1)>-1||formulaWithNumbers.indexOf('-',1)>-1){var lastFormula=formulaWithNumbers;if((formulaWithNumbers.indexOf('+',1)>-1&&(formulaWithNumbers.indexOf('+',1)<formulaWithNumbers.indexOf('-',1)))||formulaWithNumbers.indexOf('-',1)===-1){i=formulaWithNumbers.indexOf('+',1)}else{i=formulaWithNumbers.indexOf('-',1)}numResult=this.ExtractNumber(formulaWithNumbers,i,true);leftNum=numResult.num;leftPos=numResult.returnPosition;numResult=this.ExtractNumber(formulaWithNumbers,i,false);rightNum=numResult.num;rightPos=numResult.returnPosition;formulaWithNumbers=Intelledox.Common.Functions.Left(formulaWithNumbers,leftPos)+this.ReplaceFirst(formulaWithNumbers,System.String.Substring(formulaWithNumbers,leftPos,rightPos-leftPos+1),"1",leftPos);if(lastFormula===formulaWithNumbers){break}}}return true}catch(ex){return false}};CalcEngine.prototype.ValidateFunction=function(formula,bracketIndex,parameterString){var isFunction=false;var firstIndex=0;var checkStr=Intelledox.Common.Functions.Left(formula,bracketIndex);for(var i=checkStr.length-1;i>=0;i--){var a=checkStr[i];if((a>='a'&&a<='z')||(a>='A'&&a<='Z')||(a>='1'&&a<='0')){}else{firstIndex=i+1;break}}if(this.ContainsFunction(checkStr.substring(firstIndex),true)){isFunction=true;var startIndex=bracketIndex-checkStr.substring(firstIndex).length;var endIndex=formula.indexOf(')',bracketIndex);formula=Intelledox.Common.Functions.Left(formula,startIndex)+"\"VALIDATED\""+formula.substring(endIndex+1)}else if(!System.String.IsNullOrEmpty(checkStr.substring(firstIndex))){throw"Invalid function name";}return{valid:isFunction,formula:formula}};CalcEngine.prototype.AddVariableString=function(value){return this.AddVariable(value,false)};CalcEngine.prototype.AddVariable=function(value,isConvertible){if(this.m_VariableStack==null){this.m_VariableStack=[]}var newValue=new StackValue;newValue.IsConvertible=isConvertible;newValue.Value=value;this.m_VariableStack.push(newValue);return"{s"+(this.m_VariableStack.length-1).toString()+"}"};CalcEngine.prototype.ReplaceFirst=function(text,search,replace,startIndex){text=text.substring(startIndex);var pos=text.indexOf(search);if(pos<0){return text}return System.String.Substring(text,0,pos)+replace+text.substring(pos+search.length)};CalcEngine.prototype.ClearStack=function(){this.m_VariableStack=null};CalcEngine.m_FunctionList=["Round","RangeIndex","DateDiff","ErrorMask","Abs","IsTrue","Today","UtcToday","Now","UtcNow","DateAdd","Concat","Format","IsEqual","IsNotEqual","IsGreaterThan","IsGreaterThanOrEqualTo","IsLessThan","IsLessThanOrEqualTo","ProperCase","First","Last","Substring","Left","Right","IIf","Chr","Sum","CountNumber","Count","Average","Min","Max","Join","JoinAnd","Contains","StringContains","NotContains","Replace","StartsWith","EndsWith","CountIf","Trim","Len","Length","UtcToLocal","LocalToUtc"];return CalcEngine}());Design.CalcEngine=CalcEngine;var StackValue=(function(){function StackValue(){this.IsConvertible=false;this.Value=null}return StackValue}());Design.StackValue=StackValue})(Design=CalcEngine_1.Design||(CalcEngine_1.Design={}))})(CalcEngine=Intelledox.CalcEngine||(Intelledox.CalcEngine={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var AnswerExpressionBuilder=(function(){function AnswerExpressionBuilder(){this.ErrorDescription=""}AnswerExpressionBuilder.ParseExpressions=function(content){return Intelledox.Common.Functions.ParseExpressions(content)};AnswerExpressionBuilder.ExtractQuestionRef=function(refString){return Intelledox.Common.Functions.ExtractQuestionReference(refString)};AnswerExpressionBuilder.ExtractActionRef=function(refString){return Intelledox.Common.Functions.ExtractActionReference(refString)};AnswerExpressionBuilder.prototype.FindQuestionByRef=function(expression,wizard,stopQuestionGuid,currentAnswer){var qReference=AnswerExpressionBuilder.ExtractQuestionRef(expression);if(qReference.hasAnswerRef){return{question:wizard.FindQuestionById(qReference.questionRef,stopQuestionGuid),hasAnswerRef:qReference.hasAnswerRef}}else{if(Intelledox.Common.Functions.IsUInt(qReference.questionRef)){return{question:wizard.FindQuestionById(qReference.questionRef,stopQuestionGuid),hasAnswerRef:qReference.hasAnswerRef}}else if(currentAnswer!=null){return{question:currentAnswer.Question,hasAnswerRef:qReference.hasAnswerRef}}}return{question:null,hasAnswerRef:qReference.hasAnswerRef}};AnswerExpressionBuilder.ExtractAnswerRef=function(refString){var dotPos=refString.indexOf('.');var pipePos=refString.indexOf('|');if(dotPos>-1&&(pipePos===-1||dotPos<pipePos)){if(pipePos>-1){return System.String.Substring(refString,dotPos+1,(pipePos-1)-dotPos)}else{if(System.String.EndsWith(refString,']')){return System.String.Substring(refString,dotPos+1,refString.length-dotPos-2)}return refString.substring(dotPos+1)}}else{if(pipePos>-1){return System.String.Substring(refString,1,pipePos-1)}else{return System.String.Trim(refString,'[]')}}};AnswerExpressionBuilder.FindAnswerByRef=function(answerRef,parentQuestion){if(answerRef==null){return null}if(Intelledox.Common.Functions.IsUInt(answerRef)){var intId=parseInt(answerRef,10);for(var i=0;i<parentQuestion.Answers.length;i++){if(parentQuestion.Answers[i].ID===intId){return parentQuestion.Answers[i]}}return null}for(var i=0;i<parentQuestion.Answers.length;i++){if(parentQuestion.Answers[i].Name===answerRef){return parentQuestion.Answers[i]}}return null};AnswerExpressionBuilder.prototype.IsValidFormula=function(formula,wizard,currentAnswer,stopQuestionGuid,dataFields,checkActionRef,fragmentOutputs){var dereferencedFormula=this.ValidateReferences(formula,wizard,currentAnswer,stopQuestionGuid,dataFields,checkActionRef,fragmentOutputs);if(!System.String.IsNullOrEmpty(this.ErrorDescription)){return false}var calc=new Intelledox.CalcEngine.Design.CalcEngine;return calc.IsValidFormula(dereferencedFormula)};AnswerExpressionBuilder.prototype.ValidateReferences=function(formula,wizard,currentAnswer,stopQuestionGuid,dataFields,checkActionRef,fragmentOutputs){var result=formula;var references=AnswerExpressionBuilder.ParseExpressions(formula);for(var refIndex=0;refIndex<references.length;refIndex++){var reference=references[refIndex];if(System.String.StartsWithIgnoreCase(reference,"["+Intelledox.Common.ConstantValues.PREVIOUS+".")){var referenceToValidate=reference;var previousLength=Intelledox.Common.ConstantValues.PREVIOUS.length+2;referenceToValidate="["+System.String.Substring(reference,previousLength,reference.length-previousLength);if(!this.IsValidReference(referenceToValidate,wizard,currentAnswer,Intelledox.Common.ConstantValues.GUID_EMPTY,dataFields)){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(reference,'[]')+"@@";return""}}else if(System.String.StartsWithIgnoreCase(reference,"["+Intelledox.Common.ConstantValues.PROTECT+".")){var referenceToValidate=reference;var previousLength=Intelledox.Common.ConstantValues.PROTECT.length+2;referenceToValidate="["+System.String.Substring(reference,previousLength,reference.length-previousLength);if(!this.IsValidReference(referenceToValidate,wizard,currentAnswer,Intelledox.Common.ConstantValues.GUID_EMPTY,dataFields)){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(reference,'[]')+"@@";return""}}else if(System.String.StartsWithIgnoreCase(reference,"["+Intelledox.Common.ConstantValues.CHOICE+".")&&System.String.EndsWith(reference,']')){var referenceToValidate=reference;var previousLength=Intelledox.Common.ConstantValues.CHOICE.length+2;referenceToValidate="["+System.String.Substring(reference,previousLength,reference.length-previousLength);if(!this.IsValidReference(referenceToValidate,wizard,currentAnswer,Intelledox.Common.ConstantValues.GUID_EMPTY,dataFields)){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(reference,'[]')+"@@";return""}}else if(System.String.StartsWithIgnoreCase(reference,"[q")&&System.String.EndsWith(reference,']')){if(!this.IsValidReference(reference,wizard,currentAnswer,stopQuestionGuid,dataFields)){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(reference,'[]')+"@@";return""}}else if(AnswerExpressionBuilder.IsInputReference(reference)){var inputName=AnswerExpressionBuilder.ExtractAnswerRef(reference);var foundInput=false;for(var i=0;i<wizard.AvailableInputs.length;i++){var availableInput=wizard.AvailableInputs[i];if(Intelledox.Common.Functions.EqualsIgnoreCase(availableInput.description,inputName)){foundInput=true;break}}if(!foundInput){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(reference,'[]')+"@@";return""}}else if(AnswerExpressionBuilder.IsFragmentReference(reference)){var fragmentName=AnswerExpressionBuilder.ExtractFragmentRef(reference);var referencedFragment=wizard.FindFragment(fragmentName,stopQuestionGuid);if(referencedFragment==null){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(reference,'[]')+"@@";return""}else{var outputName=AnswerExpressionBuilder.ExtractOutputNameRef(reference);var foundOutput=false;var referencedFragmentOutputs=fragmentOutputs[referencedFragment.ObjectId];if(referencedFragmentOutputs!=null){for(var i=0;i<referencedFragmentOutputs.length;i++){var output=referencedFragmentOutputs[i];if(Intelledox.Common.Functions.EqualsIgnoreCase(output.Name,outputName)){foundOutput=true;break}}}if(!foundOutput){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(reference,'[]')+"@@";return""}}}else if(System.String.StartsWith(reference,'[')&&System.String.EndsWith(reference,']')&&(reference.indexOf('.')>-1)){if(checkActionRef){var actionRef=System.String.Substring(reference,1,reference.indexOf('.')-1);var hasReference=false;for(var i=0;i<wizard.Actions.length;i++){var action=wizard.Actions[i];if(Intelledox.Common.Functions.EqualsIgnoreCase(action.Name,actionRef)){hasReference=true;break}}if(!hasReference){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(reference,'[]')+"@@";return""}}}result=result.replace(reference,'"VALIDATED"')}return result};AnswerExpressionBuilder.prototype.IsValidReference=function(expression,wizard,currentAnswer,stopQuestionGuid,dataFields){var qReference;var refQuestion=null;var foundSelected=false;qReference=this.FindQuestionByRef(expression,wizard,stopQuestionGuid,currentAnswer);refQuestion=qReference.question;if(refQuestion==null){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(expression,'[]')+"@@";return false}var answerRef=AnswerExpressionBuilder.ExtractAnswerRef(expression);switch(refQuestion.QuestionTypeID){case Design.QuestionType.QuestionTypeEnum.AddressPrompt:case Design.QuestionType.QuestionTypeEnum.Variable:case Design.QuestionType.QuestionTypeEnum.Geolocation:var refAnswer=AnswerExpressionBuilder.FindAnswerByRef(answerRef,refQuestion);if(refAnswer==null){this.ErrorDescription="@@ERROR@@";return false}break;case Design.QuestionType.QuestionTypeEnum.Datasource:var fieldValue=null;if(refQuestion.IsQARepeater){return true}else if(refQuestion.DataSourceHierarchyGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){if(dataFields.hasOwnProperty(refQuestion.DataObjectGuid)){for(var i=0;i<dataFields[refQuestion.DataObjectGuid].length;i++){if(dataFields[refQuestion.DataObjectGuid][i].name===answerRef){fieldValue=dataFields[refQuestion.DataObjectGuid][i];break}}}}else{var dataQuestion=refQuestion;var parentDataQuestion=dataQuestion.GetRootDatasourceQuestion(wizard);if(dataFields.hasOwnProperty(parentDataQuestion.DataObjectGuid)){var path="";if(dataQuestion.DataSourceRepeatXPath!=null){path=dataQuestion.DataSourceRepeatXPath}for(var i=0;i<dataFields[parentDataQuestion.DataObjectGuid].length;i++){var field=dataFields[parentDataQuestion.DataObjectGuid][i];if((System.String.StartsWith(path,field.name)&&Intelledox.Common.Functions.NotEqualsIgnoreCase(field.name,path)&&Intelledox.Common.Functions.EqualsIgnoreCase(field.name,answerRef))||(Intelledox.Common.Functions.EqualsIgnoreCase(field.name,"[RowNumber]")||Intelledox.Common.Functions.EqualsIgnoreCase(field.name,"[RowCount]"))){fieldValue=field;break}}}}if(fieldValue==null){var foundAnswer=false;if(Intelledox.Common.Functions.EqualsIgnoreCase(answerRef,"rowcount")||Intelledox.Common.Functions.EqualsIgnoreCase(answerRef,"rownumber")){foundAnswer=true}else{for(var i=0;i<refQuestion.Answers.length;i++){var a=refQuestion.Answers[i];if(Intelledox.Common.Functions.EqualsIgnoreCase(a.Name,answerRef)||a.ID.toString()===answerRef){foundAnswer=true;break}}}if(!foundAnswer){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(expression,'[]')+"@@";return false}}break;case Design.QuestionType.QuestionTypeEnum.ContentLibrary:if(Intelledox.Common.Functions.NotEqualsIgnoreCase(answerRef,"filename")&&Intelledox.Common.Functions.NotEqualsIgnoreCase(answerRef,"hex")&&Intelledox.Common.Functions.NotEqualsIgnoreCase(answerRef,"base64")&&Intelledox.Common.Functions.NotEqualsIgnoreCase(answerRef,"filesize")){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(expression,'[]')+"@@";return false}break;case Design.QuestionType.QuestionTypeEnum.UserPrompt:case Design.QuestionType.QuestionTypeEnum.Label:case Design.QuestionType.QuestionTypeEnum.RichText:case Design.QuestionType.QuestionTypeEnum.Numeric:if(refQuestion.Answers.length===0){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(expression,'[]')+"@@";return false}break;case Design.QuestionType.QuestionTypeEnum.RunActionButton:var answerRef="["+AnswerExpressionBuilder.ExtractAnswerRef(expression)+"]";var qRef=AnswerExpressionBuilder.ExtractActionRef(answerRef);if(!Intelledox.Design.EditorViewModel.findActionName(wizard,qRef)){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(expression,'[]')+"@@";return false}break;default:if(foundSelected){if(refQuestion.Answers.length===0){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(expression,'[]')+"@@";return false}}else if(AnswerExpressionBuilder.FindAnswerByRef(answerRef,refQuestion)==null){if(refQuestion.Answers.length===0){this.ErrorDescription="@@REFERENCE ERROR: "+System.String.Trim(expression,'[]')+"@@";return false}}break}return true};AnswerExpressionBuilder.CreateReference=function(refQuestion,refAnswer){var refText="";if(refAnswer==null){switch(refQuestion.QuestionTypeID){case Design.QuestionType.QuestionTypeEnum.UserPrompt:case Design.QuestionType.QuestionTypeEnum.GroupLogic:case Design.QuestionType.QuestionTypeEnum.SimpleLogic:case Design.QuestionType.QuestionTypeEnum.Label:case Design.QuestionType.QuestionTypeEnum.RichText:case Design.QuestionType.QuestionTypeEnum.Numeric:refText="[q"+refQuestion.ID.toString()+"]";break;case Design.QuestionType.QuestionTypeEnum.Ink:case Design.QuestionType.QuestionTypeEnum.ContentLibrary:refText="[q"+refQuestion.ID.toString()+".base64]";break;default:refText="[q"+refQuestion.ID.toString()+".]";break}}else{switch(refQuestion.QuestionTypeID){case Design.QuestionType.QuestionTypeEnum.Datasource:switch(refAnswer.DataField){case"":case"[Formula]":case"[Aggregate]":case"[RowCount]":case"[RowNumber]":case"[RowId]":refText="[q"+refQuestion.ID.toString()+"."+refAnswer.ID.toString()+"]";break;default:if(refAnswer.DataConvertType===Design.DataConvertType.None&&refAnswer.DataField.indexOf("[")===-1&&refAnswer.DataField.indexOf("]")===-1&&refAnswer.DataField.indexOf(".")===-1&&refAnswer.DataField.indexOf("|")===-1){refText="[q"+refQuestion.ID.toString()+"."+refAnswer.DataField+"]"}else{refText="[q"+refQuestion.ID.toString()+"."+refAnswer.ID.toString()+"]"}break}break;case Design.QuestionType.QuestionTypeEnum.UserPrompt:case Design.QuestionType.QuestionTypeEnum.Label:case Design.QuestionType.QuestionTypeEnum.RichText:case Design.QuestionType.QuestionTypeEnum.Numeric:case Design.QuestionType.QuestionTypeEnum.Ink:case Design.QuestionType.QuestionTypeEnum.ContentLibrary:refText=this.CreateReference(refQuestion,null);break;default:refText="[q"+refQuestion.ID.toString()+"."+refAnswer.ID.toString()+"]";break}}return refText};AnswerExpressionBuilder.CreateActionReference=function(node,refAction,refActionOutput){var parentActionButton=Intelledox.Design.EditorViewModel.getParentActionButtonQuestion(node);if(parentActionButton!==null){return"[q"+parentActionButton.tag.ID+"."+refAction.Name+"."+refActionOutput.name+"]"}else{return"["+refAction.Name+"."+refActionOutput.name+"]"}};AnswerExpressionBuilder.DeReference=function(wizard,reference){var result={parentQuestion:null,parentAnswer:null};var questionReference=this.ExtractQuestionRef(reference);result.parentQuestion=wizard.FindQuestionById(questionReference.questionRef,Intelledox.Common.ConstantValues.GUID_EMPTY,null);if(result.parentQuestion==null){return result}if(questionReference.hasAnswerRef){var answerReference=this.ExtractAnswerRef(reference);result.parentAnswer=this.FindAnswerByRef(answerReference,result.parentQuestion)}return result};AnswerExpressionBuilder.IsInputReference=function(expression){return System.String.StartsWithIgnoreCase(expression,"["+Intelledox.Common.ConstantValues.INPUT+".")};AnswerExpressionBuilder.IsFragmentReference=function(expression){return System.String.StartsWithIgnoreCase(expression,"["+Intelledox.Common.ConstantValues.FRAGMENT+".")};AnswerExpressionBuilder.ExtractFragmentRef=function(refString){if(refString!=null&&System.String.StartsWith(refString,"["+Intelledox.Common.ConstantValues.FRAGMENT+".")){var firstDotPos=refString.indexOf('.');var pipePos=refString.lastIndexOf('|');var lastDotPos=0;if(pipePos>-1){lastDotPos=refString.lastIndexOf('.',pipePos)}else{lastDotPos=refString.lastIndexOf('.')}if(lastDotPos>-1){return System.String.Substring(refString,firstDotPos+1,lastDotPos-firstDotPos-1)}}return""};AnswerExpressionBuilder.ExtractOutputNameRef=function(refString){if(refString!=null&&System.String.StartsWith(refString,"["+Intelledox.Common.ConstantValues.FRAGMENT+".")){var pipePos=refString.lastIndexOf('|');var lastDotPos=-1;if(pipePos>-1){lastDotPos=refString.lastIndexOf('.',pipePos);return System.String.Substring(refString,lastDotPos+1,(pipePos-1)-lastDotPos)}else{lastDotPos=refString.lastIndexOf('.');if(System.String.EndsWith(refString,']')){return System.String.Substring(refString,lastDotPos+1,refString.length-lastDotPos-2)}return refString.substring(lastDotPos+1)}}return""};return AnswerExpressionBuilder}());Design.AnswerExpressionBuilder=AnswerExpressionBuilder})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Infiniti;(function(Infiniti){'use strict';var HtmlParsing=(function(){function HtmlParsing(){}HtmlParsing.sanitize=function(html){var tagname="";if(System.String.IsNullOrEmpty(html)){return""}var tagsRegEx=/<[^>]*(>|$)/g;var resultArray;var removal=[];while((resultArray=tagsRegEx.exec(html))!=null){var tag=resultArray[0];tagname=tag.toLowerCase();if(!(tagname==="<b>"||tagname==="</b>"||tagname==="<strong>"||tagname==="</strong>"||tagname==="<p>"||tagname==="</p>"||tagname==="<br>"||tagname==="</span>"||tagname==="</a>"||tagname==="</div>"||tagname==="<em>"||tagname==="</em>"||tagname==="<i>"||tagname==="</i>"||tagname==="<li>"||tagname==="</li>"||tagname==="<ul>"||tagname==="</ul>"||tagname==="<ol>"||tagname==="</ol>")){if(!(HtmlParsing._whitelistCommon.test(tagname))){if(!(HtmlParsing._whitelistFull.test(tagname))){removal.push({startIndex:resultArray.index,length:tagsRegEx.lastIndex-resultArray.index});console.log("tag sanitized: "+tagname)}}}}for(var i=removal.length-1;i>=0;i--){var currentRemoval=removal[i];html=System.String.Remove(html,currentRemoval.startIndex,currentRemoval.length)}return html.replace('<a ','<a onclick="event.preventDefault();" ')};HtmlParsing.sanitizePreview=function(html){if(System.String.IsNullOrEmpty(html)){return""}var tagname="";var tagsRegEx=/<[^>]*(>|$)/g;var resultArray;var removal=[];while((resultArray=tagsRegEx.exec(html))!=null){var tag=resultArray[0];tagname=tag.toLowerCase();if(HtmlParsing._blacklist.test(tagname)){removal.push({startIndex:resultArray.index,length:tagsRegEx.lastIndex-resultArray.index});console.log("tag sanitized: "+tagname)}}for(var i=removal.length-1;i>=0;i--){var currentRemoval=removal[i];html=System.String.Remove(html,currentRemoval.startIndex,currentRemoval.length)}var output=$($.parseHTML('<div>'+html+'</div>',null,false));output.find('*').each(function(){Infiniti.HtmlParsing.trimAttributes(this)});return output.html().replace('<a ','<a onclick="event.preventDefault();" ').replace('<input ','<input onkeypress="event.preventDefault();" ')};HtmlParsing.trimAttributes=function(node){if(node.hasAttributes()){var attrs=node.attributes;for(var i=attrs.length-1;i>=0;i--){var attrName=attrs[i].name;var attrValue=attrs[i].value;if(System.String.StartsWithIgnoreCase(attrName,'on')||Intelledox.Common.Functions.ContainsIgnoreCase(attrValue,'javascript:')){$(node).removeAttr(attrName)}}}};HtmlParsing._blacklist=/^<\/?(s(cript|tyle))(.*)?>$/;HtmlParsing._whitelistCommon=/^<\/?(a|i(mg)?|b(r)?|div|em|font|li|ol|ul|p|s(pan|ub|up|trong)?|t(d|r|h|able|body|head)|h(1|2|3|r)|u)((\s*href=\"((\#\d+|(https?:\/\/)|(..\/)| (file:\/\/\/)|(\/)|(mailto:)|(tel:))+[-a-z0-9+&@#/%?=~_|!:,.;\(\)\$]+)\")?(\s*target=\"[^\"<>]*\")?(\s*title=\"[^\"<>]+\")?(\s*src=\"((https?:\/\/)|(..\/)|(\/)|(data:image))+[-a-z0-9+&@#/%?=~_|!:,.;\(\)]+\")?(\s*width=\"\d{1,3}%?\")?(\s*height=\"\d{1,3}%?\")?(\s*alt=\"[^\"<>]*\")?(\s*title=\"[^\"<>]*\")?(\s*class=\"[-a-z0-9;\\s_]*\")?(\s*style=\"[-a-z0-9#:,;\s.'!%]*\")?(\s*align=\"[a-z;]*\")?(\s*id=\"[-A-Za-z0-9;_]*\")?(\s*color=\"[a-z0-9;#]*\")?(\s*size=\"[0-9]*\")?)*\s*\/?>$/;HtmlParsing._whitelistFull=/^<\/?(a|i(mg)?|b(lockquote|r)?|d(iv|d|t|l)|em|font|li|ol|ul|p(re)?|s(pan|ub|up|trong|trike)?|t(d|r|h|able|body|head|foot)|h(1|2|3|r)|c(aption|ode|ite)|u)((\s*href=\"((\#\d+|(https?:\/\/)|(..\/)|(file:\/\/\/)|(\/)|(mailto:)|(tel:))+[-a-z0-9+&@#/%?=~_|!:,.;\(\)\$]+)\")?(\s*target=\"[^\"<>]*\")?(\s*data-[A-Za-z]*=\"[^\"<>]*\")?(\s*title=\"[^\"<>]+\")?(\s*src=\"((https?:\/\/)|(..\/)|(\/)|(data:image))+[-a-z0-9+&@#/%?=~_|!:,.;\(\)]+\")?(\s*width=\"\d{1,3}%?\")?(\s*height=\"\d{1,3}%?\")?(\s*alt=\"[^\"<>]*\")?(\s*title=\"[^\"<>]*\")?(\s*class=\"[-a-z0-9;\s_]*\")?(\s*style=\"[-a-z0-9#:,;\s.'!%]*\")?(\s*dir=\"[a-z;]*\")?(\s*align=\"[a-z;]*\")?(\s*colspan=\"[0-9]*\")?(\s*summary=\"[a-z0-9;]*\")?(\s*frame=\"[a-z;]*\")?(\s*rules=\"[a-z0-9;]*\")?(\s*lang=\"[a-z;]*\")?(\s*id=\"[-a-z0-9;_]*\")?(\s*border=\"[0-9]*\")?(\s*cellspacing=\"[0-9]*\")?(\s*cellpadding=\"[0-9]*\")?(\s*valign=\"[a-z;]*\")?(\s*nowrap(=\"[a-z]*\")?)?(\s*bgcolor=\"[a-z0-9;#]*\")?(\s*data\-mce\-style=\"[-a-z0-9#:,;\s.'!%]*\")?(\s*data\-qref=\"[-a-z0-9\s.\[\]|&;+@#/ %?=~_!:,\(\)\$]*\")?(\s*type=\"[0-9a-zA-Z;]*\")?(\s*start=\"[0-9]*\")?(\s*color=\"[a-z0-9;#]*\")?(\s*size=\"[0-9]*\")?(\s*face=\"[ a-z;]*\")?(\s*aria-[A-Za-z]*=\"[-0-9a-z\s]*\")?(\s*role=\"[0-9a-z\s]*\")?)*\s*\/?>$/;return HtmlParsing}());Infiniti.HtmlParsing=HtmlParsing})(Infiniti||(Infiniti={}));var System;(function(System){'use strict';var Char=(function(){function Char(){}Char.IsDigit=function(s){var code=s.charCodeAt(0);return(code>=48&&code<=57)};return Char}());System.Char=Char})(System||(System={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var FoundItem=(function(){function FoundItem(){this.selected=false}return FoundItem}());Design.FoundItem=FoundItem})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var findType;(function(findType){findType[findType["any"]=0]="any";findType[findType["question"]=1]="question";findType[findType["answer"]=2]="answer";findType[findType["contentItem"]=3]="contentItem";findType[findType["section"]=4]="section";findType[findType["placeholder"]=5]="placeholder";findType[findType["layout"]=6]="layout"})(findType=Design.findType||(Design.findType={}));var findOn;(function(findOn){findOn[findOn["id"]=0]="id";findOn[findOn["text"]=1]="text"})(findOn=Design.findOn||(Design.findOn={}));var FindAndReplace=(function(){function FindAndReplace(){}FindAndReplace.find=function(wizard,foundItems,treeview,nodes,itemType,searchOn,findWhat,exactMatch){if(nodes==null||findWhat===""){return}if(searchOn===findOn.id&&(itemType===findType.any||itemType===findType.question||itemType===findType.answer)&&(System.String.StartsWithIgnoreCase(findWhat,"q")||System.String.StartsWith(findWhat,"["))){if(!System.String.StartsWith(findWhat,"[")){findWhat="["+findWhat}if(!System.String.EndsWith(findWhat,"]")){findWhat+="]"}var refs=Intelledox.QAWizard.Design.AnswerExpressionBuilder.DeReference(wizard,findWhat);if(refs.parentAnswer!=null){foundItems.push(treeview.findNodeByTag(null,refs.parentAnswer))}else if(refs.parentQuestion!=null){foundItems.push(treeview.findNodeByTag(null,refs.parentQuestion))}}else{var searchText="";for(var i=0;i<nodes.length;i++){var n=nodes[i];if(searchOn===findOn.id){if(Intelledox.Common.Functions.IsInt(findWhat)){if((itemType===findType.any||itemType===findType.question)&&n.tag instanceof Intelledox.QAWizard.Design.Question&&n.tag.ID.toString()===findWhat){foundItems.push(n)}else if((itemType===findType.any||itemType===findType.answer)&&n.tag instanceof Intelledox.QAWizard.Design.Answer&&n.tag.ID.toString()===findWhat){foundItems.push(n)}}else{if((itemType===findType.any||itemType===findType.question)&&n.tag instanceof Intelledox.QAWizard.Design.Question&&n.tag.QuestionGuid===findWhat){foundItems.push(n)}else if((itemType===findType.any||itemType===findType.answer)&&n.tag instanceof Intelledox.QAWizard.Design.Answer&&n.tag.AnswerGuid===findWhat){foundItems.push(n)}else if((itemType===findType.any||itemType===findType.contentItem)&&n.tag instanceof Intelledox.QAWizard.Design.ContentItem&&n.tag.ContentItemGuid===findWhat){foundItems.push(n)}}}else{searchText="";if(itemType===findType.any||itemType===findType.placeholder){if(n.tag instanceof Intelledox.QAWizard.Design.Section){var sect=n.tag;if(sect.IsRepeated){for(var placeIndex=0;placeIndex<sect.RepeatPlaceholders.length;placeIndex++){if(Intelledox.Common.Functions.ContainsIgnoreCase(sect.RepeatPlaceholders[placeIndex].name,findWhat)){foundItems.push(n)}}}}else if(n.tag instanceof Intelledox.QAWizard.Design.Page){var page=n.tag;if(page.IsRepeated){for(var placeIndex=0;placeIndex<page.RepeatPlaceholders.length;placeIndex++){if(Intelledox.Common.Functions.ContainsIgnoreCase(page.RepeatPlaceholders[placeIndex].name,findWhat)){foundItems.push(n)}}}}else if(n.tag instanceof Intelledox.QAWizard.Design.Question){var q=n.tag;if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&q.IsRepeated){for(var placeIndex=0;placeIndex<q.RepeatPlaceholders.length;placeIndex++){if(Intelledox.Common.Functions.ContainsIgnoreCase(q.RepeatPlaceholders[placeIndex].name,findWhat)){foundItems.push(n)}}}}}if(itemType===findType.any||((itemType===findType.placeholder&&n.tag instanceof Intelledox.QAWizard.Design.Placeholder)||(itemType===findType.question&&n.tag instanceof Intelledox.QAWizard.Design.Question)||(itemType===findType.answer&&n.tag instanceof Intelledox.QAWizard.Design.Answer)||(itemType===findType.layout&&typeof n.tag.HasContainerInterface!=="undefined")||(itemType===findType.contentItem&&n.tag instanceof Intelledox.QAWizard.Design.ContentItem))){if(n.tag instanceof Intelledox.QAWizard.Design.TabPage){searchText=n.tag.Title}else if(n.tag instanceof Intelledox.QAWizard.Design.Section){searchText=n.tag.Title}else if(n.tag instanceof Intelledox.QAWizard.Design.Column){searchText=n.tag.Title}else{searchText=n.text}var isMatch=exactMatch?Intelledox.Common.Functions.EqualsIgnoreCase(searchText,findWhat):Intelledox.Common.Functions.ContainsIgnoreCase(searchText,findWhat);if(isMatch){foundItems.push(n)}}}this.find(wizard,foundItems,treeview,n.nodes,itemType,searchOn,findWhat,exactMatch)}}};FindAndReplace.findAndReplaceText=function(wizard,findWhat,replaceWith){var foundItems=[];var i;for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var p=wizard.Pages[pageIndex];this.findAndReplaceTextInClauses(foundItems,p,p.ActiveConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,p,p.VisibleConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,p,p.EditableConditions,findWhat,replaceWith,Design.DependencyType.Condition);p.MaximumRepeats=this.findAndReplaceTextInTextValues(foundItems,p,p.MaximumRepeats,findWhat,replaceWith,Design.DependencyType.Properties);p.MinimumRepeats=this.findAndReplaceTextInTextValues(foundItems,p,p.MinimumRepeats,findWhat,replaceWith,Design.DependencyType.Properties);p.Name=this.findAndReplaceTextInTextValues(foundItems,p,p.Name,findWhat,replaceWith,Design.DependencyType.Properties);p.RepeatTitle=this.findAndReplaceTextInTextValues(foundItems,p,p.RepeatTitle,findWhat,replaceWith,Design.DependencyType.Properties);if(p instanceof Intelledox.QAWizard.Design.FragmentPage){this.findAndReplaceTextInAttributes(foundItems,p,p.Inputs,findWhat,replaceWith,Design.DependencyType.FragmentInput)}for(var childIndex=0;childIndex<p.Children.length;childIndex++){this.findAndReplaceTextRecursive(foundItems,wizard,p.Children[childIndex],findWhat,replaceWith)}}for(i=0;i<wizard.Documents.length;i++){var doc=wizard.Documents[i];this.findAndReplaceTextInClauses(foundItems,doc,doc.Conditions,findWhat,replaceWith,Design.DependencyType.Condition);doc.FileName=this.findAndReplaceTextInTextValues(foundItems,doc,doc.FileName,findWhat,replaceWith,Design.DependencyType.Properties)}for(i=0;i<wizard.Actions.length;i++){this.findAndReplaceTextInActions(foundItems,wizard.Actions[i],findWhat,replaceWith)}var fullList=wizard.Workflow.FullStateList;for(var stateIndex=0;stateIndex<fullList.length;stateIndex++){var s=fullList[stateIndex];for(var tranIndex=0;tranIndex<s.Transitions.length;tranIndex++){var tran=s.Transitions[tranIndex];this.findAndReplaceTextInClauses(foundItems,tran,tran.Conditions,findWhat,replaceWith,Design.DependencyType.Condition);tran.EmailSubject=this.findAndReplaceTextInTextValues(foundItems,tran,tran.EmailSubject,findWhat,replaceWith,Design.DependencyType.Properties);tran.EmailText=this.findAndReplaceTextInTextValues(foundItems,tran,tran.EmailText,findWhat,replaceWith,Design.DependencyType.Properties);tran.PageTitle=this.findAndReplaceTextInTextValues(foundItems,tran,tran.PageTitle,findWhat,replaceWith,Design.DependencyType.Properties);tran.HelpText=this.findAndReplaceTextInTextValues(foundItems,tran,tran.HelpText,findWhat,replaceWith,Design.DependencyType.Properties);tran.DefaultComment=this.findAndReplaceTextInTextValues(foundItems,tran,tran.DefaultComment,findWhat,replaceWith,Design.DependencyType.Properties);tran.SubmitButtonText=this.findAndReplaceTextInTextValues(foundItems,tran,tran.SubmitButtonText,findWhat,replaceWith,Design.DependencyType.Properties);tran.SubmittingText=this.findAndReplaceTextInTextValues(foundItems,tran,tran.SubmittingText,findWhat,replaceWith,Design.DependencyType.Properties);tran.ResponsesSubmittedText=this.findAndReplaceTextInTextValues(foundItems,tran,tran.ResponsesSubmittedText,findWhat,replaceWith,Design.DependencyType.Properties);tran.OfflineRedirectMessage=this.findAndReplaceTextInTextValues(foundItems,tran,tran.OfflineRedirectMessage,findWhat,replaceWith,Design.DependencyType.Properties);for(var actionIndex=0;actionIndex<tran.Actions.length;actionIndex++){this.findAndReplaceTextInActions(foundItems,tran.Actions[actionIndex],findWhat,replaceWith)}}for(var escIndex=0;escIndex<s.EscalationList.length;escIndex++){var e=s.EscalationList[escIndex];this.findAndReplaceTextInClauses(foundItems,e,e.Conditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInAttributes(foundItems,e,e.EscalationInputs,findWhat,replaceWith,Design.DependencyType.EscalationAttribute)}}this.findAndReplaceTextInClauses(foundItems,Intelledox.Common.ConstantValues.FINISHPAGETAG,wizard.FinishPageConditions,findWhat,replaceWith,Design.DependencyType.Condition);return foundItems};FindAndReplace.findAndReplaceTextRecursive=function(foundItems,wizard,child,findWhat,replaceWith){if(typeof child.HasContainerInterface!=="undefined"){if(child instanceof Intelledox.QAWizard.Design.Section){var sect=child;this.findAndReplaceTextInClauses(foundItems,sect,sect.ActiveConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,sect,sect.VisibleConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,sect,sect.EditableConditions,findWhat,replaceWith,Design.DependencyType.Condition);sect.Title=this.findAndReplaceTextInTextValues(foundItems,sect,sect.Title,findWhat,replaceWith,Design.DependencyType.Properties);sect.Description=this.findAndReplaceTextInTextValues(foundItems,sect,sect.Description,findWhat,replaceWith,Design.DependencyType.Properties);sect.MaximumRepeats=this.findAndReplaceTextInTextValues(foundItems,sect,sect.MaximumRepeats,findWhat,replaceWith,Design.DependencyType.Properties);sect.MinimumRepeats=this.findAndReplaceTextInTextValues(foundItems,sect,sect.MinimumRepeats,findWhat,replaceWith,Design.DependencyType.Properties)}else if(child instanceof Intelledox.QAWizard.Design.Column){var col=child;this.findAndReplaceTextInClauses(foundItems,col,col.ActiveConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,col,col.VisibleConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,col,col.EditableConditions,findWhat,replaceWith,Design.DependencyType.Condition)}else if(child instanceof Intelledox.QAWizard.Design.TabGroup){var tabs=child;this.findAndReplaceTextInClauses(foundItems,tabs,tabs.ActiveConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,tabs,tabs.VisibleConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,tabs,tabs.EditableConditions,findWhat,replaceWith,Design.DependencyType.Condition)}else if(child instanceof Intelledox.QAWizard.Design.TabPage){var page=child;this.findAndReplaceTextInClauses(foundItems,page,page.ActiveConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,page,page.VisibleConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,page,page.EditableConditions,findWhat,replaceWith,Design.DependencyType.Condition)}else if(child instanceof Intelledox.QAWizard.Design.FragmentReference){var ref=child;this.findAndReplaceTextInAttributes(foundItems,child,ref.Inputs,findWhat,replaceWith,Design.DependencyType.FragmentInput)}for(var childIndex=0;childIndex<child.Children.length;childIndex++){this.findAndReplaceTextRecursive(foundItems,wizard,child.Children[childIndex],findWhat,replaceWith)}return}if(child instanceof Intelledox.QAWizard.Design.Question){var q=child;this.findAndReplaceTextInClauses(foundItems,q,q.ActiveConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,q,q.VisibleConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,q,q.EditableConditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInClauses(foundItems,q,q.MandatoryConditions,findWhat,replaceWith,Design.DependencyType.Condition);q.Text=this.findAndReplaceTextInTextValues(foundItems,q,q.Text,findWhat,replaceWith,Design.DependencyType.Properties);q.DefaultValue=this.findAndReplaceTextInTextValues(foundItems,q,q.DefaultValue,findWhat,replaceWith,Design.DependencyType.Properties);q.HelpText=this.findAndReplaceTextInTextValues(foundItems,q,q.HelpText,findWhat,replaceWith,Design.DependencyType.Properties);for(var answerIndex=0;answerIndex<q.Answers.length;answerIndex++){var a=q.Answers[answerIndex];this.findAndReplaceTextInClauses(foundItems,a,a.ActiveConditions,findWhat,replaceWith,Design.DependencyType.Condition);a.Name=this.findAndReplaceTextInTextValues(foundItems,a,a.Name,findWhat,replaceWith,Design.DependencyType.Properties);if(a instanceof Intelledox.QAWizard.Design.GroupLogicAnswer){a.DisplayText=this.findAndReplaceTextInTextValues(foundItems,a,a.DisplayText,findWhat,replaceWith,Design.DependencyType.Properties)}else if(a instanceof Intelledox.QAWizard.Design.VariableAnswer){a.Formula=this.findAndReplaceTextInTextValues(foundItems,a,a.Formula,findWhat,replaceWith,Design.DependencyType.Properties)}else if(a instanceof Intelledox.QAWizard.Design.AutoLogicAnswer){this.findAndReplaceTextInClauses(foundItems,a,a.Rules,findWhat,replaceWith,Design.DependencyType.Rule)}else if(a instanceof Intelledox.QAWizard.Design.DatasourceAnswer){a.Formula=this.findAndReplaceTextInTextValues(foundItems,a,a.Formula,findWhat,replaceWith,Design.DependencyType.Properties)}if(!System.String.IsNullOrEmpty(a.ImageSettings.AlternativeText)){a.ImageSettings.AlternativeText=this.findAndReplaceTextInTextValues(foundItems,a,a.ImageSettings.AlternativeText,findWhat,replaceWith,Design.DependencyType.Properties)}if(a.HasContentItems){for(var contentIndex=0;contentIndex<a.ContentItems.length;contentIndex++){var content=a.ContentItems[contentIndex];content.ImageSettings.AlternativeText=this.findAndReplaceTextInTextValues(foundItems,a,content.ImageSettings.AlternativeText,findWhat,replaceWith,Design.DependencyType.Properties)}}}if(q instanceof Intelledox.QAWizard.Design.DatasourceQuestion){this.findAndReplaceTextInClauses(foundItems,q,q.Filters,findWhat,replaceWith,Design.DependencyType.AutoAnswer)}else if(q instanceof Intelledox.QAWizard.Design.ValidationQuestion){this.findAndReplaceTextInClauses(foundItems,q,q.ValidationRule,findWhat,replaceWith,Design.DependencyType.ValidationRule)}else if(q instanceof Intelledox.QAWizard.Design.CustomQuestion){this.findAndReplaceTextInAttributes(foundItems,q,q.Inputs,findWhat,replaceWith,Design.DependencyType.CustomQuestionInput)}}};FindAndReplace.findAndReplaceTextInClauses=function(foundItems,item,clauses,findWhat,replaceWith,dependencyType){if(clauses==null){return}var clauseList=this.getClauseList(clauses);for(var clauseIndex=0;clauseIndex<clauseList.length;clauseIndex++){var clause=clauseList[clauseIndex];if(clause instanceof Intelledox.QAWizard.Design.Condition){var cond=clause;if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.State){continue}else if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Action){continue}else{cond.CompareTo=this.findAndReplaceTextInTextValues(foundItems,item,cond.CompareTo,findWhat,replaceWith,dependencyType)}}else if(clause instanceof Intelledox.QAWizard.Design.Rule){var rule=clause;rule.Formula=this.findAndReplaceTextInTextValues(foundItems,item,rule.Formula,findWhat,replaceWith,dependencyType);rule.CompareTo=this.findAndReplaceTextInTextValues(foundItems,item,rule.CompareTo,findWhat,replaceWith,dependencyType)}else if(clause instanceof Intelledox.QAWizard.Design.ValidationRule){var vRule=clause;if(item instanceof Intelledox.QAWizard.Design.Question){vRule.Expression=this.findAndReplaceTextInTextValues(foundItems,item,vRule.Expression,findWhat,replaceWith,dependencyType)}else if(item instanceof Intelledox.QAWizard.Design.Answer){vRule.Expression=this.findAndReplaceTextInTextValues(foundItems,item,vRule.Expression,findWhat,replaceWith,dependencyType)}}else if(clause instanceof Intelledox.QAWizard.Design.Filter){var filter=clause;filter.ConstantValue=this.findAndReplaceTextInTextValues(foundItems,item,filter.ConstantValue,findWhat,replaceWith,dependencyType)}else{continue}}};FindAndReplace.findAndReplaceTextInTextValues=function(foundItems,item,text,findWhat,replaceWith,dependencyType){if(!System.String.IsNullOrEmpty(text)&&text.indexOf(findWhat)!==-1){text=text.replace(findWhat,replaceWith);foundItems.push(new Design.LogicDependency(item,dependencyType))}return text};FindAndReplace.findAndReplaceTextInAttributes=function(foundItems,item,attributes,findWhat,replaceWith,dependencyType){for(var i=0;i<attributes.length;i++){var attribute=attributes[i];attribute.FixedValue=this.findAndReplaceTextInTextValues(foundItems,item,attribute.FixedValue,findWhat,replaceWith,dependencyType)}};FindAndReplace.findAndReplaceTextInActions=function(foundItems,a,findWhat,replaceWith){this.findAndReplaceTextInClauses(foundItems,a,a.Conditions,findWhat,replaceWith,Design.DependencyType.Condition);this.findAndReplaceTextInAttributes(foundItems,a,a.ActionInputs,findWhat,replaceWith,Design.DependencyType.ActionAttribute);for(var i=0;i<a.Children.length;i++){this.findAndReplaceTextInActions(foundItems,a.Children[i],findWhat,replaceWith)}};FindAndReplace.getClauseList=function(c){var clauseList=[];if(c.Type===Intelledox.Model.ClauseType.Comparison){clauseList.push(c)}for(var i=0;i<c.SubClauses.length;i++){clauseList.push.apply(clauseList,this.getClauseList(c.SubClauses[i]))}return clauseList};return FindAndReplace}());Design.FindAndReplace=FindAndReplace})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ValidationError=(function(){function ValidationError(){}return ValidationError}());Design.ValidationError=ValidationError})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var LanguageTranslationExportHelper=(function(){function LanguageTranslationExportHelper($q,filter,listManager,editorViewModel){this._newLine="\r\n";this._q=$q;this._listManager=listManager;this._editor=editorViewModel;this._filter=filter}LanguageTranslationExportHelper.prototype.runWorker=function(){var vm=this;var promises=[];var dependantPromises=[];var escalationAttributes={};promises.push(this._listManager.escalationTypes().then(function(escalationTypes){angular.forEach(escalationTypes,function(escalationType){dependantPromises.push(vm._listManager.routingElementTypes(escalationType.routingTypeId).then(function(currentEscalationAttributes){escalationAttributes[escalationType.routingTypeId]=currentEscalationAttributes}))})}));var actionAttributes={};promises.push(this._listManager.actionTypes().then(function(actionTypes){angular.forEach(actionTypes,function(actionType){dependantPromises.push(vm._listManager.routingElementTypes(actionType.routingTypeId).then(function(currentActionAttributes){actionAttributes[actionType.routingTypeId]=currentActionAttributes}))})}));this._q.all(promises).then(function(){return vm._q.all(dependantPromises)}).then(function(){vm.createCSV(escalationAttributes,actionAttributes)})};LanguageTranslationExportHelper.prototype.createCSV=function(escalationAttributes,actionAttributes){var fileName=Intelledox.Common.Functions.MakeValidFileName(this._editor.wizard.Name+'_'+this._filter('translate')('LanguageTranslations'))+'.csv';var languageFile=this.createLanguageTranslationCSV(this.createCSVHeaderRow(),escalationAttributes,actionAttributes);languageFile=languageFile.replace(/\r\n|[\r\n]/g,this._newLine);if(window.navigator.msSaveOrOpenBlob){var csvData=new Blob([languageFile],{type:'text/csv;charset=utf-8'});navigator.msSaveOrOpenBlob(csvData,fileName)}else{var a=window.document.createElement('a');a.href='data:text/csv;charset=utf-8,'+encodeURI(languageFile);a['download']=fileName;document.body.appendChild(a);a.click();document.body.removeChild(a)}};LanguageTranslationExportHelper.prototype.createLanguageTranslationCSV=function(header,escalationAttributes,actionAttributes){var csv="";if(this._editor.wizard.TypeId===Intelledox.Model.ProjectType.Content||this._editor.wizard.TypeId===Intelledox.Model.ProjectType.Dashboard){csv+=this.createHeaderInfoTranslationCSV(header)}for(var pageIndex=0;pageIndex<this._editor.wizard.Pages.length;pageIndex++){csv+=this.createQuestionTreeItemTranslation(this._editor.wizard.Pages[pageIndex],header)}if(this._editor.wizard.TypeId===Intelledox.Model.ProjectType.Content&&this._editor.wizard.Workflow!=null&&this._editor.wizard.Workflow.States!=null){for(var stateIndex=0;stateIndex<this._editor.wizard.Workflow.States.length;stateIndex++){var state=this._editor.wizard.Workflow.States[stateIndex];if(state.Id!==Intelledox.Common.ConstantValues.FINISHED_STATE_GUID){csv+=this.createStateTranslationsCsv(state,escalationAttributes,actionAttributes,header)}}for(var parallelIndex=0;parallelIndex<this._editor.wizard.Workflow.ParallelSections.length;parallelIndex++){csv+=this.createParallelStateTranlationsCsv(this._editor.wizard.Workflow.ParallelSections[parallelIndex],escalationAttributes,actionAttributes,header)}}if(this._editor.wizard.TypeId===Intelledox.Model.ProjectType.Content){for(var actionIndex=0;actionIndex<this._editor.wizard.Actions.length;actionIndex++){csv+=this.createActionCSV(this._editor.wizard.Actions[actionIndex],actionAttributes,header)}csv+=this.createCompletionInfoTranslationCSV(header)}return header.join(',')+this._newLine+csv};LanguageTranslationExportHelper.prototype.createActionCSV=function(action,actionAttributes,header){var csv="";var translationElementTypeIds=actionAttributes[action.Type.routingTypeId].filter(function(a){return a.allowTranslation===true}).map(function(x){return x.routingElementTypeId});if(translationElementTypeIds.length>0){var translationInputs=action.ActionInputs.filter(function(i){return i.SourceType===Intelledox.Model.RoutingSourceType.FixedValue&&translationElementTypeIds.indexOf(i.ElementTypeId)!==-1});for(var inputIndex=0;inputIndex<translationInputs.length;inputIndex++){var actionInput=translationInputs[inputIndex];csv+=this.createLanguageTranslationRow(actionInput.RoutingOptionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_ACTIONINPUT,"",Intelledox.Common.ConstantValues.XTF_ACTIONATTRIBUTEFIXEDVALUE,actionInput.FixedValue,header)}}return csv};LanguageTranslationExportHelper.prototype.createCSVHeaderRow=function(){var langs=[];for(var translationIndex=0;translationIndex<this._editor.wizard.LanguageTranslations.length;translationIndex++){var lang=this._editor.wizard.LanguageTranslations[translationIndex].lang;if(langs.indexOf(lang)===-1){langs.push(lang)}}langs.sort();return["Key","Description","QuestionReference","Property","DefaultLanguage"].concat(langs)};LanguageTranslationExportHelper.prototype.createHeaderInfoTranslationCSV=function(header){var controlGuid=this._editor.wizard.ProjectGuid;var csv=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_HEADERINFO,"",Intelledox.Common.ConstantValues.XTF_NAME,this._editor.wizard.Name,header,false);if(this._editor.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard){csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_HEADERINFO,"",Intelledox.Common.ConstantValues.XTF_DEFAULTANSWERFILENAME,System.String.IsNullOrEmpty(this._editor.wizard.DefaultAnswerFileName)?"":this._editor.wizard.DefaultAnswerFileName,header,false);csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_HEADERINFO,"",Intelledox.Common.ConstantValues.XTF_DEFAULTINPROGRESSANSWERFILENAME,System.String.IsNullOrEmpty(this._editor.wizard.DefaultInProgressFileName)?"":this._editor.wizard.DefaultInProgressFileName,header,false);if(this._editor.wizard.TemporaryUserSaveSettings.AccessCodeGeneration!=Intelledox.Model.AccessCodeGeneration.None){csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_HEADERINFO,"",Intelledox.Common.ConstantValues.XTF_ANONSAVEHELPTEXT,System.String.IsNullOrEmpty(this._editor.wizard.TemporaryUserSaveSettings.HelpText)?"":this._editor.wizard.TemporaryUserSaveSettings.HelpText,header,false);csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_HEADERINFO,"",Intelledox.Common.ConstantValues.XTF_ANONSAVEEMAILSUBJECT,System.String.IsNullOrEmpty(this._editor.wizard.TemporaryUserSaveSettings.EmailSubject)?"":this._editor.wizard.TemporaryUserSaveSettings.EmailSubject,header,false);csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_HEADERINFO,"",Intelledox.Common.ConstantValues.XTF_ANONSAVEEMAILBODY,System.String.IsNullOrEmpty(this._editor.wizard.TemporaryUserSaveSettings.EmailBody)?"":this._editor.wizard.TemporaryUserSaveSettings.EmailBody,header,false);csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_HEADERINFO,"",Intelledox.Common.ConstantValues.XTF_ANONSAVERESUMETEXT,System.String.IsNullOrEmpty(this._editor.wizard.TemporaryUserSaveSettings.ResumeText)?"":this._editor.wizard.TemporaryUserSaveSettings.ResumeText,header,false);csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_HEADERINFO,"",Intelledox.Common.ConstantValues.XTF_ANONREASSIGNTEXT,System.String.IsNullOrEmpty(this._editor.wizard.TemporaryUserSaveSettings.ReassignText)?"":this._editor.wizard.TemporaryUserSaveSettings.ReassignText,header,false)}}return csv};LanguageTranslationExportHelper.prototype.createCompletionInfoTranslationCSV=function(header){var csv="";var controlGuid=this._editor.wizard.ProjectGuid;if(this._editor.wizard.FinishPageVisible){csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO,"",Intelledox.Common.ConstantValues.XTF_FINISHTITLE,this._editor.wizard.FinishTitle,header,false)}csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO,"",Intelledox.Common.ConstantValues.XTF_GENERATEBUTTONTEXT,this._editor.wizard.GenerateButtonText,header,false);csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO,"",Intelledox.Common.ConstantValues.XTF_GENERATINGTEXT,this._editor.wizard.GeneratingText,header,false);csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO,"",Intelledox.Common.ConstantValues.XTF_DOWNLOADPAGETITLE,this._editor.wizard.DownloadPageTitle,header,false);csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO,"",Intelledox.Common.ConstantValues.XTF_INVALIDPROJECTEXT,this._editor.wizard.InvalidProjectText,header,false);csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO,"",Intelledox.Common.ConstantValues.XTF_ONLINEREDIRECTMESSAGE,this._editor.wizard.OnlineRedirectMessage,header,false);csv+=this.createLanguageTranslationRow(controlGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO,"",Intelledox.Common.ConstantValues.XTF_OFFLINEREDIRECTMESSAGE,this._editor.wizard.OfflineRedirectMessage,header,false);return csv};LanguageTranslationExportHelper.prototype.createQuestionTreeItemTranslation=function(questionTreeItem,header){if(questionTreeItem instanceof Intelledox.QAWizard.Design.Page){return this.createPageTranslationCSV(questionTreeItem,header)}else if(questionTreeItem instanceof Intelledox.QAWizard.Design.Question){return this.createQuestionTranslationCSV(questionTreeItem,header)}else if(questionTreeItem instanceof Intelledox.QAWizard.Design.Section){return this.createSectionTranslationCSV(questionTreeItem,header)}else if(questionTreeItem instanceof Intelledox.QAWizard.Design.Column){return this.createColumnTranslationCSV(questionTreeItem,header)}else if(questionTreeItem instanceof Intelledox.QAWizard.Design.TabGroup){return this.createTabGroupTranslationCSV(questionTreeItem,header)}else if(questionTreeItem instanceof Intelledox.QAWizard.Design.TabPage){return this.createTabPageTranslationCSV(questionTreeItem,header)}return""};LanguageTranslationExportHelper.prototype.createColumnTranslationCSV=function(column,header){var csv=this.createLanguageTranslationRow(column.ColumnGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_COLUMN,"",Intelledox.Common.ConstantValues.XTF_TITLE,column.Title,header);csv+=this.createLanguageTranslationRow(column.ColumnGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_COLUMN,"",Intelledox.Common.ConstantValues.XTF_HELPTEXT,column.HelpText,header);for(var columnChildIndex=0;columnChildIndex<column.Children.length;columnChildIndex++){csv+=this.createQuestionTreeItemTranslation(column.Children[columnChildIndex],header)}return csv};LanguageTranslationExportHelper.prototype.createTabPageTranslationCSV=function(tabPage,header){var csv=this.createLanguageTranslationRow(tabPage.TabPageGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_TABPAGE,"",Intelledox.Common.ConstantValues.XTF_TITLE,tabPage.Title,header);for(var tabPageChildIndex=0;tabPageChildIndex<tabPage.Children.length;tabPageChildIndex++){csv+=this.createQuestionTreeItemTranslation(tabPage.Children[tabPageChildIndex],header)}return csv};LanguageTranslationExportHelper.prototype.createSectionTranslationCSV=function(section,header){var csv=this.createLanguageTranslationRow(section.SectionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_SECTION,"",Intelledox.Common.ConstantValues.XTF_TITLE,section.Title,header);csv+=this.createLanguageTranslationRow(section.SectionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_SECTION,"",Intelledox.Common.ConstantValues.XTF_DESCRIPTION,section.Description,header);csv+=this.createLanguageTranslationRow(section.SectionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_SECTION,"",Intelledox.Common.ConstantValues.XTF_REPEATNAME,section.RepeatName,header);for(var sectionChildIndex=0;sectionChildIndex<section.Children.length;sectionChildIndex++){csv+=this.createQuestionTreeItemTranslation(section.Children[sectionChildIndex],header)}return csv};LanguageTranslationExportHelper.prototype.createTabGroupTranslationCSV=function(tabGroup,header){var csv="";for(var tabGroupChildIndex=0;tabGroupChildIndex<tabGroup.Children.length;tabGroupChildIndex++){csv+=this.createQuestionTreeItemTranslation(tabGroup.Children[tabGroupChildIndex],header)}return csv};LanguageTranslationExportHelper.prototype.createPageTranslationCSV=function(page,header){var csv="";if(this._editor.wizard.TypeId!==Intelledox.Model.ProjectType.FragmentPortion&&!(page instanceof Intelledox.QAWizard.Design.FragmentPage)){csv+=this.createLanguageTranslationRow(page.PageGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_BOOKMARKGROUP,"",Intelledox.Common.ConstantValues.XTF_NAME,page.Name,header);if(page.IsRepeated){csv+=this.createLanguageTranslationRow(page.PageGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_BOOKMARKGROUP,"",Intelledox.Common.ConstantValues.XTF_REPEATTITLE,page.RepeatTitle,header);csv+=this.createLanguageTranslationRow(page.PageGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_BOOKMARKGROUP,"",Intelledox.Common.ConstantValues.XTF_REPEATNAME,page.RepeatName,header)}}for(var pageChildIndex=0;pageChildIndex<page.Children.length;pageChildIndex++){csv+=this.createQuestionTreeItemTranslation(page.Children[pageChildIndex],header)}return csv};LanguageTranslationExportHelper.prototype.createQuestionTranslationCSV=function(question,header){var csv="";if(question instanceof Intelledox.QAWizard.Design.UserPromptQuestion||question instanceof Intelledox.QAWizard.Design.GroupLogicQuestion||(question instanceof Intelledox.QAWizard.Design.DatasourceQuestion&&question.Visibility)||(question instanceof Intelledox.QAWizard.Design.LabelQuestion&&question.Visibility)||question instanceof Intelledox.QAWizard.Design.RichTextQuestion||question instanceof Intelledox.QAWizard.Design.ValidationQuestion||question instanceof Intelledox.QAWizard.Design.InkQuestion||(question instanceof Intelledox.QAWizard.Design.ContentLibraryQuestion&&question.Visibility)||question instanceof Intelledox.QAWizard.Design.NumericQuestion||question instanceof Intelledox.QAWizard.Design.GeolocationQuestion||question instanceof Intelledox.QAWizard.Design.AddressQuestion||question instanceof Intelledox.QAWizard.Design.CustomQuestion||question instanceof Intelledox.QAWizard.Design.ButtonQuestion||question instanceof Intelledox.QAWizard.Design.SummaryQuestion||question instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){csv+=this.createLanguageTranslationRow(question.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_QUESTION,"[Q"+question.ID+"]",Intelledox.Common.ConstantValues.XTF_TEXT,question.Text,header,false);if(question.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator&&question.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary&&question.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton){csv+=this.createLanguageTranslationRow(question.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_QUESTION,"[Q"+question.ID+"]",Intelledox.Common.ConstantValues.XTF_HELPTEXT,question.HelpText,header)}if(question instanceof Intelledox.QAWizard.Design.UserPromptQuestion){csv+=this.createLanguageTranslationRow(question.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_QUESTION,"[Q"+question.ID+"]",Intelledox.Common.ConstantValues.XTF_DEFAULTVALUE,question.DefaultValue,header);csv+=this.createLanguageTranslationRow(question.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_QUESTION,"[Q"+question.ID+"]",Intelledox.Common.ConstantValues.XTF_WATERMARK,System.String.IsNullOrEmpty(question.Watermark)?"":question.Watermark,header);if(question.HasValidationRules){for(var validationIndex=0;validationIndex<question.Validations.length;validationIndex++){var r=question.Validations[validationIndex];csv+=this.createLanguageTranslationRow(r.Id,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_RULE,"[Q"+question.ID+"]",Intelledox.Common.ConstantValues.XTF_MESSAGE,r.Message,header)}}}else if(question instanceof Intelledox.QAWizard.Design.GroupLogicQuestion){for(var answerIndex=0;answerIndex<question.Answers.length;answerIndex++){var answer=question.Answers[answerIndex];csv+=this.createLanguageTranslationRow(answer.AnswerGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_ANSWER,"[Q"+question.ID+"."+answer.ID+"]",Intelledox.Common.ConstantValues.XTF_DISPLAYTEXT,System.String.IsNullOrEmpty(answer.DisplayText)?"":answer.DisplayText,header);csv+=this.createLanguageTranslationRow(answer.AnswerGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_ANSWER,"[Q"+question.ID+"."+answer.ID+"]",Intelledox.Common.ConstantValues.XTF_TAGVALUE,System.String.IsNullOrEmpty(answer.TagValue)?"":answer.TagValue,header)}}else if(question instanceof Intelledox.QAWizard.Design.LabelQuestion||question instanceof Intelledox.QAWizard.Design.RichTextQuestion){csv+=this.createLanguageTranslationRow(question.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_QUESTION,"[Q"+question.ID+"]",Intelledox.Common.ConstantValues.XTF_DEFAULTVALUE,question.DefaultValue,header)}else if(question instanceof Intelledox.QAWizard.Design.DatasourceQuestion){var dsQuestion=question;if(question.DisplayType===Intelledox.Model.QuestionDisplayType.AutoComplete){csv+=this.createLanguageTranslationRow(dsQuestion.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_QUESTION,"[Q"+dsQuestion.ID+"]",Intelledox.Common.ConstantValues.XTF_WATERMARK,System.String.IsNullOrEmpty(dsQuestion.Watermark)?"":dsQuestion.Watermark,header);csv+=this.createLanguageTranslationRow(dsQuestion.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_QUESTION,"[Q"+dsQuestion.ID+"]","NoResultsMessage",System.String.IsNullOrEmpty(dsQuestion.NoResultsMessage)?"":dsQuestion.NoResultsMessage,header)}else if(question.DisplayType===Intelledox.Model.QuestionDisplayType.DataGrid&&question.HasCustomDisplayFields){for(var displayIndex=0;displayIndex<question.DisplayFields.length;displayIndex++){csv+=this.createLanguageTranslationRow(dsQuestion.QuestionGuid,question.DisplayFields[displayIndex].name,Intelledox.Common.ConstantValues.XTF_DISPLAYFIELD,"[Q"+dsQuestion.ID+"]",Intelledox.Common.ConstantValues.XTF_DISPLAYFIELDCOLUMNTITLE,System.String.IsNullOrEmpty(question.DisplayFields[displayIndex].columnTitle)?"":(question.DisplayFields[displayIndex].columnTitle),header)}}}}else if(question instanceof Intelledox.QAWizard.Design.ButtonQuestion){csv+=this.createLanguageTranslationRow(question.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_QUESTION,"[Q"+question.ID+"]",Intelledox.Common.ConstantValues.XTF_TITLE,System.String.IsNullOrEmpty(question.Title)?"":question.Title,header);csv+=this.createLanguageTranslationRow(question.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_QUESTION,"[Q"+question.ID+"]",Intelledox.Common.ConstantValues.XTF_BADGE,System.String.IsNullOrEmpty(question.Badge)?"":question.Badge,header)}return csv};LanguageTranslationExportHelper.prototype.createParallelStateTranlationsCsv=function(parallel,escalationAttributes,actionAttributes,header){var csv="";for(var i=0;i<parallel.States.length;i++){csv+=this.createStateTranslationsCsv(parallel.States[i],escalationAttributes,actionAttributes,header)}for(var i=0;i<parallel.ParallelSections.length;i++){csv+=this.createParallelStateTranlationsCsv(parallel.ParallelSections[i],escalationAttributes,actionAttributes,header)}return csv};LanguageTranslationExportHelper.prototype.createStateTranslationsCsv=function(state,escalationAttributes,actionAttributes,header){var csv="";csv+=this.createLanguageTranslationRow(state.Id,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_STATE,"",Intelledox.Common.ConstantValues.XTF_NAME,state.Name,header,false);if(state.Transitions!=null){for(var transitionIndex=0;transitionIndex<state.Transitions.length;transitionIndex++){var transition=state.Transitions[transitionIndex];if(transition.StateId!==Intelledox.Common.ConstantValues.FINISHED_STATE_GUID){csv+=this.createLanguageTranslationRow(transition.StateId,state.Id,Intelledox.Common.ConstantValues.XTF_TRANSITION,"",Intelledox.Common.ConstantValues.XTF_DEFAULTCOMMENT,System.String.IsNullOrEmpty(transition.DefaultComment)?"":transition.DefaultComment,header);csv+=this.createLanguageTranslationRow(transition.StateId,state.Id,Intelledox.Common.ConstantValues.XTF_TRANSITION,"",Intelledox.Common.ConstantValues.XTF_PAGETITLE,transition.PageTitle,header);csv+=this.createLanguageTranslationRow(transition.StateId,state.Id,Intelledox.Common.ConstantValues.XTF_TRANSITION,"",Intelledox.Common.ConstantValues.XTF_HELPTEXT,System.String.IsNullOrEmpty(transition.HelpText)?"":transition.DefaultComment,header);csv+=this.createLanguageTranslationRow(transition.StateId,state.Id,Intelledox.Common.ConstantValues.XTF_TRANSITION,"",Intelledox.Common.ConstantValues.XTF_SUBMITBUTTONTEXT,transition.SubmitButtonText,header);csv+=this.createLanguageTranslationRow(transition.StateId,state.Id,Intelledox.Common.ConstantValues.XTF_TRANSITION,"",Intelledox.Common.ConstantValues.XTF_SUBMITTINGTEXT,transition.SubmittingText,header);csv+=this.createLanguageTranslationRow(transition.StateId,state.Id,Intelledox.Common.ConstantValues.XTF_TRANSITION,"",Intelledox.Common.ConstantValues.XTF_RESPONSESUBMITTEDTEXT,transition.ResponsesSubmittedText,header);csv+=this.createLanguageTranslationRow(transition.StateId,state.Id,Intelledox.Common.ConstantValues.XTF_TRANSITION,"",Intelledox.Common.ConstantValues.XTF_OFFLINEREDIRECTMESSAGE,transition.OfflineRedirectMessage,header);if(transition.SendEmail&&transition.SendTo!==Intelledox.QAWizard.Design.StateTransitionSendTo.Group){csv+=this.createLanguageTranslationRow(transition.StateId,state.Id,Intelledox.Common.ConstantValues.XTF_TRANSITION,"",Intelledox.Common.ConstantValues.XTF_EMAILSUBJECT,transition.EmailSubject,header);csv+=this.createLanguageTranslationRow(transition.StateId,state.Id,Intelledox.Common.ConstantValues.XTF_TRANSITION,"",Intelledox.Common.ConstantValues.XTF_EMAILTEXT,transition.EmailText,header)}}if(transition.Actions.length>0){for(var actionIndex=0;actionIndex<transition.Actions.length;actionIndex++){csv+=this.createActionCSV(transition.Actions[actionIndex],actionAttributes,header)}}}}if(state.EscalationList!=null){for(var escalationIndex=0;escalationIndex<state.EscalationList.length;escalationIndex++){var escalation=state.EscalationList[escalationIndex];var translationElementTypeIds=escalationAttributes[escalation.Type.routingTypeId].filter(function(a){return a.allowTranslation===true}).map(function(x){return x.routingElementTypeId});if(translationElementTypeIds.length>0){var translationInputs=escalation.EscalationInputs.filter(function(i){return i.SourceType===Intelledox.Model.RoutingSourceType.FixedValue&&translationElementTypeIds.indexOf(i.ElementTypeId)!==-1});for(var inputIndex=0;inputIndex<translationInputs.length;inputIndex++){var escalationInput=translationInputs[inputIndex];csv+=this.createLanguageTranslationRow(escalationInput.RoutingOptionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUT,"",Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUTVALUE,escalationInput.FixedValue,header)}}}}return csv};LanguageTranslationExportHelper.prototype.createLanguageTranslationRow=function(controlGuid,parentGuid,description,questionReference,propertyName,defaultLanguage,header,skipIfEmpty){if(skipIfEmpty===void 0){skipIfEmpty=true}if(!(skipIfEmpty&&System.String.IsNullOrEmpty(defaultLanguage))){var csvControlGuid=controlGuid;if(description==Intelledox.Common.ConstantValues.XTF_TRANSITION||description==Intelledox.Common.ConstantValues.XTF_DISPLAYFIELDCOLUMNTITLE){csvControlGuid=controlGuid+"|"+parentGuid}if(header.length>5){var columns=[csvControlGuid,description,questionReference,propertyName,this.createLanguageTranslationString(defaultLanguage)];for(var transIndex=5;transIndex<header.length;transIndex++){var existingTranslations;switch(description){case Intelledox.Common.ConstantValues.XTF_HEADERINFO:existingTranslations=this._editor.wizard.LanguageTranslations.filter(function(x){return x.description===Intelledox.Common.ConstantValues.XTF_HEADERINFO&&x.lang===header[transIndex]});break;case Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO:existingTranslations=this._editor.wizard.LanguageTranslations.filter(function(x){return x.description===Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO&&x.lang===header[transIndex]});break;case Intelledox.Common.ConstantValues.XTF_STATE:existingTranslations=this._editor.wizard.LanguageTranslations.filter(function(x){return x.description===Intelledox.Common.ConstantValues.XTF_STATE&&x.controlGuid==controlGuid&&x.lang===header[transIndex]});break;case Intelledox.Common.ConstantValues.XTF_TRANSITION:existingTranslations=this._editor.wizard.LanguageTranslations.filter(function(x){return x.controlGuid==controlGuid&&x.parentGuid==parentGuid&&x.lang===header[transIndex]});break;default:existingTranslations=this._editor.wizard.LanguageTranslations.filter(function(x){return x.controlGuid==controlGuid&&x.lang===header[transIndex]});break}if(existingTranslations.length===1&&!System.String.IsNullOrEmpty(existingTranslations[0].translations[propertyName])){columns[transIndex]=this.createLanguageTranslationString(existingTranslations[0].translations[propertyName])}else{columns[transIndex]=""}}return columns.join(',')+this._newLine}else{return csvControlGuid+","+description+","+questionReference+","+propertyName+","+this.createLanguageTranslationString(defaultLanguage)+this._newLine}}else{return""}};LanguageTranslationExportHelper.prototype.createLanguageTranslationString=function(value){if(value.indexOf(",")>-1||value.indexOf("\n")>-1||value.indexOf("\"")>-1){return"\""+value.replace(/"/g,"\"\"")+"\""}else{return value}};return LanguageTranslationExportHelper}());Design.LanguageTranslationExportHelper=LanguageTranslationExportHelper})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ValidationHelper=(function(){function ValidationHelper($q,filter,listManager){this._dataSources=[];this._dataObjects={};this._dataFields={};this._keyFields={};this._q=$q;this._filter=filter;this._listManager=listManager;this._validator=new Design.ValidationWizard(filter,listManager);this.results=[];this.fragmentOutputs={};this.contentItemPlaceholders=[]}Object.defineProperty(ValidationHelper.prototype,"validationErrorCallback",{set:function(callback){this._validator.validationErrorCallback=callback},enumerable:true,configurable:true});Object.defineProperty(ValidationHelper.prototype,"progressCallback",{set:function(callback){this._validator.progressCallback=callback},enumerable:true,configurable:true});Object.defineProperty(ValidationHelper.prototype,"validationCompleteCallback",{set:function(callback){this._validator.validationCompleteCallback=callback},enumerable:true,configurable:true});ValidationHelper.prototype.runWorker=function(){var vm=this;var promises=[];var dependantPromises=[];var contentItems;promises.push(this._listManager.getContentItems().then(function(content){contentItems=content}));var contentFolders;promises.push(this._listManager.contentFolders().then(function(folders){contentFolders=folders}));var responseMetadataFields;promises.push(this._listManager.responseMetadataFields().then(function(fields){responseMetadataFields=fields}));var actionAttributes={};promises.push(this._listManager.actionTypes().then(function(actionTypes){angular.forEach(actionTypes,function(actionType){dependantPromises.push(vm._listManager.routingElementTypes(actionType.routingTypeId).then(function(currentActionAttributes){actionAttributes[actionType.routingTypeId]=currentActionAttributes}))})}));var customQuestionInputs={};promises.push(this._listManager.customQuestionTypes().then(function(customQuestionTypes){angular.forEach(customQuestionTypes,function(customQuestionType){dependantPromises.push(vm._listManager.customQuestionInputTypes(customQuestionType.customQuestionTypeId).then(function(currentCustomQuestionInputs){customQuestionInputs[customQuestionType.customQuestionTypeId]=currentCustomQuestionInputs}))})}));var escalationAttributes={};promises.push(this._listManager.escalationTypes().then(function(escalationTypes){angular.forEach(escalationTypes,function(escalationType){dependantPromises.push(vm._listManager.routingElementTypes(escalationType.routingTypeId).then(function(currentEscalationAttributes){escalationAttributes[escalationType.routingTypeId]=currentEscalationAttributes}))})}));for(var pageIndex=0;pageIndex<this.wizard.Pages.length;pageIndex++){this.prepareValidationRecursive(promises,this.wizard.Pages[pageIndex])}this._q.all(promises).then(function(){return vm._q.all(dependantPromises)}).then(function(){vm._validator.validate(vm.wizard,vm.documentInterface.getBookmarkDictionary(),contentItems,vm._dataSources,vm._dataObjects,vm._dataFields,vm._keyFields,contentFolders,vm.contentItemPlaceholders,actionAttributes,customQuestionInputs,escalationAttributes,vm.fragmentOutputs,responseMetadataFields)})};ValidationHelper.prototype.prepareValidationRecursive=function(promises,currentNode){if(typeof currentNode.HasFragmentInterface!=="undefined"){var fragmentGuid=currentNode.ObjectId;if(!this.fragmentOutputs.hasOwnProperty(fragmentGuid)){var vm=this;promises.push(this._listManager.projectFragment(currentNode.ProjectGuid).then(function(fragWiz){if(fragWiz!=null){vm.fragmentOutputs[fragmentGuid]=fragWiz.AvailableOutputs}}))}}else if(currentNode instanceof Intelledox.QAWizard.Design.DatasourceQuestion){var vm=this;var q=currentNode;this._dataSources.push(q.DataSourceGuid);promises.push(this._listManager.dataObjects(q.DataSourceGuid).then(function(dataObjects){vm._dataObjects[q.DataSourceGuid]=dataObjects}));promises.push(this._listManager.dataFields(q.DataObjectGuid,true,"").then(function(dfs){vm._dataFields[q.DataObjectGuid]=dfs}));promises.push(this._listManager.keyFields(q.DataObjectGuid,"").then(function(kfs){vm._keyFields[q.DataObjectGuid]=kfs}))}else if(typeof currentNode.HasContainerInterface!=="undefined"){for(var childIndex=0;childIndex<currentNode.Children.length;childIndex++){this.prepareValidationRecursive(promises,currentNode.Children[childIndex])}}};return ValidationHelper}());Design.ValidationHelper=ValidationHelper})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var PropertiesModalCtrl=(function(){function PropertiesModalCtrl($filter,editorViewModel){this._selectedName='';this._selectedInitialValue='';this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.Wizard=null;this._editorViewModel=editorViewModel;this._filter=$filter;this.Wizard=editorViewModel.wizard;this.sortProjectProperties()}Object.defineProperty(PropertiesModalCtrl.prototype,"selectedName",{get:function(){return this._selectedName},set:function(value){this._selectedName=value;this.updateButtons()},enumerable:true,configurable:true});Object.defineProperty(PropertiesModalCtrl.prototype,"selectedInitialValue",{get:function(){return this._selectedInitialValue},set:function(value){this._selectedInitialValue=value;this.updateButtons()},enumerable:true,configurable:true});PropertiesModalCtrl.prototype.add=function(){if(this.hasProjectProperty(this._selectedName)){alert(this._filter('translate')('ErrorMsg_ProjectPropertyExists'));return}var newProjectProperty=new Intelledox.QAWizard.Design.ProjectProperty;newProjectProperty.Id=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();newProjectProperty.Name=this._selectedName;newProjectProperty.InitialValue=this._selectedInitialValue;this.Wizard.Properties.push(newProjectProperty);this._selectedProjectProperty=newProjectProperty;this.sortProjectProperties();this.updateButtons();this._editorViewModel.wizChanged=true};PropertiesModalCtrl.prototype.update=function(){if(this._selectedProjectProperty.Name!=this._selectedName&&this.hasProjectProperty(this._selectedName)){alert(this._filter('translate')('ErrorMsg_ProjectPropertyExists'));return}this._selectedProjectProperty.Name=this._selectedName;this._selectedProjectProperty.InitialValue=this._selectedInitialValue;this.sortProjectProperties();this._editorViewModel.wizChanged=true};PropertiesModalCtrl.prototype.remove=function(){this.Wizard.Properties.splice(this.Wizard.Properties.indexOf(this._selectedProjectProperty),1);this._selectedProjectProperty=null;this.updateButtons();this._editorViewModel.wizChanged=true};PropertiesModalCtrl.prototype.updateButtons=function(){this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;if(this._selectedName!==''){this.isAddEnabled=true;if(this._selectedProjectProperty!=null){this.isUpdateEnabled=true}}if(this._selectedProjectProperty!=null){this.isRemoveEnabled=true}};PropertiesModalCtrl.prototype.selectProjectProperty=function(projectProperty){for(var i=0;i<this.Wizard.Properties.length;i++){if(this.Wizard.Properties[i]===projectProperty){this.Wizard.Properties[i]["selected"]=true;this._selectedProjectProperty=projectProperty;this._selectedName=projectProperty.Name;this._selectedInitialValue=projectProperty.InitialValue}else{this.Wizard.Properties[i]["selected"]=false}}this.updateButtons()};PropertiesModalCtrl.prototype.hasProjectProperty=function(name){for(var i=0;i<this.Wizard.Properties.length;i++){if(this.Wizard.Properties[i].Name===name){return true}}return false};PropertiesModalCtrl.prototype.sortProjectProperties=function(){var _this=this;this.Wizard.Properties.sort(function(a,b){return _this.compare(a,b)})};PropertiesModalCtrl.prototype.compare=function(a,b){if(a.Name>b.Name){return 1}else if(a.Name<b.Name){return-1}else{return 0}};return PropertiesModalCtrl}());Design.PropertiesModalCtrl=PropertiesModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Page=(function(){function Page(pageGuid){this.PageGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.m_LayoutNodes=new Array;this.IsRepeated=false;this.RepeatTitle="";this.MaximumRepeats=null;this.MinimumRepeats=null;this.CreateMinimumRepeats=false;this.RepeatSourceType=Design.RepeatSourceType.None;this.RepeatSourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.RepeatSourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.IsEditableDrivenRepeat=true;this.ID=0;this.Name=null;this.ShowFillDownButton=false;this.RepeatName="";this.CssStyle=null;this.Summary=null;this.AllowSorting=true;this.PageGuid=pageGuid;this.Questions=new Array;this.RepeatPlaceholders=new Array}Object.defineProperty(Page.prototype,"ObjectId",{get:function(){return this.PageGuid},set:function(value){this.PageGuid=value},enumerable:true,configurable:true});Page.prototype.Clone=function(nextId,addQuestionsToPage){if(addQuestionsToPage===void 0){addQuestionsToPage=null}var result=new Page(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());this.CloneWithoutChildren(result);for(var i=0;i<this.Children.length;i++){var node=this.Children[i];if(node instanceof Design.Question){var newQuestion=node.Clone(nextId,result);result.Children.push(newQuestion)}else{result.Children.push(node.Clone(nextId,result))}}return result};Page.prototype.CloneWithoutChildren=function(result){result.Name=this.Name;result.IsRepeated=this.IsRepeated;result.RepeatTitle=this.RepeatTitle;result.MaximumRepeats=this.MaximumRepeats;result.MinimumRepeats=this.MinimumRepeats;result.CreateMinimumRepeats=this.CreateMinimumRepeats;result.RepeatSourceType=this.RepeatSourceType;result.RepeatSourceGuid=this.RepeatSourceGuid;result.RepeatSourceAttributeGuid=this.RepeatSourceAttributeGuid;result.IsEditableDrivenRepeat=this.IsEditableDrivenRepeat;result.ShowFillDownButton=this.ShowFillDownButton;result.RepeatName=this.RepeatName;result.CssStyle=this.CssStyle;result.AllowSorting=this.AllowSorting;if(this.ActiveConditions!=null){result.ActiveConditions=this.ActiveConditions.Clone()}if(this.VisibleConditions!=null){result.VisibleConditions=this.VisibleConditions.Clone()}if(this.EditableConditions!=null){result.EditableConditions=this.EditableConditions.Clone()}if(this.RepeatConditions!=null){result.RepeatConditions=this.RepeatConditions.Clone()}if(this.Summary!=null){result.Summary=this.Summary.Clone()}return result};Page.prototype.QuestionByGuid=function(guid){for(var i=0;i<this.Questions.length;i++){if(this.Questions[i].QuestionGuid===guid){return this.Questions[i]}}return null};Object.defineProperty(Page.prototype,"Children",{get:function(){return this.m_LayoutNodes},enumerable:true,configurable:true});Page.prototype.FindChildObject=function(objectId,parentNode){if(parentNode===void 0){parentNode=null}if(parentNode==null){parentNode=this}try{if(parentNode.ObjectId===objectId){return parentNode}else if(typeof(parentNode.HasContainerInterface)!=="undefined"){for(var i=0;i<parentNode.Children.length;i++){var result=this.FindChildObject(objectId,parentNode.Children[i]);if(result!=null){return result}}}}catch(ex){}return null};Page.prototype.HasContainerInterface=function(){return true};Page.prototype.HasQAContainerInterface=function(){return true};Page.prototype.HasLayoutInterface=function(){return true};Page.prototype.HasChild=function(childGuid){if(childGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return false}else if(this.PageGuid===childGuid){return true}else{for(var i=0;i<this.Children.length;i++){if(this.Children[i].HasChild(childGuid)){return true}}return false}};Page.prototype.NonRepeatingQuestions=function(){var children=new Array;var results=new Array;children.push(this);while(children.length>0){var current=children.pop();if(current instanceof Design.Question){results.push(current)}else if(typeof current.HasContainerInterface!=="undefined"&&(!(current instanceof Design.Section)||!current.IsRepeated)){for(var i=current.Children.length-1;i>=0;i--){children.push(current.Children[i])}}}return results};return Page}());Design.Page=Page})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var SummarySettingsPanelViewModel=(function(){function SummarySettingsPanelViewModel($filter,editorViewModel){this._wizard=null;this._page=null;this._question=null;this.isPageSelected=false;this.isQuestionSelected=false;this.isLogicQuestionSelected=false;this.pageIncludeOptions=[{name:'',value:null},{name:'Include',value:true},{name:'Exclude',value:false}];this.pageCollapsibleOptions=[{name:'',value:null},{name:'Collapsible',value:true},{name:'NotCollapsible',value:false}];this.questionIncludeOptions=[{name:'',value:Intelledox.QAWizard.Design.QuestionSummaryInclude.Default},{name:'Visible',value:Intelledox.QAWizard.Design.QuestionSummaryInclude.Visible},{name:'Active',value:Intelledox.QAWizard.Design.QuestionSummaryInclude.Active},{name:'Include',value:Intelledox.QAWizard.Design.QuestionSummaryInclude.Include},{name:'Exclude',value:Intelledox.QAWizard.Design.QuestionSummaryInclude.Exclude}];this.questionShowAllOptions=[{name:'',value:null},{name:'ShowAll',value:true},{name:'ShowSelected',value:false}];this._editorViewModel=editorViewModel;this._filter=$filter}Object.defineProperty(SummarySettingsPanelViewModel.prototype,"selectedPageInclude",{get:function(){if(this._page.Summary==null){return null}return this._page.Summary.Include},set:function(value){this.createPageSummary();this._page.Summary.Include=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(SummarySettingsPanelViewModel.prototype,"selectedPageCollapsible",{get:function(){if(this._page.Summary==null){return null}return this._page.Summary.Collapsible},set:function(value){this.createPageSummary();this._page.Summary.Collapsible=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(SummarySettingsPanelViewModel.prototype,"selectedQuestionInclude",{get:function(){if(this._question.Summary==null){return Intelledox.QAWizard.Design.QuestionSummaryInclude.Default}return this._question.Summary.Include},set:function(value){this.createQuestionSummary();this._question.Summary.Include=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(SummarySettingsPanelViewModel.prototype,"questionTitle",{get:function(){if(this._question.Summary==null){return''}return this._question.Summary.Title},set:function(value){this.createQuestionSummary();this._question.Summary.Title=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(SummarySettingsPanelViewModel.prototype,"selectedQuestionShowall",{get:function(){if(this._question.Summary==null){return null}return this._question.Summary.ShowAll},set:function(value){this.createQuestionSummary();this._question.Summary.ShowAll=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});SummarySettingsPanelViewModel.prototype.init=function(wizard,selectedItem){var vm=this;this._page=null;this._question=null;this.isPageSelected=false;this.isQuestionSelected=false;this.isLogicQuestionSelected=false;if(selectedItem instanceof Intelledox.QAWizard.Design.Page){this._page=selectedItem;this.isPageSelected=true}else{this._question=selectedItem;this.isQuestionSelected=true;this.isLogicQuestionSelected=(selectedItem instanceof Intelledox.QAWizard.Design.GroupLogicQuestion)}this._wizard=wizard};SummarySettingsPanelViewModel.prototype.pickQuestionTitleRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.questionTitle=Design.HelperFunctions.onPickRef(_this._filter,_this.questionTitle,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};SummarySettingsPanelViewModel.prototype.createPageSummary=function(){if(this._page.Summary==null){this._page.Summary=new Intelledox.QAWizard.Design.Summary.PageSummarySettings}};SummarySettingsPanelViewModel.prototype.createQuestionSummary=function(){if(this._question.Summary==null){this._question.Summary=new Intelledox.QAWizard.Design.Summary.QuestionSummarySettings}};return SummarySettingsPanelViewModel}());Design.SummarySettingsPanelViewModel=SummarySettingsPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var PropertiesViewModel=(function(){function PropertiesViewModel(){}return PropertiesViewModel}());Design.PropertiesViewModel=PropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var QuestionPropertiesViewModel=(function(_super){__extends(QuestionPropertiesViewModel,_super);function QuestionPropertiesViewModel(editorViewModel,question,$filter,lists){var _this=_super.call(this)||this;_this._propertiesTitle='';_this.availableCssStyles=[];_this._editorViewModel=editorViewModel;_this._question=question;_this._filter=$filter;_this.setPropertiesTitle(lists);lists.cssStyles('question').then(function(data){return _this.loadCssStyles(data)});return _this}Object.defineProperty(QuestionPropertiesViewModel.prototype,"ID",{get:function(){return this._question.ID},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"QuestionTypeID",{get:function(){return this._question.QuestionTypeID},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"Text",{get:function(){return this._question.Text},set:function(value){if(this._question.Answers!=null&&this._question.Answers.length>0&&(this.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||this.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||this.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RichText||this.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Ink)){if(this.compareQuestionTextAndAnswerName(this._question.Text,this._question.Answers[0].Name)){this._question.Answers[0].Name=value;this._editorViewModel.treeView.findNodeByTag(this._editorViewModel.treeView.selectedNode,this._question.Answers[0]).text=value}}this._question.Text=value;this._editorViewModel.wizChanged=true;this._editorViewModel.treeView.selectedNode.text=value},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"TextPosition",{get:function(){return this._question.TextPosition.toString()},set:function(value){this._question.TextPosition=parseInt(value,10);this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"CssStyle",{get:function(){return this._question.CssStyle},set:function(value){this._question.CssStyle=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"WidthType",{get:function(){return this._question.WidthType.toString()},set:function(value){this._question.WidthType=parseInt(value,10);this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"LeftQuestionWidth",{get:function(){if(this._question.LeftQuestionWidth===0){return''}return this._question.LeftQuestionWidth.toString()},set:function(value){this._question.LeftQuestionWidth=parseInt(value,10);if(isNaN(this._question.LeftQuestionWidth)){this._question.LeftQuestionWidth=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"HelpText",{get:function(){return this._question.HelpText},set:function(value){this._question.HelpText=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"AllowComments",{get:function(){return this._question.AllowComments},set:function(value){this._question.AllowComments=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"DefaultValue",{get:function(){return this._question.DefaultValue},set:function(value){this._question.DefaultValue=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"visibility",{get:function(){return this._question.Visibility},set:function(value){this._question.Visibility=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"mandatory",{get:function(){if(this.hasMandatoryConditions){return true}return(this._question.Mandatory===Intelledox.QAWizard.Design.MandatoryType.Yes)},set:function(value){if(value){this._question.Mandatory=Intelledox.QAWizard.Design.MandatoryType.Yes}else{this._question.Mandatory=Intelledox.QAWizard.Design.MandatoryType.No}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"hasMandatoryConditions",{get:function(){return(this._question.Mandatory===Intelledox.QAWizard.Design.MandatoryType.Conditional)},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"isPlainQuestionText",{get:function(){return(this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable)},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"isPlainDefaultText",{get:function(){return(this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label&&!this._question.Visibility)},enumerable:true,configurable:true});QuestionPropertiesViewModel.prototype.compareQuestionTextAndAnswerName=function(questionText,answerName){if(questionText==null)questionText="";if(System.String.StartsWith(answerName,System.String.Format(this._filter('translate')('NewObjectFormat'),this._filter('translate')('Answer'),""))){answerName=""}if(System.String.IsNullOrEmpty(answerName)){return true}else{return(Intelledox.Common.Functions.EqualsIgnoreCase(questionText,answerName)||System.String.StartsWithIgnoreCase(questionText,answerName))}};QuestionPropertiesViewModel.prototype.loadCssStyles=function(data){this.availableCssStyles.push({name:this._filter('translate')('NoneWithBrackets'),value:""});for(var i=0;i<data.length;i++){var item=data[i];this.availableCssStyles.push({name:item.cssName,value:item.webClass})}if(this.CssStyle!==""&&this.CssStyle!==null){this.CssStyle=this._question.CssStyle}else{this.CssStyle=""}};QuestionPropertiesViewModel.prototype.pickDefaultValueRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.DefaultValue=Design.HelperFunctions.onPickRef(_this._filter,_this.DefaultValue,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};Object.defineProperty(QuestionPropertiesViewModel.prototype,"ShowVisible",{get:function(){if(this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary){return true}return false},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"ShowFindDependencies",{get:function(){if(this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Ink||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary){return false}return true},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"ShowTextPosition",{get:function(){var visibility=(this.ShowVisible&&this._question.Visibility);var isVisible=((this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&visibility)||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Ink||(this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label&&visibility)||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||(this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary&&visibility)||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RichText||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary);return isVisible},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"ShowStyles",{get:function(){return this.ShowTextPosition||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"ShowAllowComments",{get:function(){if(this._editorViewModel.wizard.TypeId===Intelledox.Model.ProjectType.Dashboard||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary||(this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button&&this._question.ButtonType!==Intelledox.Model.ButtonType.Toggle)||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton){return false}return this._question.Visibility},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"ShowHelpText",{get:function(){if(this._question.TextPosition===Intelledox.QAWizard.Design.TextPosition.None){return false}if(this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary){return false}if(this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary){var q=this._question;if(q.ContentTypeRestriction===Intelledox.Model.ContentType.Image){return false}}return this._question.Visibility},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"ShowLeftOptions",{get:function(){return this._question.TextPosition===Intelledox.QAWizard.Design.TextPosition.Left&&this._question.Visibility},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"PropertiesTitle",{get:function(){return this._propertiesTitle},enumerable:true,configurable:true});Object.defineProperty(QuestionPropertiesViewModel.prototype,"canBeMandatory",{get:function(){return(this._editorViewModel.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard)},enumerable:true,configurable:true});QuestionPropertiesViewModel.prototype.setPropertiesTitle=function(lists){switch(this._question.QuestionTypeID){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Datasource'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('SimpleLogic'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('UserPrompt'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Label'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Address'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('GroupLogic'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Variable'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary:if(this._question.IsFileSelection){this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('FileSelection'))}else{this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('ContentLibrary'))}break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('AutoLogic'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Chart'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Barcode'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RichText:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('RichText'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Ink:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Ink'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Validator'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom:var vm=this;this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Custom'));lists.customQuestionType(this._question.CustomQuestionTypeId).then(function(customType){vm._propertiesTitle=System.String.Format(vm._filter('translate')('QuestionPropertiesTitle'),customType.description)});break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Geolocation'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Numeric'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Button'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('Summary'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton:this._propertiesTitle=System.String.Format(this._filter('translate')('QuestionPropertiesTitle'),this._filter('translate')('RunActionButton'));break}};Object.defineProperty(QuestionPropertiesViewModel.prototype,"QuestionLabel",{get:function(){if(this._question instanceof Intelledox.QAWizard.Design.ValidationQuestion){return this._filter('translate')('Message')}else if(this._question instanceof Intelledox.QAWizard.Design.LabelQuestion){return this._filter('translate')('LabelName')}else if(this._question instanceof Intelledox.QAWizard.Design.AutoLogicQuestion){return this._filter('translate')('QuestionName')}else if(this._question instanceof Intelledox.QAWizard.Design.RunActionButtonQuestion){return this._filter('translate')('ButtonText')}return this._filter('translate')('QuestionText')},enumerable:true,configurable:true});QuestionPropertiesViewModel.prototype.findDependencies=function(){this._editorViewModel.displayFoundItems(Design.DependencyHelper.getLogicDependencies(this._editorViewModel.wizard,this._question,false),true,'','')};QuestionPropertiesViewModel.prototype.validateQuestionWidth=function(){if(this._question.LeftQuestionWidth===0){if(this._question.WidthType===Intelledox.QAWizard.Design.WidthType.Pixel){this._question.LeftQuestionWidth=Intelledox.Common.ConstantValues.DEFAULTLEFTQUESTIONWIDTH_PIXELS}else{this._question.LeftQuestionWidth=Intelledox.Common.ConstantValues.DEFAULTLEFTQUESTIONWIDTH_PERCENT}}else if(this._question.WidthType===Intelledox.QAWizard.Design.WidthType.Percentage&&this._question.LeftQuestionWidth>99){if(this._question.LeftQuestionWidth===Intelledox.Common.ConstantValues.DEFAULTLEFTQUESTIONWIDTH_PIXELS){this._question.LeftQuestionWidth=Intelledox.Common.ConstantValues.DEFAULTLEFTQUESTIONWIDTH_PERCENT}else{this._question.LeftQuestionWidth=99}}};return QuestionPropertiesViewModel}(Design.PropertiesViewModel));Design.QuestionPropertiesViewModel=QuestionPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var RunActionButtonPropertiesViewModel=(function(_super){__extends(RunActionButtonPropertiesViewModel,_super);function RunActionButtonPropertiesViewModel(editorViewModel,question,$filter,$uibModal,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._filterLocal=$filter;_this._modal=$uibModal;_this._editor=editorViewModel;_this._runActionButton=question;_this._listManager=lists;return _this}Object.defineProperty(RunActionButtonPropertiesViewModel.prototype,"ClassName",{get:function(){return this._runActionButton.ClassName},set:function(value){this._runActionButton.ClassName=value;this._editor.wizChanged=true},enumerable:true,configurable:true});return RunActionButtonPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.RunActionButtonPropertiesViewModel=RunActionButtonPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ProtectedFieldsPanelViewModel=(function(){function ProtectedFieldsPanelViewModel($filter,editorViewModel){this._selectedName='';this._selectedReference='';this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.Wizard=null;this._editorViewModel=editorViewModel;this._filter=$filter}Object.defineProperty(ProtectedFieldsPanelViewModel.prototype,"selectedName",{get:function(){return this._selectedName},set:function(value){this._selectedName=value;this.updateButtons()},enumerable:true,configurable:true});Object.defineProperty(ProtectedFieldsPanelViewModel.prototype,"selectedReference",{get:function(){return this._selectedReference},set:function(value){this._selectedReference=value;this.updateButtons()},enumerable:true,configurable:true});ProtectedFieldsPanelViewModel.prototype.add=function(){if(this.hasProtectedField(this._selectedName)){alert(this._filter('translate')('ErrorMsg_ProtectedFieldExists'));return}var newProtectedField=new Intelledox.QAWizard.Design.ProtectedField;newProtectedField.Name=this._selectedName;newProtectedField.Reference=this._selectedReference;this.Wizard.ProtectedFields.push(newProtectedField);this._selectedProtectedField=newProtectedField;this.sortProtectedFields();this.updateButtons();this._editorViewModel.wizChanged=true};ProtectedFieldsPanelViewModel.prototype.update=function(){if(this._selectedProtectedField.Name!=this._selectedName&&this.hasProtectedField(this._selectedName)){alert(this._filter('translate')('ErrorMsg_ProtectedFieldExists'));return}this._selectedProtectedField.Name=this._selectedName;this._selectedProtectedField.Reference=this._selectedReference;this.sortProtectedFields();this._editorViewModel.wizChanged=true};ProtectedFieldsPanelViewModel.prototype.remove=function(){this.Wizard.ProtectedFields.splice(this.Wizard.ProtectedFields.indexOf(this._selectedProtectedField),1);this._selectedProtectedField=null;this.updateButtons();this._editorViewModel.wizChanged=true};ProtectedFieldsPanelViewModel.prototype.init=function(wizard){this.Wizard=wizard;this.sortProtectedFields()};ProtectedFieldsPanelViewModel.prototype.updateButtons=function(){this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;if(this._selectedName!==''&&this._selectedReference!==''){this.isAddEnabled=true;if(this._selectedProtectedField!=null){this.isUpdateEnabled=true}}if(this._selectedProtectedField!=null){this.isRemoveEnabled=true}};ProtectedFieldsPanelViewModel.prototype.selectProtectedField=function(protectedField){this._selectedProtectedField=protectedField;this._selectedName=protectedField.Name;this._selectedReference=protectedField.Reference;this.updateButtons()};ProtectedFieldsPanelViewModel.prototype.hasProtectedField=function(name){for(var i=0;i<this.Wizard.ProtectedFields.length;i++){if(this.Wizard.ProtectedFields[i].Name===name){return true}}return false};ProtectedFieldsPanelViewModel.prototype.pickRef=function(){var _this=this;var insertPoint=document.getElementById('fieldReference').selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.selectedReference=Design.HelperFunctions.onPickRef(_this._filter,_this._selectedReference,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};ProtectedFieldsPanelViewModel.prototype.sortProtectedFields=function(){var _this=this;this.Wizard.ProtectedFields.sort(function(a,b){return _this.compare(a,b)})};ProtectedFieldsPanelViewModel.prototype.compare=function(a,b){if(a.Name>b.Name){return 1}else if(a.Name<b.Name){return-1}else{return 0}};return ProtectedFieldsPanelViewModel}());Design.ProtectedFieldsPanelViewModel=ProtectedFieldsPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Escalation=(function(){function Escalation(){this.Name=null;this.ExpireAfter=0;this.WorkingDays=false;this.ExpiryDateQuestionReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this.ExpiryDateAnswerReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Recurs=false;this.InitialisationType=Intelledox.Model.EscalationInitialisationType.Days;this.Recurrence=new Intelledox.Model.RecurrencePattern;this.Conditions=new Design.Condition;this.Type=new Intelledox.Model.RoutingType;this.Type.routingTypeId=Intelledox.Common.ConstantValues.EMAIL_ESCALATION_GUID}Object.defineProperty(Escalation.prototype,"EscalationInputs",{get:function(){if(this.m_EscalationInputs==null){this.m_EscalationInputs=new Array}return this.m_EscalationInputs},enumerable:true,configurable:true});return Escalation}());Design.Escalation=Escalation})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var RecurrencePanelViewModel=(function(){function RecurrencePanelViewModel($filter,editorViewModel,parent,wiz,availableQuestions){this._escalation=null;this._wizard=null;this._rangeOfRecurrence=3;this.isAnswerVisible=false;this.availableQuestions=[];this.availableAnswers=[];this._editorViewModel=editorViewModel;this._filter=$filter;this._escalation=parent;this._wizard=wiz;this.availableQuestions=availableQuestions;if(parent.Recurrence==null){parent.Recurrence=new Intelledox.Model.RecurrencePattern;parent.Recurrence.RepeatCount=10;parent.Recurrence.RepeatDays=10}this._endOccurrences='10';this._endAfterDays='10';this._hours='1';this._dailySpecified='1';this._weeklySpecified='1';this._dayMonthRecurrence='1';this._monthlyDay='1';this._monthlySpecifiedRecurrence='1';this._dailyWeekday=0;this._monthlyWeekday=0;this._selectedBySetPosition=0;this._selectedDayOfWeek="SU";this._monday=true;this._tuesday=true;this._wednesday=true;this._thursday=true;this._friday=true;this._saturday=true;this._sunday=true;this.daysOfTheWeek();this.firstSecond();this.loadAnswers();this.enableDisableQuestionReferenceAnswer();switch(parent.Recurrence.Frequency){case Intelledox.Model.FrequencyEnum.Hourly:this._hours=parent.Recurrence.Interval.toString();break;case Intelledox.Model.FrequencyEnum.Daily:if(parent.Recurrence.ByDay.length!==0){this._dailyWeekday=1}else{this._dailyWeekday=0;this._dailySpecified=parent.Recurrence.Interval.toString()}break;case Intelledox.Model.FrequencyEnum.Weekly:this._weeklySpecified=parent.Recurrence.Interval.toString();this._monday=false;this._tuesday=false;this._wednesday=false;this._thursday=false;this._friday=false;this._saturday=false;this._sunday=false;if(parent.Recurrence.ByDay.indexOf("SU")>-1){this._sunday=true}if(parent.Recurrence.ByDay.indexOf("MO")>-1){this._monday=true}if(parent.Recurrence.ByDay.indexOf("TU")>-1){this._tuesday=true}if(parent.Recurrence.ByDay.indexOf("WE")>-1){this._wednesday=true}if(parent.Recurrence.ByDay.indexOf("TH")>-1){this._thursday=true}if(parent.Recurrence.ByDay.indexOf("FR")>-1){this._friday=true}if(parent.Recurrence.ByDay.indexOf("SA")>-1){this._saturday=true}break;case Intelledox.Model.FrequencyEnum.Monthly:if(parent.Recurrence.ByDay.length===0){this._monthlyWeekday=0;this._monthlyDay=parent.Recurrence.ByMonthDay[0];this._dayMonthRecurrence=parent.Recurrence.Interval.toString()}else{this._monthlyWeekday=1;this._selectedBySetPosition=parent.Recurrence.BySetPosition;if(parent.Recurrence.ByDay.length>0){this._selectedDayOfWeek=parent.Recurrence.ByDay[0]}this._monthlySpecifiedRecurrence=parent.Recurrence.Interval.toString()}break}if(parent.Recurrence.RepeatDays>0){this._rangeOfRecurrence=1;this._endAfterDays=parent.Recurrence.RepeatDays.toString();this._endOccurrences='0'}else if(parent.Recurrence.RepeatCount>0){this._rangeOfRecurrence=0;this._endOccurrences=parent.Recurrence.RepeatCount.toString();this._endAfterDays='0'}else if(parent.Recurrence.RecurDateQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){this._rangeOfRecurrence=2;this.enableDisableQuestionReferenceAnswer()}}Object.defineProperty(RecurrencePanelViewModel.prototype,"endOccurrences",{get:function(){return this._endOccurrences},set:function(value){this._endOccurrences=value;this._escalation.Recurrence.RepeatCount=parseInt(value,10);if(isNaN(this._escalation.Recurrence.RepeatCount)){this._escalation.Recurrence.RepeatCount=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"endAfterDays",{get:function(){return this._endAfterDays},set:function(value){this._endAfterDays=value;this._escalation.Recurrence.RepeatDays=parseInt(value,10);if(isNaN(this._escalation.Recurrence.RepeatDays)){this._escalation.Recurrence.RepeatDays=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"hours",{get:function(){return this._hours},set:function(value){this._hours=value;this._escalation.Recurrence.Interval=parseInt(value,10);if(isNaN(this._escalation.Recurrence.Interval)){this._escalation.Recurrence.Interval=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"dailySpecified",{get:function(){return this._dailySpecified},set:function(value){this._dailySpecified=value;this._escalation.Recurrence.Interval=parseInt(value,10);if(isNaN(this._escalation.Recurrence.Interval)){this._escalation.Recurrence.Interval=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"weeklySpecified",{get:function(){return this._weeklySpecified},set:function(value){this._weeklySpecified=value;this._escalation.Recurrence.Interval=parseInt(value,10);if(isNaN(this._escalation.Recurrence.Interval)){this._escalation.Recurrence.Interval=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"sunday",{get:function(){return this._sunday},set:function(value){this._sunday=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"monday",{get:function(){return this._monday},set:function(value){this._monday=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"tuesday",{get:function(){return this._tuesday},set:function(value){this._tuesday=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"wednesday",{get:function(){return this._wednesday},set:function(value){this._wednesday=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"thursday",{get:function(){return this._thursday},set:function(value){this._thursday=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"friday",{get:function(){return this._friday},set:function(value){this._friday=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"saturday",{get:function(){return this._saturday},set:function(value){this._saturday=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"dayMonthRecurrence",{get:function(){return this._dayMonthRecurrence},set:function(value){this._dayMonthRecurrence=value;this._escalation.Recurrence.Interval=parseInt(value,10);if(isNaN(this._escalation.Recurrence.Interval)){this._escalation.Recurrence.Interval=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"monthlyDay",{get:function(){return this._monthlyDay},set:function(value){this._monthlyDay=value;var intValue=parseInt(value,10);if(isNaN(intValue)){intValue=0}this._escalation.Recurrence.ByMonthDay=[];this._escalation.Recurrence.ByMonthDay.push(intValue.toString());this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"monthlySpecifiedRecurrence",{get:function(){return this._monthlySpecifiedRecurrence},set:function(value){this._monthlySpecifiedRecurrence=value;this._escalation.Recurrence.Interval=parseInt(value,10);if(isNaN(this._escalation.Recurrence.Interval)){this._escalation.Recurrence.Interval=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"frequency",{get:function(){return this._escalation.Recurrence.Frequency},set:function(value){this._escalation.Recurrence.Frequency=value;this._editorViewModel.wizChanged=true;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"dailyWeekday",{get:function(){return this._dailyWeekday},set:function(value){this._dailyWeekday=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"monthlyWeekday",{get:function(){return this._monthlyWeekday},set:function(value){this._monthlyWeekday=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"workingDays",{get:function(){return this._escalation.Recurrence.WorkingDays},set:function(value){this._escalation.Recurrence.WorkingDays=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"selectedSetPosition",{get:function(){return this._selectedBySetPosition},set:function(value){this._selectedBySetPosition=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"selectedDayOfWeek",{get:function(){return this._selectedDayOfWeek},set:function(value){this._selectedDayOfWeek=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"recurDateQuestionReference",{get:function(){return this._escalation.Recurrence.RecurDateQuestionReference},set:function(value){this._escalation.Recurrence.RecurDateQuestionReference=value;this._editorViewModel.wizChanged=true;this.loadAnswers();this.enableDisableQuestionReferenceAnswer()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"recurDateAnswerReference",{get:function(){return this._escalation.Recurrence.RecurDateAnswerReference},set:function(value){this._escalation.Recurrence.RecurDateAnswerReference=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"rangeOfRecurrence",{get:function(){return this._rangeOfRecurrence},set:function(value){this._rangeOfRecurrence=value;this.save()},enumerable:true,configurable:true});Object.defineProperty(RecurrencePanelViewModel.prototype,"workingDaysOnly",{get:function(){return this._escalation.Recurrence.WorkingDays},set:function(value){this._escalation.Recurrence.WorkingDays=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});RecurrencePanelViewModel.prototype.save=function(){this._editorViewModel.wizChanged=true;this._escalation.Recurrence.Clear();if(this._escalation.Recurrence.Frequency===Intelledox.Model.FrequencyEnum.Hourly){this._escalation.Recurrence.Interval=parseInt(this._hours,10)}else if(this._escalation.Recurrence.Frequency===Intelledox.Model.FrequencyEnum.Daily){if(this.dailyWeekday===1){this._escalation.Recurrence.Interval=1;this._escalation.Recurrence.ByDay.push("MO");this._escalation.Recurrence.ByDay.push("TU");this._escalation.Recurrence.ByDay.push("WE");this._escalation.Recurrence.ByDay.push("TH");this._escalation.Recurrence.ByDay.push("FR")}else{if(!System.String.IsNullOrEmpty(this._dailySpecified)){this._escalation.Recurrence.Interval=parseInt(this._dailySpecified,10)}}}else if(this._escalation.Recurrence.Frequency===Intelledox.Model.FrequencyEnum.Weekly){if(!this._sunday&&!this._monday&&!this._tuesday&&!this._wednesday&&!this._thursday&&!this._friday&&!this._saturday){alert(this._filter('translate')('ErrorMsg_SelectOneDayOfTheWeek'))}this._escalation.Recurrence.Interval=parseInt(this._weeklySpecified,10);if(this._sunday){this._escalation.Recurrence.ByDay.push("SU")}if(this._monday){this._escalation.Recurrence.ByDay.push("MO")}if(this._tuesday){this._escalation.Recurrence.ByDay.push("TU")}if(this._wednesday){this._escalation.Recurrence.ByDay.push("WE")}if(this._thursday){this._escalation.Recurrence.ByDay.push("TH")}if(this._friday){this._escalation.Recurrence.ByDay.push("FR")}if(this._saturday){this._escalation.Recurrence.ByDay.push("SA")}}else if(this._escalation.Recurrence.Frequency===Intelledox.Model.FrequencyEnum.Monthly){if(this.monthlyWeekday===0){this._escalation.Recurrence.Interval=parseInt(this.dayMonthRecurrence,10);this._escalation.Recurrence.ByMonthDay.push(this.monthlyDay)}else{this._escalation.Recurrence.Interval=parseInt(this.monthlySpecifiedRecurrence,10);this._escalation.Recurrence.BySetPosition=this._selectedBySetPosition;this._escalation.Recurrence.ByDay.push(this._selectedDayOfWeek)}}if(this.rangeOfRecurrence===0){this._escalation.Recurrence.RepeatCount=parseInt(this._endOccurrences,10);this._escalation.Recurrence.RepeatDays=0}else if(this.rangeOfRecurrence===1){this._escalation.Recurrence.RepeatDays=parseInt(this._endAfterDays,10);this._escalation.Recurrence.RepeatCount=0}else if(this.rangeOfRecurrence===2){this._escalation.Recurrence.RepeatCount=0;this._escalation.Recurrence.RepeatDays=0}else{this._escalation.Recurrence.RepeatCount=0;this._escalation.Recurrence.RepeatDays=0;this._escalation.Recurrence.RecurDateQuestionReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this._escalation.Recurrence.RecurDateAnswerReference=Intelledox.Common.ConstantValues.GUID_EMPTY}};RecurrencePanelViewModel.prototype.loadAnswers=function(){this.availableAnswers=[];if(this.recurDateQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){var question=this.getSelectedQuestion();if(question!=null){for(var i=0;i<question.Answers.length;i++){this.availableAnswers.push(question.Answers[i])}}}};RecurrencePanelViewModel.prototype.daysOfTheWeek=function(){this.availableDaysOfWeek=[];this.availableDaysOfWeek.push({name:this._filter('translate')('Sunday'),value:"SU"});this.availableDaysOfWeek.push({name:this._filter('translate')('Monday'),value:"MO"});this.availableDaysOfWeek.push({name:this._filter('translate')('Tuesday'),value:"TU"});this.availableDaysOfWeek.push({name:this._filter('translate')('Wednesday'),value:"WE"});this.availableDaysOfWeek.push({name:this._filter('translate')('Thursday'),value:"TH"});this.availableDaysOfWeek.push({name:this._filter('translate')('Friday'),value:"FR"});this.availableDaysOfWeek.push({name:this._filter('translate')('Saturday'),value:"SA"})};RecurrencePanelViewModel.prototype.firstSecond=function(){this.availableFirstSecond=[];this.availableFirstSecond.push({name:this._filter('translate')('First'),value:0});this.availableFirstSecond.push({name:this._filter('translate')('Second'),value:1});this.availableFirstSecond.push({name:this._filter('translate')('Third'),value:2});this.availableFirstSecond.push({name:this._filter('translate')('Fourth'),value:3});this.availableFirstSecond.push({name:this._filter('translate')('Last'),value:4})};RecurrencePanelViewModel.prototype.getSelectedQuestion=function(){for(var i=0;i<this.availableQuestions.length;i++){if(this.recurDateQuestionReference===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};RecurrencePanelViewModel.prototype.enableDisableQuestionReferenceAnswer=function(){var q=this.getSelectedQuestion();if(q!=null&&q.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(this.isAnswerRequired(q.QuestionTypeID)){this.isAnswerVisible=true}else{this.isAnswerVisible=false}}else{this.isAnswerVisible=false}};RecurrencePanelViewModel.prototype.isAnswerRequired=function(questionType){switch(questionType){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label:return false;default:return true}};return RecurrencePanelViewModel}());Design.RecurrencePanelViewModel=RecurrencePanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ContentLibraryQuestion=(function(_super){__extends(ContentLibraryQuestion,_super);function ContentLibraryQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.AllowAddToContentLibrary=false;_this.ContentFolder=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.ContentFolderName=null;_this.ContentTypeRestriction=Intelledox.Model.ContentType.None;_this.AllowEdit=false;_this.ExistingContentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.ContentFolderRestriction=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.ContentFolderRestrictionName=null;_this.RepeatParentAnswer=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.RepeatParentField=null;_this.AttachmentFileName=null;_this.ValidExtensions=null;_this.KeepSourceFormatting=false;_this.Visibility=false;_this.DisplayType=Intelledox.Model.QuestionDisplayType.Search;return _this}Object.defineProperty(ContentLibraryQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.ContentLibrary},enumerable:true,configurable:true});ContentLibraryQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new ContentLibraryQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);result.ContentTypeRestriction=this.ContentTypeRestriction;result.AllowAddToContentLibrary=this.AllowAddToContentLibrary;result.ContentFolder=this.ContentFolder;result.AllowEdit=this.AllowEdit;result.ExistingContentItemGuid=this.ExistingContentItemGuid;result.ContentFolderRestriction=this.ContentFolderRestriction;result.RepeatParentAnswer=this.RepeatParentAnswer;result.RepeatParentField=this.RepeatParentField;result.AttachmentFileName=this.AttachmentFileName;result.ValidExtensions=this.ValidExtensions;result.ContentFolderName=this.ContentFolderName;result.ContentFolderRestrictionName=this.ContentFolderRestrictionName;result.KeepSourceFormatting=this.KeepSourceFormatting;return result};Object.defineProperty(ContentLibraryQuestion.prototype,"IsDisplayQuestionType",{get:function(){return this.Visibility},enumerable:true,configurable:true});Object.defineProperty(ContentLibraryQuestion.prototype,"IsFileSelection",{get:function(){return this.Visibility&&this.DisplayType!==Intelledox.Model.QuestionDisplayType.ExistingContentItem},enumerable:true,configurable:true});ContentLibraryQuestion.prototype.IsValidAutoAnswerParent=function(parent){switch(parent.QuestionTypeID){case Design.QuestionType.QuestionTypeEnum.Datasource:case Design.QuestionType.QuestionTypeEnum.UserPrompt:case Design.QuestionType.QuestionTypeEnum.Variable:case Design.QuestionType.QuestionTypeEnum.Label:case Design.QuestionType.QuestionTypeEnum.Numeric:return true}return false};return ContentLibraryQuestion}(Design.Question));Design.ContentLibraryQuestion=ContentLibraryQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ContentLibraryPropertiesViewModel=(function(_super){__extends(ContentLibraryPropertiesViewModel,_super);function ContentLibraryPropertiesViewModel(editorViewModel,question,wizard,$filter,$uibModal,lists,designApi){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._wizard=null;_this._isAutoAnswerVisible=false;_this.availableQuestions=null;_this.availableAnswers=null;_this.availableParentFields=null;_this.selectedContentItem='';_this.isAnswerEnabled=false;_this.isParentFieldVisible=false;_this.availableFieldWidth=0;var vm=_this;_this._filterLocal=$filter;_this._modal=$uibModal;_this._wizard=wizard;_this._lists=lists;_this._designApi=designApi;_this._editor=editorViewModel;_this._currentQuestion=question;_this.isAutoAnswerVisible=(_this._currentQuestion.RepeatParent!==Intelledox.Common.ConstantValues.GUID_EMPTY);_this.loadContentTypes();if(_this._currentQuestion.Visibility&&_this._currentQuestion.ExistingContentItemGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){lists.getContentItems().then(function(items){for(var i=0;i<items.length;i++){if(items[i].contentItemGuid===vm._currentQuestion.ExistingContentItemGuid){vm.selectedContentItem=items[i].name;break}}if(System.String.IsNullOrEmpty(vm.selectedContentItem)){vm.selectedContentItem=$filter('translate')('InvalidContentItem')}})}if(_this.isAutoAnswerVisible){_this.loadQuestions();_this.loadAnswers();_this.isAnswerEnabled=true}return _this}Object.defineProperty(ContentLibraryPropertiesViewModel.prototype,"isFileSelection",{get:function(){return false},enumerable:true,configurable:true});Object.defineProperty(ContentLibraryPropertiesViewModel.prototype,"isMandatoryVisible",{get:function(){return this._currentQuestion.Visibility&&this._currentQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.UnformattedText},enumerable:true,configurable:true});Object.defineProperty(ContentLibraryPropertiesViewModel.prototype,"isAutoAnswerVisible",{get:function(){return this._isAutoAnswerVisible},set:function(value){this._isAutoAnswerVisible=value;this._editor.wizChanged=true;if(value&&this.availableQuestions==null){this.loadQuestions();this.loadAnswers()}},enumerable:true,configurable:true});Object.defineProperty(ContentLibraryPropertiesViewModel.prototype,"selectedQuestionGuid",{get:function(){return this._currentQuestion.RepeatParent},set:function(value){this._currentQuestion.RepeatParent=value;this._editor.wizChanged=true;this.loadAnswers();this.isAnswerEnabled=true},enumerable:true,configurable:true});Object.defineProperty(ContentLibraryPropertiesViewModel.prototype,"selectedAnswerGuid",{get:function(){return this._currentQuestion.RepeatParentAnswer},set:function(value){this._currentQuestion.RepeatParentAnswer=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ContentLibraryPropertiesViewModel.prototype,"selectedParentField",{get:function(){return this._currentQuestion.RepeatParentField},set:function(value){this._currentQuestion.RepeatParentField=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ContentLibraryPropertiesViewModel.prototype,"visible",{get:function(){return this._currentQuestion.Visibility},set:function(value){this._currentQuestion.Visibility=value;this._editor.wizChanged=true;if(this._currentQuestion.Visibility){this._currentQuestion.DisplayType=Intelledox.Model.QuestionDisplayType.ExistingContentItem;this._currentQuestion.ContentTypeRestriction=Intelledox.Model.ContentType.Image;this.isAutoAnswerVisible=false;this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}else{this._currentQuestion.DisplayType=Intelledox.Model.QuestionDisplayType.Search;this._currentQuestion.ExistingContentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}this._editor.nodeSelected(this._currentQuestion)},enumerable:true,configurable:true});Object.defineProperty(ContentLibraryPropertiesViewModel.prototype,"contentType",{get:function(){return this._currentQuestion.ContentTypeRestriction},set:function(value){this._currentQuestion.ContentTypeRestriction=value;this._editor.wizChanged=true;this._currentQuestion.ExistingContentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._editor.nodeSelected(this._currentQuestion)},enumerable:true,configurable:true});ContentLibraryPropertiesViewModel.prototype.pickRef=function(){var _this=this;this._editor.treeView.pickEvent=function(node){_this.onPickRef(node)};this._editor.treeView.togglePickMode()};ContentLibraryPropertiesViewModel.prototype.onPickRef=function(node){if(node.tag instanceof Intelledox.QAWizard.Design.Question){this.selectedQuestionGuid=node.tag.QuestionGuid}else if(node.tag instanceof Intelledox.QAWizard.Design.Answer){if(node.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.selectedQuestionGuid=node.parent.tag.QuestionGuid;this.selectedParentField=node.tag.DataField}else{this.selectedQuestionGuid=node.parent.tag.QuestionGuid;this.selectedAnswerGuid=node.tag.AnswerGuid}}};ContentLibraryPropertiesViewModel.prototype.selectContentItem=function(){var vm=this;var modalConfirm=this._modal.open({templateUrl:'Views/Modal/selectContentItem.html?v=106882799234227327',controller:['$scope','$modalInstance','$filter','designApi','lists','contentTypeId',Design.SelectContentItemModalCtrl],backdrop:'static',resolve:{designApi:function(){return vm._designApi},lists:function(){return vm._lists},contentTypeId:function(){return vm.contentType}}});modalConfirm.result.then(function(selectedContentItem){vm.selectedContentItem=selectedContentItem.name;vm._currentQuestion.ExistingContentItemGuid=selectedContentItem.contentItemGuid;vm._editor.wizChanged=true})};ContentLibraryPropertiesViewModel.prototype.loadContentTypes=function(){this.availableContentTypes=[];this.availableContentTypes.push({name:this._filterLocal('translate')('Image'),value:Intelledox.Model.ContentType.Image});this.availableContentTypes.push({name:this._filterLocal('translate')('Text'),value:Intelledox.Model.ContentType.UnformattedText});this.availableContentTypes.push({name:this._filterLocal('translate')('Attachment'),value:Intelledox.Model.ContentType.Attachment})};ContentLibraryPropertiesViewModel.prototype.loadQuestions=function(){var foundThis=false;this.availableQuestions=[];for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var g=this._wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<g.Questions.length;questionIndex++){var questionItem=g.Questions[questionIndex];if(questionItem.QuestionGuid===this._currentQuestion.QuestionGuid){foundThis=true;break}if(this._currentQuestion.IsValidAutoAnswerParent(questionItem)){this.availableQuestions.push(questionItem)}}if(foundThis){break}}this.availableQuestions.sort(function(a,b){if(a.Text>b.Text){return 1}if(a.Text<b.Text){return-1}return 0});this.availableQuestions.splice(0,0,new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filterLocal('translate')('NoneWithBrackets')))};ContentLibraryPropertiesViewModel.prototype.loadAnswers=function(){var vm=this;this.availableAnswers=[];this.availableParentFields=[];if(this._currentQuestion.RepeatParent!==Intelledox.Common.ConstantValues.GUID_EMPTY){var currentParentQuestion=this.findSelectedQuestion(this._currentQuestion.RepeatParent);if(currentParentQuestion==null){return}if(currentParentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){var currentDataSourceParentQuestion=currentParentQuestion;this.isParentFieldVisible=true;var fieldSortingFunc=function(a,b){if(a.name>b.name){return 1}if(a.name<b.name){return-1}return 0};if(currentDataSourceParentQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){Design.HierarchyHelper.getDataFields(this._wizard,this._lists,currentDataSourceParentQuestion,this.availableFieldWidth,false).then(function(fields){fields.sort(fieldSortingFunc);vm.availableParentFields.push.apply(vm.availableParentFields,fields);vm.availableParentFields.splice(0,0,{name:vm._filterLocal('translate')('NoneWithBrackets'),value:vm._filterLocal('translate')('NoneWithBrackets')})})}else if(currentDataSourceParentQuestion.IsQARepeater){var fields=Design.QARepeatHelper.getDataFields(this._filterLocal,this._wizard,currentDataSourceParentQuestion);fields.sort(fieldSortingFunc);vm.availableParentFields.push.apply(vm.availableParentFields,fields);vm.availableParentFields.splice(0,0,{name:vm._filterLocal('translate')('NoneWithBrackets'),value:vm._filterLocal('translate')('NoneWithBrackets')})}else if(currentDataSourceParentQuestion.DataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(currentDataSourceParentQuestion.DataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&currentDataSourceParentQuestion.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this._lists.dataFieldsList(currentDataSourceParentQuestion.DataObjectGuid,this.availableFieldWidth,false,'').then(function(fields){fields.sort(fieldSortingFunc);vm.availableParentFields.push.apply(vm.availableParentFields,fields);vm.availableParentFields.splice(0,0,{name:vm._filterLocal('translate')('NoneWithBrackets'),value:vm._filterLocal('translate')('NoneWithBrackets')})})}}}else{this.isParentFieldVisible=false;for(var i=0;i<currentParentQuestion.Answers.length;i++){this.availableAnswers.push(currentParentQuestion.Answers[i])}this.availableAnswers.sort(function(a,b){if(a.AnswerGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return-1}if(b.AnswerGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return 1}if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0});this.availableAnswers.splice(0,0,new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,vm._filterLocal('translate')('NoneWithBrackets')))}}};ContentLibraryPropertiesViewModel.prototype.findSelectedQuestion=function(questionGuid){for(var i=0;i<this.availableQuestions.length;i++){if(questionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};return ContentLibraryPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.ContentLibraryPropertiesViewModel=ContentLibraryPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Answer=(function(){function Answer(answerGuid,answerName){this.ID=0;this.AnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.WritebackField="";this.SaveToAnswerFileBy=Design.SaveAnswerByEnum.None;this.SaveToAnswerFileLabel="";this.FormatString="";this.DataField="";if(answerGuid){this.AnswerGuid=answerGuid}if(answerName){this.Name=answerName}else{this.Name=null}}Object.defineProperty(Answer.prototype,"Question",{get:function(){return this.m_Question},set:function(value){this.m_Question=value},enumerable:true,configurable:true});Answer.prototype.Clone=function(){var result=new Answer;return this.CloneInternal(result)};Answer.prototype.CloneInternal=function(result){result.Name=this.Name;result.DataField=this.DataField;result.FormatString=this.FormatString;result.WritebackField=this.WritebackField;result.AnswerGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();result.ImageSettings.MaxHeight=this.ImageSettings.MaxHeight;result.ImageSettings.MaxWidth=this.ImageSettings.MaxWidth;result.ImageSettings.StretchToFit=this.ImageSettings.StretchToFit;result.ImageSettings.UnitOfMeasure=this.ImageSettings.UnitOfMeasure;result.ImageSettings.SizeScale=this.ImageSettings.SizeScale;result.ImageSettings.AlternativeText=this.ImageSettings.AlternativeText;if(this.SaveToAnswerFileBy!==Design.SaveAnswerByEnum.SaveByLabel){result.SaveToAnswerFileBy=this.SaveToAnswerFileBy}result.SaveToAnswerFileLabel=this.SaveToAnswerFileLabel;if(this.ActiveConditions!=null){result.ActiveConditions=this.ActiveConditions.Clone()}for(var contentIndex=0;contentIndex<this.ContentItems.length;contentIndex++){result.ContentItems.push(this.ContentItems[contentIndex].Clone())}if(this.HasValidationRules){for(var validationIndex=0;validationIndex<this.Validations.length;validationIndex++){result.Validations.push(this.Validations[validationIndex].Clone())}}return result};Object.defineProperty(Answer.prototype,"Placeholders",{get:function(){if(this.m_Placeholders==null){this.m_Placeholders=new Array}return this.m_Placeholders},enumerable:true,configurable:true});Object.defineProperty(Answer.prototype,"Validations",{get:function(){if(this.m_Validations==null){this.m_Validations=new Array}return this.m_Validations},enumerable:true,configurable:true});Object.defineProperty(Answer.prototype,"HasPlaceholders",{get:function(){return(this.m_Placeholders!=null&&this.m_Placeholders.length>0)},enumerable:true,configurable:true});Object.defineProperty(Answer.prototype,"ResponseMetadataFields",{get:function(){if(this.m_ResponseMetadataFields==null){this.m_ResponseMetadataFields=new Array}return this.m_ResponseMetadataFields},enumerable:true,configurable:true});Object.defineProperty(Answer.prototype,"HasResponseMetadataFields",{get:function(){return(this.m_ResponseMetadataFields!=null&&this.m_ResponseMetadataFields.length>0)},enumerable:true,configurable:true});Answer.prototype.AddContent=function(contentItem){if(contentItem!=null){var newContent=new QAWizard.Design.ContentItem;newContent.ContentItemGuid=contentItem.contentItemGuid;newContent.ContentTypeId=contentItem.contentTypeId;if(contentItem.contentTypeId===Intelledox.Model.ContentType.Attachment){newContent.AttachmentName=contentItem.name}this.ContentItems.push(newContent);return newContent}return null};Object.defineProperty(Answer.prototype,"HasContentItems",{get:function(){if(this.m_ContentItems!=null&&this.m_ContentItems.length>0){return true}else{return false}},enumerable:true,configurable:true});Object.defineProperty(Answer.prototype,"ContentItems",{get:function(){if(this.m_ContentItems==null){this.m_ContentItems=new Array}return this.m_ContentItems},enumerable:true,configurable:true});Object.defineProperty(Answer.prototype,"HasValidationRules",{get:function(){return(this.m_Validations!=null&&this.m_Validations.length>0)},enumerable:true,configurable:true});Object.defineProperty(Answer.prototype,"ImageSettings",{get:function(){if(this.m_ImageSettings==null){this.m_ImageSettings=new Design.ImageSettings}return this.m_ImageSettings},enumerable:true,configurable:true});Object.defineProperty(Answer.prototype,"SaveToAnswerFile",{get:function(){return(this.SaveToAnswerFileBy!==Design.SaveAnswerByEnum.None)},enumerable:true,configurable:true});return Answer}());Design.Answer=Answer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var AnswerPropertiesViewModel=(function(_super){__extends(AnswerPropertiesViewModel,_super);function AnswerPropertiesViewModel(editorViewModel,question,answer,$filter,lists){var _this=_super.call(this)||this;_this._propertiesTitle='';_this._editorViewModel=editorViewModel;_this._question=question;_this._answer=answer;_this._filter=$filter;_this.setPropertiesTitle(lists);return _this}Object.defineProperty(AnswerPropertiesViewModel.prototype,"ID",{get:function(){return this._answer.ID},enumerable:true,configurable:true});Object.defineProperty(AnswerPropertiesViewModel.prototype,"QuestionTypeID",{get:function(){return this._question.QuestionTypeID},enumerable:true,configurable:true});Object.defineProperty(AnswerPropertiesViewModel.prototype,"Name",{get:function(){return this._answer.Name},set:function(value){this._answer.Name=value;this._editorViewModel.wizChanged=true;this.updateTreeName(value)},enumerable:true,configurable:true});Object.defineProperty(AnswerPropertiesViewModel.prototype,"FormatString",{get:function(){return this._answer.FormatString},set:function(value){this._answer.FormatString=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerPropertiesViewModel.prototype,"PropertiesTitle",{get:function(){return this._propertiesTitle},enumerable:true,configurable:true});AnswerPropertiesViewModel.prototype.updateTreeName=function(value){this._editorViewModel.treeView.selectedNode.text=value};AnswerPropertiesViewModel.prototype.setPropertiesTitle=function(lists){switch(this._question.QuestionTypeID){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Variable'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Address'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Datasource'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('GroupLogic'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('UserPrompt'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Label'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('SimpleLogic'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary:if(this._question.IsFileSelection){this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('FileSelection'))}else{this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('ContentLibrary'))}break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('AutoLogic'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Chart'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Barcode'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Ink:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Ink'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RichText:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('RichText'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom:var vm=this;this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Custom'));lists.customQuestionType(this._answer.Question.CustomQuestionTypeId).then(function(customType){vm._propertiesTitle=System.String.Format(vm._filter('translate')('AnswerPropertiesTitle'),customType.description)});break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Geolocation'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Numeric'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button:this._propertiesTitle=System.String.Format(this._filter('translate')('AnswerPropertiesTitle'),this._filter('translate')('Button'));break}};Object.defineProperty(AnswerPropertiesViewModel.prototype,"ShowFindDependencies",{get:function(){if(this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Ink||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator||this._question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary){return false}return true},enumerable:true,configurable:true});AnswerPropertiesViewModel.prototype.findDependencies=function(){this._editorViewModel.displayFoundItems(Design.DependencyHelper.getLogicDependencies(this._editorViewModel.wizard,this._answer,false),true,'','')};AnswerPropertiesViewModel.prototype.pickAceRef=function(id){var _this=this;var aceEditor=ace.edit(id);this._editorViewModel.treeView.pickEvent=function(node){aceEditor.insert(Design.HelperFunctions.createReferenceText(_this._filter,node));aceEditor.focus()};this._editorViewModel.treeView.togglePickMode()};AnswerPropertiesViewModel.prototype.onEditorLoad=function(){var vm=this;return function(editor){AnswerPropertiesViewModel.configureAceEditor(editor,vm._filter)}};AnswerPropertiesViewModel.configureAceEditor=function(editor,filter){var functionCompleter={functionList:[{value:'Abs',docHTML:'<div class="func">Abs(<span class="params">decimal1,decimal2,...</span>)</div><div class="func-desc">'+filter('translate')('fnAbsDesc')+'</div>'},{value:'Average',docHTML:'<div class="func">Average(<span class="params">number1,number2,...</span>)</div><div class="func-desc"> '+filter('translate')('fnAverageDesc')+'</div>'},{value:'Chr',docHTML:'<div class="func">Chr(<span class="params">number</span>)</div><div class="func-desc">'+filter('translate')('fnChrDesc')+'</div>'},{value:'Concat',docHTML:'<div class="func">Concat(<span class="params">value1,value2,...</span>)</div><div class="func-desc">'+filter('translate')('fnChrDesc')+'</div>'},{value:'Contains',docHTML:'<div class="func">Contains(<span class="params">compareValue,value1,value2,...</span>)</div><div class="func-desc">'+filter('translate')('fnContainsDesc')+'</div>'},{value:'Count',docHTML:'<div class="func">Count(<span class="params">value1,value2,...</span>)</div><div class="func-desc">'+filter('translate')('fnCountDesc')+'</div>'},{value:'CountIf',docHTML:'<div class="func">CountIf(<span class="params">pipedValues,compareValue</span>)</div><div class="func-desc">'+filter('translate')('fnCountIfDesc')+'</div>'},{value:'CountNumber',docHTML:'<div class="func">CountNumber(<span class="params">number1,value2,...</span>)</div><div class="func-desc">'+filter('translate')('fnCountNumberDesc')+'</div>'},{value:'DateAdd',docHTML:'<div class="func">DateAdd(<span class="params">interval,numberToAdd,date</span>)</div><div class="func-desc">'+filter('translate')('fnDateAddDesc')+'</div>'},{value:'DateDiff',docHTML:'<div class="func">DateDiff(<span class="params">interval,date1,date2,[int],[int]</span>)</div><div class="func-desc">'+filter('translate')('fnDateDiffDesc')+'</div>'},{value:'EndsWith',docHTML:'<div class="func">EndsWith(<span class="params">value,searchValue</span>)</div><div class="func-desc">'+filter('translate')('fnEndsWithDesc')+'</div>'},{value:'ErrorMask',docHTML:'<div class="func">ErrorMask(<span class="params">formula,valueOnError</span>)</div><div class="func-desc">'+filter('translate')('fnErrorMaskDesc')+'</div>'},{value:'First',docHTML:'<div class="func">First(<span class="params">value1,value2,...</span>)</div><div class="func-desc">'+filter('translate')('fnFirstDesc')+'</div>'},{value:'Format',docHTML:'<div class="func">Format(<span class="params">value,formatString</span>)</div><div class="func-desc">'+filter('translate')('fnFormatDesc')+'</div>'},{value:'IIf',docHTML:'<div class="func">IIf(<span class="params">bool,valueIfTrue,valueIfFalse</span>)</div><div class="func-desc">'+filter('translate')('fnIIFDesc')+'</div>'},{value:'IsEqual',docHTML:'<div class="func">IsEqual(<span class="params">value1,value2,...</span>)</div><div class="func-desc">'+filter('translate')('fnIsEqualDesc')+'</div>'},{value:'IsGreaterThan',docHTML:'<div class="func">IsGreaterThan(<span class="params">value1,value2</span>)</div><div class="func-desc">'+filter('translate')('fnIsGreaterThanDesc')+'</div>'},{value:'IsGreaterThanOrEqualTo',docHTML:'<div class="func">IsGreaterThanOrEqualTo(<span class="params">value1,value2</span>)</div><div class="func-desc">'+filter('translate')('fnIsGreaterThanOrEqualToDesc')+'</div>'},{value:'IsLessThan',docHTML:'<div class="func">IsLessThan(<span class="params">value1,value2</span>)</div><div class="func-desc">'+filter('translate')('fnIsLessThanDesc')+'</div>'},{value:'IsLessThanOrEqualTo',docHTML:'<div class="func">IsLessThanOrEqualTo(<span class="params">value1,value2</span>)</div><div class="func-desc">'+filter('translate')('fnIsLessThanOrEqualToDesc')+'</div>'},{value:'IsNotEqual',docHTML:'<div class="func">IsNotEqual(<span class="params">value1,value2</span>)</div><div class="func-desc">'+filter('translate')('fnNotEqualDesc')+'</div>'},{value:'IsTrue',docHTML:'<div class="func">IsTrue(<span class="params">value,[customTrueValue]</span>)</div><div class="func-desc">'+filter('translate')('fnIsTrueDesc')+'</div>'},{value:'Join',docHTML:'<div class="func">Join(<span class="params">delimiter,value1,value2,...</span>)</div><div class="func-desc">'+filter('translate')('fnJoinDesc')+'</div>'},{value:'JoinAnd',docHTML:'<div class="func">JoinAnd(<span class="params">delimiter,lastDelimiter,value1,value2,...</span>)</div><div class="func-desc">'+filter('translate')('fnJoinAndDesc')+'</div>'},{value:'Last',docHTML:'<div class="func">Last(<span class="params">value1,value2,...</span>)</div><div class="func-desc">'+filter('translate')('fnLastDesc')+'</div>'},{value:'Left',docHTML:'<div class="func">Left(<span class="params">value,length</span>)</div><div class="func-desc">'+filter('translate')('fnLeftDesc')+'</div>'},{value:'Len',docHTML:'<div class="func">Len(<span class="params">value</span>)</div><div class="func-desc">'+filter('translate')('fnLenDesc')+'</div>'},{value:'Length',docHTML:'<div class="func">Length(<span class="params">value</span>)</div><div class="func-desc">'+filter('translate')('fnLenDesc')+'</div>'},{value:'LocalToUtc',docHTML:'<div class="func">LocalToUtc(<span class="params">date</span>)</div><div class="func-desc">'+filter('translate')('fnLocalToUtcDesc')+'</div>'},{value:'Max',docHTML:'<div class="func">Max(<span class="params">number1,number2,...</span>)</div><div class="func-desc">'+filter('translate')('fnMaxDesc')+'</div>'},{value:'Min',docHTML:'<div class="func">Min(<span class="params">number1,number2,...</span>)</div><div class="func-desc">'+filter('translate')('fnMinDesc')+'</div>'},{value:'NotContains',docHTML:'<div class="func">NotContains(<span class="params">compareValue,value1,value2,...</span>)</div><div class="func-desc">'+filter('translate')('fnNotContainsDesc')+'</div>'},{value:'Now()',caption:'Now',docHTML:'<div class="func">Now()</div><div class="func-desc">'+filter('translate')('fnNowDesc')+'</div>'},{value:'ProperCase',docHTML:'<div class="func">ProperCase(<span class="params">value,excludeWords,capitalWords</span>)</div><div class="func-desc">'+filter('translate')('fnProperCaseDesc')+'</div>'},{value:'RangeIndex',docHTML:'<div class="func">RangeIndex(<span class="params">compareNumber,number1,number2,...</span>)</div><div class="func-desc">'+filter('translate')('fnRangeIndexDesc')+'</div>'},{value:'Replace',docHTML:'<div class="func">Replace(<span class="params">value,findValue,replaceValue</span>)</div><div class="func-desc">'+filter('translate')('fnReplaceDesc')+'</div>'},{value:'Right',docHTML:'<div class="func">Right(<span class="params">value,length</span>)</div><div class="func-desc">'+filter('translate')('fnRightDesc')+'</div>'},{value:'Round',docHTML:'<div class="func">Round(<span class="params">decimal,[digits]</span>)</div><div class="func-desc">'+filter('translate')('fnRoundDesc')+'</div>'},{value:'Today()',caption:'Today',docHTML:'<div class="func">Today()</div><div class="func-desc">'+filter('translate')('fnTodayDesc')+'</div>'},{value:'StartsWith',docHTML:'<div class="func">StartsWith(<span class="params">value,searchValue</span>)</div><div class="func-desc">'+filter('translate')('fnStartsWithDesc')+'</div>'},{value:'StringContains',docHTML:'<div class="func">StringContains(<span class="params">value,searchValue</span>)</div><div class="func-desc">'+filter('translate')('fnStringContainsDesc')+'</div>'},{value:'Substring',docHTML:'<div class="func">Substring(<span class="params">value,startPosition,length</span>)</div><div class="func-desc">'+filter('translate')('fnSubstringDesc')+'</div>'},{value:'Sum',docHTML:'<div class="func">Sum(<span class="params">number1,number2,...</span>)</div><div class="func-desc">'+filter('translate')('fnSumDesc')+'</div>'},{value:'Trim',docHTML:'<div class="func">Trim(<span class="params">value</span>)</div><div class="func-desc">'+filter('translate')('fnTrimDesc')+'</div>'},{value:'UtcNow()',caption:'UtcNow',docHTML:'<div class="func">UtcNow()</div><div class="func-desc">'+filter('translate')('fnUtcNowDesc')+'</div>'},{value:'UtcToday()',caption:'UtcToday',docHTML:'<div class="func">UtcToday()</div><div class="func-desc">'+filter('translate')('fnUtcTodayDesc')+'</div>'},{value:'UtcToLocal',docHTML:'<div class="func">UtcToLocal(<span class="params">date</span>)</div><div class="func-desc">'+filter('translate')('fnUtcToLocalDesc')+'</div>'}],getCompletions:function(editor,session,pos,prefix,callback){callback(null,this.functionList.map(function(functionItem){return{docHTML:functionItem.docHTML,value:functionItem.value,caption:functionItem.caption||functionItem.value}}))}};editor.completers=[functionCompleter];editor.$blockScrolling=Infinity};return AnswerPropertiesViewModel}(Design.PropertiesViewModel));Design.AnswerPropertiesViewModel=AnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ContentLibraryAnswerPropertiesViewModel=(function(_super){__extends(ContentLibraryAnswerPropertiesViewModel,_super);function ContentLibraryAnswerPropertiesViewModel(editorViewModel,question,answer,$filter,lists){var _this=_super.call(this,editorViewModel,question,answer,$filter,lists)||this;_this.imageProperties=null;if(question.Visibility&&question.ContentTypeRestriction===Intelledox.Model.ContentType.Image){_this.imageProperties=new Design.ImagePropertiesViewModel($filter,editorViewModel,answer.ImageSettings);_this.imageProperties.isAlternativeTextVisible=true}return _this}return ContentLibraryAnswerPropertiesViewModel}(Design.AnswerPropertiesViewModel));Design.ContentLibraryAnswerPropertiesViewModel=ContentLibraryAnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var InkAnswerPropertiesViewModel=(function(_super){__extends(InkAnswerPropertiesViewModel,_super);function InkAnswerPropertiesViewModel(editorViewModel,question,answer,$filter,lists){var _this=_super.call(this,editorViewModel,question,answer,$filter,lists)||this;_this.imageProperties=new Design.ImagePropertiesViewModel($filter,editorViewModel,answer.ImageSettings);_this.imageProperties.isAlternativeTextVisible=true;return _this}return InkAnswerPropertiesViewModel}(Design.AnswerPropertiesViewModel));Design.InkAnswerPropertiesViewModel=InkAnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ChartQuestion=(function(_super){__extends(ChartQuestion,_super);function ChartQuestion(questionGuid){return _super.call(this,questionGuid)||this}Object.defineProperty(ChartQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Chart},enumerable:true,configurable:true});ChartQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new ChartQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);if(this.Chart!=null){result.Chart=this.Chart.Clone()}return result};Object.defineProperty(ChartQuestion.prototype,"IsDisplayQuestionType",{get:function(){return false},enumerable:true,configurable:true});return ChartQuestion}(Design.Question));Design.ChartQuestion=ChartQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ChartPropertiesViewModel=(function(_super){__extends(ChartPropertiesViewModel,_super);function ChartPropertiesViewModel(editorViewModel,question,wizard,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._editor=editorViewModel;_this._wizard=wizard;_this._chart=question;_this._filterLocal=$filter;_this.fillColourPalette();_this.fillLineStyle();_this.availableColours=Intelledox.Common.Functions.ColourList($filter,true);_this.fillPosition();_this.fillAlignment();var docking=_this._chart.Chart.Legend.Docking.toString();var alignment=_this._chart.Chart.Legend.Alignment.toString();if(docking.length===1){docking="0"+docking}if(alignment.length===1){alignment="0"+alignment}_this._legendPosition=docking+alignment;return _this}Object.defineProperty(ChartPropertiesViewModel.prototype,"chartTitle",{get:function(){return this._chart.Chart.Title},set:function(value){this._chart.Chart.Title=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"chartPalette",{get:function(){return this._chart.Chart.ColourPalette},set:function(value){this._chart.Chart.ColourPalette=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"chartFillColour",{get:function(){return this._chart.Chart.BackColour},set:function(value){this._chart.Chart.BackColour=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"chartBorderLineColour",{get:function(){return this._chart.Chart.BorderlineColour},set:function(value){this._chart.Chart.BorderlineColour=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"chartBorderLineDashStyle",{get:function(){return this._chart.Chart.BorderlineDashStyle},set:function(value){this._chart.Chart.BorderlineDashStyle=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"chartBorderLineWidth",{get:function(){return this._chart.Chart.BorderlineWidth.toString()},set:function(value){this._chart.Chart.BorderlineWidth=parseInt(value,10);if(isNaN(this._chart.Chart.BorderlineWidth)){this._chart.Chart.BorderlineWidth=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"isLegendVisible",{get:function(){return this._chart.Chart.Legend.IsVisible},set:function(value){this._chart.Chart.Legend.IsVisible=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"legendPosition",{get:function(){return this._legendPosition},set:function(value){var docking=value.substring(0,2);var alignment=value.substring(2);this._legendPosition=value;this._chart.Chart.Legend.Docking=parseInt(docking,10);this._chart.Chart.Legend.Alignment=parseInt(alignment,10);this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"legendFillColour",{get:function(){return this._chart.Chart.Legend.BackColour},set:function(value){this._chart.Chart.Legend.BackColour=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"legendBorderLineColour",{get:function(){return this._chart.Chart.Legend.BorderlineColour},set:function(value){this._chart.Chart.Legend.BorderlineColour=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"legendBorderLineDashStyle",{get:function(){return this._chart.Chart.Legend.BorderlineDashStyle},set:function(value){this._chart.Chart.Legend.BorderlineDashStyle=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"legendBorderLineWidth",{get:function(){return this._chart.Chart.Legend.BorderlineWidth.toString()},set:function(value){this._chart.Chart.Legend.BorderlineWidth=parseInt(value,10);if(isNaN(this._chart.Chart.Legend.BorderlineWidth)){this._chart.Chart.Legend.BorderlineWidth=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"enable3DChartArea",{get:function(){return this._chart.Chart.ChartArea.Is3D},set:function(value){this._chart.Chart.ChartArea.Is3D=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"chartAreaFillColour",{get:function(){return this._chart.Chart.ChartArea.BackColour},set:function(value){this._chart.Chart.ChartArea.BackColour=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"chartAreaBorderLineColour",{get:function(){return this._chart.Chart.ChartArea.BorderlineColour},set:function(value){this._chart.Chart.ChartArea.BorderlineColour=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"chartAreaBorderLineDashStyle",{get:function(){return this._chart.Chart.ChartArea.BorderlineDashStyle},set:function(value){this._chart.Chart.ChartArea.BorderlineDashStyle=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"chartAreaBorderLineWidth",{get:function(){return this._chart.Chart.ChartArea.BorderlineWidth.toString()},set:function(value){this._chart.Chart.ChartArea.BorderlineWidth=parseInt(value,10);if(isNaN(this._chart.Chart.ChartArea.BorderlineWidth)){this._chart.Chart.ChartArea.BorderlineWidth=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"valueAxisHideTitle",{get:function(){return this._chart.Chart.AxisY.HideTitle},set:function(value){this._chart.Chart.AxisY.HideTitle=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"valueAxisAlignment",{get:function(){return this._chart.Chart.AxisY.Alignment},set:function(value){this._chart.Chart.AxisY.Alignment=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"valueAxisHideLabels",{get:function(){return this._chart.Chart.AxisY.HideLabels},set:function(value){this._chart.Chart.AxisY.HideLabels=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"valueAxisHideFirstAndLast",{get:function(){return this._chart.Chart.AxisY.HideFirstAndLastLabels},set:function(value){this._chart.Chart.AxisY.HideFirstAndLastLabels=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"valueAxisTitle",{get:function(){return this._chart.Chart.AxisY.Title},set:function(value){this._chart.Chart.AxisY.Title=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"valueAxisBorderLineColour",{get:function(){return this._chart.Chart.AxisY.BorderlineColour},set:function(value){this._chart.Chart.AxisY.BorderlineColour=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"valueAxisBorderLineDashStyle",{get:function(){return this._chart.Chart.AxisY.BorderlineDashStyle},set:function(value){this._chart.Chart.AxisY.BorderlineDashStyle=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"valueAxisBorderLineWidth",{get:function(){return this._chart.Chart.AxisY.BorderlineWidth.toString()},set:function(value){this._chart.Chart.AxisY.BorderlineWidth=parseInt(value,10);if(isNaN(this._chart.Chart.AxisY.BorderlineWidth)){this._chart.Chart.AxisY.BorderlineWidth=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"categoryAxisHideTitle",{get:function(){return this._chart.Chart.AxisX.HideTitle},set:function(value){this._chart.Chart.AxisX.HideTitle=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"categoryAxisAlignment",{get:function(){return this._chart.Chart.AxisX.Alignment},set:function(value){this._chart.Chart.AxisX.Alignment=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"categoryAxisHideLabels",{get:function(){return this._chart.Chart.AxisX.HideLabels},set:function(value){this._chart.Chart.AxisX.HideLabels=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"categoryAxisHideFirstAndLast",{get:function(){return this._chart.Chart.AxisX.HideFirstAndLastLabels},set:function(value){this._chart.Chart.AxisX.HideFirstAndLastLabels=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"categoryAxisTitle",{get:function(){return this._chart.Chart.AxisX.Title},set:function(value){this._chart.Chart.AxisX.Title=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"categoryAxisBorderLineColour",{get:function(){return this._chart.Chart.AxisX.BorderlineColour},set:function(value){this._chart.Chart.AxisX.BorderlineColour=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"categoryAxisBorderLineDashStyle",{get:function(){return this._chart.Chart.AxisX.BorderlineDashStyle},set:function(value){this._chart.Chart.AxisX.BorderlineDashStyle=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ChartPropertiesViewModel.prototype,"categoryAxisBorderLineWidth",{get:function(){return this._chart.Chart.AxisX.BorderlineWidth.toString()},set:function(value){this._chart.Chart.AxisX.BorderlineWidth=parseInt(value,10);if(isNaN(this._chart.Chart.AxisX.BorderlineWidth)){this._chart.Chart.AxisX.BorderlineWidth=0}this._editor.wizChanged=true},enumerable:true,configurable:true});ChartPropertiesViewModel.prototype.fillColourPalette=function(){this.availablePalettes=[];this.availablePalettes.push({name:this._filterLocal('translate')('DefaultString'),value:Intelledox.QAWizard.Design.ChartColourPalette.Default});this.availablePalettes.push({name:this._filterLocal('translate')('Berry'),value:Intelledox.QAWizard.Design.ChartColourPalette.Berry});this.availablePalettes.push({name:this._filterLocal('translate')('BrightPastel'),value:Intelledox.QAWizard.Design.ChartColourPalette.BrightPastel});this.availablePalettes.push({name:this._filterLocal('translate')('Chocolate'),value:Intelledox.QAWizard.Design.ChartColourPalette.Chocolate});this.availablePalettes.push({name:this._filterLocal('translate')('EarthTones'),value:Intelledox.QAWizard.Design.ChartColourPalette.EarthTones});this.availablePalettes.push({name:this._filterLocal('translate')('Excel'),value:Intelledox.QAWizard.Design.ChartColourPalette.Excel});this.availablePalettes.push({name:this._filterLocal('translate')('Fire'),value:Intelledox.QAWizard.Design.ChartColourPalette.Fire});this.availablePalettes.push({name:this._filterLocal('translate')('GrayScale'),value:Intelledox.QAWizard.Design.ChartColourPalette.GrayScale});this.availablePalettes.push({name:this._filterLocal('translate')('Light'),value:Intelledox.QAWizard.Design.ChartColourPalette.Light});this.availablePalettes.push({name:this._filterLocal('translate')('Pastel'),value:Intelledox.QAWizard.Design.ChartColourPalette.Pastel});this.availablePalettes.push({name:this._filterLocal('translate')('SeaGreen'),value:Intelledox.QAWizard.Design.ChartColourPalette.SeaGreen});this.availablePalettes.push({name:this._filterLocal('translate')('SemiTransparent'),value:Intelledox.QAWizard.Design.ChartColourPalette.SemiTransparent})};ChartPropertiesViewModel.prototype.fillLineStyle=function(){this.availableLineStyles=[];this.availableLineStyles.push({name:this._filterLocal('translate')('DefaultString'),value:Intelledox.QAWizard.Design.ChartBorderlineDashStyle.Solid});this.availableLineStyles.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:Intelledox.QAWizard.Design.ChartBorderlineDashStyle.NotSet});this.availableLineStyles.push({name:this._filterLocal('translate')('Dotted'),value:Intelledox.QAWizard.Design.ChartBorderlineDashStyle.Dot});this.availableLineStyles.push({name:this._filterLocal('translate')('Dashed'),value:Intelledox.QAWizard.Design.ChartBorderlineDashStyle.Dash});this.availableLineStyles.push({name:this._filterLocal('translate')('Solid'),value:Intelledox.QAWizard.Design.ChartBorderlineDashStyle.Solid})};ChartPropertiesViewModel.prototype.fillPosition=function(){this.availablePositions=[];this.availablePositions.push({name:this._filterLocal('translate')('TopLeft'),value:"0000"});this.availablePositions.push({name:this._filterLocal('translate')('TopMiddle'),value:"0001"});this.availablePositions.push({name:this._filterLocal('translate')('TopRight'),value:"0002"});this.availablePositions.push({name:this._filterLocal('translate')('RightTop'),value:"0100"});this.availablePositions.push({name:this._filterLocal('translate')('RightMiddle'),value:"0101"});this.availablePositions.push({name:this._filterLocal('translate')('RightBottom'),value:"0102"});this.availablePositions.push({name:this._filterLocal('translate')('BottomLeft'),value:"0200"});this.availablePositions.push({name:this._filterLocal('translate')('BottomMiddle'),value:"0201"});this.availablePositions.push({name:this._filterLocal('translate')('BottomRight'),value:"0202"});this.availablePositions.push({name:this._filterLocal('translate')('LeftTop'),value:"0300"});this.availablePositions.push({name:this._filterLocal('translate')('LeftMiddle'),value:"0301"});this.availablePositions.push({name:this._filterLocal('translate')('LeftBottom'),value:"0302"})};ChartPropertiesViewModel.prototype.fillAlignment=function(){this.availableAlignments=[];this.availableAlignments.push({name:this._filterLocal('translate')('Left'),value:Intelledox.QAWizard.Design.StringAlignment.Near});this.availableAlignments.push({name:this._filterLocal('translate')('Middle'),value:Intelledox.QAWizard.Design.StringAlignment.Center});this.availableAlignments.push({name:this._filterLocal('translate')('Right'),value:Intelledox.QAWizard.Design.StringAlignment.Far})};return ChartPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.ChartPropertiesViewModel=ChartPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ChartAnswerPropertiesViewModel=(function(_super){__extends(ChartAnswerPropertiesViewModel,_super);function ChartAnswerPropertiesViewModel(editorViewModel,question,answer,$filter,lists){var _this=_super.call(this,editorViewModel,question,answer,$filter,lists)||this;answer.ImageSettings.StretchToFit=true;_this.imageProperties=new Design.ImagePropertiesViewModel($filter,editorViewModel,answer.ImageSettings);_this.imageProperties.isAlternativeTextVisible=true;_this.imageProperties.isStretchToFitEnabled=false;return _this}return ChartAnswerPropertiesViewModel}(Design.AnswerPropertiesViewModel));Design.ChartAnswerPropertiesViewModel=ChartAnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ProjectPropertiesPanelViewModel=(function(){function ProjectPropertiesPanelViewModel($filter,editorViewModel){this._wizard=null;this._transition=null;this._selectedProjectProperty=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedValue='';this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.existingProjectProperties=[];this._editorViewModel=editorViewModel;this._filter=$filter}Object.defineProperty(ProjectPropertiesPanelViewModel.prototype,"availableProjectProperties",{get:function(){return this._wizard.Properties},enumerable:true,configurable:true});Object.defineProperty(ProjectPropertiesPanelViewModel.prototype,"selectedProjectProperty",{get:function(){return this._selectedProjectProperty},set:function(value){this._selectedProjectProperty=value;this.updateButtons()},enumerable:true,configurable:true});Object.defineProperty(ProjectPropertiesPanelViewModel.prototype,"selectedValue",{get:function(){return this._selectedValue},set:function(value){this._selectedValue=value;this.updateButtons()},enumerable:true,configurable:true});ProjectPropertiesPanelViewModel.prototype.add=function(){var newField=new Intelledox.QAWizard.Design.AlterProperty;var prop=this.selectedProjectProperty;if(this.transitionHasProjectProperty(prop)){return}newField.Id=prop;newField.Value=this.selectedValue;this._transition.Properties.push(newField);this.fillProjectPropertiesView();this._editorViewModel.wizChanged=true};ProjectPropertiesPanelViewModel.prototype.update=function(){var existingProp=this.getSelectedExistingProjectProperty();var prop=this.selectedProjectProperty;if(existingProp.Id!==prop&&this.transitionHasProjectProperty(prop)){return}existingProp.Id=prop;existingProp.Value=this.selectedValue;this.fillProjectPropertiesView();this._editorViewModel.wizChanged=true};ProjectPropertiesPanelViewModel.prototype.remove=function(){var existingProp=this.getSelectedExistingProjectProperty();this._transition.Properties.splice(this._transition.Properties.indexOf(existingProp),1);this.fillProjectPropertiesView();this._editorViewModel.wizChanged=true};ProjectPropertiesPanelViewModel.prototype.init=function(wizard,transition){var vm=this;this._transition=transition;this._wizard=wizard;this.selectedValue='';this.selectedProjectProperty=Intelledox.Common.ConstantValues.GUID_EMPTY;this.fillProjectPropertiesView()};ProjectPropertiesPanelViewModel.prototype.updateButtons=function(){var existingProp=this.getSelectedExistingProjectProperty();this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;if(existingProp!=null){if(this.selectedProjectProperty!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.isUpdateEnabled=true}this.isRemoveEnabled=true}if(this.selectedProjectProperty!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.isAddEnabled=true}};ProjectPropertiesPanelViewModel.prototype.selectExistingProjectProperty=function(prop){for(var i=0;i<this.existingProjectProperties.length;i++){if(this.existingProjectProperties[i].tag===prop){this.existingProjectProperties[i].selected=true}else{this.existingProjectProperties[i].selected=false}}this.showProjectPropertyDetails()};ProjectPropertiesPanelViewModel.prototype.getSelectedExistingProjectProperty=function(){for(var i=0;i<this.existingProjectProperties.length;i++){if(this.existingProjectProperties[i].selected){return this.existingProjectProperties[i].tag}}return null};ProjectPropertiesPanelViewModel.prototype.fillProjectPropertiesView=function(){var found=false;this.existingProjectProperties=[];for(var i=0;i<this._transition.Properties.length;i++){var prop=this._transition.Properties[i];var displayProp={tag:prop,name:'',value:prop.Value,selected:false};found=false;for(var propIndex=0;propIndex<this.availableProjectProperties.length;propIndex++){if(this.availableProjectProperties[propIndex].Id===prop.Id){displayProp.name=this.availableProjectProperties[propIndex].Name;found=true;break}}if(!found){displayProp.name=this._filter('translate')('Invalid')}this.existingProjectProperties.push(displayProp)}this.updateButtons()};ProjectPropertiesPanelViewModel.prototype.showProjectPropertyDetails=function(){var existingProp=this.getSelectedExistingProjectProperty();if(existingProp==null){return}this.selectedProjectProperty=existingProp.Id;this.selectedValue=existingProp.Value;this.updateButtons()};ProjectPropertiesPanelViewModel.prototype.transitionHasProjectProperty=function(id){for(var i=0;i<this._transition.Properties.length;i++){if(this._transition.Properties[i].Id===id){alert(this._filter('translate')('ErrorMsg_ProjectPropertyAlreadyAdded'));return true}}return false};return ProjectPropertiesPanelViewModel}());Design.ProjectPropertiesPanelViewModel=ProjectPropertiesPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Section=(function(){function Section(){this.Title="";this.Description="";this.IsRepeated=false;this.DisplayImportOptions=true;this.MaximumRepeats=null;this.MinimumRepeats=null;this.CreateMinimumRepeats=false;this.ShowFillDownButton=true;this.SectionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.RepeatSourceType=Design.RepeatSourceType.None;this.RepeatSourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.RepeatSourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.IsEditableDrivenRepeat=true;this.RepeatName="";this.CssStyle=null;this.AllowSorting=true;this.Columns=new Array;this.RepeatPlaceholders=new Array;this.SectionGuid=Design.GeneralFunctions.NewGuid()}Object.defineProperty(Section.prototype,"ObjectId",{get:function(){return this.SectionGuid},set:function(value){this.SectionGuid=value},enumerable:true,configurable:true});Section.prototype.Clone=function(nextId,addQuestionsToPage){if(addQuestionsToPage===void 0){addQuestionsToPage=null}var result=new Section;result.Title=this.Title;result.Description=this.Description;result.IsRepeated=this.IsRepeated;result.DisplayImportOptions=this.DisplayImportOptions;result.MaximumRepeats=this.MaximumRepeats;result.MinimumRepeats=this.MinimumRepeats;result.ShowFillDownButton=this.ShowFillDownButton;result.CreateMinimumRepeats=this.CreateMinimumRepeats;result.RepeatSourceType=this.RepeatSourceType;result.RepeatSourceGuid=this.RepeatSourceGuid;result.RepeatSourceAttributeGuid=this.RepeatSourceAttributeGuid;result.IsEditableDrivenRepeat=this.IsEditableDrivenRepeat;result.RepeatName=this.RepeatName;result.CssStyle=this.CssStyle;result.AllowSorting=this.AllowSorting;if(this.ActiveConditions!=null){result.ActiveConditions=this.ActiveConditions.Clone()}if(this.VisibleConditions!=null){result.VisibleConditions=this.VisibleConditions.Clone()}if(this.EditableConditions!=null){result.EditableConditions=this.EditableConditions.Clone()}if(this.RepeatConditions!=null){result.RepeatConditions=this.RepeatConditions.Clone()}for(var i=0;i<this.Columns.length;i++){result.Columns.push(this.Columns[i].Clone(nextId,addQuestionsToPage))}return result};Object.defineProperty(Section.prototype,"Children",{get:function(){return this.Columns},enumerable:true,configurable:true});Section.prototype.HasContainerInterface=function(){return true};Section.prototype.HasLayoutInterface=function(){return true};Section.prototype.HasChild=function(childGuid){if(childGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return false}else if(this.SectionGuid===childGuid){return true}else{for(var i=0;i<this.Children.length;i++){if(this.Children[i].HasChild(childGuid)){return true}}return false}};Section.prototype.NonRepeatingQuestions=function(){var children=new Array;var results=new Array;children.push(this);while(children.length>0){var current=children.pop();if(current instanceof Design.Question){results.push(current)}else if(typeof current.HasContainerInterface!=="undefined"&&(!(current instanceof Section)||current==this||!current.IsRepeated)){for(var i=current.Children.length-1;i>=0;i--){children.push(current.Children[i])}}}return results};return Section}());Design.Section=Section})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var NextId=(function(){function NextId(questionId,answerId){this.nextQuestionId=0;this.nextAnswerId=0;this.nextQuestionId=questionId;this.nextAnswerId=answerId}return NextId}());Design.NextId=NextId})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var StylePropertiesViewModel=(function(_super){__extends(StylePropertiesViewModel,_super);function StylePropertiesViewModel(editorViewModel,layoutNode,$filter,lists){var _this=_super.call(this)||this;_this.availableCssStyles=[];_this._filter=$filter;_this._editorViewModel=editorViewModel;_this._layoutNode=layoutNode;lists.cssStyles('layout').then(function(data){return _this.loadCssStyles(data)});return _this}Object.defineProperty(StylePropertiesViewModel.prototype,"CssStyle",{get:function(){if(this._layoutNode instanceof Intelledox.QAWizard.Design.Page||this._layoutNode instanceof Intelledox.QAWizard.Design.Section||this._layoutNode instanceof Intelledox.QAWizard.Design.Column||this._layoutNode instanceof Intelledox.QAWizard.Design.TabGroup||this._layoutNode instanceof Intelledox.QAWizard.Design.TabPage){if(this._layoutNode.CssStyle!=null){return this._layoutNode.CssStyle}}return""},set:function(value){if(this._layoutNode instanceof Intelledox.QAWizard.Design.Page||this._layoutNode instanceof Intelledox.QAWizard.Design.Section||this._layoutNode instanceof Intelledox.QAWizard.Design.Column||this._layoutNode instanceof Intelledox.QAWizard.Design.TabGroup||this._layoutNode instanceof Intelledox.QAWizard.Design.TabPage){this._layoutNode.CssStyle=value}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});StylePropertiesViewModel.prototype.loadCssStyles=function(data){this.availableCssStyles.push({name:this._filter('translate')('NoneWithBrackets'),value:""});for(var i=0;i<data.length;i++){var item=data[i];this.availableCssStyles.push({name:item.cssName,value:item.webClass})}};return StylePropertiesViewModel}(Design.PropertiesViewModel));Design.StylePropertiesViewModel=StylePropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var RepeatPropertiesViewModel=(function(_super){__extends(RepeatPropertiesViewModel,_super);function RepeatPropertiesViewModel(editorViewModel,repeatNode,$filter,$uibModal,listManager,nodeIcon,repeatingNodeIcon){var _this=_super.call(this)||this;_this.availableRepeatSources=[];_this.availableFragmentOutputs=[];_this.repeatPlaceholderText='';_this._listManager=listManager;_this._filter=$filter;_this._modal=$uibModal;_this._editorViewModel=editorViewModel;_this._repeatNode=repeatNode;_this.hasDocument=(editorViewModel.wizard.Documents.length>0);_this._nodeIcon=nodeIcon;_this._repeatingNodeIcon=repeatingNodeIcon;_this._label=repeatNode instanceof Intelledox.QAWizard.Design.Section?$filter('translate')('ShowMinimumSectionsOnStartup'):$filter('translate')('ShowMinimumPagesOnStartup');if(repeatNode.IsRepeated){if(_this._repeatNode.RepeatSourceType!==Intelledox.QAWizard.Design.RepeatSourceType.None){_this._isDataDriven=true;_this.loadRepeatSources();if(_this._repeatNode.RepeatSourceType===Intelledox.QAWizard.Design.RepeatSourceType.FragmentOutput){_this.isFragmentOutputVisible=true;_this.loadFragmentOutputs()}}else{_this._isDataDriven=false;repeatNode.IsEditableDrivenRepeat=false}_this._repeatPlaceholders=(repeatNode.RepeatPlaceholders!=null&&repeatNode.RepeatPlaceholders.length>0);_this.displayRepeatPlaceholderText()}else{_this._repeatPlaceholders=false;_this.repeatPlaceholderText='';_this._isDataDriven=false;repeatNode.IsEditableDrivenRepeat=false}return _this}Object.defineProperty(RepeatPropertiesViewModel.prototype,"isRepeated",{get:function(){return this._repeatNode.IsRepeated},set:function(value){this._repeatNode.IsRepeated=value;this._editorViewModel.wizChanged=true;this._editorViewModel.treeView.selectedNode.imageKey=value?this._repeatingNodeIcon:this._nodeIcon;if(!value){this._repeatPlaceholders=false;this._repeatNode.RepeatName='';this.clearRepeatPlaceholders();if(this.repeatNameChanged!=null){this.repeatNameChanged()}}},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"isDataDriven",{get:function(){return this._isDataDriven},set:function(value){this._isDataDriven=value;if(value){if(this.availableRepeatSources.length===0){this.loadRepeatSources()}this._repeatNode.MinimumRepeats='';this._repeatNode.MaximumRepeats='';this._repeatNode.CreateMinimumRepeats=false;this._repeatNode.IsEditableDrivenRepeat=false}else{this._repeatNode.RepeatSourceType=Intelledox.QAWizard.Design.RepeatSourceType.None;this._repeatNode.RepeatSourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._repeatNode.IsEditableDrivenRepeat=true}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"allowAddAndRemove",{get:function(){return this._repeatNode.IsEditableDrivenRepeat},set:function(value){this._repeatNode.IsEditableDrivenRepeat=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"allowSorting",{get:function(){return this._repeatNode.AllowSorting},set:function(value){this._repeatNode.AllowSorting=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"minimum",{get:function(){return this._repeatNode.MinimumRepeats},set:function(value){this._repeatNode.MinimumRepeats=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"maximum",{get:function(){return this._repeatNode.MaximumRepeats},set:function(value){this._repeatNode.MaximumRepeats=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"createMinimum",{get:function(){return this._repeatNode.CreateMinimumRepeats},set:function(value){this._repeatNode.CreateMinimumRepeats=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"repeatSourceGuid",{get:function(){return this._repeatNode.RepeatSourceGuid},set:function(value){this._repeatNode.RepeatSourceGuid=value;this._editorViewModel.wizChanged=true;for(var i=0;i<this.availableRepeatSources.length;i++){if(this.availableRepeatSources[i].value===value){this._repeatNode.RepeatSourceType=this.availableRepeatSources[i].type;break}}if(this._repeatNode.RepeatSourceType===Intelledox.QAWizard.Design.RepeatSourceType.FragmentOutput){this.isFragmentOutputVisible=true;this.loadFragmentOutputs()}else{this.isFragmentOutputVisible=false}},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"repeatSourceAttributeGuid",{get:function(){return this._repeatNode.RepeatSourceAttributeGuid},set:function(value){this._repeatNode.RepeatSourceAttributeGuid=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"repeatContent",{get:function(){if(this._repeatPlaceholders){return"1"}return"0"},set:function(value){this._repeatPlaceholders=(value==="1");if(value!=="1"){this.clearRepeatPlaceholders()}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"createMinimumLabel",{get:function(){return this._label},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"showDuplicateButton",{get:function(){return this._repeatNode.ShowFillDownButton},set:function(value){this._repeatNode.ShowFillDownButton=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RepeatPropertiesViewModel.prototype,"repeatName",{get:function(){return this._repeatNode.RepeatName},set:function(value){this._repeatNode.RepeatName=value;this._editorViewModel.wizChanged=true;if(this.repeatNameChanged!=null){this.repeatNameChanged()}},enumerable:true,configurable:true});RepeatPropertiesViewModel.prototype.validateMinMax=function(){var minRepeats=parseInt(this._repeatNode.MinimumRepeats,10);var maxRepeats=parseInt(this._repeatNode.MaximumRepeats,10);if((maxRepeats>0)&&(minRepeats>maxRepeats)){alert(this._filter('translate')('MinMaxRepeatValidMessage'))}};RepeatPropertiesViewModel.prototype.selectRepeatPlaceholder=function(){var vm=this;var originalList=[];if(this._repeatNode.RepeatPlaceholders!=null){for(var i=0;i<this._repeatNode.RepeatPlaceholders.length;i++){var newItem=new Design.PlaceholderListItem(this._repeatNode.RepeatPlaceholders[i],Intelledox.Common.ConstantValues.GUID_EMPTY);originalList.push(newItem)}}var modalConfirm=this._modal.open({templateUrl:'Views/Modal/managePlaceholders.html?v=106882799234227327',controller:['$scope','$modalInstance','$filter','editor','singleSelect','placeholders','usedPlaceholders','unusedPlaceholders','additionalListItem','placeholderPurpose',Design.SelectPlaceholdersModalCtrl],backdrop:'static',resolve:{editor:function(){return vm._editorViewModel},singleSelect:function(){return false},placeholders:function(){return vm._repeatNode.RepeatPlaceholders},usedPlaceholders:function(){return vm._editorViewModel.flyoutPlaceholders.usedPlaceholders},unusedPlaceholders:function(){return vm._editorViewModel.flyoutPlaceholders.unusedPlaceholders},additionalListItem:function(){return null},placeholderPurpose:function(){return Intelledox.Model.PlaceholderPurpose.Repeat}}});modalConfirm.result.then(function(newList){vm._editorViewModel.flyoutPlaceholders.colourPlaceholdersFromList(originalList,false);vm._editorViewModel.flyoutPlaceholders.colourPlaceholdersFromList(newList,true);vm._repeatNode.RepeatPlaceholders=[];for(var i=0;i<newList.length;i++){vm._repeatNode.RepeatPlaceholders.push(newList[i].reference)}vm.displayRepeatPlaceholderText();vm._editorViewModel.wizChanged=true})};RepeatPropertiesViewModel.prototype.pickMinimum=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.minimum=Design.HelperFunctions.onPickRef(_this._filter,_this.minimum,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};RepeatPropertiesViewModel.prototype.pickMaximum=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.maximum=Design.HelperFunctions.onPickRef(_this._filter,_this.maximum,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};RepeatPropertiesViewModel.prototype.loadRepeatSources=function(){this.availableRepeatSources=[];this._listManager.populateRepeatSources(this._editorViewModel.wizard,true,this._repeatNode,this.availableRepeatSources)};RepeatPropertiesViewModel.prototype.loadFragmentOutputs=function(){var fragmentReference=this._editorViewModel.wizard.FindLayoutNode(this.repeatSourceGuid);this.availableFragmentOutputs=[];if(fragmentReference!=null){this._listManager.populateFragmentRepeatedOutputs(fragmentReference.ProjectGuid,this.availableFragmentOutputs)}};RepeatPropertiesViewModel.prototype.displayRepeatPlaceholderText=function(){this.repeatPlaceholderText="";if(this._repeatNode.RepeatPlaceholders!=null){for(var i=0;i<this._repeatNode.RepeatPlaceholders.length;i++){this.repeatPlaceholderText+=this._repeatNode.RepeatPlaceholders[i].name;if(i+1!==this._repeatNode.RepeatPlaceholders.length){this.repeatPlaceholderText+=", "}}}};RepeatPropertiesViewModel.prototype.clearRepeatPlaceholders=function(){this._editorViewModel.flyoutPlaceholders.colourPlaceholders(this._repeatNode.RepeatPlaceholders,false);this._repeatNode.RepeatPlaceholders=[];this.repeatPlaceholderText=""};return RepeatPropertiesViewModel}(Design.PropertiesViewModel));Design.RepeatPropertiesViewModel=RepeatPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var AnswerFileOptionsPanelViewModel=(function(){function AnswerFileOptionsPanelViewModel($filter,editorViewModel){this._editorViewModel=editorViewModel;this._filter=$filter}Object.defineProperty(AnswerFileOptionsPanelViewModel.prototype,"isQuestion",{get:function(){return this._currentQuestion!==null},enumerable:true,configurable:true});Object.defineProperty(AnswerFileOptionsPanelViewModel.prototype,"saveBy",{get:function(){return this._currentAnswer.SaveToAnswerFileBy},set:function(value){this._currentAnswer.SaveToAnswerFileBy=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFileOptionsPanelViewModel.prototype,"saveByLabel",{get:function(){if(this.isQuestion){return this._currentQuestion.SaveToAnswerFile}else{return this._currentAnswer.SaveToAnswerFileBy===Intelledox.QAWizard.Design.SaveAnswerByEnum.SaveByLabel}},set:function(value){if(this.isQuestion){this._currentQuestion.SaveToAnswerFile=value;this._editorViewModel.wizChanged=true}},enumerable:true,configurable:true});Object.defineProperty(AnswerFileOptionsPanelViewModel.prototype,"labelName",{get:function(){if(this.isQuestion){return this.saveByLabel?this._currentQuestion.SaveToAnswerFileLabel:''}else{return this.saveByLabel?this._currentAnswer.SaveToAnswerFileLabel:''}},set:function(value){if(this.isQuestion){this._currentQuestion.SaveToAnswerFileLabel=value}else{this._currentAnswer.SaveToAnswerFileLabel=value}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});AnswerFileOptionsPanelViewModel.prototype.init=function(wizard,currentObject){this._wizard=wizard;if(currentObject instanceof Intelledox.QAWizard.Design.Answer){this._currentAnswer=currentObject;this._currentQuestion=null}else{this._currentAnswer=null;this._currentQuestion=currentObject}};AnswerFileOptionsPanelViewModel.prototype.labelNameValidate=function(){var unique=true;var newLabelText;var thisObject;if(this.isQuestion){thisObject=this._currentQuestion;newLabelText=this._currentQuestion.SaveToAnswerFileLabel}else{thisObject=this._currentAnswer;newLabelText=this._currentAnswer.SaveToAnswerFileLabel}for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var page=this._wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<page.Questions.length;questionIndex++){var question=page.Questions[questionIndex];if(question!==thisObject){if(question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary&&question.Visibility&&question.SaveToAnswerFile&&Intelledox.Common.Functions.EqualsIgnoreCase(question.SaveToAnswerFileLabel,newLabelText)){unique=false;break}for(var answerIndex=0;answerIndex<question.Answers.length;answerIndex++){var answer=question.Answers[answerIndex];if(answer!==thisObject){if(answer.SaveToAnswerFileBy===Intelledox.QAWizard.Design.SaveAnswerByEnum.SaveByLabel&&Intelledox.Common.Functions.EqualsIgnoreCase(answer.SaveToAnswerFileLabel,newLabelText)){unique=false;break}}}}if(!unique){break}}if(!unique){break}}if(!unique){alert(this._filter('translate')('ErrorMsg_AnswerFileLabelNotValid'))}};return AnswerFileOptionsPanelViewModel}());Design.AnswerFileOptionsPanelViewModel=AnswerFileOptionsPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var TemplatePropertiesViewModel=(function(_super){__extends(TemplatePropertiesViewModel,_super);function TemplatePropertiesViewModel(editorViewModel,$filter,designApi,documentInterface,wizard,currentDocument,binary,placeholdersPanel,listManager,enableOfficeEdit){var _this=_super.call(this)||this;_this.availablePlaceholders=[];_this.isUploading=false;_this.isUploadComplete=false;_this.availableRepeatSources=[];_this.availableFragmentOutputs=[];_this._editor=editorViewModel;_this._filter=$filter;_this._designApi=designApi;_this._documentInterface=documentInterface;_this._placeholdersPanel=placeholdersPanel;_this._wizard=wizard;_this._currentDocument=currentDocument;_this._binary=binary;_this._listManager=listManager;_this._enableOfficeEdit=enableOfficeEdit;_this.availableColours=[];_this.availableColours.push({name:_this._filter('translate')('Green'),value:Intelledox.QAWizard.Design.PlaceholderColour.Green});_this.availableColours.push({name:_this._filter('translate')('Blue'),value:Intelledox.QAWizard.Design.PlaceholderColour.Blue});_this.availableColours.push({name:_this._filter('translate')('Orange'),value:Intelledox.QAWizard.Design.PlaceholderColour.Orange});_this.availableColours.push({name:_this._filter('translate')('Purple'),value:Intelledox.QAWizard.Design.PlaceholderColour.Purple});_this.availableColours.push({name:_this._filter('translate')('Cyan'),value:Intelledox.QAWizard.Design.PlaceholderColour.Cyan});if(wizard.TypeId===Intelledox.Model.ProjectType.Layout){editorViewModel.fillPlaceholderDropdown(_this.availablePlaceholders,wizard.ContentPlaceholder,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Model.PlaceholderPurpose.Insert);if(wizard.ContentPlaceholder==null){_this._contentPlaceholderListitem=_this.availablePlaceholders[0]}else{for(var i=0;i<_this.availablePlaceholders.length;i++){if(wizard.ContentPlaceholder.equals(_this.availablePlaceholders[i].reference)){_this._contentPlaceholderListitem=_this.availablePlaceholders[i];break}}}}else{if(currentDocument.RepeatSourceType!==Intelledox.QAWizard.Design.RepeatSourceType.None){_this._isDataDriven=true;_this.loadRepeatSources();if(currentDocument.RepeatSourceType===Intelledox.QAWizard.Design.RepeatSourceType.FragmentOutput){_this.isFragmentOutputVisible=true;_this.loadFragmentOutputs()}}else{_this._isDataDriven=false}}return _this}Object.defineProperty(TemplatePropertiesViewModel.prototype,"isBuiltInTemplate",{get:function(){return this._currentDocument.FormatType===Intelledox.Model.TemplateFormatType.ProjectResults},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"isLayoutProject",{get:function(){return(this._wizard.TypeId===Intelledox.Model.ProjectType.Layout)},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"name",{get:function(){return this._currentDocument.Name},set:function(value){this._currentDocument.Name=value;this._editor.wizChanged=true;this._editor.treeView.selectedNode.text=value;this._placeholdersPanel.changeDocumentProperties(this._currentDocument.DocumentGuid,value)},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"fileName",{get:function(){return this._currentDocument.FileName},set:function(value){this._currentDocument.FileName=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"allowNameChange",{get:function(){return this._currentDocument.AllowNameChange},set:function(value){this._currentDocument.AllowNameChange=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"colour",{get:function(){return this._currentDocument.Colour},set:function(value){this._editor.wizChanged=true;this.updatePlaceholderColour(value)},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"isDataDriven",{get:function(){return this._isDataDriven},set:function(value){this._isDataDriven=value;if(value){this.loadRepeatSources()}else{this._currentDocument.RepeatSourceType=Intelledox.QAWizard.Design.RepeatSourceType.None;this.repeatSourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"repeatSourceGuid",{get:function(){return this._currentDocument.RepeatSourceGuid},set:function(value){this._currentDocument.RepeatSourceGuid=value;this._editor.wizChanged=true;for(var i=0;i<this.availableRepeatSources.length;i++){if(this.availableRepeatSources[i].value===value){this._currentDocument.RepeatSourceType=this.availableRepeatSources[i].type;break}}if(this._currentDocument.RepeatSourceType===Intelledox.QAWizard.Design.RepeatSourceType.FragmentOutput){this.isFragmentOutputVisible=true;this.loadFragmentOutputs()}else{this.isFragmentOutputVisible=false}},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"repeatSourceAttributeGuid",{get:function(){return this._currentDocument.RepeatSourceAttributeGuid},set:function(value){this._currentDocument.RepeatSourceAttributeGuid=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"contentPlaceholder",{get:function(){return this._contentPlaceholderListitem},set:function(value){var newReference;if(value.reference.name===this._filter('translate')('NoneWithBrackets')){newReference=null}else{newReference=value.reference}if((this._wizard.ContentPlaceholder==null&&newReference!=null)||!this._wizard.ContentPlaceholder.equals(newReference)){this._placeholdersPanel.doPlaceholderColouringFromDropdown(this.availablePlaceholders,newReference,this._wizard.ContentPlaceholder,false,null);this._wizard.ContentPlaceholder=newReference;this._editor.wizChanged=true}this._contentPlaceholderListitem=value},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"isOfficeEditable",{get:function(){return this._enableOfficeEdit&&(this._binary.formatType==Intelledox.Model.TemplateFormatType.ExcelXlsx||this._binary.formatType==Intelledox.Model.TemplateFormatType.PowerPointPptx||this._binary.formatType==Intelledox.Model.TemplateFormatType.WordBinary||this._binary.formatType==Intelledox.Model.TemplateFormatType.WordDocm||this._binary.formatType==Intelledox.Model.TemplateFormatType.WordDocx)},enumerable:true,configurable:true});Object.defineProperty(TemplatePropertiesViewModel.prototype,"officeAppName",{get:function(){var stringTemplate=this._filter('translate')('EditIn');switch(this._binary.formatType){case Intelledox.Model.TemplateFormatType.ExcelXlsx:return System.String.Format(stringTemplate,'Excel');case Intelledox.Model.TemplateFormatType.PowerPointPptx:return System.String.Format(stringTemplate,'PowerPoint');case Intelledox.Model.TemplateFormatType.WordBinary:case Intelledox.Model.TemplateFormatType.WordDocm:case Intelledox.Model.TemplateFormatType.WordDocx:return System.String.Format(stringTemplate,'Word');default:return System.String.Format(stringTemplate,'App')}},enumerable:true,configurable:true});TemplatePropertiesViewModel.prototype.validateName=function(){if(System.String.IsNullOrEmpty(this._currentDocument.Name)){alert(this._filter('translate')('ErrorMsg_InvalidDocName'))}};TemplatePropertiesViewModel.prototype.downloadTemplate=function(){var vm=this;this._designApi.documentInterfaceDownload(this._wizard.ProjectGuid,this._binary.documentGuid,this._binary.templateEditGuid).then(function(result){if(window.navigator.msSaveOrOpenBlob){var blobObject=vm.dataURLtoBlob('data:application/octet-stream;base64,'+result);window.navigator.msSaveOrOpenBlob(blobObject,vm._currentDocument.Name+Intelledox.Model.FormatType.GetExtension(vm._binary.formatType))}else if(window.Blob){var blobObject=vm.dataURLtoBlob('data:application/octet-stream;base64,'+result);var objUrl=URL.createObjectURL(blobObject);var a=window.document.createElement('a');a.href=objUrl;a['download']=vm._currentDocument.Name+Intelledox.Model.FormatType.GetExtension(vm._binary.formatType);document.body.appendChild(a);a.click();document.body.removeChild(a)}else{var a=window.document.createElement('a');a.href='data:application/octet-stream;charset=utf-16;base64,'+result;a['download']=vm._currentDocument.Name+Intelledox.Model.FormatType.GetExtension(vm._binary.formatType);document.body.appendChild(a);a.click();document.body.removeChild(a)}})};TemplatePropertiesViewModel.prototype.uploadTemplate=function(){if(this.newTemplate==null||this.newTemplate.name==null){return}var vm=this;var extension=this.newTemplate.name.substring(this.newTemplate.name.lastIndexOf('.'));var formatType=Intelledox.Model.FormatType.GetID(extension);if(this.isLayoutProject){if(formatType!==Intelledox.Model.TemplateFormatType.WordBinary&&formatType!==Intelledox.Model.TemplateFormatType.WordDocx){alert(System.String.Format(this._filter('translate')('ErrorMsg_InvalidFileType'),'docx, doc'));return}}else{if(formatType===Intelledox.Model.TemplateFormatType.None){alert(System.String.Format(this._filter('translate')('ErrorMsg_InvalidFileType'),Intelledox.Model.FormatType.validExtensions()));return}}this.isUploadComplete=false;this.isUploading=true;var reader=new FileReader;reader.onloadend=function(){vm._editor.wizChanged=true;vm._binary.formatType=formatType;vm._currentDocument.FormatType=formatType;if(vm._binary.templateEditGuid==null){vm._binary.templateEditGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid()}vm._documentInterface.updatePlaceholders(vm._currentDocument.DocumentGuid,formatType,reader.result.split(",")[1],vm._binary.templateEditGuid).then(function(){vm._editor.flyoutPlaceholders.resetState(vm._documentInterface.getBookmarkDictionary());vm.isUploading=false;vm.isUploadComplete=true})};reader.readAsDataURL(this.newTemplate)};TemplatePropertiesViewModel.prototype.editInOffice=function(){var vm=this;var uriScheme='';switch(this._binary.formatType){case Intelledox.Model.TemplateFormatType.ExcelXlsx:uriScheme='ms-excel';break;case Intelledox.Model.TemplateFormatType.PowerPointPptx:uriScheme='ms-powerpoint';break;case Intelledox.Model.TemplateFormatType.WordBinary:case Intelledox.Model.TemplateFormatType.WordDocm:case Intelledox.Model.TemplateFormatType.WordDocx:uriScheme='ms-word';break;default:return}var encodedFileName=Intelledox.Common.Functions.MakeValidFileName(this._currentDocument.Name)+Intelledox.Model.FormatType.GetExtension(this._binary.formatType);vm._documentInterface.prepareForEdit(vm._binary,vm._wizard.ProjectGuid,vm._listManager,vm._binary.formatType).then(function(baseUrl){vm._editor.beginTemplateEdit=true;vm._editor.monitor.watchTemplateEdit(vm._binary.templateEditGuid);var a=window.document.createElement('a');a.href=uriScheme+':ofe%7cu%7c'+baseUrl+encodeURIComponent(encodedFileName);document.body.appendChild(a);a.click();document.body.removeChild(a)})};TemplatePropertiesViewModel.prototype.dataURLtoBlob=function(dataurl){var arr=dataurl.split(','),mime=arr[0].match(/:(.*?);/)[1],bstr=atob(arr[1]),n=bstr.length,u8arr=new Uint8Array(n);while(n--){u8arr[n]=bstr.charCodeAt(n)}return new Blob([u8arr],{type:mime})};TemplatePropertiesViewModel.prototype.updatePlaceholderColour=function(value){var originalBookmarkImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Bookmark,this._currentDocument.DocumentGuid,this._wizard);var originalUsedBookmarkImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.Bookmark,this._currentDocument.DocumentGuid,this._wizard);var originalMustacheImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Mustache,this._currentDocument.DocumentGuid,this._wizard);var originalUsedMustacheImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.Mustache,this._currentDocument.DocumentGuid,this._wizard);var originalXmlImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Xml,this._currentDocument.DocumentGuid,this._wizard);var originalUsedXmlImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.Xml,this._currentDocument.DocumentGuid,this._wizard);var originalXmlRepeatImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.XmlRepeat,this._currentDocument.DocumentGuid,this._wizard);var originalUsedXmlRepeatImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.XmlRepeat,this._currentDocument.DocumentGuid,this._wizard);var originalNamedRangeImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.NamedRange,this._currentDocument.DocumentGuid,this._wizard);var originalUsedNamedRangeImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.NamedRange,this._currentDocument.DocumentGuid,this._wizard);var originalWorksheetImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Worksheet,this._currentDocument.DocumentGuid,this._wizard);var originalUsedWorksheetImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.Worksheet,this._currentDocument.DocumentGuid,this._wizard);var originalPdfImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.PdfField,this._currentDocument.DocumentGuid,this._wizard);var originalUsedPdfImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.PdfField,this._currentDocument.DocumentGuid,this._wizard);var originalJsonImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Json,this._currentDocument.DocumentGuid,this._wizard);var originalUsedJsonImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.Json,this._currentDocument.DocumentGuid,this._wizard);this._currentDocument.Colour=value;var newBookmarkImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Bookmark,this._currentDocument.DocumentGuid,this._wizard);var newUsedBookmarkImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.Bookmark,this._currentDocument.DocumentGuid,this._wizard);var newMustacheImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Mustache,this._currentDocument.DocumentGuid,this._wizard);var newUsedMustacheImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.Mustache,this._currentDocument.DocumentGuid,this._wizard);var newXmlImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Xml,this._currentDocument.DocumentGuid,this._wizard);var newUsedXmlImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.Xml,this._currentDocument.DocumentGuid,this._wizard);var newXmlRepeatImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.XmlRepeat,this._currentDocument.DocumentGuid,this._wizard);var newUsedXmlRepeatImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.XmlRepeat,this._currentDocument.DocumentGuid,this._wizard);var newNamedRangeImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.NamedRange,this._currentDocument.DocumentGuid,this._wizard);var newUsedNamedRangeImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.NamedRange,this._currentDocument.DocumentGuid,this._wizard);var newWorksheetImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Worksheet,this._currentDocument.DocumentGuid,this._wizard);var newUsedWorksheetImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.Worksheet,this._currentDocument.DocumentGuid,this._wizard);var newPdfImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.PdfField,this._currentDocument.DocumentGuid,this._wizard);var newUsedPdfImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.PdfField,this._currentDocument.DocumentGuid,this._wizard);var newJsonImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(Intelledox.Model.PlaceholderType.Json,this._currentDocument.DocumentGuid,this._wizard);var newUsedJsonImage=Design.QuestionSetDesignerFactory.getUsedPlaceholderImage(Intelledox.Model.PlaceholderType.Json,this._currentDocument.DocumentGuid,this._wizard);for(var i=0;i<this._editor.treeView.nodes.length;i++){this.changePlaceholderImage(this._editor.treeView.nodes[i],originalBookmarkImage,originalMustacheImage,originalXmlImage,originalXmlRepeatImage,originalNamedRangeImage,originalWorksheetImage,originalPdfImage,originalJsonImage,newBookmarkImage,newMustacheImage,newXmlImage,newXmlRepeatImage,newNamedRangeImage,newWorksheetImage,newPdfImage,newJsonImage,this._currentDocument.DocumentGuid)}this._placeholdersPanel.changePlaceholderImage(null,originalBookmarkImage,originalMustacheImage,originalXmlImage,originalXmlRepeatImage,originalNamedRangeImage,originalWorksheetImage,originalPdfImage,originalJsonImage,newBookmarkImage,newMustacheImage,newXmlImage,newXmlRepeatImage,newNamedRangeImage,newWorksheetImage,newPdfImage,newJsonImage,this._currentDocument.DocumentGuid);this._placeholdersPanel.changePlaceholderImage(null,originalUsedBookmarkImage,originalUsedMustacheImage,originalUsedXmlImage,originalUsedXmlRepeatImage,originalUsedNamedRangeImage,originalUsedWorksheetImage,originalUsedPdfImage,originalUsedJsonImage,newUsedBookmarkImage,newUsedMustacheImage,newUsedXmlImage,newUsedXmlRepeatImage,newUsedNamedRangeImage,newUsedWorksheetImage,newUsedPdfImage,newUsedJsonImage,this._currentDocument.DocumentGuid)};TemplatePropertiesViewModel.prototype.changePlaceholderImage=function(node,oldBookmarkImage,oldMustacheImage,oldXmlImage,oldXmlRepeatImage,oldNamedRangeImage,oldWorksheetImage,oldPdfImage,oldJsonImage,newBookmarkImage,newMustacheImage,newXmlImage,newXmlRepeatImage,newNamedRangeImage,newWorksheetImage,newPdfImage,newJsonImage,docGuid){if(node.imageKey===oldBookmarkImage){if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===node.tag.DocumentGuid){node.imageKey=newBookmarkImage}}else if(node.imageKey===oldMustacheImage){if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===node.tag.DocumentGuid){node.imageKey=newMustacheImage}}else if(node.imageKey===oldXmlImage){if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===node.tag.DocumentGuid){node.imageKey=newXmlImage}}else if(node.imageKey===oldXmlRepeatImage){if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===node.tag.DocumentGuid){node.imageKey=newXmlRepeatImage}}else if(node.imageKey===oldNamedRangeImage){if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===node.tag.DocumentGuid){node.imageKey=newNamedRangeImage}}else if(node.imageKey===oldWorksheetImage){if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===node.tag.DocumentGuid){node.imageKey=newWorksheetImage}}else if(node.imageKey===oldPdfImage){if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===node.tag.DocumentGuid){node.imageKey=newPdfImage}}else if(node.imageKey===oldJsonImage){if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===node.tag.DocumentGuid){node.imageKey=newJsonImage}}for(var i=0;i<node.nodes.length;i++){this.changePlaceholderImage(node.nodes[i],oldBookmarkImage,oldMustacheImage,oldXmlImage,oldXmlRepeatImage,oldNamedRangeImage,oldWorksheetImage,oldPdfImage,oldJsonImage,newBookmarkImage,newMustacheImage,newXmlImage,newXmlRepeatImage,newNamedRangeImage,newWorksheetImage,newPdfImage,newJsonImage,docGuid)}};TemplatePropertiesViewModel.prototype.loadRepeatSources=function(){this.availableRepeatSources=[];this._listManager.populateRepeatSources(this._wizard,true,null,this.availableRepeatSources)};TemplatePropertiesViewModel.prototype.loadFragmentOutputs=function(){var fragmentReference=this._wizard.FindLayoutNode(this.repeatSourceGuid);this.availableFragmentOutputs=[];if(fragmentReference!=null){this._listManager.populateFragmentRepeatedOutputs(fragmentReference.ProjectGuid,this.availableFragmentOutputs)}};return TemplatePropertiesViewModel}(Design.PropertiesViewModel));Design.TemplatePropertiesViewModel=TemplatePropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var InkQuestion=(function(_super){__extends(InkQuestion,_super);function InkQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.ImageSettings=new Design.ImageSettings;_this.BackgroundSource=Intelledox.Model.BackgroundSource.StaticImage;_this.BackgroundImage=null;_this.IncludeBackground=false;_this.AllowBackgroundUpload=false;_this.ResizeBackgroundImage=false;_this.AllowInkColourChoice=false;_this.InkColour=-16777216;_this.BackgroundQRQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.BackgroundQRAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.AllowZoom=false;_this.ThumbnailMaxWidth=0;_this.ThumbnailMaxHeight=0;return _this}Object.defineProperty(InkQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Ink},enumerable:true,configurable:true});InkQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new InkQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());result.BackgroundSource=this.BackgroundSource;result.BackgroundImage=this.BackgroundImage;result.IncludeBackground=this.IncludeBackground;result.AllowBackgroundUpload=this.AllowBackgroundUpload;result.ResizeBackgroundImage=this.ResizeBackgroundImage;result.AllowInkColourChoice=this.AllowInkColourChoice;result.InkColour=this.InkColour;result.BackgroundQRQuestionGuid=this.BackgroundQRQuestionGuid;result.BackgroundQRAnswerGuid=this.BackgroundQRAnswerGuid;result.AllowZoom=this.AllowZoom;result.ThumbnailMaxWidth=this.ThumbnailMaxWidth;result.ThumbnailMaxHeight=this.ThumbnailMaxHeight;result.ImageSettings.MaxHeight=this.ImageSettings.MaxHeight;result.ImageSettings.MaxWidth=this.ImageSettings.MaxWidth;result.ImageSettings.StretchToFit=this.ImageSettings.StretchToFit;result.ImageSettings.UnitOfMeasure=this.ImageSettings.UnitOfMeasure;result.ImageSettings.SizeScale=this.ImageSettings.SizeScale;result.ImageSettings.AlternativeText=this.ImageSettings.AlternativeText;_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);return result};return InkQuestion}(Design.Question));Design.InkQuestion=InkQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var QuestionReferenceViewModel=(function(){function QuestionReferenceViewModel($filter,editorViewModel,wizard,question){this._wizard=null;this._parentQuestion=null;this.isAnswerVisible=false;this.availableQuestions=[];this.availableAnswers=[];this._filter=$filter;this._editorViewModel=editorViewModel;this._wizard=wizard;this._parentQuestion=question;this.loadQuestions();this.loadAnswers();this.enableDisableQuestionReferenceAnswer()}Object.defineProperty(QuestionReferenceViewModel.prototype,"questionReference",{get:function(){return this._parentQuestion.BackgroundQRQuestionGuid},set:function(value){this._parentQuestion.BackgroundQRQuestionGuid=value;this._parentQuestion.BackgroundQRAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._editorViewModel.wizChanged=true;this.loadAnswers();this.enableDisableQuestionReferenceAnswer()},enumerable:true,configurable:true});Object.defineProperty(QuestionReferenceViewModel.prototype,"answerReference",{get:function(){return this._parentQuestion.BackgroundQRAnswerGuid},set:function(value){this._parentQuestion.BackgroundQRAnswerGuid=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});QuestionReferenceViewModel.prototype.loadQuestions=function(){this.availableQuestions=[];this.availableAnswers=[];this.availableQuestions.push(new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.availableAnswers.push(new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));var questionList=this._wizard.GetNonRepeatedQuestions(this._parentQuestion.QuestionGuid);for(var i=0;i<questionList.length;i++){var q=questionList[i];if((q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&(q.SelectionType===Intelledox.Model.SelectionType.Single))||(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary&&q.ContentTypeRestriction===Intelledox.Model.ContentType.Image)){this.availableQuestions.push(q)}}};QuestionReferenceViewModel.prototype.loadAnswers=function(){this.availableAnswers=[];this.availableAnswers.push(new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));if(this.questionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){var question=this.getSelectedQuestion();if(question!=null){for(var i=0;i<question.Answers.length;i++){if(question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&question.Answers[i].DataConvertType===Intelledox.QAWizard.Design.DataConvertType.Image){this.availableAnswers.push(question.Answers[i])}else if(question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary){this.availableAnswers.push(question.Answers[i])}}}}};QuestionReferenceViewModel.prototype.enableDisableQuestionReferenceAnswer=function(){if(this.questionReference!=null&&this.questionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.isAnswerVisible=true}else{this.isAnswerVisible=false}};QuestionReferenceViewModel.prototype.getSelectedQuestion=function(){for(var i=0;i<this.availableQuestions.length;i++){if(this.questionReference===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};return QuestionReferenceViewModel}());Design.QuestionReferenceViewModel=QuestionReferenceViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Series=(function(){function Series(){this.Name="";this.DataQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.CategoriesAnswer=Intelledox.Common.ConstantValues.GUID_EMPTY;this.ValueAnswer=Intelledox.Common.ConstantValues.GUID_EMPTY;this.BackColour=-10185235;this.BorderlineColour=0;this.BorderlineDashStyle=Design.ChartBorderlineDashStyle.Solid;this.BorderlineWidth=1;this.ColourPalette=Design.ChartColourPalette.None;this.ChartType=Design.ChartType.Column;this.DataPointLabel=Design.ChartDataPointLabel.None}Series.prototype.Clone=function(){var result=new Series;result.Name=this.Name;result.DataQuestionGuid=this.DataQuestionGuid;result.CategoriesAnswer=this.CategoriesAnswer;result.ValueAnswer=this.ValueAnswer;result.BackColour=this.BackColour;result.BorderlineColour=this.BorderlineColour;result.BorderlineDashStyle=this.BorderlineDashStyle;result.BorderlineWidth=this.BorderlineWidth;result.ColourPalette=this.ColourPalette;result.ChartType=this.ChartType;result.DataPointLabel=this.DataPointLabel;return result};return Series}());Design.Series=Series})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var SeriesPanelViewModel=(function(){function SeriesPanelViewModel($filter,editorViewModel){this._selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.name='';this.selectedType=Intelledox.QAWizard.Design.ChartType.Point;this.selectedCategoryField=Intelledox.Common.ConstantValues.GUID_EMPTY;this.selectedValueField=Intelledox.Common.ConstantValues.GUID_EMPTY;this.selectedPalette=Intelledox.QAWizard.Design.ChartColourPalette.None;this.selectedDataPointLabel=Intelledox.QAWizard.Design.ChartDataPointLabel.None;this.selectedFillColour=0;this.selectedBorderLineColour=0;this.selectedBorderLineDashStyle=Intelledox.QAWizard.Design.ChartBorderlineDashStyle.NotSet;this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.existingSeries=[];this.availableQuestions=[];this.availableAnswers=[];this._editorViewModel=editorViewModel;this._filter=$filter}Object.defineProperty(SeriesPanelViewModel.prototype,"selectedQuestionGuid",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;this.availableAnswers=[];if(value!=null&&value!==Intelledox.Common.ConstantValues.GUID_EMPTY){var currentQuestion=this.findSelectedQuestion(value);for(var i=0;i<currentQuestion.Answers.length;i++){this.availableAnswers.push(currentQuestion.Answers[i])}}},enumerable:true,configurable:true});SeriesPanelViewModel.prototype.add=function(){var newSeries=new Intelledox.QAWizard.Design.Series;newSeries.Name=this.name;newSeries.ChartType=this.selectedType;newSeries.DataQuestionGuid=this.selectedQuestionGuid;newSeries.CategoriesAnswer=this.selectedCategoryField;newSeries.ValueAnswer=this.selectedValueField;newSeries.ColourPalette=this.selectedPalette;newSeries.DataPointLabel=this.selectedDataPointLabel;newSeries.BackColour=this.selectedFillColour;newSeries.BorderlineDashStyle=this.selectedBorderLineColour;newSeries.BorderlineWidth=parseInt(this.borderLineWidth,10);newSeries.BorderlineColour=this.selectedBorderLineColour;this._currentQuestion.Chart.Series.push(newSeries);this._editorViewModel.wizChanged=true;this.initSeries();this.selectExistingSeries(newSeries)};SeriesPanelViewModel.prototype.update=function(){var editSeries=this.getSelectedExistingSeries();editSeries.Name=this.name;editSeries.ChartType=this.selectedType;editSeries.DataQuestionGuid=this.selectedQuestionGuid;editSeries.CategoriesAnswer=this.selectedCategoryField;editSeries.ValueAnswer=this.selectedValueField;editSeries.ColourPalette=this.selectedPalette;editSeries.DataPointLabel=this.selectedDataPointLabel;editSeries.BackColour=this.selectedFillColour;editSeries.BorderlineDashStyle=this.selectedBorderLineColour;editSeries.BorderlineWidth=parseInt(this.borderLineWidth,10);editSeries.BorderlineColour=this.selectedBorderLineColour;this._editorViewModel.wizChanged=true;this.initSeries();this.selectExistingSeries(editSeries)};SeriesPanelViewModel.prototype.remove=function(){this._currentQuestion.Chart.Series.splice(this._currentQuestion.Chart.Series.indexOf(this.getSelectedExistingSeries()),1);this._editorViewModel.wizChanged=true;this.initSeries();this.selectExistingSeries(this._currentQuestion.Chart.Series[0])};SeriesPanelViewModel.prototype.init=function(wizard,currentQuestion){this._wizard=wizard;this._currentQuestion=currentQuestion;this.fillDataQuestions();this.fillColourPalette();this.fillLineStyle();this.fillDataPointLabel();this.availableColours=Intelledox.Common.Functions.ColourList(this._filter,true);this.initSeries();this.selectExistingSeries(currentQuestion.Chart.Series[0])};SeriesPanelViewModel.prototype.initSeries=function(){this.existingSeries=[];for(var i=0;i<this._currentQuestion.Chart.Series.length;i++){var s=this._currentQuestion.Chart.Series[i];this.existingSeries.push({tag:s,name:s.Name,selected:(i===0)})}};SeriesPanelViewModel.prototype.fillChartType=function(){var hasPie=false;var hasBar=false;var hasColumn=false;var currentSeries=this.getSelectedExistingSeries();for(var i=0;i<this._currentQuestion.Chart.Series.length;i++){if(this._currentQuestion.Chart.Series[i]!==currentSeries){switch(this._currentQuestion.Chart.Series[i].ChartType){case Intelledox.QAWizard.Design.ChartType.Pie:hasPie=true;break;case Intelledox.QAWizard.Design.ChartType.Line:case Intelledox.QAWizard.Design.ChartType.Point:case Intelledox.QAWizard.Design.ChartType.Column:case Intelledox.QAWizard.Design.ChartType.StackedColumn:hasColumn=true;break;case Intelledox.QAWizard.Design.ChartType.Bar:case Intelledox.QAWizard.Design.ChartType.StackedBar:hasBar=true;break}}}this.availableTypes=[];if(!hasPie&&!hasColumn){this.availableTypes.push({name:this._filter('translate')('Bar'),value:Intelledox.QAWizard.Design.ChartType.Bar})}if(!hasPie&&!hasBar){this.availableTypes.push({name:this._filter('translate')('Column'),value:Intelledox.QAWizard.Design.ChartType.Column})}if(!hasPie&&!hasBar){this.availableTypes.push({name:this._filter('translate')('Line'),value:Intelledox.QAWizard.Design.ChartType.Line})}if(!hasBar&&!hasColumn){this.availableTypes.push({name:this._filter('translate')('Pie'),value:Intelledox.QAWizard.Design.ChartType.Pie})}if(!hasPie&&!hasBar){this.availableTypes.push({name:this._filter('translate')('Point'),value:Intelledox.QAWizard.Design.ChartType.Point})}if(!hasPie&&!hasColumn){this.availableTypes.push({name:this._filter('translate')('StackedBar'),value:Intelledox.QAWizard.Design.ChartType.StackedBar})}if(!hasPie&&!hasBar){this.availableTypes.push({name:this._filter('translate')('StackedColumn'),value:Intelledox.QAWizard.Design.ChartType.StackedColumn})}};SeriesPanelViewModel.prototype.fillDataQuestions=function(){this.availableQuestions=[];for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){for(var questionIndex=0;questionIndex<this._wizard.Pages[pageIndex].Questions.length;questionIndex++){var q=this._wizard.Pages[pageIndex].Questions[questionIndex];if(q===this._currentQuestion){break}else if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.availableQuestions.push(q)}}}};SeriesPanelViewModel.prototype.fillColourPalette=function(){this.availablePalettes=[];this.availablePalettes.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.QAWizard.Design.ChartColourPalette.None});this.availablePalettes.push({name:this._filter('translate')('DefaultString'),value:Intelledox.QAWizard.Design.ChartColourPalette.Default});this.availablePalettes.push({name:this._filter('translate')('Berry'),value:Intelledox.QAWizard.Design.ChartColourPalette.Berry});this.availablePalettes.push({name:this._filter('translate')('BrightPastel'),value:Intelledox.QAWizard.Design.ChartColourPalette.BrightPastel});this.availablePalettes.push({name:this._filter('translate')('Chocolate'),value:Intelledox.QAWizard.Design.ChartColourPalette.Chocolate});this.availablePalettes.push({name:this._filter('translate')('EarthTones'),value:Intelledox.QAWizard.Design.ChartColourPalette.EarthTones});this.availablePalettes.push({name:this._filter('translate')('Excel'),value:Intelledox.QAWizard.Design.ChartColourPalette.Excel});this.availablePalettes.push({name:this._filter('translate')('Fire'),value:Intelledox.QAWizard.Design.ChartColourPalette.Fire});this.availablePalettes.push({name:this._filter('translate')('GrayScale'),value:Intelledox.QAWizard.Design.ChartColourPalette.GrayScale});this.availablePalettes.push({name:this._filter('translate')('Light'),value:Intelledox.QAWizard.Design.ChartColourPalette.Light});this.availablePalettes.push({name:this._filter('translate')('Pastel'),value:Intelledox.QAWizard.Design.ChartColourPalette.Pastel});this.availablePalettes.push({name:this._filter('translate')('SeaGreen'),value:Intelledox.QAWizard.Design.ChartColourPalette.SeaGreen});this.availablePalettes.push({name:this._filter('translate')('SemiTransparent'),value:Intelledox.QAWizard.Design.ChartColourPalette.SemiTransparent})};SeriesPanelViewModel.prototype.fillDataPointLabel=function(){this.availableDataPointLabels=[];this.availableDataPointLabels.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.QAWizard.Design.ChartDataPointLabel.None});this.availableDataPointLabels.push({name:this._filter('translate')('Value'),value:Intelledox.QAWizard.Design.ChartDataPointLabel.Value});this.availableDataPointLabels.push({name:this._filter('translate')('Category'),value:Intelledox.QAWizard.Design.ChartDataPointLabel.Category})};SeriesPanelViewModel.prototype.fillLineStyle=function(){this.availableLineStyles=[];this.availableLineStyles.push({name:this._filter('translate')('DefaultString'),value:Intelledox.QAWizard.Design.ChartBorderlineDashStyle.Solid});this.availableLineStyles.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.QAWizard.Design.ChartBorderlineDashStyle.NotSet});this.availableLineStyles.push({name:this._filter('translate')('Dotted'),value:Intelledox.QAWizard.Design.ChartBorderlineDashStyle.Dot});this.availableLineStyles.push({name:this._filter('translate')('Dashed'),value:Intelledox.QAWizard.Design.ChartBorderlineDashStyle.Dash});this.availableLineStyles.push({name:this._filter('translate')('Solid'),value:Intelledox.QAWizard.Design.ChartBorderlineDashStyle.Solid})};SeriesPanelViewModel.prototype.populateCurrentSeries=function(){var selectedItem=this.getSelectedExistingSeries();if(selectedItem==null){return}this.name=selectedItem.Name;this.selectedType=selectedItem.ChartType;this.selectedQuestionGuid=selectedItem.DataQuestionGuid;this.selectedCategoryField=selectedItem.CategoriesAnswer;this.selectedValueField=selectedItem.ValueAnswer;this.selectedPalette=selectedItem.ColourPalette;this.selectedDataPointLabel=selectedItem.DataPointLabel;this.selectedFillColour=selectedItem.BackColour;this.selectedBorderLineDashStyle=selectedItem.BorderlineDashStyle;this.borderLineWidth=selectedItem.BorderlineWidth.toString();this.selectedBorderLineColour=selectedItem.BorderlineColour};SeriesPanelViewModel.prototype.checkSeriesAddUpdateRemove=function(){this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;if(!System.String.IsNullOrEmpty(this.name)){this.isAddEnabled=true;this.isUpdateEnabled=true}if(this._currentQuestion.Chart.Series.length>1){this.isRemoveEnabled=true}};SeriesPanelViewModel.prototype.selectExistingSeries=function(series){for(var i=0;i<this.existingSeries.length;i++){if(this.existingSeries[i].tag===series){this.existingSeries[i].selected=true;this.populateCurrentSeries();this.checkSeriesAddUpdateRemove()}else{this.existingSeries[i].selected=false}}this.fillChartType();this.checkSeriesAddUpdateRemove()};SeriesPanelViewModel.prototype.getSelectedExistingSeries=function(){for(var i=0;i<this.existingSeries.length;i++){if(this.existingSeries[i].selected){return this.existingSeries[i].tag}}return null};SeriesPanelViewModel.prototype.findSelectedQuestion=function(questionGuid){for(var i=0;i<this.availableQuestions.length;i++){if(questionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};return SeriesPanelViewModel}());Design.SeriesPanelViewModel=SeriesPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var PlaceholderPropertiesViewModel=(function(_super){__extends(PlaceholderPropertiesViewModel,_super);function PlaceholderPropertiesViewModel(editorViewModel,$filter,$uibModal,docInterface,wizard,currentQuestion,currentAnswer,currentPlaceholder,placeholdersPanel,isPlaceholderNameAllowed){var _this=_super.call(this)||this;_this.isReverseHideValueVisible=false;_this.isGapPlaceholderVisible=true;_this.isBehaviourVisible=false;_this.isStyleVisible=false;_this.isImageScaleVisible=false;_this._editor=editorViewModel;_this._filter=$filter;_this._modal=$uibModal;_this._docInterface=docInterface;_this._placeholdersPanel=placeholdersPanel;_this._isPlaceholderNameAllowed=isPlaceholderNameAllowed;_this._wizard=wizard;_this._currentPlaceholder=currentPlaceholder;_this._name=currentPlaceholder.Name;if(currentQuestion!=null){switch(currentQuestion.QuestionTypeID){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary:if(_this._editor.treeView.selectedNode.parent.tag instanceof Intelledox.QAWizard.Design.ContentItem&&_this._editor.treeView.selectedNode.parent.tag.ContentTypeId===Intelledox.Model.ContentType.Image){_this.isImageScaleVisible=true}break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Ink:_this.isImageScaleVisible=true;break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource:if(currentAnswer.DataConvertType===Intelledox.QAWizard.Design.DataConvertType.Image){_this.isImageScaleVisible=true}break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic:if(_this._editor.treeView.selectedNode.parent.tag instanceof Intelledox.QAWizard.Design.ContentItem){if(_this._editor.treeView.selectedNode.parent.tag.ContentTypeId===Intelledox.Model.ContentType.Image){_this.isImageScaleVisible=true}}else{_this.isGapPlaceholderVisible=false;if(currentQuestion.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic){_this.loadPlaceholderActions((currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic),(currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic));_this.isBehaviourVisible=true;if(currentPlaceholder.Behaviour===Intelledox.QAWizard.Design.PlaceholderBehaviour.SetStyle){_this.isStyleVisible=true;_this.loadStyles()}}}_this.isReverseHideValueVisible=true;break}}if(currentPlaceholder.External){_this.template=$filter('translate')('ExternalPlaceholder')}else{if(currentPlaceholder.DocumentGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){_this.template=wizard.Documents[0].Name}else{_this.fillTemplateName()}}if(currentPlaceholder.HasCloseGap){_this.gapPlaceholder=currentPlaceholder.CloseGapPlaceholder.name}else{_this.gapPlaceholder=""}return _this}Object.defineProperty(PlaceholderPropertiesViewModel.prototype,"name",{get:function(){return this._name},set:function(value){this._name=value},enumerable:true,configurable:true});Object.defineProperty(PlaceholderPropertiesViewModel.prototype,"behaviour",{get:function(){return this._currentPlaceholder.Behaviour},set:function(value){this._currentPlaceholder.Behaviour=value;this._editor.wizChanged=true;this.isStyleVisible=(value===Intelledox.QAWizard.Design.PlaceholderBehaviour.SetStyle);if(this.isStyleVisible){this.loadStyles()}},enumerable:true,configurable:true});Object.defineProperty(PlaceholderPropertiesViewModel.prototype,"style",{get:function(){return this._currentPlaceholder.StyleName},set:function(value){this._currentPlaceholder.StyleName=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(PlaceholderPropertiesViewModel.prototype,"reverseHideValue",{get:function(){return this._currentPlaceholder.ReverseHideValue},set:function(value){this._currentPlaceholder.ReverseHideValue=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(PlaceholderPropertiesViewModel.prototype,"imageScale",{get:function(){if(this._currentPlaceholder.ContentImageScale===0){return''}return this._currentPlaceholder.ContentImageScale.toString()},set:function(value){this._currentPlaceholder.ContentImageScale=parseFloat(value);if(isNaN(this._currentPlaceholder.ContentImageScale)){this._currentPlaceholder.ContentImageScale=0}this._editor.wizChanged=true},enumerable:true,configurable:true});PlaceholderPropertiesViewModel.prototype.selectGapPlaceholder=function(){var vm=this;var placeholders=[];var originalList=[];var originalItem=null;if(!this._editor.placeholderIsBlank(vm._currentPlaceholder.CloseGapPlaceholder)){placeholders.push(vm._currentPlaceholder.CloseGapPlaceholder);originalItem=new Design.PlaceholderListItem(vm._currentPlaceholder.CloseGapPlaceholder,Intelledox.Common.ConstantValues.GUID_EMPTY);originalList.push(originalItem)}var modalConfirm=this._modal.open({templateUrl:'Views/Modal/managePlaceholders.html?v=106882799234227327',controller:['$scope','$modalInstance','$filter','editor','singleSelect','placeholders','usedPlaceholders','unusedPlaceholders','additionalListItem','placeholderPurpose',Design.SelectPlaceholdersModalCtrl],backdrop:'static',resolve:{editor:function(){return vm._editor},singleSelect:function(){return true},placeholders:function(){return placeholders},usedPlaceholders:function(){return vm._placeholdersPanel.usedPlaceholders},unusedPlaceholders:function(){return vm._placeholdersPanel.unusedPlaceholders},additionalListItem:function(){return new Design.PlaceholderListItem(vm._currentPlaceholder.Reference,Intelledox.Common.ConstantValues.GUID_EMPTY)},placeholderPurpose:function(){return Intelledox.Model.PlaceholderPurpose.Range}}});modalConfirm.result.then(function(newList){vm._placeholdersPanel.colourPlaceholdersFromList(originalList,false);vm._placeholdersPanel.colourPlaceholdersFromList(newList,true);if(newList.length===0){vm._currentPlaceholder.CloseGapPlaceholder=null;vm.gapPlaceholder=""}else{vm._currentPlaceholder.CloseGapPlaceholder=newList[0].reference;vm.gapPlaceholder=vm._currentPlaceholder.CloseGapPlaceholder.name}vm._editor.wizChanged=true})};PlaceholderPropertiesViewModel.prototype.autoGapPlaceholder=function(){var originalList=[];var newList=[];originalList.push(new Design.PlaceholderListItem(this._currentPlaceholder.CloseGapPlaceholder,Intelledox.Common.ConstantValues.GUID_EMPTY));this._placeholdersPanel.colourPlaceholdersFromList(originalList,false);this._currentPlaceholder.CloseGapPlaceholder=this._placeholdersPanel.findPossibleCloseGap(this._currentPlaceholder.Reference);newList.push(new Design.PlaceholderListItem(this._currentPlaceholder.CloseGapPlaceholder,Intelledox.Common.ConstantValues.GUID_EMPTY));this._placeholdersPanel.colourPlaceholdersFromList(newList,true);if(this._currentPlaceholder.HasCloseGap){this.gapPlaceholder=this._currentPlaceholder.CloseGapPlaceholder.name}else{this.gapPlaceholder=""}this._editor.wizChanged=true};PlaceholderPropertiesViewModel.prototype.validateName=function(){var propertyValidationError=false;if(System.String.Trim(this._name," ")===""){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('Placeholder'),this._filter('translate')('Name')));propertyValidationError=true}if(this._currentPlaceholder.Name!==this._name){var newReference=new Intelledox.Model.PlaceholderReference;newReference.name=this._name;newReference.type=this._currentPlaceholder.PlaceholderType;if(!this._isPlaceholderNameAllowed(newReference,this._editor.treeView.selectedNode.parent,this._currentPlaceholder.DocumentGuid,null)){alert(this._filter('translate')('ErrorMsg_DuplicatePlaceholder'));this._name=this._currentPlaceholder.Name}else if(!this._currentPlaceholder.External){var docGuid;var validName=false;if(this._placeholdersPanel.isPlaceholderUnused(this._currentPlaceholder.DocumentGuid,newReference)){validName=true;docGuid=this._currentPlaceholder.DocumentGuid}else{docGuid=this.findPlaceholder(newReference);if(docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){alert(this._filter('translate')('ErrorMsg_PlaceholderNotInDocument'));if(this._currentPlaceholder.PlaceholderType===Intelledox.Model.PlaceholderType.Bookmark){this._editor.treeView.selectedNode.imageKey="icon-nobookmark"}else{this._editor.treeView.selectedNode.imageKey="icon-nomustache"}}else{validName=true}}if(validName){this._editor.treeView.selectedNode.text=this._name;if(this._placeholdersPanel.unusedPlaceholders.hasOwnProperty(this._currentPlaceholder.DocumentGuid)){this._placeholdersPanel.colourPlaceholder(this._currentPlaceholder.Reference,false,false,this._currentPlaceholder.DocumentGuid)}this._currentPlaceholder.Name=this._name;this._currentPlaceholder.DocumentGuid=docGuid;this._placeholdersPanel.colourPlaceholder(this._currentPlaceholder.Reference,false,true,docGuid);this.fillTemplateName();var bmImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(this._currentPlaceholder.PlaceholderType,docGuid,this._wizard);this._editor.treeView.selectedNode.imageKey=bmImage}this._editor.wizChanged=true}else{this._editor.treeView.selectedNode.text=this._name;this._placeholdersPanel.colourPlaceholder(this._currentPlaceholder.Reference,true,false,Intelledox.Common.ConstantValues.GUID_EMPTY);this._currentPlaceholder.Name=this._name;this._placeholdersPanel.colourPlaceholder(this._currentPlaceholder.Reference,true,true,Intelledox.Common.ConstantValues.GUID_EMPTY);this._editor.wizChanged=true;if(this._currentPlaceholder.PlaceholderType===Intelledox.Model.PlaceholderType.Bookmark){this._editor.treeView.selectedNode.imageKey="icon-externalbookmark"}else{this._editor.treeView.selectedNode.imageKey="icon-externalmustache"}}}else if(!this._currentPlaceholder.External){var bmImage=Design.QuestionSetDesignerFactory.getPlaceholderImage(this._currentPlaceholder.PlaceholderType,this._currentPlaceholder.DocumentGuid,this._wizard);this._editor.treeView.selectedNode.imageKey=bmImage}};PlaceholderPropertiesViewModel.prototype.loadPlaceholderActions=function(hasTagValue,hasDisplayText){var purpose=this._currentPlaceholder.Reference.purpose;this.availableBehaviours=[];if((purpose&Intelledox.Model.PlaceholderPurpose.Range)===Intelledox.Model.PlaceholderPurpose.Range){this.availableBehaviours.push({name:this._filter('translate')('InsertionRemoval'),value:Intelledox.QAWizard.Design.PlaceholderBehaviour.Default});this.availableBehaviours.push({name:this._filter('translate')('ApplyStyle'),value:Intelledox.QAWizard.Design.PlaceholderBehaviour.SetStyle})}if((purpose&Intelledox.Model.PlaceholderPurpose.Insert)===Intelledox.Model.PlaceholderPurpose.Insert){if(hasTagValue){this.availableBehaviours.push({name:this._filter('translate')('InsertValue'),value:Intelledox.QAWizard.Design.PlaceholderBehaviour.InsertTagValue})}if(hasDisplayText){this.availableBehaviours.push({name:this._filter('translate')('InsertDisplayText'),value:Intelledox.QAWizard.Design.PlaceholderBehaviour.InsertDisplayText})}this.availableBehaviours.push({name:this._filter('translate')('InsertCheckbox'),value:Intelledox.QAWizard.Design.PlaceholderBehaviour.InsertCheckbox})}};PlaceholderPropertiesViewModel.prototype.loadStyles=function(){if(this.availableStyles==null){var vm=this;this.availableStyles=[];vm.availableStyles.push.apply(vm.availableStyles,this._docInterface.getCustomStylesDetail())}};PlaceholderPropertiesViewModel.prototype.fillTemplateName=function(){var found=false;for(var i=0;i<this._wizard.Documents.length;i++){if(this._currentPlaceholder.DocumentGuid===this._wizard.Documents[i].DocumentGuid){this.template=this._wizard.Documents[i].Name;found=true;break}}if(!found){this.template=this._filter('translate')('Deleted')}};PlaceholderPropertiesViewModel.prototype.findPlaceholder=function(placeholderName){var posibleDocuments=this._docInterface.findPlaceholder(placeholderName);for(var i=0;i<posibleDocuments.length;i++){if(this._placeholdersPanel.isPlaceholderUnused(posibleDocuments[i],placeholderName)){return posibleDocuments[i]}}return Intelledox.Common.ConstantValues.GUID_EMPTY};return PlaceholderPropertiesViewModel}(Design.PropertiesViewModel));Design.PlaceholderPropertiesViewModel=PlaceholderPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var PlaceholderTreeNode=(function(_super){__extends(PlaceholderTreeNode,_super);function PlaceholderTreeNode(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.documentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;return _this}return PlaceholderTreeNode}(Design.TreeNode));Design.PlaceholderTreeNode=PlaceholderTreeNode})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var EscalationPropertiesViewModel=(function(){function EscalationPropertiesViewModel(editorViewModel,escalation,wizard,$filter,lists,scope){this.showQuestionRef=false;this.showWorkingDays=false;this.isRecursEnabled=false;this.isAnswerVisible=false;this.initiateTypes=[];this.availableQuestions=[];this.availableAnswers=[];this.inputsPanelModel=null;this.recurrencePanelViewModel=null;var vm=this;this._editor=editorViewModel;this._filter=$filter;this._escalation=escalation;this._wizard=wizard;this._scope=scope;this.loadInitiateTypes();this.loadQuestions();this.loadAnswers();this.enableDisableQuestionReferenceAnswer();this.inputsPanelModel=new Design.InputsPanelViewModel($filter,editorViewModel,escalation,wizard,lists);this.recurrencePanelViewModel=new Design.RecurrencePanelViewModel($filter,editorViewModel,escalation,wizard,this.availableQuestions);lists.escalationTypes().then(function(escalations){for(var i=0;i<escalations.length;i++){if(escalations[i].routingTypeId===escalation.Type.routingTypeId){vm.isRecursEnabled=escalations[i].supportsRecurring;break}}})}Object.defineProperty(EscalationPropertiesViewModel.prototype,"name",{get:function(){return Design.TranslationHelper.KeywordValueToTranslation(this._filter,this._escalation.Name)},set:function(value){this._escalation.Name=Design.TranslationHelper.TranslationToKeywordValue(this._filter,value);this._editor.wizChanged=true;this._scope.$emit('workflowChanged')},enumerable:true,configurable:true});Object.defineProperty(EscalationPropertiesViewModel.prototype,"selectedType",{get:function(){this.showInitiateAfterFields(this._escalation.InitialisationType);return this._escalation.InitialisationType},set:function(value){this._escalation.InitialisationType=value;this.showInitiateAfterFields(value);this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(EscalationPropertiesViewModel.prototype,"initiateAfter",{get:function(){if(this._escalation.ExpireAfter===0){return''}return this._escalation.ExpireAfter.toString()},set:function(value){this._escalation.ExpireAfter=parseInt(value,10);if(isNaN(this._escalation.ExpireAfter)){this._escalation.ExpireAfter=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(EscalationPropertiesViewModel.prototype,"workingDaysOnly",{get:function(){return this._escalation.WorkingDays},set:function(value){this._escalation.WorkingDays=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(EscalationPropertiesViewModel.prototype,"selectedQuestionGuid",{get:function(){return this._escalation.ExpiryDateQuestionReference},set:function(value){this._escalation.ExpiryDateQuestionReference=value;this._escalation.ExpiryDateAnswerReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this._editor.wizChanged=true;this.loadAnswers();this.enableDisableQuestionReferenceAnswer()},enumerable:true,configurable:true});Object.defineProperty(EscalationPropertiesViewModel.prototype,"selectedAnswerGuid",{get:function(){return this._escalation.ExpiryDateAnswerReference},set:function(value){this._escalation.ExpiryDateAnswerReference=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(EscalationPropertiesViewModel.prototype,"recurs",{get:function(){return this._escalation.Recurs},set:function(value){this._escalation.Recurs=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(EscalationPropertiesViewModel.prototype,"initiateAfterLabel",{get:function(){switch(this.selectedType){case Intelledox.Model.EscalationInitialisationType.Mins:return this._filter('translate')('MinsAfterTransition');case Intelledox.Model.EscalationInitialisationType.Hours:return this._filter('translate')('HoursAfterTransition');case Intelledox.Model.EscalationInitialisationType.Days:return this._filter('translate')('DaysAfterTransition')}},enumerable:true,configurable:true});EscalationPropertiesViewModel.prototype.showInitiateAfterFields=function(initiateType){this.showQuestionRef=false;this.showWorkingDays=false;if(initiateType==Intelledox.Model.EscalationInitialisationType.QuestionReference){this.showQuestionRef=true}else if(initiateType==Intelledox.Model.EscalationInitialisationType.Days){this.showWorkingDays=true}};EscalationPropertiesViewModel.prototype.validateName=function(){if(System.String.IsNullOrEmpty(this._escalation.Name)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('Escalation'),this._filter('translate')('Name')))}};EscalationPropertiesViewModel.prototype.loadInitiateTypes=function(){this.initiateTypes=[];this.initiateTypes.push({name:this._filter('translate')('InMins'),value:Intelledox.Model.EscalationInitialisationType.Mins});this.initiateTypes.push({name:this._filter('translate')('InHours'),value:Intelledox.Model.EscalationInitialisationType.Hours});this.initiateTypes.push({name:this._filter('translate')('InDays'),value:Intelledox.Model.EscalationInitialisationType.Days});this.initiateTypes.push({name:this._filter('translate')('DateTimeLiteral'),value:Intelledox.Model.EscalationInitialisationType.QuestionReference})};EscalationPropertiesViewModel.prototype.loadQuestions=function(){this.availableQuestions=[];this.availableAnswers=[];this.availableQuestions.push(new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.availableAnswers.push(new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));var questionList=this._wizard.GetNonRepeatedQuestions(Intelledox.Common.ConstantValues.GUID_EMPTY);for(var i=0;i<questionList.length;i++){var q=questionList[i];if((q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic&&(q.DisplayType===Intelledox.Model.QuestionDisplayType.MultiChoice||q.DisplayType===Intelledox.Model.QuestionDisplayType.MultiChoiceToggleButton||q.DisplayType===Intelledox.Model.QuestionDisplayType.Dropdown))||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&(q.SelectionType===Intelledox.Model.SelectionType.Single))){this.availableQuestions.push(q)}}};EscalationPropertiesViewModel.prototype.loadAnswers=function(){this.availableAnswers=[];if(this.selectedQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var question=this.getSelectedQuestion();if(question!=null){for(var i=0;i<question.Answers.length;i++){this.availableAnswers.push(question.Answers[i])}}}};EscalationPropertiesViewModel.prototype.enableDisableQuestionReferenceAnswer=function(){var q=this.getSelectedQuestion();if(q!=null&&q.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(this.isAnswerRequired(q.QuestionTypeID)){this.isAnswerVisible=true}else{this.isAnswerVisible=false}}else{this.isAnswerVisible=false}};EscalationPropertiesViewModel.prototype.getSelectedQuestion=function(){for(var i=0;i<this.availableQuestions.length;i++){if(this.selectedQuestionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};EscalationPropertiesViewModel.prototype.isAnswerRequired=function(questionType){switch(questionType){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label:return false;default:return true}};return EscalationPropertiesViewModel}());Design.EscalationPropertiesViewModel=EscalationPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ButtonType=Intelledox.Model.ButtonType;var ButtonPropertiesViewModel=(function(_super){__extends(ButtonPropertiesViewModel,_super);function ButtonPropertiesViewModel(editorViewModel,question,$filter,$uibModal,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._pages=null;_this._folders=null;_this._projects=null;_this._goToFolder="";_this.icon=Intelledox.Common.ConstantValues.DATA_URI_BLANK;_this.sizes=[{name:'Small',value:Intelledox.Model.ButtonSize.Small},{name:'Medium',value:Intelledox.Model.ButtonSize.Medium},{name:'Wide',value:Intelledox.Model.ButtonSize.Wide},{name:'Large',value:Intelledox.Model.ButtonSize.Large}];_this._filterLocal=$filter;_this._modal=$uibModal;_this._editor=editorViewModel;_this._button=question;_this._listManager=lists;if(!System.String.IsNullOrEmpty(_this._button.Icon)){_this.icon=Intelledox.Common.ConstantValues.DATA_URI_PREFIX+_this._button.Icon}_this.buttonTypes=[{name:'Toggle',value:Intelledox.Model.ButtonType.Toggle},{name:'OpenUrl',value:Intelledox.Model.ButtonType.OpenUrl}];if(editorViewModel.wizard.TypeId!==Intelledox.Model.ProjectType.FragmentPortion&&editorViewModel.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard){_this.buttonTypes.push({name:'GoToPage',value:Intelledox.Model.ButtonType.GoToPage})}_this.buttonTypes.push({name:'GoToProject',value:Intelledox.Model.ButtonType.GoToProject});_this.buttonTypes.push({name:'RefreshString',value:Intelledox.Model.ButtonType.Refresh});var vm=_this;_this._listManager.publishedProjects().then(function(f){var found=false;vm._folders=[];for(var i=0;i<f.length;i++){vm._folders.push({name:f[i].name,value:f[i].projectGroups});if(!found&&vm.goToProjectGroupGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var j=0;j<f[i].projectGroups.length;j++){if(f[i].projectGroups[j].projectGroupGuid===vm.goToProjectGroupGuid){found=true;vm.goToFolder=f[i].name;vm.loadProjects(f[i].name);break}}}}});return _this}Object.defineProperty(ButtonPropertiesViewModel.prototype,"goToFolder",{get:function(){return this._goToFolder},set:function(value){this._goToFolder=value;this.loadProjects(value)},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"pages",{get:function(){if(this._pages===null){var wiz=this._editor.wizard;this._pages=[];for(var i=0;i<wiz.Pages.length;i++){if(!(wiz.Pages[i]instanceof Intelledox.QAWizard.Design.FragmentPage)){this._pages.push({name:wiz.Pages[i].Name,value:wiz.Pages[i].PageGuid})}}if(wiz.FinishPageVisible){this._pages.push({name:this._filterLocal('translate')('FinishPage'),value:Intelledox.Common.ConstantValues.GUID_EMPTY})}}return this._pages},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"folders",{get:function(){return this._folders},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"projects",{get:function(){return this._projects},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"title",{get:function(){return this._button.Title},set:function(value){this._button.Title=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"badge",{get:function(){return this._button.Badge},set:function(value){this._button.Badge=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"backColour",{get:function(){return this._button.BackColour},set:function(value){this._button.BackColour=value;var backGradient=this.LightenDarkenColor(value,-20);this._button.BackColourDark=backGradient;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"backToggleColour",{get:function(){return this._button.BackToggleColour},set:function(value){this._button.BackToggleColour=value;var backToggleGradient=this.LightenDarkenColor(value,-20);this._button.BackToggleColourDark=backToggleGradient;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"focusRingColour",{get:function(){return this._button.FocusRingColour},set:function(value){this._button.FocusRingColour=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"size",{get:function(){return this._button.Size},set:function(value){this._button.Size=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"buttonType",{get:function(){return this._button.ButtonType},set:function(value){var originalButtonType=this._button.ButtonType;this._button.ButtonType=value;if(originalButtonType!==value&&originalButtonType===ButtonType.Toggle){if(this._button.Answers.length>0){for(var i=0;i<this._button.Answers.length;i++){this._button.Answers[i].SaveToAnswerFileBy=Intelledox.QAWizard.Design.SaveAnswerByEnum.None}}}else if(originalButtonType!==value&&value===ButtonType.Toggle){if(this._button.Answers.length>0){this._button.Answers[0].SaveToAnswerFileBy=Intelledox.QAWizard.Design.SaveAnswerByEnum.SaveById}}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"launchUrl",{get:function(){return this._button.LaunchUrl},set:function(value){this._button.LaunchUrl=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"openInNewTab",{get:function(){return this._button.NewTab},set:function(value){this._button.NewTab=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"goToPageGuid",{get:function(){return this._button.GoToPageGuid},set:function(value){this._button.GoToPageGuid=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"goToProjectGroupGuid",{get:function(){return this._button.GoToProjectGroupGuid},set:function(value){this._button.GoToProjectGroupGuid=value;this._editor.wizChanged=true},enumerable:true,configurable:true});ButtonPropertiesViewModel.prototype.loadProjects=function(folder){this._projects=[];var myFolder=null;for(var i=0;i<this._folders.length;i++){if(this._folders[i].name===folder){myFolder=this._folders[i];break}}for(var i=0;i<myFolder.value.length;i++){this._projects.push({name:myFolder.value[i].name,value:myFolder.value[i].projectGroupGuid})}};ButtonPropertiesViewModel.prototype.pickTitleRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editor.treeView.pickEvent=function(node){_this.title=Design.HelperFunctions.onPickRef(_this._filterLocal,_this.title,node,insertPoint)};this._editor.treeView.togglePickMode()};ButtonPropertiesViewModel.prototype.pickBadgeRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editor.treeView.pickEvent=function(node){_this.badge=Design.HelperFunctions.onPickRef(_this._filterLocal,_this.badge,node,insertPoint)};this._editor.treeView.togglePickMode()};ButtonPropertiesViewModel.prototype.openImage=function(){var vm=this;var modalInstance=this._modal.open({templateUrl:'Views/Modal/imageUpload.html?v=106882799234227327',controller:['$scope','$modalInstance','$http',Design.OpenImageModalCtrl],backdrop:'static'});modalInstance.result.then(function(base64Image){vm.icon=Intelledox.Common.ConstantValues.DATA_URI_PREFIX+base64Image;vm._button.Icon=base64Image;vm._editor.wizChanged=true})};ButtonPropertiesViewModel.prototype.clearImage=function(){this.icon=Intelledox.Common.ConstantValues.DATA_URI_BLANK;this._button.Icon=null};Object.defineProperty(ButtonPropertiesViewModel.prototype,"showUrl",{get:function(){return this._button.ButtonType===Intelledox.Model.ButtonType.OpenUrl},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"showNewTab",{get:function(){return this._button.ButtonType===Intelledox.Model.ButtonType.OpenUrl},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"showGoToPage",{get:function(){return this._button.ButtonType===Intelledox.Model.ButtonType.GoToPage},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"showGoToProject",{get:function(){return this._button.ButtonType===Intelledox.Model.ButtonType.GoToProject},enumerable:true,configurable:true});Object.defineProperty(ButtonPropertiesViewModel.prototype,"showProjects",{get:function(){return this.buttonType===Intelledox.Model.ButtonType.GoToProject&&this.goToFolder!==""},enumerable:true,configurable:true});ButtonPropertiesViewModel.prototype.LightenDarkenColor=function(col,amt){var usePound=false;if(col[0]==="#"){col=col.slice(1);usePound=true}var num=parseInt(col,16);var r=(num>>16)+amt;if(r>255)r=255;else if(r<0)r=0;var b=((num>>8)&0x00FF)+amt;if(b>255)b=255;else if(b<0)b=0;var g=(num&0x0000FF)+amt;if(g>255)g=255;else if(g<0)g=0;return(usePound?"#":"")+(g|(b<<8)|(r<<16)).toString(16)};return ButtonPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.ButtonPropertiesViewModel=ButtonPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var SummaryPropertiesViewModel=(function(_super){__extends(SummaryPropertiesViewModel,_super);function SummaryPropertiesViewModel(editorViewModel,question,currentPage,wizard,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._selectedPage=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.isAddEnabled=false;_this.isRemoveEnabled=false;_this.existingExcludedPages=[];_this.availablePages=[];_this._editor=editorViewModel;_this._filterLocal=$filter;_this._summary=question;_this._currentPage=currentPage;_this._wizard=wizard;_this.loadPages();_this.loadExcludedPages();return _this}Object.defineProperty(SummaryPropertiesViewModel.prototype,"upToCurrentPageOnly",{get:function(){return this._summary.Settings.UpToCurrentPageOnly},set:function(value){this._summary.Settings.UpToCurrentPageOnly=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(SummaryPropertiesViewModel.prototype,"collapsiblePages",{get:function(){return this._summary.Settings.CollapsiblePages},set:function(value){this._summary.Settings.CollapsiblePages=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(SummaryPropertiesViewModel.prototype,"includePageLinks",{get:function(){return this._summary.Settings.IncludePageLinks},set:function(value){this._summary.Settings.IncludePageLinks=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(SummaryPropertiesViewModel.prototype,"includeComments",{get:function(){return this._summary.Settings.IncludeComments},set:function(value){this._summary.Settings.IncludeComments=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(SummaryPropertiesViewModel.prototype,"includeAllChoices",{get:function(){return this._summary.Settings.IncludeAllChoices},set:function(value){this._summary.Settings.IncludeAllChoices=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(SummaryPropertiesViewModel.prototype,"selectedPage",{get:function(){return this._selectedPage},set:function(value){this._selectedPage=value;this.checkAddRemove()},enumerable:true,configurable:true});SummaryPropertiesViewModel.prototype.add=function(){var pageGuid=this.getSelectedPage();if(this._summary.Settings.ExcludedPages==null){this._summary.Settings.ExcludedPages=[]}this._summary.Settings.ExcludedPages.push(pageGuid.value);this.loadExcludedPages();this._editor.wizChanged=true};SummaryPropertiesViewModel.prototype.remove=function(){var pageGuid=this.getSelectedExcludedPage();if(pageGuid!=null){this._summary.Settings.ExcludedPages.splice(this._summary.Settings.ExcludedPages.indexOf(pageGuid),1);this.loadExcludedPages();this.checkAddRemove();this._editor.wizChanged=true}};SummaryPropertiesViewModel.prototype.checkAddRemove=function(){var addState=false;var removeState=false;if(this.getSelectedExcludedPage()!=null){removeState=true}if(this.selectedPage!==Intelledox.Common.ConstantValues.GUID_EMPTY){var selectedPage=this.getSelectedPage();if(selectedPage!=null){addState=true;if(this._summary.Settings.ExcludedPages!=null){for(var i=0;i<this._summary.Settings.ExcludedPages.length;i++){var pageGuid=this._summary.Settings.ExcludedPages[i];if(pageGuid===this.selectedPage){addState=false;break}}}}}this.isAddEnabled=addState;this.isRemoveEnabled=removeState};SummaryPropertiesViewModel.prototype.loadPages=function(){this.availablePages=[];this.availablePages.push({name:'',value:Intelledox.Common.ConstantValues.GUID_EMPTY});for(var i=0;i<this._wizard.Pages.length;i++){if(!(this._wizard.Pages[i]instanceof Intelledox.QAWizard.Design.FragmentPage)){this.availablePages.push({name:this._wizard.Pages[i].Name,value:this._wizard.Pages[i].PageGuid})}}};SummaryPropertiesViewModel.prototype.loadExcludedPages=function(){this.existingExcludedPages=[];if(this._summary.Settings.ExcludedPages!=null){for(var i=0;i<this._summary.Settings.ExcludedPages.length;i++){for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){if(this._summary.Settings.ExcludedPages[i]===this._wizard.Pages[pageIndex].PageGuid){this.existingExcludedPages.push({tag:this._wizard.Pages[pageIndex].PageGuid,name:this._wizard.Pages[pageIndex].Name,selected:false});break}}}}};SummaryPropertiesViewModel.prototype.selectExistingExcludedPage=function(pageGuid){for(var i=0;i<this.existingExcludedPages.length;i++){if(this.existingExcludedPages[i].tag===pageGuid){this.existingExcludedPages[i].selected=true;this.selectedPage=pageGuid;this.checkAddRemove()}else{this.existingExcludedPages[i].selected=false}}};SummaryPropertiesViewModel.prototype.getSelectedExcludedPage=function(){for(var i=0;i<this.existingExcludedPages.length;i++){if(this.existingExcludedPages[i].selected){return this.existingExcludedPages[i].tag}}return null};SummaryPropertiesViewModel.prototype.getSelectedPage=function(){for(var i=0;i<this.availablePages.length;i++){if(this.availablePages[i].value===this.selectedPage){return this.availablePages[i]}}return null};return SummaryPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.SummaryPropertiesViewModel=SummaryPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var WorkflowParallelPropertiesViewModel=(function(_super){__extends(WorkflowParallelPropertiesViewModel,_super);function WorkflowParallelPropertiesViewModel(filter,scope,editorViewModel,workflow,wizard){var _this=_super.call(this)||this;_this._editorViewModel=editorViewModel;_this._workflow=workflow;_this._wizard=wizard;_this._filter=filter;_this._scope=scope;return _this}Object.defineProperty(WorkflowParallelPropertiesViewModel.prototype,"name",{get:function(){return this._workflow.Name},set:function(value){this._workflow.Name=value;this._editorViewModel.wizChanged=true;this._scope.$emit('workflowChanged')},enumerable:true,configurable:true});WorkflowParallelPropertiesViewModel.prototype.validateName=function(){if(System.String.IsNullOrWhiteSpace(this.name)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('State'),this._filter('translate')('Name')));return}if(this.name.indexOf("|")>-1){alert(this._filter('translate')('ErrorMsg_StateCannotContainBar'));return}var fullList=this._wizard.Workflow.FullSectionList();for(var i=0;i<fullList.length;i++){if(fullList[i]!==this._workflow&&Intelledox.Common.Functions.EqualsIgnoreCase(fullList[i].Name,Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.name))){alert(this._filter('translate')('ErrorMsg_DuplicateParallelSection'));return}}};return WorkflowParallelPropertiesViewModel}(Design.PropertiesViewModel));Design.WorkflowParallelPropertiesViewModel=WorkflowParallelPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var WorkflowTransitionPropertiesViewModel=(function(_super){__extends(WorkflowTransitionPropertiesViewModel,_super);function WorkflowTransitionPropertiesViewModel(filter,scope,editorViewModel,transitions,wizard,lists,$uibModal){var _this=_super.call(this)||this;_this._transitionType=TransitionType.Normal;_this._pages=null;_this.isCreationVisible=false;_this.isDisplayOptionsVisible=true;_this.isStartPageOptionVisible=true;_this.isDocumentsOptionsVisible=true;_this.isParallelExitVisible=false;_this.isSendtoVisible=true;_this.isSendToTypeEnabled=true;_this.isSpecifiedVisible=true;_this.isQuestionVisible=false;_this.isAnswerVisible=false;_this.isRestrictByVisible=false;_this.isPageTitleVisible=true;_this.isHelpTextVisible=true;_this.isShowNextStepsVisible=true;_this.isShowSendToVisible=true;_this.isShowCommentVisible=true;_this.isCommentMandatoryVisible=true;_this.isSubmitButtonTextVisible=true;_this.isSubmittingTextVisible=true;_this.isResponseSubmittedTextVisible=true;_this.isParallelVisible=false;_this.isDefaultCommentVisible=true;_this.isReassignVisible=true;_this.isSendEmailVisible=true;_this.isRecipientNameVisible=false;_this.isTemporaryTransitionAnswerVisible=false;_this.isTemporaryTransition=false;_this.isTemporaryReassignHelpVisible=false;_this.documentsText='';_this._modal=$uibModal;_this._editorViewModel=editorViewModel;_this._transitionCollection=transitions;_this._transition=transitions.transitions[0];_this._wizard=wizard;_this._filter=filter;_this._scope=scope;_this._listManager=lists;_this._transitionType=transitions.transType;_this.availableSpecified=[];_this.title=_this._filter('translate')('Transition');_this.treeView=editorViewModel.treeView;_this.loadSendToListType();_this.loadSendToList();_this.bindSpecifiedSelect();_this.loadQuestions();_this.loadAnswers();_this.isAnswerVisible=_this.enableDisableQuestionReferenceAnswer(_this.selectedQuestion);_this.displayDocumentsText();if(_this._transition.SendToType===Intelledox.QAWizard.Design.StateTransitionSendToType.Search){_this.forEachTransition(function(tran){return tran.ShowSendTo=true});_this.bindRestrictGroups()}if(_this._transition.SendToType===Intelledox.QAWizard.Design.StateTransitionSendToType.QuestionReference&&_this._transition.SendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.Temporary){_this.forEachTransition(function(tran){return _this.isTemporaryTransitionAnswerVisible=_this.enableDisableQuestionReferenceAnswer(tran.TemporaryRecipientNameQuestion)})}switch(_this._transitionType){case TransitionType.Creation:_this.isCreationVisible=true;_this.isStartPageOptionVisible=false;_this.isDisplayOptionsVisible=false;_this.isDocumentsOptionsVisible=false;_this.isPageTitleVisible=false;_this.isHelpTextVisible=false;_this.isShowNextStepsVisible=false;_this.isShowSendToVisible=false;_this.isShowCommentVisible=false;_this.isCommentMandatoryVisible=false;_this.isSendtoVisible=false;_this.isReassignVisible=false;_this.isSendEmailVisible=false;_this.isSubmitButtonTextVisible=false;_this.isSubmittingTextVisible=false;_this.isResponseSubmittedTextVisible=false;_this.loadStatesList();break;case TransitionType.Normal:if(_this._transition.PriorityExit){_this.isParallelExitVisible=true}break;case TransitionType.SingleEntry:_this.isDocumentsOptionsVisible=false;_this.isPageTitleVisible=false;_this.isHelpTextVisible=false;_this.isShowNextStepsVisible=false;_this.isShowSendToVisible=false;_this.isShowCommentVisible=false;_this.isCommentMandatoryVisible=false;_this.isSubmitButtonTextVisible=false;_this.isSubmittingTextVisible=false;_this.isResponseSubmittedTextVisible=false;_this.title=System.String.Format(_this._filter('translate')('TransitionFrom'),_this.generateStateDisplayName(_this._transitionCollection.state));_this.forEachTransition(function(tran){return tran.ShowNextSteps=false});_this.forEachTransition(function(tran){return tran.ShowSendTo=false});break;case TransitionType.SingleExit:_this.isParallelExitVisible=true;_this.isStartPageOptionVisible=false;_this.isSendtoVisible=false;_this.isReassignVisible=false;_this.isSendEmailVisible=false;_this.setSingleExitTabs();_this.title=System.String.Format(_this._filter('translate')('TransitionTo'),_this.generateStateDisplayNameByGuid(_this._transitionCollection.transitions[0].StateId));if(!_this._transition.PriorityExit){_this.forEachTransition(function(tran){return tran.ShowNextSteps=false});_this.forEachTransition(function(tran){return tran.ShowSendTo=false})}break;case TransitionType.MultipleEntry:_this.isHelpTextVisible=false;_this.isStartPageOptionVisible=false;_this.isSendtoVisible=false;_this.isReassignVisible=false;_this.isSendEmailVisible=false;_this.isShowNextStepsVisible=false;_this.isShowSendToVisible=false;_this.isShowCommentVisible=false;_this.isCommentMandatoryVisible=false;_this.isDefaultCommentVisible=false;_this.forEachTransition(function(tran){return tran.ShowNextSteps=false});_this.forEachTransition(function(tran){return tran.ShowSendTo=false});break;case TransitionType.MultipleExit:_this.isDocumentsOptionsVisible=false;_this.isPageTitleVisible=false;_this.isHelpTextVisible=false;_this.isShowNextStepsVisible=false;_this.isShowSendToVisible=false;_this.isShowCommentVisible=false;_this.isCommentMandatoryVisible=false;_this.isSubmitButtonTextVisible=false;_this.isSubmittingTextVisible=false;_this.isResponseSubmittedTextVisible=false;_this.forEachTransition(function(tran){return tran.ShowNextSteps=false});_this.forEachTransition(function(tran){return tran.ShowSendTo=false});break}if(_this.toState()instanceof Intelledox.QAWizard.Design.FinishWorkflowState){_this.isDisplayOptionsVisible=false;_this.isStartPageOptionVisible=false;_this.isDocumentsOptionsVisible=false;_this.isSendtoVisible=false;_this.isReassignVisible=false;_this.isSendEmailVisible=false}_this.updateSendToType();_this.updateSendToEnabled();return _this}Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"selectedSendTo",{get:function(){return this._transition.SendTo},set:function(value){this.forEachTransition(function(tran){return tran.SendTo=value});this._editorViewModel.wizChanged=true;this.availableSpecified=[];this.updateSendToEnabled();if(value===Intelledox.QAWizard.Design.StateTransitionSendTo.Temporary){this.isTemporaryTransition=true}else{this.isTemporaryTransition=false}this.updateTempUserReassignHelpTextVisible();this.loadSendToListType();this.selectedSendToType=this.availableSendToTypes[0].value;this.updateSendToType()},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"selectedSendToType",{get:function(){return this._transition.SendToType},set:function(value){this.forEachTransition(function(tran){return tran.SendToType=value});this._editorViewModel.wizChanged=true;if(value===Intelledox.QAWizard.Design.StateTransitionSendToType.Search){this.forEachTransition(function(tran){return tran.ShowSendTo=true})}this.updateSendToType()},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"selectedSpecified",{get:function(){if(this._transition.SendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.User){return this._transition.SendToUser}else{return this._transition.SendToGroup}},set:function(value){var currentSpecified=this.getSpecified(value);this.forEachTransition(function(tran){return tran.SendToName=currentSpecified.name});if(this._transition.SendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.User){this.forEachTransition(function(tran){return tran.SendToUser=value});this.forEachTransition(function(tran){return tran.SendToGroup=Intelledox.Common.ConstantValues.GUID_EMPTY})}else{this.forEachTransition(function(tran){return tran.SendToGroup=value});this.forEachTransition(function(tran){return tran.SendToUser=Intelledox.Common.ConstantValues.GUID_EMPTY})}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"selectedRestrictGroup",{get:function(){return this._transition.SendToRestrictGroup},set:function(value){this.forEachTransition(function(tran){return tran.SendToRestrictGroup=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"selectedQuestion",{get:function(){return this._transition.QuestionGuid},set:function(value){this.forEachTransition(function(tran){return tran.QuestionGuid=value});this._editorViewModel.wizChanged=true;this.loadAnswers();this.isAnswerVisible=this.enableDisableQuestionReferenceAnswer(value)},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"selectedAnswer",{get:function(){return this._transition.AnswerGuid},set:function(value){this.forEachTransition(function(tran){return tran.AnswerGuid=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"startPageGuid",{get:function(){return this._transition.StartPageGuid},set:function(value){this.forEachTransition(function(tran){return tran.StartPageGuid=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"pages",{get:function(){if(this._pages===null){var wiz=this._editorViewModel.wizard;this._pages=[];for(var i=0;i<wiz.Pages.length;i++){if(!(wiz.Pages[i]instanceof Intelledox.QAWizard.Design.FragmentPage)){if(!wiz.Pages[i].VisibleConditions||wiz.Pages[i].VisibleConditions.PageVisible(this._transition.StateId)){this._pages.push({name:wiz.Pages[i].Name,value:wiz.Pages[i].PageGuid})}}}}return this._pages},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"isRestrictByListVisible",{get:function(){return(this.restrictBy&&this.isRestrictByVisible)},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"restrictBy",{get:function(){return this._transition.SendToRestrictSearch},set:function(value){this.forEachTransition(function(tran){return tran.SendToRestrictSearch=value});this._editorViewModel.wizChanged=true;this.bindRestrictGroups()},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"pageTitle",{get:function(){return this._transition.PageTitle},set:function(value){this.forEachTransition(function(tran){return tran.PageTitle=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"helpText",{get:function(){return this._transition.HelpText},set:function(value){this.forEachTransition(function(tran){return tran.HelpText=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"showNextSteps",{get:function(){return this._transition.ShowNextSteps},set:function(value){this.forEachTransition(function(tran){return tran.ShowNextSteps=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"showSendTo",{get:function(){return this._transition.ShowSendTo},set:function(value){this.forEachTransition(function(tran){return tran.ShowSendTo=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"showComment",{get:function(){return this._transition.ShowComment},set:function(value){this.forEachTransition(function(tran){return tran.ShowComment=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"commentMandatory",{get:function(){return this._transition.CommentMandatory},set:function(value){this.forEachTransition(function(tran){return tran.CommentMandatory=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"defaultComment",{get:function(){return this._transition.DefaultComment},set:function(value){this.forEachTransition(function(tran){return tran.DefaultComment=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"submitButtonText",{get:function(){return this._transition.SubmitButtonText},set:function(value){this.forEachTransition(function(tran){return tran.SubmitButtonText=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"submittingText",{get:function(){return this._transition.SubmittingText},set:function(value){this.forEachTransition(function(tran){return tran.SubmittingText=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"responsesSubmittedText",{get:function(){return this._transition.ResponsesSubmittedText},set:function(value){this.forEachTransition(function(tran){return tran.ResponsesSubmittedText=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"offlineRedirectSubmittedText",{get:function(){return this._transition.OfflineRedirectMessage},set:function(value){this.forEachTransition(function(tran){return tran.OfflineRedirectMessage=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"showRedirectOptions",{get:function(){return this._transition.RedirectToHome},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"redirectToHome",{get:function(){return this._transition.RedirectToHome},set:function(value){this.forEachTransition(function(tran){return tran.RedirectToHome=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"waitForProject",{get:function(){return this._transition.WaitForProject},set:function(value){this.forEachTransition(function(tran){return tran.WaitForProject=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"allowReassign",{get:function(){return this._transition.AllowReassign},set:function(value){this.forEachTransition(function(tran){return tran.AllowReassign=value});this.updateTempUserReassignHelpTextVisible();this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"sendEmail",{get:function(){return this._transition.SendEmail},set:function(value){this.forEachTransition(function(tran){return tran.SendEmail=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"emailSubject",{get:function(){return this._transition.EmailSubject},set:function(value){this.forEachTransition(function(tran){return tran.EmailSubject=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"emailBody",{get:function(){return this._transition.EmailText},set:function(value){this.forEachTransition(function(tran){return tran.EmailText=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"name",{get:function(){return this._transition.Name},set:function(value){this.forEachTransition(function(tran){return tran.Name=value});this._editorViewModel.wizChanged=true;this._scope.$emit('workflowChanged')},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"temporaryRecipientNameQuestion",{get:function(){return this._transition.TemporaryRecipientNameQuestion},set:function(value){this.forEachTransition(function(tran){return tran.TemporaryRecipientNameQuestion=value});this._editorViewModel.wizChanged=true;this.loadAnswers();this.isTemporaryTransitionAnswerVisible=this.enableDisableQuestionReferenceAnswer(value)},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"temporaryRecipientNameAnswer",{get:function(){return this._transition.TemporaryRecipientNameAnswer},set:function(value){this.forEachTransition(function(tran){return tran.TemporaryRecipientNameAnswer=value});this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"isPriorityExit",{get:function(){return this._transition.PriorityExit},set:function(value){this.forEachTransition(function(tran){return tran.PriorityExit=value});this._editorViewModel.wizChanged=true;this._scope.$emit('workflowChanged');if(value){this._scope.$emit('workflowSelectTransition',this._transition)}else{this._scope.$emit('workflowSelectAndInitTransition',this._transition,true)}},enumerable:true,configurable:true});Object.defineProperty(WorkflowTransitionPropertiesViewModel.prototype,"priorityInstructionText",{get:function(){if(this._transition.PriorityExit){return this._filter('translate')('PriorityExitInstructions')}else{return this._filter('translate')('NonPriorityExitInstructions')}},enumerable:true,configurable:true});WorkflowTransitionPropertiesViewModel.prototype.selectTransitionDocuments=function(){var vm=this;vm.availableDocuments=[];var modalConfirm=this._modal.open({templateUrl:'Views/Modal/manageDocuments.html?v=106882799234227327',controller:['$scope','$modalInstance','$filter','editor','wizard','allDocuments','selectedDocuments',Design.SelectDocumentsModalCtrl],backdrop:'static',resolve:{editor:function(){return vm._editorViewModel},wizard:function(){return vm._wizard},allDocuments:function(){return vm._editorViewModel.findDownloadableDocuments(vm.availableDocuments)},selectedDocuments:function(){return vm._transition.DownloadableDocuments}}});modalConfirm.result.then(function(newList){vm._transition.DownloadableDocuments=newList;if(vm._transitionType===TransitionType.MultipleEntry){vm.forEachTransition(function(tran){return tran.DownloadableDocuments=newList})}vm.displayDocumentsText();vm._editorViewModel.wizChanged=true})};WorkflowTransitionPropertiesViewModel.prototype.validateName=function(){if(System.String.IsNullOrWhiteSpace(this.pageTitle)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('PageTitle'),''))}};WorkflowTransitionPropertiesViewModel.prototype.validateOnlineRedirectMessage=function(id){if(System.String.IsNullOrEmpty(this.responsesSubmittedText)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('ResponsesSubmittedMessage'),''));this.responsesSubmittedText=this._editorViewModel.wizard.DefaultOnlineRedirectMessage;this._scope.setFocus(id)}};WorkflowTransitionPropertiesViewModel.prototype.validateOfflineRedirectMessage=function(id){var allowRedirect=this.redirectToHome;if(allowRedirect&&System.String.IsNullOrEmpty(this.offlineRedirectSubmittedText)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('OfflineRedirectMessage'),''));this.offlineRedirectSubmittedText=this._editorViewModel.wizard.DefaultOfflineRedirectMessage;this._scope.setFocus(id)}};WorkflowTransitionPropertiesViewModel.prototype.create=function(){this._transition.StateId=this.selectedState;this._transitionCollection.state.Transitions.push(this._transition);this._scope.$emit('workflowChanged');this._scope.$emit('workflowSelectAndInitTransition',this._transition,false)};WorkflowTransitionPropertiesViewModel.prototype.loadStatesList=function(){this.availableStates=[];var validTransistions=this.getValidNewTransitionStates(this._transitionCollection.state);for(var i=0;i<validTransistions.length;i++){var state=validTransistions[i];var optionName=this.generateStateDisplayName(state);this.availableStates.push({name:optionName,value:state.Id})}if(this.availableStates.length>0){this.selectedState=this.availableStates[0].value}else{this.selectedState=Intelledox.Common.ConstantValues.GUID_EMPTY}};WorkflowTransitionPropertiesViewModel.prototype.loadSendToList=function(){this.availableSendTos=[];if(!(this.parentState()instanceof Intelledox.QAWizard.Design.StartWorkflowState)){this.availableSendTos.push({name:this._filter('translate')('Creator'),value:Intelledox.QAWizard.Design.StateTransitionSendTo.Creator});this.availableSendTos.push({name:this._filter('translate')('Previous'),value:Intelledox.QAWizard.Design.StateTransitionSendTo.Previous})}this.availableSendTos.push({name:this._filter('translate')('CurrentUser'),value:Intelledox.QAWizard.Design.StateTransitionSendTo.CurrentUser});this.availableSendTos.push({name:this._filter('translate')('UserString'),value:Intelledox.QAWizard.Design.StateTransitionSendTo.User});this.availableSendTos.push({name:this._filter('translate')('Group'),value:Intelledox.QAWizard.Design.StateTransitionSendTo.Group});this.availableSendTos.push({name:this._filter('translate')('TemporaryUser'),value:Intelledox.QAWizard.Design.StateTransitionSendTo.Temporary})};WorkflowTransitionPropertiesViewModel.prototype.loadSendToListType=function(){this.availableSendToTypes=[];if(this.selectedSendTo!==Intelledox.QAWizard.Design.StateTransitionSendTo.Temporary){this.availableSendToTypes.push({name:this._filter('translate')('Specified'),value:Intelledox.QAWizard.Design.StateTransitionSendToType.Specified});var fullList=this._wizard.Workflow.FullStateList;for(var i=0;i<fullList.length;i++){if(fullList[i].Id===this._transition.StateId){if(fullList[i].ParallelSectionGuid===this.parentState().ParallelSectionGuid){this.availableSendToTypes.push({name:this._filter('translate')('Search'),value:Intelledox.QAWizard.Design.StateTransitionSendToType.Search})}break}}}this.availableSendToTypes.push({name:this._filter('translate')('QuestionReference'),value:Intelledox.QAWizard.Design.StateTransitionSendToType.QuestionReference})};WorkflowTransitionPropertiesViewModel.prototype.forEachTransition=function(callbackfn){for(var i=0;i<this._transitionCollection.transitions.length;i++){callbackfn(this._transitionCollection.transitions[i])}};WorkflowTransitionPropertiesViewModel.prototype.parentState=function(){var fullList=this._wizard.Workflow.FullStateList;for(var i=0;i<fullList.length;i++){for(var tranIndex=0;tranIndex<fullList[i].Transitions.length;tranIndex++){if(fullList[i].Transitions[tranIndex]===this._transition){return fullList[i]}}}return null};WorkflowTransitionPropertiesViewModel.prototype.bindSpecifiedSelect=function(){if(this._transition.SendToType===Intelledox.QAWizard.Design.StateTransitionSendToType.Specified){if(this.selectedSendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.User){this.bindUsers()}else if(this.selectedSendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.Group){this.bindGroups()}}};WorkflowTransitionPropertiesViewModel.prototype.bindUsers=function(){if(this.availableSpecified==null||this.availableSpecified.length===0){var vm=this;this.availableSpecified=[];var blankUser=new Intelledox.Model.SearchResults;blankUser.name="";this.availableSpecified.push(blankUser);this._listManager.users().then(function(users){for(var i=0;i<users.length;i++){vm.availableSpecified.push(users[i])}})}};WorkflowTransitionPropertiesViewModel.prototype.bindGroups=function(){if(this.availableSpecified==null||this.availableSpecified.length===0){var vm=this;this.availableSpecified=[];var blankGroup=new Intelledox.Model.SearchResults;blankGroup.name="";this.availableSpecified.push(blankGroup);this._listManager.groups().then(function(groups){for(var i=0;i<groups.length;i++){vm.availableSpecified.push(groups[i])}})}};WorkflowTransitionPropertiesViewModel.prototype.bindRestrictGroups=function(){if(this.availableRestrictGroups==null||this.availableRestrictGroups.length===0){var vm=this;this.availableRestrictGroups=[];this._listManager.groups().then(function(groups){var blankGroup=new Intelledox.Model.SearchResults;blankGroup.name="";vm.availableRestrictGroups.push(blankGroup);for(var i=0;i<groups.length;i++){vm.availableRestrictGroups.push(groups[i])}})}};WorkflowTransitionPropertiesViewModel.prototype.getSpecified=function(id){for(var i=0;i<this.availableSpecified.length;i++){if(this.availableSpecified[i].id===id){return this.availableSpecified[i]}}return null};WorkflowTransitionPropertiesViewModel.prototype.loadQuestions=function(){this.availableQuestions=[];this.availableAnswers=[];this.availableQuestions.push(new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.availableAnswers.push(new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));var questions=this._wizard.GetNonRepeatedQuestions(Intelledox.Common.ConstantValues.GUID_EMPTY);for(var i=0;i<questions.length;i++){var q=questions[i];if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&(q.SelectionType===Intelledox.Model.SelectionType.Single))){this.availableQuestions.push(q)}}};WorkflowTransitionPropertiesViewModel.prototype.loadAnswers=function(){this.availableAnswers=[];this.availableAnswers.push(new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));if(this.selectedQuestion!==Intelledox.Common.ConstantValues.GUID_EMPTY){var question=this.getQuestion(this.selectedQuestion);if(question!=null){for(var i=0;i<question.Answers.length;i++){this.availableAnswers.push(question.Answers[i])}}}};WorkflowTransitionPropertiesViewModel.prototype.getQuestion=function(id){for(var i=0;i<this.availableQuestions.length;i++){if(this.availableQuestions[i].QuestionGuid===id){return this.availableQuestions[i]}}return null};WorkflowTransitionPropertiesViewModel.prototype.isAnswerRequired=function(questionType){switch(questionType){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label:return false;default:return true}};WorkflowTransitionPropertiesViewModel.prototype.enableDisableQuestionReferenceAnswer=function(questionId){if(questionId===Intelledox.Common.ConstantValues.GUID_EMPTY){return false}var q=this.getQuestion(questionId);if(q!=null){if(this.isAnswerRequired(q.QuestionTypeID)){return true}else{return false}}else{return false}};WorkflowTransitionPropertiesViewModel.prototype.enableQuestionReference=function(){this.loadAnswers();this.isQuestionVisible=true;this.isAnswerVisible=this.enableDisableQuestionReferenceAnswer(this.selectedQuestion);this.disableSpecify()};WorkflowTransitionPropertiesViewModel.prototype.disableQuestionReference=function(){this.selectedQuestion=Intelledox.Common.ConstantValues.GUID_EMPTY;this.availableAnswers=[];this.isQuestionVisible=false;this.isAnswerVisible=false;this.forEachTransition(function(tran){return tran.QuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY});this.forEachTransition(function(tran){return tran.AnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY})};WorkflowTransitionPropertiesViewModel.prototype.enableSpecify=function(){this.isSpecifiedVisible=true;this.bindSpecifiedSelect()};WorkflowTransitionPropertiesViewModel.prototype.disableSpecify=function(){this.isSpecifiedVisible=false};WorkflowTransitionPropertiesViewModel.prototype.updateSendToType=function(){if(this.selectedSendToType===Intelledox.QAWizard.Design.StateTransitionSendToType.Specified){this.enableSpecify()}else{this.disableSpecify()}if(this.selectedSendToType===Intelledox.QAWizard.Design.StateTransitionSendToType.QuestionReference){this.enableQuestionReference()}else{this.disableQuestionReference()}if(this.selectedSendToType===Intelledox.QAWizard.Design.StateTransitionSendToType.Search){this.isShowSendToVisible=false}else if(this._transitionType===TransitionType.Normal){this.isShowSendToVisible=true}this.updateSendToEnabled()};WorkflowTransitionPropertiesViewModel.prototype.updateSendToEnabled=function(){if(this.selectedSendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.User&&this.selectedSendToType===Intelledox.QAWizard.Design.StateTransitionSendToType.Search){this.isRestrictByVisible=true}else{this.isRestrictByVisible=false}if((this._transitionType===TransitionType.Normal||this._transitionType===TransitionType.SingleEntry||this._transitionType===TransitionType.MultipleExit)&&this.selectedSendTo!==Intelledox.QAWizard.Design.StateTransitionSendTo.Group&&(this.toState()instanceof Intelledox.QAWizard.Design.FinishWorkflowState===false)){this.isReassignVisible=true}else{this.isReassignVisible=false}if(this.toState()instanceof Intelledox.QAWizard.Design.FinishWorkflowState||this._transitionType===TransitionType.MultipleEntry||this._transitionType===TransitionType.SingleExit){this.disableSpecify()}else if(this.selectedSendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.Creator||this.selectedSendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.Previous||this.selectedSendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.CurrentUser){this.forEachTransition(function(tran){return tran.SendToType=Intelledox.QAWizard.Design.StateTransitionSendToType.Specified});this.isSendToTypeEnabled=false;this.disableSpecify()}else if(this.selectedSendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.Temporary){this.forEachTransition(function(tran){return tran.SendToType=Intelledox.QAWizard.Design.StateTransitionSendToType.QuestionReference});this.isSendToTypeEnabled=false;this.disableSpecify();this.isTemporaryTransition=true;this.updateTempUserReassignHelpTextVisible()}else{this.isSendToTypeEnabled=true;if(this.selectedSendToType===Intelledox.QAWizard.Design.StateTransitionSendToType.Specified){this.enableSpecify()}}};WorkflowTransitionPropertiesViewModel.prototype.updateTempUserReassignHelpTextVisible=function(){if(this.selectedSendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.Temporary&&this._transition.AllowReassign){this.isTemporaryReassignHelpVisible=true}else{this.isTemporaryReassignHelpVisible=false}};WorkflowTransitionPropertiesViewModel.prototype.toState=function(){var fullList=this._wizard.Workflow.FullStateList;for(var i=0;i<fullList.length;i++){if(fullList[i].Id===this._transition.StateId){return fullList[i]}}return null};WorkflowTransitionPropertiesViewModel.prototype.setSingleExitTabs=function(){if(this._transition.PriorityExit){}else{this.isParallelVisible=true;this.isShowNextStepsVisible=false;this.isShowSendToVisible=false;this.isShowCommentVisible=false;this.isCommentMandatoryVisible=false;this.isDefaultCommentVisible=false}};WorkflowTransitionPropertiesViewModel.prototype.getValidNewTransitionStates=function(parentState){var excludeStates=[];var result=[];if(parentState.Transitions!=null){for(var i=0;i<parentState.Transitions.length;i++){excludeStates.push(parentState.Transitions[i].StateId)}}excludeStates.push(parentState.Id);var validTransitions=this._wizard.Workflow.ValidTransitions(parentState);validTransitions.sort(function(a,b){if(a.Name<b.Name){return-1}if(a.Name>b.Name){return 1}return 0});for(var i=0;i<validTransitions.length;i++){if(excludeStates.indexOf(validTransitions[i].Id)===-1){result.push(validTransitions[i])}}return result};WorkflowTransitionPropertiesViewModel.prototype.generateStateDisplayName=function(state){if(state instanceof Intelledox.QAWizard.Design.StartWorkflowState&&state.Name.indexOf(this._filter('translate')('StartState'))===-1){return System.String.Format(this._filter('translate')('NamePlusStart'),Design.TranslationHelper.KeywordValueToTranslation(this._filter,state.Name),this._filter('translate')('StartState'))}else{return Design.TranslationHelper.KeywordValueToTranslation(this._filter,state.Name)}};WorkflowTransitionPropertiesViewModel.prototype.generateStateDisplayNameByGuid=function(id){var validTransitions=this._wizard.Workflow.ValidTransitions(this._transitionCollection.state);for(var i=0;i<validTransitions.length;i++){if(validTransitions[i].Id==id){return validTransitions[i].Name}}return""};WorkflowTransitionPropertiesViewModel.prototype.pickRef=function(){var _this=this;this.treeView.pickEvent=function(node){_this.onPickRef(node)};this.treeView.togglePickMode()};WorkflowTransitionPropertiesViewModel.prototype.onPickRef=function(node){if(node.tag instanceof Intelledox.QAWizard.Design.Question){this.setReferenceQuestion(node.tag)}else if(node.tag instanceof Intelledox.QAWizard.Design.Answer){if(this.isAnswerRequired(node.parent.tag.QuestionTypeID)){this.setReferenceQuestionAnswer(node.parent.tag,node.tag)}else{this.setReferenceQuestion(node.parent.tag)}}};WorkflowTransitionPropertiesViewModel.prototype.pickEmailSubjectRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this.treeView.pickEvent=function(node){_this.emailSubject=Design.HelperFunctions.onPickRef(_this._filter,_this.emailSubject,node,insertPoint)};this.treeView.togglePickMode()};WorkflowTransitionPropertiesViewModel.prototype.pickEmailBodyRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this.treeView.pickEvent=function(node){_this.emailBody=Design.HelperFunctions.onPickRef(_this._filter,_this.emailBody,node,insertPoint)};this.treeView.togglePickMode()};WorkflowTransitionPropertiesViewModel.prototype.pickDefaultCommentRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this.treeView.pickEvent=function(node){_this.defaultComment=Design.HelperFunctions.onPickRef(_this._filter,_this.defaultComment,node,insertPoint)};this.treeView.togglePickMode()};WorkflowTransitionPropertiesViewModel.prototype.setReferenceQuestion=function(refQuestion){this.selectedQuestion=refQuestion.QuestionGuid};WorkflowTransitionPropertiesViewModel.prototype.setReferenceQuestionAnswer=function(refQuestion,refAnswer){this.selectedQuestion=refQuestion.QuestionGuid;this.selectedAnswer=refAnswer.AnswerGuid};WorkflowTransitionPropertiesViewModel.prototype.displayDocumentsText=function(){var docCount=0;if(!System.String.IsNullOrEmpty(this._transition.DownloadableDocuments)){docCount=this._transition.DownloadableDocuments.split(',').length}this.documentsText=System.String.Format(this._filter('translate')('NoOfDocsSelected'),docCount)};return WorkflowTransitionPropertiesViewModel}(Design.PropertiesViewModel));Design.WorkflowTransitionPropertiesViewModel=WorkflowTransitionPropertiesViewModel;var TransitionType;(function(TransitionType){TransitionType[TransitionType["Creation"]=-1]="Creation";TransitionType[TransitionType["Normal"]=0]="Normal";TransitionType[TransitionType["SingleEntry"]=1]="SingleEntry";TransitionType[TransitionType["MultipleEntry"]=2]="MultipleEntry";TransitionType[TransitionType["SingleExit"]=3]="SingleExit";TransitionType[TransitionType["MultipleExit"]=4]="MultipleExit"})(TransitionType=Design.TransitionType||(Design.TransitionType={}))})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var WorkflowStatePropertiesViewModel=(function(_super){__extends(WorkflowStatePropertiesViewModel,_super);function WorkflowStatePropertiesViewModel(filter,scope,editorViewModel,state,wizard){var _this=_super.call(this)||this;_this.isAnswerVisible=false;_this.availableQuestions=[];_this.availableAnswers=[];_this._filter=filter;_this._scope=scope;_this._editorViewModel=editorViewModel;_this._state=state;_this._wizard=wizard;_this.loadQuestions();_this.loadAnswers();_this.enableDisableQuestionReferenceAnswer();return _this}Object.defineProperty(WorkflowStatePropertiesViewModel.prototype,"name",{get:function(){return this._state.Name},set:function(value){this._state.Name=value;this._editorViewModel.wizChanged=true;this._scope.$emit('workflowChanged')},enumerable:true,configurable:true});Object.defineProperty(WorkflowStatePropertiesViewModel.prototype,"allowCancellation",{get:function(){return this._state.AllowCancellation},set:function(value){this._state.AllowCancellation=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowStatePropertiesViewModel.prototype,"dueDateType",{get:function(){return this._state.DueType},set:function(value){this._state.DueType=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowStatePropertiesViewModel.prototype,"dueDaysAfter",{get:function(){if(this._state.DueAfter===0){return''}return this._state.DueAfter.toString()},set:function(value){this._state.DueAfter=parseInt(value,10);if(isNaN(this._state.DueAfter)){this._state.DueAfter=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowStatePropertiesViewModel.prototype,"workingDaysOnly",{get:function(){return this._state.WorkingDays},set:function(value){this._state.WorkingDays=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(WorkflowStatePropertiesViewModel.prototype,"selectedQuestionGuid",{get:function(){return this._state.DueDateQuestionReference},set:function(value){this._state.DueDateQuestionReference=value;this._state.DueDateAnswerReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this._editorViewModel.wizChanged=true;this.loadAnswers();this.enableDisableQuestionReferenceAnswer()},enumerable:true,configurable:true});Object.defineProperty(WorkflowStatePropertiesViewModel.prototype,"selectedAnswerGuid",{get:function(){return this._state.DueDateAnswerReference},set:function(value){this._state.DueDateAnswerReference=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});WorkflowStatePropertiesViewModel.prototype.validateName=function(){if(System.String.IsNullOrWhiteSpace(this.name)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('State'),this._filter('translate')('Name')));return}if(this.name.indexOf("|")>-1){alert(this._filter('translate')('ErrorMsg_StateCannotContainBar'));return}var fullList=this._wizard.Workflow.FullStateList;for(var i=0;i<fullList.length;i++){if(fullList[i]!==this._state&&Intelledox.Common.Functions.EqualsIgnoreCase(fullList[i].Name,Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.name))){alert(this._filter('translate')('ErrorMsg_DuplicateState'));return}}};WorkflowStatePropertiesViewModel.prototype.loadQuestions=function(){this.availableQuestions=[];this.availableAnswers=[];this.availableQuestions.push(new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.availableAnswers.push(new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));var questionList=this._wizard.GetNonRepeatedQuestions(Intelledox.Common.ConstantValues.GUID_EMPTY);for(var i=0;i<questionList.length;i++){var q=questionList[i];if((q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic&&(q.DisplayType===Intelledox.Model.QuestionDisplayType.MultiChoice||q.DisplayType===Intelledox.Model.QuestionDisplayType.MultiChoiceToggleButton||q.DisplayType===Intelledox.Model.QuestionDisplayType.Dropdown))||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&(q.SelectionType===Intelledox.Model.SelectionType.Single))){this.availableQuestions.push(q)}}};WorkflowStatePropertiesViewModel.prototype.loadAnswers=function(){this.availableAnswers=[];if(this.selectedQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var question=this.getSelectedQuestion();if(question!=null){for(var i=0;i<question.Answers.length;i++){this.availableAnswers.push(question.Answers[i])}}}};WorkflowStatePropertiesViewModel.prototype.enableDisableQuestionReferenceAnswer=function(){var q=this.getSelectedQuestion();if(q!=null&&q.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(this.isAnswerRequired(q.QuestionTypeID)){this.isAnswerVisible=true}else{this.isAnswerVisible=false}}else{this.isAnswerVisible=false}};WorkflowStatePropertiesViewModel.prototype.getSelectedQuestion=function(){for(var i=0;i<this.availableQuestions.length;i++){if(this.selectedQuestionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};WorkflowStatePropertiesViewModel.prototype.isAnswerRequired=function(questionType){switch(questionType){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label:return false;default:return true}};return WorkflowStatePropertiesViewModel}(Design.PropertiesViewModel));Design.WorkflowStatePropertiesViewModel=WorkflowStatePropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var LanguageTranslationsModalCtrl=(function(){function LanguageTranslationsModalCtrl(rootScope,editorViewModel,filter,listManager){this._rootScope=rootScope;this._editorViewModel=editorViewModel;this._filter=filter;this._listManager=listManager;this.bindTranslationSummary()}LanguageTranslationsModalCtrl.prototype.exportLanguageTranslationsFile=function(){var exportHelper=new Design.LanguageTranslationExportHelper(this._listManager.qservice,this._filter,this._listManager,this._editorViewModel);exportHelper.runWorker()};LanguageTranslationsModalCtrl.prototype.importLanguageTranslationsFile=function(){if(this.uploadedLanguageTranslationsFile==null||this.uploadedLanguageTranslationsFile.name==null){return}var vm=this;var reader=new FileReader;reader.onloadend=function(){vm._editorViewModel.wizChanged=true;vm.readLanguageTranslationCSV(reader.result);vm.bindTranslationSummary();vm._rootScope.$apply()};reader.readAsText(this.uploadedLanguageTranslationsFile)};LanguageTranslationsModalCtrl.prototype.hasLanguageTranslations=function(){return this._editorViewModel.wizard.LanguageTranslations.length>0};LanguageTranslationsModalCtrl.prototype.bindTranslationSummary=function(){var summary=[];for(var i=0;i<this._editorViewModel.wizard.LanguageTranslations.length;i++){var languageTranslation=this._editorViewModel.wizard.LanguageTranslations[i];var summaryIndex=summary.map(function(x){return x.lang}).indexOf(languageTranslation.lang);if(summaryIndex===-1){var languageSummary={lang:languageTranslation.lang,count:Object.keys(languageTranslation.translations).length};summary.push(languageSummary)}else{summary[summaryIndex].count+=Object.keys(languageTranslation.translations).length}}this.languageTranslationSummary=summary};LanguageTranslationsModalCtrl.prototype.buildConfig=function(){return{delimiter:',',header:false,dynamicTyping:false,skipEmptyLines:true,preview:0,step:false,worker:false}};LanguageTranslationsModalCtrl.prototype.readLanguageTranslationCSV=function(csvFile){this._editorViewModel.wizard.LanguageTranslations=new Array;var translations=Papa.parse(csvFile,this.buildConfig());if(translations.data.length>1){var header=translations.data[0];for(var langIndex=5;langIndex<header.length;langIndex++){var translationIndex=1;while(translationIndex<translations.data.length){var languageTranslation={controlGuid:Intelledox.Common.ConstantValues.GUID_EMPTY,parentGuid:Intelledox.Common.ConstantValues.GUID_EMPTY,lang:header[langIndex],description:translations.data[translationIndex][1],translations:{}};var values=translations.data[translationIndex][0].split("|");if(values.length===1){languageTranslation.controlGuid=values[0];languageTranslation.parentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}else{languageTranslation.controlGuid=values[0];languageTranslation.parentGuid=values[1]}while((values.length===1&&translations.data[translationIndex][0]==languageTranslation.controlGuid)||(values.length===2&&translations.data[translationIndex][0]==languageTranslation.controlGuid+"|"+languageTranslation.parentGuid)){if(translations.data[translationIndex][langIndex]!=""){languageTranslation.translations[translations.data[translationIndex][3]]=translations.data[translationIndex][langIndex]}translationIndex++;if(translationIndex===translations.data.length){break}}if(Object.keys(languageTranslation.translations).length>0&&languageTranslation.lang&&this._editorViewModel.wizard.LanguageTranslations.filter(function(t){return t.controlGuid===languageTranslation.controlGuid&&t.parentGuid===languageTranslation.parentGuid&&t.description===languageTranslation.description&&t.lang===languageTranslation.lang}).length===0){this._editorViewModel.wizard.LanguageTranslations.push(languageTranslation)}}}}};return LanguageTranslationsModalCtrl}());Design.LanguageTranslationsModalCtrl=LanguageTranslationsModalCtrl})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var StateTransition=(function(){function StateTransition(){this.StateId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.SendTo=Design.StateTransitionSendTo.Creator;this.SendToType=Design.StateTransitionSendToType.Specified;this.QuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.AnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.StartPageGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.SendToUser=Intelledox.Common.ConstantValues.GUID_EMPTY;this.SendToGroup=Intelledox.Common.ConstantValues.GUID_EMPTY;this.SendToRestrictSearch=false;this.SendToRestrictGroup=Intelledox.Common.ConstantValues.GUID_EMPTY;this.AllowReassign=false;this.SendEmail=true;this.ShowNextSteps=true;this.ShowSendTo=true;this.ShowComment=true;this.CommentMandatory=false;this.RedirectToHome=false;this.WaitForProject=true;this.PriorityExit=false;this.TemporaryRecipientNameQuestion=Intelledox.Common.ConstantValues.GUID_EMPTY;this.TemporaryRecipientNameAnswer=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Actions=[];this.PageTitle=Design.Resources.Strings.DefaultFinishTitle;this.SubmitButtonText=Design.Resources.Strings.FormDefaultGenerateButtonText;this.SubmittingText=Design.Resources.Strings.CurrentlySubmittingDefault;this.ResponsesSubmittedText=Design.Resources.Strings.WorkflowStepCompleteDefault;this.OfflineRedirectMessage=Design.Resources.Strings.FormQueueMessage;this.Properties=[]}Object.defineProperty(StateTransition.prototype,"EmailText",{get:function(){if(this.m_EmailText==null){this.m_EmailText=StateTransition.TranslationToEmailString(Design.Resources.Strings.DefaultWorkflowTransitionEmail)}return this.m_EmailText},set:function(value){this.m_EmailText=value},enumerable:true,configurable:true});Object.defineProperty(StateTransition.prototype,"EmailSubject",{get:function(){if(this.m_EmailSubject==null){this.m_EmailSubject=StateTransition.TranslationToEmailString(Design.Resources.Strings.DefaultWorkflowTransitionEmailSubject)}return this.m_EmailSubject},set:function(value){this.m_EmailSubject=value},enumerable:true,configurable:true});StateTransition.TranslationToEmailString=function(translation){var result=translation;result=result.replace(new RegExp("("+this.Escape("["+Design.Resources.Strings.ProjectLink+"]")+")"),"["+Intelledox.Common.ConstantValues.PROJECTLINK+"]");result=result.replace(new RegExp("("+this.Escape("["+Design.Resources.Strings.Comments+"]")+")"),"["+Intelledox.Common.ConstantValues.COMMENTS+"]");result=result.replace(new RegExp("("+this.Escape("["+Design.Resources.Strings.ProjectName+"]")+")"),"["+Intelledox.Common.ConstantValues.PROJECTNAME+"]");result=result.replace(new RegExp("("+this.Escape("["+Design.Resources.Strings.StateName+"]")+")"),"["+Intelledox.Common.ConstantValues.STATENAME+"]");result=result.replace(new RegExp("("+this.Escape("["+Design.Resources.Strings.AssigneeFullName+"]")+")"),"["+Intelledox.Common.ConstantValues.ASSIGNEEFULLNAME+"]");result=result.replace(new RegExp("("+this.Escape("["+Design.Resources.Strings.WorkflowId+"]")+")"),"["+Intelledox.Common.ConstantValues.WORKFLOW_ID+"]");return result};StateTransition.EmailStringToTranslation=function(emailString){var result=emailString;result=result.replace("["+Intelledox.Common.ConstantValues.PROJECTLINK+"]","["+Design.Resources.Strings.ProjectLink+"]");result=result.replace("["+Intelledox.Common.ConstantValues.COMMENTS+"]","["+Design.Resources.Strings.Comments+"]");result=result.replace("["+Intelledox.Common.ConstantValues.PROJECTNAME+"]","["+Design.Resources.Strings.ProjectName+"]");result=result.replace("["+Intelledox.Common.ConstantValues.STATENAME+"]","["+Design.Resources.Strings.StateName+"]");result=result.replace("["+Intelledox.Common.ConstantValues.ASSIGNEEFULLNAME+"]","["+Design.Resources.Strings.AssigneeFullName+"]");result=result.replace("["+Intelledox.Common.ConstantValues.WORKFLOW_ID+"]","["+Design.Resources.Strings.WorkflowId+"]");return result};StateTransition.Escape=function(str){var specials=/[.*+?|()\[\]{}\\$^]/g;return str.replace(specials,"\\$&")};return StateTransition}());Design.StateTransition=StateTransition})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var WorkflowTransitionCollection=(function(){function WorkflowTransitionCollection(){this.transitions=[];this.transType=Design.TransitionType.Normal}return WorkflowTransitionCollection}());Design.WorkflowTransitionCollection=WorkflowTransitionCollection})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var WorkflowPage=(function(_super){__extends(WorkflowPage,_super);function WorkflowPage(filter,wizard,lists,pageGuid,editorViewModel){var _this=_super.call(this,pageGuid)||this;_this._onlyShowStates=false;_this._filter=filter;_this._wizard=wizard;_this._lists=lists;_this._editorViewModel=editorViewModel;if(wizard.Workflow.States==null){wizard.Workflow.States=[]}if(wizard.Workflow.States.length===0){var startState=new Intelledox.QAWizard.Design.StartWorkflowState;startState.AllowCancellation=true;wizard.Workflow.States.push(startState);wizard.Workflow.States.push(new Intelledox.QAWizard.Design.FinishWorkflowState)}_this.buildGraph();return _this}Object.defineProperty(WorkflowPage.prototype,"Name",{get:function(){return'Workflow'},set:function(value){},enumerable:true,configurable:true});Object.defineProperty(WorkflowPage.prototype,"Workflow",{get:function(){return this._wizard.Workflow},enumerable:true,configurable:true});Object.defineProperty(WorkflowPage.prototype,"OnlyShowStates",{get:function(){return this._onlyShowStates},set:function(value){this._onlyShowStates=value},enumerable:true,configurable:true});WorkflowPage.prototype.buildGraph=function(){this.nodes=[];this.edges=[];var visitedStates=new Array;var start;if(this._wizard.Workflow.States!=null){this.buildGraphNodes(this._wizard.Workflow,this._wizard.Workflow.States,true,undefined);for(var i=0;i<this._wizard.Workflow.States.length;i++){if(this._wizard.Workflow.States[i]instanceof Intelledox.QAWizard.Design.StartWorkflowState){start=this._wizard.Workflow.States[i];break}}this.buildGraphAddEdges(visitedStates,start)}};WorkflowPage.prototype.rebuild=function(){this.buildGraph()};WorkflowPage.prototype.buildGraphNodes=function(workflow,nodes,isRoot,parentId){if(nodes==null){return}if(!isRoot){var previousParentId=parentId;parentId=workflow.ParallelSectionGuid;this.addCompoundNode(workflow,parentId,previousParentId);this.addNode(workflow,this._filter('translate')('Start')+" "+workflow.Name,true,parentId,true);this.addNode(workflow,this._filter('translate')('Finish')+" "+workflow.Name,true,parentId,true)}for(var i=0;i<nodes.length;i++){var stateName=this.generateStateDisplayName(nodes[i]);if(isRoot){this.addNode(nodes[i],stateName,nodes[i]instanceof Intelledox.QAWizard.Design.StartWorkflowState||nodes[i]instanceof Intelledox.QAWizard.Design.FinishWorkflowState,parentId,!(nodes[i]instanceof Intelledox.QAWizard.Design.FinishWorkflowState))}else{this.addNode(nodes[i],stateName,false,parentId,true)}if(!this.OnlyShowStates){for(var escIndex=0;escIndex<nodes[i].EscalationList.length;escIndex++){this.addEscalationNode(nodes[i].EscalationList[escIndex],stateName+'esc'+escIndex.toString(),nodes[i].EscalationList[escIndex].Name,stateName,parentId)}}}if(workflow.ParallelSections!=null){for(var i=0;i<workflow.ParallelSections.length;i++){this.buildGraphNodes(workflow.ParallelSections[i],workflow.ParallelSections[i].States,false,parentId)}}};WorkflowPage.prototype.buildGraphAddEdges=function(visitedStates,currentState){visitedStates.push(currentState);if(currentState.Transitions!=null){var currentStateName=null;var currentSectionName=null;currentStateName=System.String.IsNullOrWhiteSpace(currentState.Name)?this._filter('translate')('NoneWithBrackets'):this.generateStateDisplayName(currentState);if(currentState.ParallelSectionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var currentSection=this._wizard.Workflow.GetSection(currentState.ParallelSectionGuid);if(currentSection!=null){currentSectionName=currentSection.Name}}var tran;var transitionState;var stateId;var transitionSectionName;var exitingParallels;var instanceCurrentSectionName;for(var tranIndex=0;tranIndex<currentState.Transitions.length;tranIndex++){tran=currentState.Transitions[tranIndex];transitionState=null;stateId=tran.StateId;transitionSectionName=null;exitingParallels=new Array;instanceCurrentSectionName=currentSectionName;transitionState=this._wizard.Workflow.GetState(stateId);var transitionStateName=System.String.IsNullOrWhiteSpace(transitionState.Name)?this._filter('translate')('NoneWithBrackets'):this.generateStateDisplayName(transitionState);if(transitionState.ParallelSectionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var transitionSection=this._wizard.Workflow.GetSection(transitionState.ParallelSectionGuid);if(transitionSection!=null){transitionSectionName=transitionSection.Name;if(transitionSectionName===instanceCurrentSectionName){instanceCurrentSectionName=null;transitionSectionName=null}else{if(!tran.PriorityExit&&instanceCurrentSectionName!=null&&transitionSection.HasParallelSectionName(instanceCurrentSectionName)){exitingParallels=this.fillExitingParallelsList(transitionSection,instanceCurrentSectionName)}}}}if(instanceCurrentSectionName==null){if(transitionSectionName==null){this.addEdge(currentState,tran,Design.TransitionType.Normal,currentStateName,transitionStateName,false,transitionState.ParallelSectionGuid,tran.Actions,false)}else{this.addEdge(currentState,tran,Design.TransitionType.MultipleEntry,currentStateName,this._filter('translate')('Start')+" "+transitionSectionName,false,null,null,false);this.addEdge(currentState,tran,Design.TransitionType.SingleEntry,this._filter('translate')('Start')+" "+transitionSectionName,transitionStateName,false,transitionState.ParallelSectionGuid,tran.Actions,false)}}else{if(transitionSectionName==null&&!tran.PriorityExit){exitingParallels=this.fillExitingParallelsList(this._wizard.Workflow,instanceCurrentSectionName)}if(exitingParallels.length>0){var edgeStart=currentStateName;for(var i=0;i<exitingParallels.length;i++){var exitParallel=exitingParallels[i];this.addEdge(currentState,tran,Design.TransitionType.SingleExit,edgeStart,this._filter('translate')('Finish')+" "+exitParallel,(i!==0),currentState.ParallelSectionGuid,null,true);edgeStart=this._filter('translate')('Finish')+" "+exitParallel}this.addEdge(currentState,tran,Design.TransitionType.MultipleExit,edgeStart,transitionStateName,false,null,tran.Actions,true)}else if(tran.PriorityExit&&System.String.IsNullOrEmpty(transitionSectionName)){this.addEdge(currentState,tran,Design.TransitionType.Normal,currentStateName,transitionStateName,false,transitionState.ParallelSectionGuid,tran.Actions,false)}else{this.addEdge(currentState,tran,Design.TransitionType.MultipleEntry,currentStateName,this._filter('translate')('Start')+" "+transitionSectionName,false,null,null,false);this.addEdge(currentState,tran,Design.TransitionType.SingleEntry,this._filter('translate')('Start')+" "+transitionSectionName,transitionStateName,false,transitionState.ParallelSectionGuid,tran.Actions,false)}}if(visitedStates.indexOf(transitionState)===-1){this.buildGraphAddEdges(visitedStates,transitionState)}}}};WorkflowPage.prototype.generateStateDisplayName=function(state){if(state instanceof Intelledox.QAWizard.Design.StartWorkflowState&&state.Name.indexOf(this._filter('translate')('StartState'))===-1){return System.String.Format(this._filter('translate')('NamePlusStart'),Design.TranslationHelper.KeywordValueToTranslation(this._filter,state.Name),this._filter('translate')('StartState'))}else{return Design.TranslationHelper.KeywordValueToTranslation(this._filter,state.Name)}};WorkflowPage.prototype.fillExitingParallelsList=function(parentSection,currentSectionName){var result=new Array;for(var i=0;parentSection.ParallelSections.length;i++){var parallel=parentSection.ParallelSections[i];if(parallel.Name===currentSectionName){result.push(currentSectionName);return result}if(parallel.HasParallelSectionName(currentSectionName)){result=this.fillExitingParallelsList(parallel,currentSectionName);result.push(parallel.Name);break}}return result};WorkflowPage.prototype.addCompoundNode=function(tag,id,parentId){this.nodes.push({group:'nodes',data:{id:id,parent:parentId,name:'',isEscalation:false,isAction:false,tag:tag,width:null,special:false},grabbable:false,selectable:true})};WorkflowPage.prototype.addNode=function(tag,id,isSpecial,parentId,selectable){this.nodes.push({group:'nodes',data:{id:System.String.IsNullOrEmpty(id)?'-':id,name:id,width:Math.max(36,id.length*12),special:isSpecial,isEscalation:false,isAction:false,parent:parentId,tag:tag},grabbable:false,selectable:selectable})};WorkflowPage.prototype.addEscalationNode=function(tag,id,name,source,parentId){this.nodes.push({group:'nodes',data:{id:id,name:name,width:Math.max(24,name.length*10),special:false,isEscalation:true,isAction:false,parent:parentId,tag:tag},grabbable:false,selectable:true});this.edges.push({group:'edges',data:{id:undefined,source:source,target:id,isSectionTransition:false,isEscalation:true,tag:tag,name:'',transType:Design.TransitionType.Creation},selectable:false})};WorkflowPage.prototype.addActionNode=function(tag,id,parentId){this.nodes.push({group:'nodes',data:{id:id,name:tag.Name,width:Math.max(24,tag.Name.length*11),special:false,isEscalation:false,isAction:true,parent:parentId,tag:tag},grabbable:true,selectable:true})};WorkflowPage.prototype.addEdge=function(parentState,tag,transType,source,target,isSectionTransition,parentId,actions,mergeActions){if(transType!==Design.TransitionType.SingleExit&&transType!==Design.TransitionType.SingleEntry){if(this.edgeExists(source,target,transType,tag,mergeActions)){return}}if(!this.OnlyShowStates&&actions!=null&&actions.length>0){var previousNode=source;var actionNodeId='';var newTag;for(var actionIndex=0;actionIndex<actions.length;actionIndex++){var currentAction=actions[actionIndex];var actionNodeId='action'+currentAction.ActionGuid;if(!this.edgeExists(previousNode,actionNodeId,transType,tag,mergeActions)){this.addActionNode(currentAction,actionNodeId,parentId);if(currentAction.Children.length>0){this.addChildActionNodes(currentAction,actionNodeId,parentId)}newTag=new Design.WorkflowTransitionCollection;newTag.transitions.push(tag);newTag.transType=transType;newTag.state=parentState;newTag.id=source+"-"+target;var edgeName='';if(actionIndex===0){edgeName=tag.Name}this.edges.push({group:'edges',data:{id:undefined,source:previousNode,target:actionNodeId,isSectionTransition:isSectionTransition,isEscalation:false,tag:newTag,name:edgeName,transType:transType},selectable:!isSectionTransition})}previousNode=actionNodeId}if(!this.edgeExists(actionNodeId,target,transType,tag,mergeActions)){newTag=new Design.WorkflowTransitionCollection;newTag.transitions.push(tag);newTag.transType=transType;newTag.state=parentState;newTag.id=source+"-"+target;this.edges.push({group:'edges',data:{id:undefined,source:actionNodeId,target:target,isSectionTransition:isSectionTransition,isEscalation:false,tag:newTag,name:'',transType:transType},selectable:!isSectionTransition})}}else{var newTag=new Design.WorkflowTransitionCollection;newTag.transitions.push(tag);newTag.transType=transType;newTag.state=parentState;newTag.id=source+"-"+target;this.edges.push({group:'edges',data:{id:undefined,source:source,target:target,isSectionTransition:isSectionTransition,isEscalation:false,tag:newTag,name:tag.Name,transType:transType},selectable:!isSectionTransition})}};WorkflowPage.prototype.edgeExists=function(source,target,transType,tag,mergeActions){for(var i=0;i<this.edges.length;i++){if(this.edges[i].data.tag instanceof Design.WorkflowTransitionCollection&&this.edges[i].data.tag.transType===transType&&this.edges[i].data.tag.id==source+"-"+target){if(mergeActions){tag.Actions=this.edges[i].data.tag.transitions[0].Actions}this.edges[i].data.tag.transitions.push(tag);return true}}return false};WorkflowPage.prototype.addChildActionNodes=function(parent,parentNodeId,parentId){for(var i=0;i<parent.Children.length;i++){var child=parent.Children[i];var actionNodeId='action'+child.ActionGuid;this.addActionNode(child,actionNodeId,parentId);if(child.Children.length>0){this.addChildActionNodes(child,actionNodeId,parentId)}this.edges.push({group:'edges',data:{id:undefined,source:parentNodeId,target:actionNodeId,isSectionTransition:false,isEscalation:false,tag:null,name:'',transType:Design.TransitionType.Creation},selectable:false})}};WorkflowPage.prototype.addNewParallel=function(parentParallel){if(parentParallel==null){parentParallel=this._wizard.Workflow}var newParallel=new Intelledox.QAWizard.Design.Workflow;var allSections=this._wizard.Workflow.FullSectionList();var count=allSections.length+1;var foundMatch;do{var newName=this._filter('translate')('Parallel')+' '+count.toString();foundMatch=false;for(var i=0;i<allSections.length;i++){if(allSections[i].Name===newName){foundMatch=true;count++}}}while(foundMatch);newParallel.Name=newName;newParallel.States=[];parentParallel.ParallelSections.push(newParallel);this._editorViewModel.wizChanged=true;return newParallel};WorkflowPage.prototype.addNewState=function(parentParallel){if(parentParallel==null){parentParallel=this._wizard.Workflow}var newState=new Intelledox.QAWizard.Design.WorkflowState;var allStates=this._wizard.Workflow.FullStateList;var count=allStates.length;var foundMatch;do{var newName=this._filter('translate')('State')+' '+count.toString();foundMatch=false;for(var i=0;i<allStates.length;i++){if(allStates[i].Name===newName){foundMatch=true;count++}}}while(foundMatch);newState.Id=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();newState.Name=newName;newState.ParallelSectionGuid=parentParallel.ParallelSectionGuid;parentParallel.States.push(newState);this._editorViewModel.wizChanged=true;return newState};WorkflowPage.prototype.addNewTransition=function(parentState){var newTransition=new Intelledox.QAWizard.Design.StateTransition;newTransition.Conditions=new Intelledox.QAWizard.Design.Condition;newTransition.StateId=Intelledox.Common.ConstantValues.GUID_EMPTY;newTransition.ShowNextSteps=false;newTransition.ShowSendTo=false;newTransition.ShowComment=false;if(parentState.IsFixedState){newTransition.SendTo=Intelledox.QAWizard.Design.StateTransitionSendTo.User;newTransition.SendToType=Intelledox.QAWizard.Design.StateTransitionSendToType.Search}else{newTransition.SendTo=Intelledox.QAWizard.Design.StateTransitionSendTo.Creator}if(parentState.Transitions==null){parentState.Transitions=[]}var newTag=new Design.WorkflowTransitionCollection;newTag.transitions.push(newTransition);newTag.transType=Design.TransitionType.Creation;newTag.state=parentState;this._editorViewModel.wizChanged=true;return newTag};WorkflowPage.prototype.addNewEscalation=function(parentState,routingTypeId){var vm=this;return this._lists.licensedEscalationTypes().then(function(escalations){for(var i=0;i<escalations.length;i++){if(escalations[i].routingTypeId===routingTypeId){var newEscalation=new Intelledox.QAWizard.Design.Escalation;newEscalation.Type=escalations[i];newEscalation.Name=vm._lists.nameToTranslation(escalations[i].description);newEscalation.ExpireAfter=1;newEscalation.InitialisationType=Intelledox.Model.EscalationInitialisationType.Days;parentState.EscalationList.push(newEscalation);vm._editorViewModel.wizChanged=true;return newEscalation}}return null})};WorkflowPage.prototype.addNewAction=function(parentTransition,parentAction,actionId){var vm=this;return this._lists.licensedActionTypes().then(function(actions){for(var i=0;i<actions.length;i++){if(actions[i].routingTypeId===actionId){var newAction=new Intelledox.QAWizard.Design.Action;newAction.Type=actions[i];newAction.Name=vm._lists.nameToTranslation(actions[i].description);newAction.HasCustomDocuments=true;if(parentAction!=null){parentAction.Children.push(newAction)}else{parentTransition.Actions.push(newAction)}vm._editorViewModel.wizChanged=true;return newAction}}return null})};WorkflowPage.prototype.reorderAction=function(parentTransition,dragAction,dropActionIndex){var vm=this;var dragIndex=-1;var actionCount=parentTransition.Actions.length;for(var i=0;i<parentTransition.Actions.length;i++){if(parentTransition.Actions[i].ActionGuid===dragAction.ActionGuid){dragIndex=i;break}}if(dragIndex<dropActionIndex){dropActionIndex--}if(dragIndex===dropActionIndex){return false}var tmpAction=parentTransition.Actions[dragIndex];parentTransition.Actions.splice(dragIndex,1);if(dropActionIndex===actionCount){parentTransition.Actions.push(tmpAction)}else{parentTransition.Actions.splice(dropActionIndex,0,tmpAction)}vm._editorViewModel.wizChanged=true;return true};WorkflowPage.prototype.findTransitionByAction=function(dragAction){var parentTransition=null;var findTransitionByAction=function findTransitionByAction(actions,dragAction){for(var actionIndex=0;actionIndex<actions.length;actionIndex++){if(actions[actionIndex]===dragAction){return true}if(actions[actionIndex].Children.length>0){if(findTransitionByAction(actions[actionIndex].Children,dragAction)){return true}}}return false};var fullList=this._wizard.Workflow.FullStateList;for(var stateIndex=0;stateIndex<fullList.length;stateIndex++){for(var transitionsIndex=0;transitionsIndex<fullList[stateIndex].Transitions.length;transitionsIndex++){if(findTransitionByAction(fullList[stateIndex].Transitions[transitionsIndex].Actions,dragAction)){parentTransition=fullList[stateIndex].Transitions[transitionsIndex];break}}if(parentTransition!=null){break}}return parentTransition};return WorkflowPage}(Intelledox.QAWizard.Design.Page));Design.WorkflowPage=WorkflowPage})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var FragmentsFlyout=(function(){function FragmentsFlyout(designApi,excludeProjectGuid,allowFragmentPage){this.availableFragments=[];this.filteredFragments=[];this.searchValue='';var vm=this;designApi.getProjects(false).then(function(projects){var fragments=[];for(var i=0;i<projects.length;i++){var t=projects[i];if(t.projectGuid!==excludeProjectGuid&&((allowFragmentPage&&t.projectTypeId===Intelledox.Model.ProjectType.FragmentPage)||t.projectTypeId===Intelledox.Model.ProjectType.FragmentPortion)){fragments.push(t)}}vm.availableFragments=fragments;vm.filteredFragments=fragments})}FragmentsFlyout.prototype.searchFragments=function(){var searchString=this.searchValue.toLowerCase();this.filteredFragments=[];for(var i=0;i<this.availableFragments.length;i++){var currentFragment=this.availableFragments[i];if(currentFragment.name.toLowerCase().indexOf(searchString)>-1){this.filteredFragments.push(currentFragment)}}};return FragmentsFlyout}());Design.FragmentsFlyout=FragmentsFlyout})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ActionsFlyout=(function(){function ActionsFlyout(lists,filter){this.availableActions=[];this.filteredActions=[];this.searchValue='';this.message='';this.forWorkflow=false;var vm=this;lists.licensedActionTypes().then(function(actions){var clonedActions=[];for(var i=0;i<actions.length;i++){var clone=new Intelledox.Model.RoutingType;var obj=actions[i];for(var prop in obj){if(obj.hasOwnProperty(prop)){clone[prop]=obj[prop]}}clone.description=lists.nameToTranslation(clone.description);clonedActions.push(clone)}vm.availableActions=clonedActions;vm.filteredActions=clonedActions});vm._filter=filter;vm.message=this._filter('translate')('WorkflowActionMessage')}ActionsFlyout.prototype.searchActions=function(){var searchString=this.searchValue.toLowerCase();this.filteredActions=[];for(var i=0;i<this.availableActions.length;i++){var currentAction=this.availableActions[i];if(currentAction.description.toLowerCase().indexOf(searchString)>-1){this.filteredActions.push(currentAction)}}};return ActionsFlyout}());Design.ActionsFlyout=ActionsFlyout})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var BaseFlyout=(function(){function BaseFlyout(){}return BaseFlyout}());Design.BaseFlyout=BaseFlyout})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Infiniti;(function(Infiniti){var Model;(function(Model){var Apis;(function(Apis){var DataService=(function(){function DataService(){this.name=null;this.dataServiceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.providerName=null}return DataService}());Apis.DataService=DataService})(Apis=Model.Apis||(Model.Apis={}))})(Model=Infiniti.Model||(Infiniti.Model={}))})(Infiniti||(Infiniti={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var ContentFolder=(function(){function ContentFolder(){this.folderGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.name=null}return ContentFolder}());Model.ContentFolder=ContentFolder})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var RoutingElementType=(function(){function RoutingElementType(){this.routingElementTypeId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.routingTypeId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.description=null;this.elementLimit=0;this.required=false;this.allowTranslation=false;this.isKeyValue=false;this.valueType=Model.ValueTypes.Any;this.enumValues=null;this.parentRoutingElementTypeId=Intelledox.Common.ConstantValues.GUID_EMPTY}return RoutingElementType}());Model.RoutingElementType=RoutingElementType})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var CustomQuestionOutput=(function(_super){__extends(CustomQuestionOutput,_super);function CustomQuestionOutput(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.outputType=Model.CustomQuestionOutputType.Text;return _this}return CustomQuestionOutput}(Model.RoutingElementType));Model.CustomQuestionOutput=CustomQuestionOutput})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var DataObject=(function(){function DataObject(){this.dataServiceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.dataObjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.name=null;this.displayName=null;this.mergeSource=false;this.allowCache=false;this.objectType=Intelledox.Common.ConstantValues.GUID_EMPTY}return DataObject}());Model.DataObject=DataObject})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var DataProvider=(function(){function DataProvider(){this.providerName=null;this.supportsProvidedData=false}return DataProvider}());Model.DataProvider=DataProvider})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var CustomQuestionType=(function(){function CustomQuestionType(){this.customQuestionTypeId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.description=null;this.icon16=null;this.icon48=null;this.moduleId=null;this.previewHtml=null}return CustomQuestionType}());Model.CustomQuestionType=CustomQuestionType})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var KeyField=(function(){function KeyField(){this.dataObjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.displayName=null;this.isDisplay=false;this.isRequiredInFilter=false;this.keyFieldId=0;this.name=null;this.hierarchyParentName=null}return KeyField}());Model.KeyField=KeyField})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var QARepeatHelper=(function(){function QARepeatHelper(){}QARepeatHelper.getDataFields=function($filter,wizard,currentQuestion){var repeat=wizard.FindLayoutNode(currentQuestion.DataObjectGuid);var questions=null;var currentDataFields=new Array;if(repeat instanceof Intelledox.QAWizard.Design.Page){questions=repeat.NonRepeatingQuestions();currentDataFields.push({name:"["+$filter('translate')('RowId')+"]",value:"[RowId]"})}else if(repeat instanceof Intelledox.QAWizard.Design.Section){questions=repeat.NonRepeatingQuestions();currentDataFields.push({name:"["+$filter('translate')('RowId')+"]",value:"[RowId]"})}else{questions=[]}for(var questionIndex=0;questionIndex<questions.length;questionIndex++){var q=questions[questionIndex];var fieldNames=this.getFieldNames(q);for(var nameIndex=0;nameIndex<fieldNames.length;nameIndex++){currentDataFields.push({name:fieldNames[nameIndex],value:fieldNames[nameIndex]})}}return currentDataFields};QARepeatHelper.getKeyFields=function($filter,wizard,currentQuestion){var repeat=wizard.FindLayoutNode(currentQuestion.DataObjectGuid);var questions=null;var currentDataFields=new Array;if(repeat instanceof Intelledox.QAWizard.Design.Page){questions=repeat.NonRepeatingQuestions();currentDataFields.push({name:"["+$filter('translate')('RowId')+"]",value:"[RowId]"})}else if(repeat instanceof Intelledox.QAWizard.Design.Section){questions=repeat.NonRepeatingQuestions();currentDataFields.push({name:"["+$filter('translate')('RowId')+"]",value:"[RowId]"})}else{questions=[]}for(var questionIndex=0;questionIndex<questions.length;questionIndex++){var q=questions[questionIndex];var fieldNames=this.getFieldNames(q);for(var nameIndex=0;nameIndex<fieldNames.length;nameIndex++){currentDataFields.push({name:fieldNames[nameIndex],value:fieldNames[nameIndex]})}}return currentDataFields};QARepeatHelper.getFieldNames=function(q){if(q instanceof Intelledox.QAWizard.Design.DatasourceQuestion||q instanceof Intelledox.QAWizard.Design.AddressQuestion||q instanceof Intelledox.QAWizard.Design.LogicQuestion||q instanceof Intelledox.QAWizard.Design.CustomQuestion||q instanceof Intelledox.QAWizard.Design.VariableQuestion){var answers=[];for(var answerIndex=0;answerIndex<q.Answers.length;answerIndex++){answers.push("Q"+q.ID.toString()+"."+q.Answers[answerIndex].ID.toString())}return answers}else if(q instanceof Intelledox.QAWizard.Design.UserPromptQuestion||q instanceof Intelledox.QAWizard.Design.RichTextQuestion||q instanceof Intelledox.QAWizard.Design.NumericQuestion){return["Q"+q.ID.toString()]}return[]};return QARepeatHelper}());Design.QARepeatHelper=QARepeatHelper})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ListManager=(function(){function ListManager($filter,$q,designApi){this._filter=$filter;this.qservice=$q;this._designApi=designApi;this.clear()}ListManager.prototype.clear=function(){this._addressFields=null;this._actionTypes=null;this._actionOutputs={};this._actionAvailableDocuments={};this._contentCategories=null;this._contentFolders=null;this._contentFoldersByUser=null;this._publishFolders=null;this._contentItems=null;this._customQuestionTypes=null;this._customQuestionInputTypes={};this._customQuestionOutputTypes={};this._dataFields={};this._dataObjects={};this._dataProvider=null;this._dataSources=null;this._escalationTypes=null;this._filterComparisons={};this._hierarchicalfilterComparisons={};this._groups=null;this._keyFields={};this._linkssList={};this._licensedActionTypes=null;this._licensedCustomQuestionTypes=null;this._licensedEscalationTypes=null;this._projectFragments={};this._routingElementTypes={};this._users=null;this._responseMetadataFields=null;this._publishedProjects=null;this._cssStyles={};this._canPublish=null};ListManager.prototype.canPublish=function(){if(this._canPublish==null){this._canPublish=this._designApi.getCanPublish()}return this._canPublish};ListManager.prototype.addressFields=function(){if(this._addressFields==null){this._addressFields=this._designApi.getAddressFields()}return this._addressFields};ListManager.prototype.actionTypes=function(){if(this._actionTypes==null){this._actionTypes=this._designApi.getRoutingTypes(Intelledox.Model.ProviderType.Action,false)}return this._actionTypes};ListManager.prototype.licensedActionTypes=function(){if(this._licensedActionTypes==null){this._licensedActionTypes=this._designApi.getRoutingTypes(Intelledox.Model.ProviderType.Action,true).then(function(actions){actions.sort(function(a,b){if(a.description>b.description){return 1}if(a.description<b.description){return-1}return 0});return actions})}return this._licensedActionTypes};ListManager.prototype.licensedEscalationTypes=function(){if(this._licensedEscalationTypes==null){this._licensedEscalationTypes=this._designApi.getRoutingTypes(Intelledox.Model.ProviderType.Escalation,true).then(function(escalations){escalations.sort(function(a,b){if(a.description>b.description){return 1}if(a.description<b.description){return-1}return 0});return escalations})}return this._licensedEscalationTypes};ListManager.prototype.routingElementTypes=function(routingTypeId){if(!this._routingElementTypes.hasOwnProperty(routingTypeId)){this._routingElementTypes[routingTypeId]=this._designApi.getRoutingElementTypes(routingTypeId)}return this._routingElementTypes[routingTypeId]};ListManager.prototype.actionOutputs=function(actionTypeId){if(!this._actionOutputs.hasOwnProperty(actionTypeId)){this._actionOutputs[actionTypeId]=this._designApi.getActionOutputs(actionTypeId).then(function(data){var cloneArray=new Array;for(var i=0;i<data.length;i++){var clone=new Intelledox.Model.ActionOutput;var obj=data[i];for(var prop in obj){if(obj.hasOwnProperty(prop)){clone[prop]=obj[prop]}}cloneArray.push(clone)}return cloneArray})}return this._actionOutputs[actionTypeId]};ListManager.prototype.actionAvailableDocuments=function(actionTypeId){if(!this._actionAvailableDocuments.hasOwnProperty(actionTypeId)){this._actionAvailableDocuments[actionTypeId]=this._designApi.getActionAvailableDocuments(actionTypeId).then(function(data){var cloneArray=new Array;for(var i=0;i<data.length;i++){var clone=new Intelledox.Model.ActionAvailableDocument;var obj=data[i];for(var prop in obj){if(obj.hasOwnProperty(prop)){clone[prop]=obj[prop]}}cloneArray.push(clone)}return cloneArray})}return this._actionAvailableDocuments[actionTypeId]};ListManager.prototype.actionOutput=function(actionOutputId){var vm=this;var ctx={foundOutput:null};return this.actionTypes().then(function(actionTypes){var defer=vm.qservice.defer();defer.resolve();var deferred=defer.promise;angular.forEach(actionTypes,function(actionType){deferred=deferred.then(function(){if(ctx.foundOutput!=null){return}return vm.actionOutputs(actionType.routingTypeId)});deferred=deferred.then(function(actionOutputs){if(ctx.foundOutput!=null){return}for(var outputIndex=0;outputIndex<actionOutputs.length;outputIndex++){if(actionOutputs[outputIndex].id===actionOutputId){ctx.foundOutput=actionOutputs[outputIndex];break}}})});return deferred}).then(function(){return ctx.foundOutput})};ListManager.prototype.getActionName=function(actionTypeId){var vm=this;return this.actionTypes().then(function(actionTypes){for(var i=0;i<actionTypes.length;i++){if(actionTypes[i].routingTypeId===actionTypeId){return vm.nameToTranslation(actionTypes[i].description)}}return vm._filter('translate')('ActionNotInstalled')})};ListManager.prototype.nameToTranslation=function(name){var resourceStr;var term;term=name.replace(/ /g,"");term=term.replace(/\(/g,"_");term=term.replace(/\)/g,"_");term=term.replace(/\|/g,"_");term=term.replace(/\-/g,"_");term=term.replace(/\//g,"_");term=term.replace(/\\/g,"_");term=term.replace(/:/g,"_");resourceStr=this._filter('translate')(term);if(!System.String.IsNullOrEmpty(resourceStr)&&resourceStr!==term){return resourceStr}else{return name}};ListManager.prototype.dataFieldToTranslation=function(dataField){switch(dataField){case"[Formula]":return"["+this._filter('translate')('Formula')+"]";case"[Aggregate]":return"["+this._filter('translate')('Aggregate')+"]";case"[RowCount]":return"["+this._filter('translate')('RowCount')+"]";case"[RowNumber]":return"["+this._filter('translate')('RowNumber')+"]";case Intelledox.Common.ConstantValues.RESULTS_COMPLETED:return this._filter('translate')('ResultsCompleted');case Intelledox.Common.ConstantValues.RESULTS_COMPLETIONDATE:return this._filter('translate')('ResultsCompletionTime');case Intelledox.Common.ConstantValues.RESULTS_CURRENTSTATE:return this._filter('translate')('ResultsCurrentState');case Intelledox.Common.ConstantValues.RESULTS_USERNAME:return this._filter('translate')('ResultsUsername');case Intelledox.Common.ConstantValues.RESULTS_WORKFLOWINPROGRESS:return this._filter('translate')('ResultsWorkflowInProgress');case Intelledox.Common.ConstantValues.RESULTS_RUNID:return this._filter('translate')('ResultsRunId');default:return dataField.replace(Intelledox.Common.ConstantValues.RESULTS_UNIQUEFIELD,this._filter('translate')('ResultsUniqueField'))}};ListManager.prototype.projectFragment=function(projectGuid){if(!this._projectFragments.hasOwnProperty(projectGuid)){this._projectFragments[projectGuid]=this._designApi.getProjectDefinition(projectGuid).then(function(definition){if(definition!=null){var importer=new Intelledox.QAWizard.Design.WizardController;var wizard=importer.CreateFromXTF(definition.xml,true);return wizard}return null},function(){return null})}return this._projectFragments[projectGuid]};ListManager.prototype.getContentItems=function(){if(this._contentItems==null){this._contentItems=this._designApi.getContentItems()}return this._contentItems};ListManager.prototype.contentFolders=function(){if(this._contentFolders==null){this._contentFolders=this._designApi.getContentFolders(false)}return this._contentFolders};ListManager.prototype.contentFoldersByUser=function(){if(this._contentFoldersByUser==null){this._contentFoldersByUser=this._designApi.getContentFolders(true)}return this._contentFoldersByUser};ListManager.prototype.publishFolders=function(){if(this._publishFolders==null){this._publishFolders=this._designApi.getPublishFolders()}return this._publishFolders};ListManager.prototype.dataFieldsList=function(dataObjectGuid,dropDownWidthInPixels,includeAdhocFields,hierarchyParentName){var vm=this;return this.dataFields(dataObjectGuid,includeAdhocFields,hierarchyParentName).then(function(fields){return vm.dataFieldsListFromExisting(fields,dropDownWidthInPixels)})};ListManager.prototype.dataFieldsListFromExisting=function(fields,dropDownWidthInPixels){var result=new Array;var maxNameLength=dropDownWidthInPixels/6;if(maxNameLength>20){var startLength=((maxNameLength-3)/3);var finishLength=((maxNameLength-3)*2/3);for(var i=0;i<fields.length;i++){var field=fields[i];var displayValue=field.displayName;if(displayValue.length>maxNameLength){var trimmedFieldName=System.String.Substring(displayValue,0,startLength);trimmedFieldName+="...";trimmedFieldName+=System.String.Substring(displayValue,displayValue.length-finishLength,finishLength);displayValue=trimmedFieldName}result.push({name:this.dataFieldToTranslation(displayValue),value:field.name})}}else{for(var i=0;i<fields.length;i++){var field=fields[i];result.push({name:this.dataFieldToTranslation(field.displayName),value:field.name})}}return result};ListManager.prototype.dataFields=function(dataObjectGuid,includeAdhocFields,hierarchyParentName){if(!this._dataFields.hasOwnProperty(dataObjectGuid)){var vm=this;this._dataFields[dataObjectGuid]=this._designApi.getDataFields(dataObjectGuid).then(function(fields){var i=0;for(i=0;i<fields.length;i++){var field=fields[i];if(System.String.IsNullOrEmpty(field.displayName)){field.displayName=field.name}if(field.displayName.indexOf(Intelledox.Common.ConstantValues.REPEATED_SECTION)===0){field.displayName=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(field.displayName,Intelledox.Common.ConstantValues.REPEATED_SECTION,vm._filter('translate')('RepeatedSection'))}else if(field.displayName.indexOf(Intelledox.Common.ConstantValues.REPEATED_PAGE)===0){field.displayName=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(field.displayName,Intelledox.Common.ConstantValues.REPEATED_PAGE,vm._filter('translate')('RepeatedPage'))}}fields.sort(function(a,b){if(a.displayName>b.displayName){return 1}if(a.displayName<b.displayName){return-1}return 0});return fields},function(){return[]})}return this._dataFields[dataObjectGuid].then(function(fields){var dataFieldsCopy=fields.slice(0);for(var i=dataFieldsCopy.length-1;i>=0;i--){var field=dataFieldsCopy[i];if(System.String.IsNullOrEmpty(hierarchyParentName)){if(!System.String.IsNullOrEmpty(field.hierarchyParentName)){dataFieldsCopy.splice(i,1)}}else if(field.hierarchyParentName==null){if(field.name===hierarchyParentName||!System.String.StartsWith(field.name,hierarchyParentName)){dataFieldsCopy.splice(i,1)}}else{if(field.hierarchyParentName!==hierarchyParentName){dataFieldsCopy.splice(i,1)}}}if(includeAdhocFields){var rowNumber=new Intelledox.Model.SchemaField;rowNumber.name="[RowNumber]";rowNumber.displayName="[RowNumber]";dataFieldsCopy.splice(0,0,rowNumber);var rowCount=new Intelledox.Model.SchemaField;rowCount.name="[RowCount]";rowCount.displayName="[RowCount]";dataFieldsCopy.splice(0,0,rowCount)}return dataFieldsCopy})};ListManager.prototype.dataSources=function(){if(this._dataSources==null){this._dataSources=this._designApi.getDataServices().then(function(data){var cloneArray=new Array;for(var i=0;i<data.length;i++){var clone=new Infiniti.Model.Apis.DataService;var obj=data[i];for(var prop in obj){if(obj.hasOwnProperty(prop)){clone[prop]=obj[prop]}}cloneArray.push(clone)}return cloneArray})}return this._dataSources};ListManager.prototype.dataProviders=function(){if(this._dataProvider==null){this._dataProvider=this._designApi.getDataProviders()}return this._dataProvider};ListManager.prototype.dataObjects=function(dataServiceGuid){if(!this._dataObjects.hasOwnProperty(dataServiceGuid)){this._dataObjects[dataServiceGuid]=this._designApi.getDataObjects(dataServiceGuid)}return this._dataObjects[dataServiceGuid]};ListManager.prototype.customQuestionTypes=function(){if(this._customQuestionTypes==null){this._customQuestionTypes=this._designApi.getCustomQuestionTypes(false)}return this._customQuestionTypes};ListManager.prototype.licensedCustomQuestionTypes=function(){if(this._licensedCustomQuestionTypes==null){this._licensedCustomQuestionTypes=this._designApi.getCustomQuestionTypes(true)}return this._licensedCustomQuestionTypes};ListManager.prototype.customQuestionType=function(customQuestionTypeId){var vm=this;return this.customQuestionTypes().then(function(customTypes){for(var i=0;i<customTypes.length;i++){if(customTypes[i].customQuestionTypeId===customQuestionTypeId){return customTypes[i]}}var badType=new Intelledox.Model.CustomQuestionType;badType.description="<"+vm._filter('translate')('InvalidQuestionType')+">";return badType})};ListManager.prototype.customQuestionInputTypes=function(customQuestionID){if(!this._customQuestionInputTypes.hasOwnProperty(customQuestionID)){this._customQuestionInputTypes[customQuestionID]=this._designApi.getCustomQuestionInputTypes(customQuestionID)}return this._customQuestionInputTypes[customQuestionID]};ListManager.prototype.customQuestionOutputTypes=function(customQuestionID){if(!this._customQuestionOutputTypes.hasOwnProperty(customQuestionID)){this._customQuestionOutputTypes[customQuestionID]=this._designApi.getCustomQuestionOutputTypes(customQuestionID)}return this._customQuestionOutputTypes[customQuestionID]};ListManager.prototype.links=function(dataObjectTypeGuid){if(!this._linkssList.hasOwnProperty(dataObjectTypeGuid)){this._linkssList[dataObjectTypeGuid]=this._designApi.getDataLinks(dataObjectTypeGuid)}return this._linkssList[dataObjectTypeGuid]};ListManager.prototype.keyFields=function(dataObjectGuid,hierarchyParentName){if(!this._keyFields.hasOwnProperty(dataObjectGuid)){this._keyFields[dataObjectGuid]=this._designApi.getDataKeyFields(dataObjectGuid)}return this._keyFields[dataObjectGuid].then(function(fields){var keyFieldsCopy=new Array;keyFieldsCopy.push.apply(keyFieldsCopy,fields);for(var i=keyFieldsCopy.length-1;i>=0;i--){var field=keyFieldsCopy[i];if(System.String.IsNullOrEmpty(hierarchyParentName)){if(!System.String.IsNullOrEmpty(field.hierarchyParentName)){keyFieldsCopy.splice(i,1)}}else if(System.String.IsNullOrEmpty(field.hierarchyParentName)){if(field.name===hierarchyParentName||!System.String.StartsWith(field.name,hierarchyParentName)){keyFieldsCopy.splice(i,1)}}else{if(field.hierarchyParentName!==hierarchyParentName){keyFieldsCopy.splice(i,1)}}}return keyFieldsCopy})};ListManager.prototype.keyFieldsList=function(dataObjectGuid,dropDownWidthInPixels,hierarchyParentName){var maxNameLength=dropDownWidthInPixels/6;if(maxNameLength>20){var startLength=((maxNameLength-3)/3);var finishLength=((maxNameLength-3)*2/3);return this.keyFields(dataObjectGuid,hierarchyParentName).then(function(fields){var result=new Array;var displayValue;for(var i=0;i<fields.length;i++){if(System.String.IsNullOrEmpty(fields[i].displayName)){displayValue=fields[i].name}else{displayValue=fields[i].displayName}if(displayValue.length>maxNameLength){var trimmedFieldName=System.String.Substring(displayValue,0,startLength);trimmedFieldName+="...";trimmedFieldName+=System.String.Substring(displayValue,displayValue.length-finishLength,finishLength);displayValue=trimmedFieldName}result.push({name:displayValue,value:fields[i].name})}return result})}else{return this.keyFields(dataObjectGuid,hierarchyParentName).then(function(fields){var result=new Array;var displayValue;for(var i=0;i<fields.length;i++){if(System.String.IsNullOrEmpty(fields[i].displayName)){displayValue=fields[i].name}else{displayValue=fields[i].displayName}result.push({name:displayValue,value:fields[i].name})}return result})}};ListManager.prototype.supportedFilterComparisons=function(dataServiceGuid,dataObjectGuid){if(!this._filterComparisons.hasOwnProperty(dataObjectGuid)){this._filterComparisons[dataObjectGuid]=this._designApi.getSuppportedFilterComparisions(dataServiceGuid,dataObjectGuid)}return this._filterComparisons[dataObjectGuid]};ListManager.prototype.supportedHierarchicalFilterComparisons=function(dataServiceGuid,dataObjectGuid){if(!this._hierarchicalfilterComparisons.hasOwnProperty(dataObjectGuid)){this._hierarchicalfilterComparisons[dataObjectGuid]=this._designApi.getSupportedHierarchicalFilterComparisons(dataServiceGuid,dataObjectGuid)}return this._hierarchicalfilterComparisons[dataObjectGuid]};ListManager.prototype.isCalculatedDataField=function(dataField){return(dataField==="[Formula]"||dataField==="[Aggregate]"||dataField==="[RowCount]"||dataField==="[RowNumber]"||dataField==="[RowId]")};ListManager.prototype.users=function(){if(this._users==null){this._users=this._designApi.getUsers()}return this._users};ListManager.prototype.groups=function(){if(this._groups==null){this._groups=this._designApi.getGroups()}return this._groups};ListManager.prototype.escalationTypes=function(){if(this._escalationTypes==null){this._escalationTypes=this._designApi.getRoutingTypes(Intelledox.Model.ProviderType.Escalation,false)}return this._escalationTypes};ListManager.prototype.contentCategories=function(){if(this._contentCategories==null){this._contentCategories=this._designApi.getContentCategories()}return this._contentCategories};ListManager.prototype.responseMetadataFields=function(){if(this._responseMetadataFields==null){this._responseMetadataFields=this._designApi.getResponseMetadataFields()}return this._responseMetadataFields};ListManager.prototype.publishedProjects=function(){if(this._publishedProjects==null){this._publishedProjects=this._designApi.getPublishedProjects()}return this._publishedProjects};ListManager.prototype.cssStyles=function(appliesTo){if(!this._cssStyles.hasOwnProperty(appliesTo)){this._cssStyles[appliesTo]=this._designApi.getCssStyles(appliesTo)}return this._cssStyles[appliesTo]};ListManager.prototype.populateRepeatSources=function(wizard,includeInputs,stopNode,availableRepeatSources){availableRepeatSources.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY,type:Intelledox.QAWizard.Design.RepeatSourceType.None,tag:null});if(includeInputs){for(var i=0;i<wizard.AvailableInputs.length;i++){var input=wizard.AvailableInputs[i];if(input.valueType===Intelledox.Model.ValueTypes.Repeat){availableRepeatSources.push({name:input.description,value:input.routingElementTypeId,type:Intelledox.QAWizard.Design.RepeatSourceType.Input,tag:input})}}}var results={sectionsSoFar:0};for(var i=0;i<wizard.Pages.length;i++){var page=wizard.Pages[i];var foundStop=this.populateRepeatSourcesRecursive(page,"",results,stopNode,availableRepeatSources);if(foundStop){break}if(page instanceof Intelledox.QAWizard.Design.FragmentPage){var vm=this;(function(fragmentRef){vm.projectFragment(fragmentRef.ProjectGuid).then(function(fragmentWizard){if(fragmentWizard!=null){for(var outputIndex=0;outputIndex<fragmentWizard.AvailableOutputs.length;outputIndex++){if(fragmentWizard.AvailableOutputs[outputIndex].SourceType===Intelledox.Model.RoutingSourceType.Repeat){availableRepeatSources.push({name:fragmentRef.Name,value:fragmentRef.ObjectId,type:Intelledox.QAWizard.Design.RepeatSourceType.FragmentOutput,tag:fragmentRef});break}}}})})(page)}else if(page.IsRepeated){availableRepeatSources.push({name:page.Name,value:page.PageGuid,type:Intelledox.QAWizard.Design.RepeatSourceType.Page,tag:page})}}};ListManager.prototype.populateRepeatSourcesRecursive=function(node,sectionNamePrefix,results,stopNode,availableRepeatSources){if(node===stopNode){return true}if(typeof node.HasContainerInterface!=="undefined"){for(var i=0;i<node.Children.length;i++){var containerChild=node.Children[i];var sectionName=sectionNamePrefix;if(containerChild instanceof Intelledox.QAWizard.Design.Section){results.sectionsSoFar+=1;var section=containerChild;if(!System.String.IsNullOrEmpty(section.Title)){sectionName+=Design.TranslationHelper.KeywordValueToTranslation(this._filter,section.Title)}else{sectionName+=System.String.Format(this._filter('translate')('SectionNumber'),results.sectionsSoFar.toString())}}var foundStop=this.populateRepeatSourcesRecursive(containerChild,sectionName+" - ",results,stopNode,availableRepeatSources);if(foundStop){return true}if(containerChild instanceof Intelledox.QAWizard.Design.Section){if(containerChild.IsRepeated){var section=containerChild;availableRepeatSources.push({name:sectionName,value:section.SectionGuid,type:Intelledox.QAWizard.Design.RepeatSourceType.Section,tag:section})}}else if(containerChild instanceof Intelledox.QAWizard.Design.FragmentReference){var vm=this;(function(fragmentRef){vm.projectFragment(fragmentRef.ProjectGuid).then(function(fragmentWizard){if(fragmentWizard!=null){for(var outputIndex=0;outputIndex<fragmentWizard.AvailableOutputs.length;outputIndex++){if(fragmentWizard.AvailableOutputs[outputIndex].SourceType===Intelledox.Model.RoutingSourceType.Repeat){availableRepeatSources.push({name:fragmentRef.Name,value:fragmentRef.FragmentGuid,type:Intelledox.QAWizard.Design.RepeatSourceType.FragmentOutput,tag:fragmentRef});break}}}})})(containerChild)}}}else if(node instanceof Intelledox.QAWizard.Design.DatasourceQuestion){var dataSourceQuestion=node;if(dataSourceQuestion.SelectionType===Intelledox.Model.SelectionType.Multiple){if(!dataSourceQuestion.Visibility||dataSourceQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.List||dataSourceQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelectDropdown||dataSourceQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.Popup){availableRepeatSources.push({name:node.Text,value:node.QuestionGuid,type:Intelledox.QAWizard.Design.RepeatSourceType.DataSource,tag:node})}else if(dataSourceQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.Search||dataSourceQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.DataGrid){if(stopNode===null||!dataSourceQuestion.Page.HasChild(stopNode.ObjectId)){availableRepeatSources.push({name:node.Text,value:node.QuestionGuid,type:Intelledox.QAWizard.Design.RepeatSourceType.DataSource,tag:node})}}}}return false};ListManager.prototype.populateInstanceFragments=function(wizard,availableFragments){for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var p=wizard.Pages[pageIndex];if(p instanceof Intelledox.QAWizard.Design.FragmentPage){availableFragments.push(p)}else{for(var i=0;i<p.Children.length;i++){this.populateInstanceFragmentsRecursive(p.Children[i],availableFragments)}}}};ListManager.prototype.populateInstanceFragmentsRecursive=function(node,availableFragments){if(node instanceof Intelledox.QAWizard.Design.FragmentReference){availableFragments.push(node)}else if(typeof node.HasContainerInterface!=="undefined"){for(var i=0;i<node.Children.length;i++){this.populateInstanceFragmentsRecursive(node.Children[i],availableFragments)}}};ListManager.prototype.populateFragmentOutputs=function(projectGuid,availableFragmentOutputs){var noneOutput=new Intelledox.QAWizard.Design.AvailableOutput;noneOutput.RoutingOptionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;noneOutput.Name=this._filter('translate')('NoneWithBrackets');availableFragmentOutputs.push(noneOutput);if(projectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){return this.projectFragment(projectGuid).then(function(fragment){if(fragment!=null){for(var i=0;i<fragment.AvailableOutputs.length;i++){availableFragmentOutputs.push(fragment.AvailableOutputs[i])}availableFragmentOutputs.sort(function(a,b){if(a.RoutingOptionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return-1}if(b.RoutingOptionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return 1}if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0})}})}};ListManager.prototype.populateFragmentRepeatedOutputs=function(projectGuid,availableFragmentOutputs){return this.projectFragment(projectGuid).then(function(fragment){if(fragment!=null){for(var outputIndex=0;outputIndex<fragment.AvailableOutputs.length;outputIndex++){if(fragment.AvailableOutputs[outputIndex].SourceType===Intelledox.Model.RoutingSourceType.Repeat){availableFragmentOutputs.push(fragment.AvailableOutputs[outputIndex])}}availableFragmentOutputs.sort(function(a,b){if(a.RoutingOptionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return-1}if(b.RoutingOptionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return 1}if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0})}})};return ListManager}());Design.ListManager=ListManager})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var LogicDependency=(function(){function LogicDependency(item,dependencyType){this.item=item;this.dependencyType=dependencyType}return LogicDependency}());Design.LogicDependency=LogicDependency;var DependencyType;(function(DependencyType){DependencyType[DependencyType["Condition"]=0]="Condition";DependencyType[DependencyType["AutoAnswer"]=1]="AutoAnswer";DependencyType[DependencyType["Rule"]=2]="Rule";DependencyType[DependencyType["ActionAttribute"]=3]="ActionAttribute";DependencyType[DependencyType["EscalationAttribute"]=4]="EscalationAttribute";DependencyType[DependencyType["QuestionReference"]=5]="QuestionReference";DependencyType[DependencyType["CustomQuestionInput"]=6]="CustomQuestionInput";DependencyType[DependencyType["ValidationRule"]=7]="ValidationRule";DependencyType[DependencyType["FragmentInput"]=8]="FragmentInput";DependencyType[DependencyType["AvailableOutput"]=9]="AvailableOutput";DependencyType[DependencyType["Properties"]=10]="Properties";DependencyType[DependencyType["ProtectedField"]=11]="ProtectedField";DependencyType[DependencyType["Template"]=12]="Template"})(DependencyType=Design.DependencyType||(Design.DependencyType={}))})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var DependencyHelper=(function(){function DependencyHelper(){}DependencyHelper.getLogicDependencies=function(wizard,parent,removeDependencies){if(parent instanceof Design.TreeNode){var parentNode=parent;if(parentNode.tag instanceof Intelledox.QAWizard.Design.Action){return this.getLogicDependenciesAction(wizard,parentNode.tag,removeDependencies)}else if(parentNode.tag instanceof Intelledox.QAWizard.Design.FragmentReference){return this.getLogicDependenciesInternal(wizard,parentNode.getSelfAndChildTags(function(childNode){return childNode.tag instanceof Intelledox.QAWizard.Design.FragmentReference}),null,removeDependencies,parentNode.getSelfAndChildTags(function(childNode){return childNode.tag instanceof Intelledox.QAWizard.Design.FragmentOutput}))}else{return this.getLogicDependenciesInternal(wizard,parentNode.getSelfAndChildTags(function(childNode){return childNode.tag instanceof Intelledox.QAWizard.Design.Question}),null,removeDependencies,[])}}else if(parent instanceof Intelledox.QAWizard.Design.Answer){return this.getLogicDependenciesAnswer(wizard,parent,removeDependencies)}else if(parent instanceof Intelledox.QAWizard.Design.Question){return this.getLogicDependenciesQuestion(wizard,parent,removeDependencies)}else if(parent instanceof Intelledox.QAWizard.Design.Action){return this.getLogicDependenciesAction(wizard,parent,removeDependencies)}else{return[]}};DependencyHelper.getLogicDependenciesAnswer=function(wizard,parent,removeDependencies){var parentQuestions=new Array;parentQuestions.push(parent.Question);return this.getLogicDependenciesInternal(wizard,parentQuestions,parent,removeDependencies,[])};DependencyHelper.getLogicDependenciesQuestion=function(wizard,parent,removeDependencies){var parentQuestions=new Array;parentQuestions.push(parent);return this.getLogicDependenciesInternal(wizard,parentQuestions,null,removeDependencies,[])};DependencyHelper.getLogicDependenciesAction=function(wizard,parent,removeDependencies){var foundItems=new Array;for(var i=0;i<wizard.Actions.length;i++){this.getLogicDependenciesFromAction(wizard,foundItems,wizard.Actions[i],parent,removeDependencies)}return foundItems};DependencyHelper.getLogicDependenciesFromActionParents=function(wizard,foundItems,a,parents,parentAnswer,removeDependencies){this.getLogicDependanciesClause(foundItems,a,a.Conditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,[]);this.checkAttributes(foundItems,a,parents,parentAnswer,Design.DependencyType.ActionAttribute,a.ActionInputs);for(var i=0;i<a.Children.length;i++){this.getLogicDependenciesFromActionParents(wizard,foundItems,a.Children[i],parents,parentAnswer,removeDependencies)}};DependencyHelper.getLogicDependenciesFromAction=function(wizard,foundItems,a,parent,removeDependencies){this.getLogicDependanciesClauseAction(foundItems,a,a.Conditions,parent,removeDependencies,Design.DependencyType.Condition);this.checkAttributesAction(foundItems,a,parent,Design.DependencyType.ActionAttribute,a.ActionInputs);for(var i=0;i<a.Children.length;i++){this.getLogicDependenciesFromAction(wizard,foundItems,a.Children[i],parent,removeDependencies)}};DependencyHelper.getLogicDependenciesInternal=function(wizard,parents,parentAnswer,removeDependencies,fragmentOutputs){var foundItems=new Array;var childList;for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var p=wizard.Pages[pageIndex];this.getLogicDependanciesClause(foundItems,p,p.ActiveConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,p,p.VisibleConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,p,p.EditableConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.checkTextValues(foundItems,p,p.MaximumRepeats,parents,parentAnswer,Design.DependencyType.QuestionReference);this.checkTextValues(foundItems,p,p.MinimumRepeats,parents,parentAnswer,Design.DependencyType.QuestionReference);if(p instanceof Intelledox.QAWizard.Design.FragmentPage){this.checkAttributes(foundItems,p,parents,parentAnswer,Design.DependencyType.FragmentInput,p.Inputs)}childList=wizard.GetChildrenOfType(p,function(child){return child instanceof Intelledox.QAWizard.Design.Section});for(var sectionIndex=0;sectionIndex<childList.length;sectionIndex++){var sectionChild=childList[sectionIndex];this.getLogicDependanciesClause(foundItems,sectionChild,sectionChild.ActiveConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,sectionChild,sectionChild.VisibleConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,sectionChild,sectionChild.EditableConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.checkTextValues(foundItems,sectionChild,sectionChild.Description,parents,parentAnswer,Design.DependencyType.QuestionReference);this.checkTextValues(foundItems,sectionChild,sectionChild.MaximumRepeats,parents,parentAnswer,Design.DependencyType.QuestionReference);this.checkTextValues(foundItems,sectionChild,sectionChild.MinimumRepeats,parents,parentAnswer,Design.DependencyType.QuestionReference)}childList=wizard.GetChildrenOfType(p,function(child){return child instanceof Intelledox.QAWizard.Design.Column});for(var columnIndex=0;columnIndex<childList.length;columnIndex++){var columnChild=childList[columnIndex];this.getLogicDependanciesClause(foundItems,columnChild,columnChild.ActiveConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,columnChild,columnChild.VisibleConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,columnChild,columnChild.EditableConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs)}childList=wizard.GetChildrenOfType(p,function(child){return child instanceof Intelledox.QAWizard.Design.TabGroup});for(var tabGroupIndex=0;tabGroupIndex<childList.length;tabGroupIndex++){var tabGroupChild=childList[tabGroupIndex];this.getLogicDependanciesClause(foundItems,tabGroupChild,tabGroupChild.ActiveConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,tabGroupChild,tabGroupChild.VisibleConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,tabGroupChild,tabGroupChild.EditableConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs)}childList=wizard.GetChildrenOfType(p,function(child){return child instanceof Intelledox.QAWizard.Design.TabPage});for(var tabPageIndex=0;tabPageIndex<childList.length;tabPageIndex++){var tabPageChild=childList[tabPageIndex];this.getLogicDependanciesClause(foundItems,tabPageChild,tabPageChild.ActiveConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,tabPageChild,tabPageChild.VisibleConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,tabPageChild,tabPageChild.EditableConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs)}childList=wizard.GetChildrenOfType(p,function(child){return child instanceof Intelledox.QAWizard.Design.FragmentReference});for(var fragmentIndex=0;fragmentIndex<childList.length;fragmentIndex++){var fragmentChild=childList[fragmentIndex];this.checkAttributes(foundItems,fragmentChild,parents,parentAnswer,Design.DependencyType.FragmentInput,fragmentChild.Inputs);this.getLogicDependanciesClause(foundItems,fragmentChild,fragmentChild.ActiveConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,fragmentChild,fragmentChild.VisibleConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,fragmentChild,fragmentChild.EditableConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.checkAttributes(foundItems,fragmentChild,parents,parentAnswer,Design.DependencyType.FragmentInput,fragmentChild.Inputs)}childList=p.Questions;for(var questionIndex=0;questionIndex<childList.length;questionIndex++){var q=childList[questionIndex];if(parents.indexOf(q)===-1){this.getLogicDependanciesClause(foundItems,q,q.ActiveConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,q,q.VisibleConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,q,q.EditableConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.getLogicDependanciesClause(foundItems,q,q.MandatoryConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.checkTextValues(foundItems,q,q.DefaultValue,parents,parentAnswer,Design.DependencyType.QuestionReference);this.checkTextValues(foundItems,q,q.HelpText,parents,parentAnswer,Design.DependencyType.QuestionReference);this.checkTextValues(foundItems,q,q.Text,parents,parentAnswer,Design.DependencyType.QuestionReference);for(var answerIndex=0;answerIndex<q.Answers.length;answerIndex++){var a=q.Answers[answerIndex];this.getLogicDependanciesClause(foundItems,a,a.ActiveConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);if(a instanceof Intelledox.QAWizard.Design.GroupLogicAnswer){this.checkTextValues(foundItems,a,a.DisplayText,parents,parentAnswer,Design.DependencyType.QuestionReference)}if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable){this.checkTextValues(foundItems,a,a.Formula,parents,parentAnswer,Design.DependencyType.QuestionReference)}if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic){this.getLogicDependanciesClause(foundItems,a,a.Rules,parents,parentAnswer,removeDependencies,Design.DependencyType.Rule,fragmentOutputs)}if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.checkTextValues(foundItems,a,a.Formula,parents,parentAnswer,Design.DependencyType.QuestionReference)}if(!System.String.IsNullOrEmpty(a.ImageSettings.AlternativeText)){this.checkTextValues(foundItems,a,a.ImageSettings.AlternativeText,parents,parentAnswer,Design.DependencyType.QuestionReference)}if(a.HasContentItems){for(var contentIndex=0;contentIndex<a.ContentItems.length;contentIndex++){this.checkTextValues(foundItems,a,a.ContentItems[contentIndex].ImageSettings.AlternativeText,parents,parentAnswer,Design.DependencyType.QuestionReference)}}}if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.getLogicDependanciesClause(foundItems,q,q.Filters,parents,parentAnswer,removeDependencies,Design.DependencyType.AutoAnswer,fragmentOutputs)}else if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator){this.getLogicDependanciesClause(foundItems,q,q.ValidationRule,parents,parentAnswer,removeDependencies,Design.DependencyType.QuestionReference,fragmentOutputs)}else if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom){this.checkAttributes(foundItems,q,parents,parentAnswer,Design.DependencyType.CustomQuestionInput,q.Inputs)}else if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart){this.checkSelectedReferences(foundItems,q,parents,removeDependencies)}}}}for(var fieldIndex=0;fieldIndex<wizard.ProtectedFields.length;fieldIndex++){var field=wizard.ProtectedFields[fieldIndex];this.checkTextValues(foundItems,field,field.Reference,parents,parentAnswer,Design.DependencyType.ProtectedField)}for(var docIndex=0;docIndex<wizard.Documents.length;docIndex++){var doc=wizard.Documents[docIndex];this.getLogicDependanciesClause(foundItems,doc,doc.Conditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,fragmentOutputs);this.checkTextValues(foundItems,doc,doc.FileName,parents,parentAnswer,Design.DependencyType.QuestionReference);this.getLogicDependanciesTemplate(foundItems,doc,parents,removeDependencies)}for(var actionIndex=0;actionIndex<wizard.Actions.length;actionIndex++){this.getLogicDependenciesFromActionParents(wizard,foundItems,wizard.Actions[actionIndex],parents,parentAnswer,removeDependencies)}var fullStates=wizard.Workflow.FullStateList;for(var stateIndex=0;stateIndex<fullStates.length;stateIndex++){var s=fullStates[stateIndex];for(var tranIndex=0;tranIndex<s.Transitions.length;tranIndex++){var tran=s.Transitions[tranIndex];this.getLogicDependanciesClause(foundItems,tran,tran.Conditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,[]);this.checkTextValues(foundItems,tran,tran.EmailText,parents,parentAnswer,Design.DependencyType.QuestionReference);this.checkTextValues(foundItems,tran,tran.EmailSubject,parents,parentAnswer,Design.DependencyType.QuestionReference);this.checkTextValues(foundItems,tran,tran.HelpText,parents,parentAnswer,Design.DependencyType.QuestionReference);this.checkTextValues(foundItems,tran,tran.PageTitle,parents,parentAnswer,Design.DependencyType.QuestionReference);this.checkTextValues(foundItems,tran,tran.DefaultComment,parents,parentAnswer,Design.DependencyType.QuestionReference);for(var tranActionIndex=0;tranActionIndex<tran.Actions.length;tranActionIndex++){var tranAction=tran.Actions[tranActionIndex];this.getLogicDependanciesClause(foundItems,tranAction,tranAction.Conditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,[]);this.checkAttributes(foundItems,tranAction,parents,parentAnswer,Design.DependencyType.ActionAttribute,tranAction.ActionInputs)}}for(var escalationIndex=0;escalationIndex<s.EscalationList.length;escalationIndex++){var e=s.EscalationList[escalationIndex];this.getLogicDependanciesClause(foundItems,e,e.Conditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,[]);this.checkAttributes(foundItems,e,parents,parentAnswer,Design.DependencyType.EscalationAttribute,e.EscalationInputs)}}this.getLogicDependanciesClause(foundItems,Intelledox.Common.ConstantValues.FINISHPAGETAG,wizard.FinishPageConditions,parents,parentAnswer,removeDependencies,Design.DependencyType.Condition,[]);for(var outputIndex=0;outputIndex<wizard.AvailableOutputs.length;outputIndex++){var output=wizard.AvailableOutputs[outputIndex];for(var parentIndex=0;parentIndex<parents.length;parentIndex++){var parent=parents[parentIndex];if(parent instanceof Intelledox.QAWizard.Design.Question){if(parent.QuestionGuid===output.SourceGuid){foundItems.push(new Design.LogicDependency(output,Design.DependencyType.AvailableOutput))}}}}return foundItems};DependencyHelper.getLogicDependanciesClause=function(foundItems,item,clauses,parents,parentAnswer,removeDependencies,dependencyType,fragmentOutputs){var questionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;var answerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(clauses==null){return}var clauseList=this.getClauseList(clauses);for(var clauseIndex=0;clauseIndex<clauseList.length;clauseIndex++){var clause=clauseList[clauseIndex];if(clause instanceof Intelledox.QAWizard.Design.Condition){var cond=clause;if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.State){continue}else if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Action){continue}else{questionGuid=cond.ParentItemGuid;answerGuid=cond.ParentAttributeGuid}}else if(clause instanceof Intelledox.QAWizard.Design.Rule){var rule=clause;questionGuid=rule.ParentItemGuid;answerGuid=rule.ParentAttributeGuid;this.checkTextValues(foundItems,item,rule.Formula,parents,parentAnswer,Design.DependencyType.QuestionReference);this.checkTextValues(foundItems,item,rule.CompareTo,parents,parentAnswer,Design.DependencyType.QuestionReference)}else if(clause instanceof Intelledox.QAWizard.Design.ValidationRule){var vRule=clause;if(vRule.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var parentIndex=0;parentIndex<parents.length;parentIndex++){var parent=parents[parentIndex];if(parent instanceof Intelledox.QAWizard.Design.Question){if(vRule.QuestionGuid===parent.QuestionGuid){foundItems.push(new Design.LogicDependency(item,Design.DependencyType.ValidationRule));break}}}}if(item instanceof Intelledox.QAWizard.Design.Question){this.checkTextValues(foundItems,item,vRule.Expression,parents,parentAnswer,Design.DependencyType.QuestionReference)}else if(item instanceof Intelledox.QAWizard.Design.Answer){this.checkTextValues(foundItems,item,vRule.Expression,parents,parentAnswer,Design.DependencyType.QuestionReference)}}else if(clause instanceof Intelledox.QAWizard.Design.Filter){var filter=clause;if(filter.ParentType===Intelledox.QAWizard.Design.FilterParentType.Reference){questionGuid=filter.ParentItemGuid;answerGuid=filter.ParentAttributeGuid}else{continue}}else{continue}for(var parentIndex=0;parentIndex<parents.length;parentIndex++){var parent=parents[parentIndex];if(parent.QuestionGuid===questionGuid){if(parentAnswer==null||answerGuid===parentAnswer.AnswerGuid){foundItems.push(new Design.LogicDependency(item,dependencyType));if(removeDependencies){this.removeClause(clause,clauses)}}}}for(var outputIndex=0;outputIndex<fragmentOutputs.length;outputIndex++){var output=fragmentOutputs[outputIndex];if(output.OutputGuid===answerGuid){var fragmentReference=output.Parent;if(fragmentReference.FragmentGuid===questionGuid){foundItems.push(new Design.LogicDependency(item,dependencyType));if(removeDependencies){this.removeClause(clause,clauses)}}}}}};DependencyHelper.getLogicDependanciesClauseAction=function(foundItems,item,clauses,parent,removeDependencies,dependencyType){var clauseList=this.getClauseList(clauses);for(var clauseIndex=0;clauseIndex<clauseList.length;clauseIndex++){var clause=clauseList[clauseIndex];if(clause instanceof Intelledox.QAWizard.Design.Condition){var cond=clause;if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Action){if(parent.ActionGuid===cond.ParentItemGuid){foundItems.push(new Design.LogicDependency(item,dependencyType))}if(removeDependencies){this.removeClause(clause,clauses)}}}else{}}};DependencyHelper.getClauseList=function(c){var clauseList=new Array;if(c.Type===Intelledox.Model.ClauseType.Comparison){clauseList.push(c)}for(var subClauseIndex=0;subClauseIndex<c.SubClauses.length;subClauseIndex++){var childrenClauses=this.getClauseList(c.SubClauses[subClauseIndex]);for(var childrenClauseIndex=0;childrenClauseIndex<childrenClauses.length;childrenClauseIndex++){clauseList.push(childrenClauses[childrenClauseIndex])}}return clauseList};DependencyHelper.getLogicDependanciesTemplate=function(foundItems,doc,parents,removeDependencies){if(doc.RepeatSourceType!==Intelledox.QAWizard.Design.RepeatSourceType.None){for(var parentIndex=0;parentIndex<parents.length;parentIndex++){var remQuestion=parents[parentIndex];if(remQuestion.QuestionGuid===doc.RepeatSourceGuid){foundItems.push(new Design.LogicDependency(doc,Design.DependencyType.Template));if(removeDependencies){doc.RepeatSourceType=Intelledox.QAWizard.Design.RepeatSourceType.None}}}}};DependencyHelper.checkAttributes=function(foundItems,item,parents,parentAnswer,dependencyType,attributes){for(var attributeIndex=0;attributeIndex<attributes.length;attributeIndex++){var attribute=attributes[attributeIndex];for(var parentIndex=0;parentIndex<parents.length;parentIndex++){var parent=parents[parentIndex];if(parent instanceof Intelledox.QAWizard.Design.Question){if(parent.QuestionGuid===attribute.SourceGuid){foundItems.push(new Design.LogicDependency(item,dependencyType))}}else if(parent instanceof Intelledox.QAWizard.Design.FragmentReference){if(parent.FragmentGuid===attribute.SourceGuid){foundItems.push(new Design.LogicDependency(item,dependencyType))}}}this.checkTextValues(foundItems,item,attribute.FixedValue,parents,parentAnswer,dependencyType)}};DependencyHelper.checkAttributesAction=function(foundItems,item,parent,dependencyType,attributes){for(var attributeIndex=0;attributeIndex<attributes.length;attributeIndex++){this.checkTextValuesAction(foundItems,item,attributes[attributeIndex].FixedValue,parent,dependencyType)}};DependencyHelper.checkSelectedReferences=function(foundItems,item,parents,removeDependencies){for(var parentIndex=0;parentIndex<parents.length;parentIndex++){var parentQuestion=parents[parentIndex];if(item instanceof Intelledox.QAWizard.Design.AutoLogicQuestion){var autoLogicQuestion=item;if(autoLogicQuestion.RepeatParent!==Intelledox.Common.ConstantValues.GUID_EMPTY&&autoLogicQuestion.RepeatParent===parentQuestion.QuestionGuid){foundItems.push(new Design.LogicDependency(autoLogicQuestion,Design.DependencyType.AutoAnswer));if(removeDependencies){autoLogicQuestion.RepeatParent=Intelledox.Common.ConstantValues.GUID_EMPTY}}}else if(item instanceof Intelledox.QAWizard.Design.ChartQuestion){var chartQuestion=item;for(var seriesIndex=0;seriesIndex<chartQuestion.Chart.Series.length;seriesIndex++){if(chartQuestion.Chart.Series[seriesIndex].DataQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&chartQuestion.Chart.Series[seriesIndex].DataQuestionGuid===parentQuestion.QuestionGuid){foundItems.push(new Design.LogicDependency(chartQuestion,Design.DependencyType.AutoAnswer));if(removeDependencies){chartQuestion.Chart.Series[seriesIndex].DataQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;chartQuestion.Chart.Series[seriesIndex].CategoriesAnswer=Intelledox.Common.ConstantValues.GUID_EMPTY;chartQuestion.Chart.Series[seriesIndex].ValueAnswer=Intelledox.Common.ConstantValues.GUID_EMPTY}}}}else if(item instanceof Intelledox.QAWizard.Design.GroupLogicQuestion){var groupLogicQuestion=item;if(groupLogicQuestion.DisplayType!==Intelledox.Model.QuestionDisplayType.MultiSelect&&groupLogicQuestion.DisplayType!==Intelledox.Model.QuestionDisplayType.MultiSelectToggleButton&&groupLogicQuestion.DefaultQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY&&groupLogicQuestion.DefaultQuestionReference===parentQuestion.QuestionGuid){for(var answerIndex=0;answerIndex<groupLogicQuestion.Answers.length;answerIndex++){foundItems.push(new Design.LogicDependency(groupLogicQuestion.Answers[answerIndex],Design.DependencyType.QuestionReference));if(removeDependencies){groupLogicQuestion.DefaultQuestionReference=Intelledox.Common.ConstantValues.GUID_EMPTY;groupLogicQuestion.DefaultValue=Intelledox.Common.ConstantValues.GUID_EMPTY}}}else if(groupLogicQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelect||groupLogicQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelectToggleButton){for(var answerIndex=0;answerIndex<groupLogicQuestion.Answers.length;answerIndex++){var groupLogicAnswer=groupLogicQuestion.Answers[answerIndex];if(groupLogicAnswer.DefaultQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY&&groupLogicAnswer.DefaultQuestionReference==parentQuestion.QuestionGuid){foundItems.push(new Design.LogicDependency(groupLogicAnswer,Design.DependencyType.QuestionReference));if(removeDependencies){groupLogicAnswer.DefaultQuestionReference=Intelledox.Common.ConstantValues.GUID_EMPTY;groupLogicAnswer.DefaultAnswerReference=Intelledox.Common.ConstantValues.GUID_EMPTY}}}}}}};DependencyHelper.checkTextValues=function(foundItems,item,text,parents,parentAnswer,dependencyType){var expressions=Intelledox.Common.Functions.ParseExpressions(text);for(var expIndex=0;expIndex<expressions.length;expIndex++){var reference=expressions[expIndex];var isFragRef=false;if(System.String.StartsWithIgnoreCase(reference,"["+Intelledox.Common.ConstantValues.PREVIOUS+".")){var previousLength=Intelledox.Common.ConstantValues.PREVIOUS.length+2;reference="["+System.String.Substring(reference,previousLength,reference.length-previousLength)}else if(System.String.StartsWithIgnoreCase(reference,"["+Intelledox.Common.ConstantValues.PROTECT+".")){var protectLength=Intelledox.Common.ConstantValues.PROTECT.length+2;reference="["+System.String.Substring(reference,protectLength,reference.length-protectLength)}else if(System.String.StartsWithIgnoreCase(reference,"["+Intelledox.Common.ConstantValues.CHOICE+".")&&System.String.EndsWith(reference,']')){var choiceLength=Intelledox.Common.ConstantValues.CHOICE.length+2;reference="["+System.String.Substring(reference,choiceLength,reference.length-choiceLength)}else if(System.String.StartsWithIgnoreCase(reference,"["+Intelledox.Common.ConstantValues.FRAGMENT+".")&&System.String.EndsWith(reference,']')){var fragmentLength=Intelledox.Common.ConstantValues.FRAGMENT.length+2;reference="["+System.String.Substring(reference,fragmentLength,reference.length-fragmentLength);isFragRef=true}if(isFragRef){var refFrag=Intelledox.Common.Functions.ExtractFragmentReference(reference);for(var parentIndex=0;parentIndex<parents.length;parentIndex++){var fragment=parents[parentIndex];if(fragment instanceof Intelledox.QAWizard.Design.FragmentReference){if(Intelledox.Common.Functions.EqualsIgnoreCase(fragment.Name,refFrag.fragmentRef)){foundItems.push(new Design.LogicDependency(item,dependencyType))}}}}else{var refVal=Intelledox.Common.Functions.ExtractQuestionReference(reference);if(Intelledox.Common.Functions.IsUInt(refVal.questionRef)){var refId=parseInt(refVal.questionRef,10);for(var parentIndex=0;parentIndex<parents.length;parentIndex++){var question=parents[parentIndex];if(refId===question.ID){if(parentAnswer!=null){if(!refVal.hasAnswerRef){continue}var answerRef=Intelledox.QAWizard.Design.AnswerExpressionBuilder.ExtractAnswerRef(reference);var isAnswerId=Intelledox.Common.Functions.IsUInt(answerRef);if((isAnswerId&&parentAnswer.ID===parseInt(answerRef,10))||(!isAnswerId&&Intelledox.Common.Functions.EqualsIgnoreCase(parentAnswer.Name,answerRef))){foundItems.push(new Design.LogicDependency(item,dependencyType))}}else{foundItems.push(new Design.LogicDependency(item,dependencyType))}}}}}}};DependencyHelper.checkTextValuesAction=function(foundItems,item,text,parent,dependencyType){var expressions=Intelledox.Common.Functions.ParseExpressions(text);for(var expIndex=0;expIndex<expressions.length;expIndex++){var ex=expressions[expIndex];var refVal=Intelledox.Common.Functions.ExtractActionReference(ex);if(Intelledox.Common.Functions.EqualsIgnoreCase(refVal,parent.Name)){foundItems.push(new Design.LogicDependency(item,dependencyType))}}};DependencyHelper.removeClause=function(c,nodes){if(c===nodes){c.Type=Intelledox.Model.ClauseType.Basic;return}for(var i=0;i<nodes.SubClauses.length;i++){if(c===nodes.SubClauses[i]){nodes.SubClauses.splice(i,1);return}else{this.removeClause(c,nodes.SubClauses[i])}}};return DependencyHelper}());Design.DependencyHelper=DependencyHelper})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var ContentItem=(function(){function ContentItem(){this.contentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.name=null;this.description='';this.contentTypeId=Model.ContentType.None;this.sizeScale=0;this.categoryId=0;this.extension=null;this.alternativeText=null}return ContentItem}());Model.ContentItem=ContentItem})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var ActionOutput=(function(){function ActionOutput(){this.name=null;this.id=Intelledox.Common.ConstantValues.GUID_EMPTY;this.value=null}return ActionOutput}());Model.ActionOutput=ActionOutput})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var Variable=(function(){function Variable(name,typeId){this.name=name;this.typeId=typeId}return Variable}());Model.Variable=Variable})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var InfinitiClipboard=(function(){function InfinitiClipboard(){}InfinitiClipboard.clear=function(){this.clauseCopy=null};InfinitiClipboard.clauseCopy=null;return InfinitiClipboard}());Design.InfinitiClipboard=InfinitiClipboard})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var Settings=(function(){function Settings(){}Object.defineProperty(Settings.prototype,"isTreeViewVisible",{get:function(){var value=localStorage.getItem('isTreeViewVisible');if(value==null||value===''){return true}return(value==='true')},set:function(value){localStorage.setItem('isTreeViewVisible',value?'true':'false')},enumerable:true,configurable:true});Object.defineProperty(Settings.prototype,"isPreviewVisible",{get:function(){var value=localStorage.getItem('isPreviewVisible');if(value==null||value===''){return true}return(value==='true')},set:function(value){localStorage.setItem('isPreviewVisible',value?'true':'false')},enumerable:true,configurable:true});Object.defineProperty(Settings.prototype,"leftPanelSize",{get:function(){var value=localStorage.getItem('leftPanelSize');if(value==null||value===''){return 300}return parseInt(value,10)},set:function(value){localStorage.setItem('leftPanelSize',value.toString())},enumerable:true,configurable:true});Object.defineProperty(Settings.prototype,"rightPanelSize",{get:function(){var value=localStorage.getItem('rightPanelSize');if(value==null||value===''){return 400}return parseInt(value,10)},set:function(value){localStorage.setItem('rightPanelSize',value.toString())},enumerable:true,configurable:true});Object.defineProperty(Settings.prototype,"toolboxSelection",{get:function(){var value=localStorage.getItem('toolboxSelection');if(value==null||value===''){return'|common|'}return value},set:function(value){localStorage.setItem('toolboxSelection',value)},enumerable:true,configurable:true});return Settings}());Design.Settings=Settings;angular.module("Design").service("settings",[Settings]);angular.module("Startup").service("settings",[Settings])})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var HierarchyHelper=(function(){function HierarchyHelper(){}HierarchyHelper.getDataFields=function(wizard,listManager,currentQuestion,dropDownWidth,includeAdhocFields){var rootDataSource=currentQuestion.GetRootDatasourceQuestion(wizard);var path=currentQuestion.DataSourceRepeatXPath;if(path==null){path=''}return listManager.dataFieldsList(rootDataSource.DataObjectGuid,dropDownWidth,includeAdhocFields,path)};HierarchyHelper.getKeyFields=function(wizard,listManager,currentQuestion,dropDownWidth){var rootDataSource=currentQuestion.GetRootDatasourceQuestion(wizard);var path=currentQuestion.DataSourceRepeatXPath;if(path==null){path=''}return listManager.keyFieldsList(rootDataSource.DataObjectGuid,dropDownWidth,path)};return HierarchyHelper}());Design.HierarchyHelper=HierarchyHelper})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var RoutingOption=(function(){function RoutingOption(){this.RoutingOptionId=0;this.RoutingTypeId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.RoutingOptionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.TemplateGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.ElementTypeId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.SourceType=0;this.SourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.SourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.FieldName='';this.FixedValue='';this.OutputValue='';this.Key='';this.TypeValue='';this.ChildInputs=null}RoutingOption.prototype.Clone=function(){var result=new RoutingOption;this.CloneInternal(result);return result};RoutingOption.prototype.CloneInternal=function(result){result.SourceAttributeGuid=this.SourceAttributeGuid;result.ElementTypeId=this.ElementTypeId;result.FieldName=this.FieldName;result.FixedValue=this.FixedValue;result.OutputValue=this.OutputValue;result.SourceGuid=this.SourceGuid;result.RoutingOptionGuid=this.RoutingOptionGuid;result.RoutingOptionId=this.RoutingOptionId;result.RoutingTypeId=this.RoutingTypeId;result.SourceType=this.SourceType;result.TemplateGuid=this.TemplateGuid;result.Key=this.Key;result.TypeValue=this.TypeValue;if(this.ChildInputs!=null){result.ChildInputs=[];for(var i=0;i<this.ChildInputs.length;i++){result.ChildInputs.push(this.ChildInputs[i].Clone())}}};return RoutingOption}());Model.RoutingOption=RoutingOption})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var RoutingType=(function(){function RoutingType(){this.routingTypeId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.description=null;this.supportsUI=false;this.supportsRun=false;this.supportsRecurring=false;this.runForAllProjects=false;this.moduleId=null;this.usesDocuments=Model.DocumentUsage.Always}return RoutingType}());Model.RoutingType=RoutingType})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var ActionDocument=(function(){function ActionDocument(){this.DocumentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Type=Model.ActionDocumentType.Document;this.Format=Model.OutputType.None}ActionDocument.prototype.Clone=function(){var result=new ActionDocument;result.DocumentGuid=this.DocumentGuid;result.Type=this.Type;result.Format=this.Format;return result};return ActionDocument}());Model.ActionDocument=ActionDocument})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var GeneralFunctions=(function(){function GeneralFunctions(){}GeneralFunctions.ToBool=function(inputValue){try{if(typeof inputValue==='string'){if(inputValue==="True"||inputValue==="1"){return true}if(inputValue==="False"||inputValue==="0"){return false}inputValue=inputValue.trim();if(inputValue==="true"||inputValue==="t"||inputValue==="T"||inputValue==="yes"||inputValue==="Yes"||inputValue==="y"||inputValue==="Y"){return true}if(inputValue==="false"||inputValue==="f"||inputValue==="F"||inputValue==="no"||inputValue==="No"||inputValue==="n"||inputValue==="N"){return false}}if(typeof inputValue==='boolean'){return inputValue}else if(inputValue===0){return false}else if(inputValue===1){return true}}catch(ex){return false}return false};GeneralFunctions.NewGuid=function(){var d=(new Date).getTime();var uuid='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function guidCreate(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c==='x'?r:(r&0x3|0x8)).toString(16)});return uuid};GeneralFunctions.ToDateTime=function(value){return new Date(value.replace(/-/g,"/"))};GeneralFunctions.FromBool=function(value){if(value){return"True"}else{return"False"}};GeneralFunctions.ReplaceIgnoreCase=function(source,find,replace){find=find.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var reg=new RegExp(find,'ig');return source.replace(reg,replace)};return GeneralFunctions}());Design.GeneralFunctions=GeneralFunctions})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var TextPosition;(function(TextPosition){TextPosition[TextPosition["Top"]=0]="Top";TextPosition[TextPosition["Left"]=1]="Left";TextPosition[TextPosition["None"]=2]="None"})(TextPosition=Design.TextPosition||(Design.TextPosition={}));var MandatoryType;(function(MandatoryType){MandatoryType[MandatoryType["No"]=0]="No";MandatoryType[MandatoryType["Yes"]=1]="Yes";MandatoryType[MandatoryType["Conditional"]=2]="Conditional"})(MandatoryType=Design.MandatoryType||(Design.MandatoryType={}));var WidthType;(function(WidthType){WidthType[WidthType["Percentage"]=7]="Percentage";WidthType[WidthType["Pixel"]=1]="Pixel"})(WidthType=Design.WidthType||(Design.WidthType={}));var ValidationErrorType;(function(ValidationErrorType){ValidationErrorType[ValidationErrorType["None"]=0]="None";ValidationErrorType[ValidationErrorType["PlaceholderNotFound"]=1]="PlaceholderNotFound";ValidationErrorType[ValidationErrorType["ContentItemNotFound"]=2]="ContentItemNotFound";ValidationErrorType[ValidationErrorType["DataSourceNotFound"]=3]="DataSourceNotFound";ValidationErrorType[ValidationErrorType["DataObjectNotFound"]=4]="DataObjectNotFound";ValidationErrorType[ValidationErrorType["DataFieldNotFound"]=5]="DataFieldNotFound";ValidationErrorType[ValidationErrorType["BadFormulaReference"]=6]="BadFormulaReference";ValidationErrorType[ValidationErrorType["InvalidDynamicAnswering"]=7]="InvalidDynamicAnswering";ValidationErrorType[ValidationErrorType["InvalidParentQuestionOrder"]=8]="InvalidParentQuestionOrder";ValidationErrorType[ValidationErrorType["InvalidParentQuestionSamePage"]=9]="InvalidParentQuestionSamePage";ValidationErrorType[ValidationErrorType["AnswerNotFound"]=10]="AnswerNotFound";ValidationErrorType[ValidationErrorType["NoDisplayField"]=11]="NoDisplayField";ValidationErrorType[ValidationErrorType["InvalidDataFilter"]=12]="InvalidDataFilter";ValidationErrorType[ValidationErrorType["InvalidDisplayField"]=13]="InvalidDisplayField";ValidationErrorType[ValidationErrorType["InvalidSortField"]=14]="InvalidSortField";ValidationErrorType[ValidationErrorType["BadFormula"]=15]="BadFormula";ValidationErrorType[ValidationErrorType["PlaceholderFromRemovedDocument"]=16]="PlaceholderFromRemovedDocument";ValidationErrorType[ValidationErrorType["BadFormulaReferenceDefaultValue"]=17]="BadFormulaReferenceDefaultValue";ValidationErrorType[ValidationErrorType["BadFormulaDefaultValue"]=18]="BadFormulaDefaultValue";ValidationErrorType[ValidationErrorType["BadFormulaReferenceRepeatTitle"]=19]="BadFormulaReferenceRepeatTitle";ValidationErrorType[ValidationErrorType["BadFormulaRepeatTitle"]=20]="BadFormulaRepeatTitle";ValidationErrorType[ValidationErrorType["BadFormulaReferenceSectionDescription"]=21]="BadFormulaReferenceSectionDescription";ValidationErrorType[ValidationErrorType["BadFormulaSectionDescription"]=22]="BadFormulaSectionDescription";ValidationErrorType[ValidationErrorType["BadFormulaReferenceQuestionText"]=23]="BadFormulaReferenceQuestionText";ValidationErrorType[ValidationErrorType["BadFormulaQuestionText"]=24]="BadFormulaQuestionText";ValidationErrorType[ValidationErrorType["BadFormulaReferenceValidationValue"]=25]="BadFormulaReferenceValidationValue";ValidationErrorType[ValidationErrorType["BadFormulaReferenceEscalationAttribute"]=26]="BadFormulaReferenceEscalationAttribute";ValidationErrorType[ValidationErrorType["BadFormulaReferenceMaximumRepeats"]=27]="BadFormulaReferenceMaximumRepeats";ValidationErrorType[ValidationErrorType["BadFormulaReferenceMinimumRepeats"]=28]="BadFormulaReferenceMinimumRepeats";ValidationErrorType[ValidationErrorType["ParentAnswerDeleted"]=29]="ParentAnswerDeleted";ValidationErrorType[ValidationErrorType["InvalidParentQuestionOrderRule"]=30]="InvalidParentQuestionOrderRule";ValidationErrorType[ValidationErrorType["ParentAnswerDeletedRule"]=31]="ParentAnswerDeletedRule";ValidationErrorType[ValidationErrorType["BadFormulaReferenceRule"]=32]="BadFormulaReferenceRule";ValidationErrorType[ValidationErrorType["BadFormulaReferenceMessage"]=33]="BadFormulaReferenceMessage";ValidationErrorType[ValidationErrorType["BadFormulaRule"]=34]="BadFormulaRule";ValidationErrorType[ValidationErrorType["InvalidParentQuestion"]=35]="InvalidParentQuestion";ValidationErrorType[ValidationErrorType["DuplicateUniqueLabel"]=36]="DuplicateUniqueLabel";ValidationErrorType[ValidationErrorType["ContentFolderDeleted"]=37]="ContentFolderDeleted";ValidationErrorType[ValidationErrorType["ContentItemOnVisibleContentLibrary"]=38]="ContentItemOnVisibleContentLibrary";ValidationErrorType[ValidationErrorType["ExternalPlaceholderNotInContentItem"]=39]="ExternalPlaceholderNotInContentItem";ValidationErrorType[ValidationErrorType["RepeatPlaceholderNotFound"]=40]="RepeatPlaceholderNotFound";ValidationErrorType[ValidationErrorType["BadFormulaFinishGenerateButtonText"]=41]="BadFormulaFinishGenerateButtonText";ValidationErrorType[ValidationErrorType["BadFormulaFinishGeneratingText"]=42]="BadFormulaFinishGeneratingText";ValidationErrorType[ValidationErrorType["BadFormulaFinishDownloadPageTitle"]=43]="BadFormulaFinishDownloadPageTitle";ValidationErrorType[ValidationErrorType["BadFormulaFinishPageTitle"]=44]="BadFormulaFinishPageTitle";ValidationErrorType[ValidationErrorType["InvalidParentAction"]=45]="InvalidParentAction";ValidationErrorType[ValidationErrorType["InvalidParentState"]=46]="InvalidParentState";ValidationErrorType[ValidationErrorType["InvalidActionOrder"]=47]="InvalidActionOrder";ValidationErrorType[ValidationErrorType["RequiredAttributeNotFound"]=48]="RequiredAttributeNotFound";ValidationErrorType[ValidationErrorType["RequiredEscalationAttributeNotFound"]=49]="RequiredEscalationAttributeNotFound";ValidationErrorType[ValidationErrorType["ActionNotFound"]=50]="ActionNotFound";ValidationErrorType[ValidationErrorType["ParentQuestionDeleted"]=51]="ParentQuestionDeleted";ValidationErrorType[ValidationErrorType["NoRepeaterDefined"]=52]="NoRepeaterDefined";ValidationErrorType[ValidationErrorType["InvalidActionDocument"]=53]="InvalidActionDocument";ValidationErrorType[ValidationErrorType["BadFormulaAction"]=54]="BadFormulaAction";ValidationErrorType[ValidationErrorType["WorkflowQuestionReferenceIsRepeated"]=55]="WorkflowQuestionReferenceIsRepeated";ValidationErrorType[ValidationErrorType["WorkflowParentQuestionDeleted"]=56]="WorkflowParentQuestionDeleted";ValidationErrorType[ValidationErrorType["RepeatPlaceholderAlreadyUsed"]=57]="RepeatPlaceholderAlreadyUsed";ValidationErrorType[ValidationErrorType["BadFormulaCustomInput"]=58]="BadFormulaCustomInput";ValidationErrorType[ValidationErrorType["InvalidParentInput"]=59]="InvalidParentInput";ValidationErrorType[ValidationErrorType["InvalidParentFragment"]=60]="InvalidParentFragment";ValidationErrorType[ValidationErrorType["InvalidParentOutput"]=61]="InvalidParentOutput";ValidationErrorType[ValidationErrorType["BadFormulaFragmentInput"]=62]="BadFormulaFragmentInput";ValidationErrorType[ValidationErrorType["OutputNotFoundInFragment"]=63]="OutputNotFoundInFragment";ValidationErrorType[ValidationErrorType["BadUniqueField"]=64]="BadUniqueField";ValidationErrorType[ValidationErrorType["BadOnlineRedirectMessage"]=65]="BadOnlineRedirectMessage";ValidationErrorType[ValidationErrorType["BadOfflineRedirectMessage"]=66]="BadOfflineRedirectMessage";ValidationErrorType[ValidationErrorType["ResponseMetadataFieldNotFound"]=67]="ResponseMetadataFieldNotFound";ValidationErrorType[ValidationErrorType["ResponseMetadataFieldHasRepeatingParent"]=68]="ResponseMetadataFieldHasRepeatingParent";ValidationErrorType[ValidationErrorType["BadFormulaDisplayField"]=69]="BadFormulaDisplayField";ValidationErrorType[ValidationErrorType["DuplicateActionName"]=70]="DuplicateActionName"})(ValidationErrorType=Design.ValidationErrorType||(Design.ValidationErrorType={}));var ClauseComparisonType;(function(ClauseComparisonType){ClauseComparisonType[ClauseComparisonType["None"]=0]="None";ClauseComparisonType[ClauseComparisonType["Is"]=10]="Is";ClauseComparisonType[ClauseComparisonType["IsNot"]=11]="IsNot";ClauseComparisonType[ClauseComparisonType["Equals"]=1]="Equals";ClauseComparisonType[ClauseComparisonType["IsNotEqual"]=9]="IsNotEqual";ClauseComparisonType[ClauseComparisonType["GreaterThan"]=5]="GreaterThan";ClauseComparisonType[ClauseComparisonType["LessThan"]=7]="LessThan";ClauseComparisonType[ClauseComparisonType["GreaterThanOrEquals"]=6]="GreaterThanOrEquals";ClauseComparisonType[ClauseComparisonType["LessThanOrEquals"]=8]="LessThanOrEquals";ClauseComparisonType[ClauseComparisonType["Contains"]=4]="Contains"})(ClauseComparisonType=Design.ClauseComparisonType||(Design.ClauseComparisonType={}));var DataConvertType;(function(DataConvertType){DataConvertType[DataConvertType["None"]=0]="None";DataConvertType[DataConvertType["Date"]=1]="Date";DataConvertType[DataConvertType["Number"]=2]="Number";DataConvertType[DataConvertType["Image"]=3]="Image";DataConvertType[DataConvertType["Text"]=4]="Text";DataConvertType[DataConvertType["Html"]=5]="Html"})(DataConvertType=Design.DataConvertType||(Design.DataConvertType={}));var RuleParentType;(function(RuleParentType){RuleParentType[RuleParentType["Reference"]=0]="Reference";RuleParentType[RuleParentType["Formula"]=1]="Formula";RuleParentType[RuleParentType["Aggregate"]=2]="Aggregate";RuleParentType[RuleParentType["Input"]=3]="Input";RuleParentType[RuleParentType["FragmentOutput"]=4]="FragmentOutput";RuleParentType[RuleParentType["ProjectProperty"]=5]="ProjectProperty"})(RuleParentType=Design.RuleParentType||(Design.RuleParentType={}));var ConditionType;(function(ConditionType){ConditionType[ConditionType["Active"]=0]="Active";ConditionType[ConditionType["Visible"]=1]="Visible";ConditionType[ConditionType["Editable"]=2]="Editable";ConditionType[ConditionType["Repeat"]=3]="Repeat";ConditionType[ConditionType["Mandatory"]=4]="Mandatory"})(ConditionType=Design.ConditionType||(Design.ConditionType={}));var ConditionParentType;(function(ConditionParentType){ConditionParentType[ConditionParentType["Reference"]=0]="Reference";ConditionParentType[ConditionParentType["State"]=1]="State";ConditionParentType[ConditionParentType["Action"]=2]="Action";ConditionParentType[ConditionParentType["Input"]=3]="Input";ConditionParentType[ConditionParentType["FragmentOutput"]=4]="FragmentOutput";ConditionParentType[ConditionParentType["ProjectProperty"]=5]="ProjectProperty"})(ConditionParentType=Design.ConditionParentType||(Design.ConditionParentType={}));var FilterParentType;(function(FilterParentType){FilterParentType[FilterParentType["Reference"]=0]="Reference";FilterParentType[FilterParentType["Constant"]=1]="Constant";FilterParentType[FilterParentType["Input"]=2]="Input";FilterParentType[FilterParentType["UserEntered"]=3]="UserEntered"})(FilterParentType=Design.FilterParentType||(Design.FilterParentType={}));var RepeatSourceType;(function(RepeatSourceType){RepeatSourceType[RepeatSourceType["None"]=0]="None";RepeatSourceType[RepeatSourceType["DataSource"]=1]="DataSource";RepeatSourceType[RepeatSourceType["Page"]=2]="Page";RepeatSourceType[RepeatSourceType["Section"]=3]="Section";RepeatSourceType[RepeatSourceType["Input"]=4]="Input";RepeatSourceType[RepeatSourceType["FragmentOutput"]=5]="FragmentOutput"})(RepeatSourceType=Design.RepeatSourceType||(Design.RepeatSourceType={}));var RepeaterChoice;(function(RepeaterChoice){RepeaterChoice[RepeaterChoice["NotRepeated"]=0]="NotRepeated";RepeaterChoice[RepeaterChoice["AtLeastOne"]=1]="AtLeastOne";RepeaterChoice[RepeaterChoice["Every"]=2]="Every"})(RepeaterChoice=Design.RepeaterChoice||(Design.RepeaterChoice={}));var ChartColourPalette;(function(ChartColourPalette){ChartColourPalette[ChartColourPalette["None"]=0]="None";ChartColourPalette[ChartColourPalette["Default"]=5]="Default";ChartColourPalette[ChartColourPalette["Berry"]=8]="Berry";ChartColourPalette[ChartColourPalette["BrightPastel"]=1]="BrightPastel";ChartColourPalette[ChartColourPalette["Chocolate"]=9]="Chocolate";ChartColourPalette[ChartColourPalette["EarthTones"]=6]="EarthTones";ChartColourPalette[ChartColourPalette["Excel"]=3]="Excel";ChartColourPalette[ChartColourPalette["Fire"]=10]="Fire";ChartColourPalette[ChartColourPalette["GrayScale"]=2]="GrayScale";ChartColourPalette[ChartColourPalette["Light"]=4]="Light";ChartColourPalette[ChartColourPalette["Pastel"]=5]="Pastel";ChartColourPalette[ChartColourPalette["SeaGreen"]=11]="SeaGreen";ChartColourPalette[ChartColourPalette["SemiTransparent"]=7]="SemiTransparent"})(ChartColourPalette=Design.ChartColourPalette||(Design.ChartColourPalette={}));var ChartBorderlineDashStyle;(function(ChartBorderlineDashStyle){ChartBorderlineDashStyle[ChartBorderlineDashStyle["Dash"]=1]="Dash";ChartBorderlineDashStyle[ChartBorderlineDashStyle["Dot"]=4]="Dot";ChartBorderlineDashStyle[ChartBorderlineDashStyle["NotSet"]=0]="NotSet";ChartBorderlineDashStyle[ChartBorderlineDashStyle["Solid"]=5]="Solid"})(ChartBorderlineDashStyle=Design.ChartBorderlineDashStyle||(Design.ChartBorderlineDashStyle={}));var ChartType;(function(ChartType){ChartType[ChartType["Bar"]=7]="Bar";ChartType[ChartType["Column"]=10]="Column";ChartType[ChartType["Line"]=3]="Line";ChartType[ChartType["Pie"]=17]="Pie";ChartType[ChartType["Point"]=0]="Point";ChartType[ChartType["StackedColumn"]=11]="StackedColumn";ChartType[ChartType["StackedBar"]=8]="StackedBar"})(ChartType=Design.ChartType||(Design.ChartType={}));var ChartDataPointLabel;(function(ChartDataPointLabel){ChartDataPointLabel[ChartDataPointLabel["None"]=0]="None";ChartDataPointLabel[ChartDataPointLabel["Value"]=1]="Value";ChartDataPointLabel[ChartDataPointLabel["Category"]=2]="Category"})(ChartDataPointLabel=Design.ChartDataPointLabel||(Design.ChartDataPointLabel={}));var Docking;(function(Docking){Docking[Docking["Bottom"]=2]="Bottom";Docking[Docking["Left"]=3]="Left";Docking[Docking["Right"]=1]="Right";Docking[Docking["Top"]=0]="Top"})(Docking=Design.Docking||(Design.Docking={}));var BarcodeType;(function(BarcodeType){BarcodeType[BarcodeType["None"]=-1]="None";BarcodeType[BarcodeType["Codabar"]=0]="Codabar";BarcodeType[BarcodeType["Code11"]=1]="Code11";BarcodeType[BarcodeType["Code128"]=22]="Code128";BarcodeType[BarcodeType["Code39Extended"]=3]="Code39Extended";BarcodeType[BarcodeType["Code93Extended"]=4]="Code93Extended";BarcodeType[BarcodeType["DataMatrix"]=10]="DataMatrix";BarcodeType[BarcodeType["EAN13"]=12]="EAN13";BarcodeType[BarcodeType["EAN8"]=13]="EAN8";BarcodeType[BarcodeType["Interleaved2of5"]=5]="Interleaved2of5";BarcodeType[BarcodeType["ITF14"]=17]="ITF14";BarcodeType[BarcodeType["Pdf417"]=15]="Pdf417";BarcodeType[BarcodeType["Planet"]=16]="Planet";BarcodeType[BarcodeType["Postnet"]=17]="Postnet";BarcodeType[BarcodeType["QR"]=18]="QR";BarcodeType[BarcodeType["UPCA"]=19]="UPCA";BarcodeType[BarcodeType["UPCE"]=20]="UPCE";BarcodeType[BarcodeType["Code39Standard"]=6]="Code39Standard";BarcodeType[BarcodeType["Code93Standard"]=7]="Code93Standard";BarcodeType[BarcodeType["MSI"]=8]="MSI";BarcodeType[BarcodeType["Standard2of5"]=9]="Standard2of5";BarcodeType[BarcodeType["Aztec"]=23]="Aztec";BarcodeType[BarcodeType["EAN14"]=26]="EAN14";BarcodeType[BarcodeType["SSCC18"]=42]="SSCC18";BarcodeType[BarcodeType["MacroPdf417"]=24]="MacroPdf417";BarcodeType[BarcodeType["OneCode"]=28]="OneCode";BarcodeType[BarcodeType["AustraliaPost"]=29]="AustraliaPost";BarcodeType[BarcodeType["Matrix2of5"]=31]="Matrix2of5";BarcodeType[BarcodeType["DeutschePostIdentcode"]=32]="DeutschePostIdentcode";BarcodeType[BarcodeType["PZN"]=33]="PZN";BarcodeType[BarcodeType["ItalianPost25"]=34]="ItalianPost25";BarcodeType[BarcodeType["IATA2of5"]=35]="IATA2of5";BarcodeType[BarcodeType["RM4SCC"]=30]="RM4SCC";BarcodeType[BarcodeType["VIN"]=36]="VIN";BarcodeType[BarcodeType["OPC"]=38]="OPC";BarcodeType[BarcodeType["DeutschePostLeitcode"]=37]="DeutschePostLeitcode";BarcodeType[BarcodeType["ITF6"]=39]="ITF6"})(BarcodeType=Design.BarcodeType||(Design.BarcodeType={}));var AustraliaPostBarcodeType;(function(AustraliaPostBarcodeType){AustraliaPostBarcodeType[AustraliaPostBarcodeType["None"]=0]="None";AustraliaPostBarcodeType[AustraliaPostBarcodeType["Standard"]=11]="Standard";AustraliaPostBarcodeType[AustraliaPostBarcodeType["ReplyPaid"]=45]="ReplyPaid";AustraliaPostBarcodeType[AustraliaPostBarcodeType["Customer2"]=59]="Customer2";AustraliaPostBarcodeType[AustraliaPostBarcodeType["Customer3"]=62]="Customer3";AustraliaPostBarcodeType[AustraliaPostBarcodeType["Routing"]=87]="Routing";AustraliaPostBarcodeType[AustraliaPostBarcodeType["Redirection"]=92]="Redirection"})(AustraliaPostBarcodeType=Design.AustraliaPostBarcodeType||(Design.AustraliaPostBarcodeType={}));var BarcodeCodeLocation;(function(BarcodeCodeLocation){BarcodeCodeLocation[BarcodeCodeLocation["Above"]=0]="Above";BarcodeCodeLocation[BarcodeCodeLocation["Below"]=1]="Below";BarcodeCodeLocation[BarcodeCodeLocation["None"]=2]="None"})(BarcodeCodeLocation=Design.BarcodeCodeLocation||(Design.BarcodeCodeLocation={}));var PlaceholderBehaviour;(function(PlaceholderBehaviour){PlaceholderBehaviour[PlaceholderBehaviour["Default"]=0]="Default";PlaceholderBehaviour[PlaceholderBehaviour["SetStyle"]=1]="SetStyle";PlaceholderBehaviour[PlaceholderBehaviour["InsertTagValue"]=2]="InsertTagValue";PlaceholderBehaviour[PlaceholderBehaviour["InsertCheckbox"]=3]="InsertCheckbox";PlaceholderBehaviour[PlaceholderBehaviour["InsertDisplayText"]=4]="InsertDisplayText"})(PlaceholderBehaviour=Design.PlaceholderBehaviour||(Design.PlaceholderBehaviour={}));var StateTransitionSendTo;(function(StateTransitionSendTo){StateTransitionSendTo[StateTransitionSendTo["Creator"]=0]="Creator";StateTransitionSendTo[StateTransitionSendTo["Previous"]=1]="Previous";StateTransitionSendTo[StateTransitionSendTo["User"]=2]="User";StateTransitionSendTo[StateTransitionSendTo["Group"]=3]="Group";StateTransitionSendTo[StateTransitionSendTo["CurrentUser"]=4]="CurrentUser";StateTransitionSendTo[StateTransitionSendTo["Temporary"]=5]="Temporary"})(StateTransitionSendTo=Design.StateTransitionSendTo||(Design.StateTransitionSendTo={}));var StateTransitionSendToType;(function(StateTransitionSendToType){StateTransitionSendToType[StateTransitionSendToType["Specified"]=0]="Specified";StateTransitionSendToType[StateTransitionSendToType["Search"]=1]="Search";StateTransitionSendToType[StateTransitionSendToType["QuestionReference"]=2]="QuestionReference"})(StateTransitionSendToType=Design.StateTransitionSendToType||(Design.StateTransitionSendToType={}));var StateTransitionType;(function(StateTransitionType){StateTransitionType[StateTransitionType["Single"]=0]="Single";StateTransitionType[StateTransitionType["Concurrent"]=1]="Concurrent"})(StateTransitionType=Design.StateTransitionType||(Design.StateTransitionType={}));var ActionResultType;(function(ActionResultType){ActionResultType[ActionResultType["Success"]=1]="Success";ActionResultType[ActionResultType["Fail"]=-1]="Fail";ActionResultType[ActionResultType["NotRun"]=0]="NotRun"})(ActionResultType=Design.ActionResultType||(Design.ActionResultType={}));var GenerateButtonLocation;(function(GenerateButtonLocation){GenerateButtonLocation[GenerateButtonLocation["BottomMiddle_Default"]=0]="BottomMiddle_Default";GenerateButtonLocation[GenerateButtonLocation["TopRight"]=1]="TopRight";GenerateButtonLocation[GenerateButtonLocation["Both"]=2]="Both"})(GenerateButtonLocation=Design.GenerateButtonLocation||(Design.GenerateButtonLocation={}));var StringAlignment;(function(StringAlignment){StringAlignment[StringAlignment["Near"]=0]="Near";StringAlignment[StringAlignment["Center"]=1]="Center";StringAlignment[StringAlignment["Far"]=2]="Far"})(StringAlignment=Design.StringAlignment||(Design.StringAlignment={}));var PlaceholderColour;(function(PlaceholderColour){PlaceholderColour[PlaceholderColour["Green"]=0]="Green";PlaceholderColour[PlaceholderColour["Blue"]=1]="Blue";PlaceholderColour[PlaceholderColour["Orange"]=2]="Orange";PlaceholderColour[PlaceholderColour["Purple"]=3]="Purple";PlaceholderColour[PlaceholderColour["Cyan"]=4]="Cyan"})(PlaceholderColour=Design.PlaceholderColour||(Design.PlaceholderColour={}));var CompatibilityLevel;(function(CompatibilityLevel){CompatibilityLevel[CompatibilityLevel["Version2001"]=2001]="Version2001";CompatibilityLevel[CompatibilityLevel["Version2014"]=2014]="Version2014"})(CompatibilityLevel=Design.CompatibilityLevel||(Design.CompatibilityLevel={}));var SaveAnswerByEnum;(function(SaveAnswerByEnum){SaveAnswerByEnum[SaveAnswerByEnum["None"]=-1]="None";SaveAnswerByEnum[SaveAnswerByEnum["SaveById"]=0]="SaveById";SaveAnswerByEnum[SaveAnswerByEnum["SaveByLabel"]=1]="SaveByLabel"})(SaveAnswerByEnum=Design.SaveAnswerByEnum||(Design.SaveAnswerByEnum={}));var QuestionSummaryInclude;(function(QuestionSummaryInclude){QuestionSummaryInclude[QuestionSummaryInclude["Default"]=0]="Default";QuestionSummaryInclude[QuestionSummaryInclude["Visible"]=1]="Visible";QuestionSummaryInclude[QuestionSummaryInclude["Active"]=2]="Active";QuestionSummaryInclude[QuestionSummaryInclude["Include"]=3]="Include";QuestionSummaryInclude[QuestionSummaryInclude["Exclude"]=4]="Exclude"})(QuestionSummaryInclude=Design.QuestionSummaryInclude||(Design.QuestionSummaryInclude={}))})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Clause=(function(){function Clause(){this.Type=Intelledox.Model.ClauseType.Basic}Object.defineProperty(Clause.prototype,"SubClauses",{get:function(){if(this.m_Clauses==null){this.m_Clauses=new Array}return this.m_Clauses},set:function(value){this.m_Clauses=value},enumerable:true,configurable:true});Clause.prototype.Clone=function(){throw new Error('This method is abstract');};Clause.prototype.Add=function(newClause){throw new Error('This method is abstract');};Clause.prototype.ComparisonContainsItem=function(item){throw new Error('This method is abstract');};Clause.prototype.ContainsItem=function(item){switch(this.Type){case Intelledox.Model.ClauseType.Basic:return false;case Intelledox.Model.ClauseType.Comparison:return this.ComparisonContainsItem(item);default:for(var i=0;i<this.SubClauses.length;i++){if(this.SubClauses[i].ContainsItem(item)){return true}}return false}};Object.defineProperty(Clause.prototype,"HasSubClauses",{get:function(){return(this.m_Clauses!=null&&this.m_Clauses.length>0)},enumerable:true,configurable:true});return Clause}());Design.Clause=Clause})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Condition=(function(_super){__extends(Condition,_super);function Condition(clauseType,parentItemGuid,parentAttributeGuid,comparisonType,compareTo,parentType){if(clauseType===void 0){clauseType=Intelledox.Model.ClauseType.Basic}if(comparisonType===void 0){comparisonType=Design.ClauseComparisonType.None}if(compareTo===void 0){compareTo=null}if(parentType===void 0){parentType=Design.ConditionParentType.Reference}var _this=_super.call(this)||this;_this.ComparisonType=Design.ClauseComparisonType.None;_this.CompareTo=null;_this.ParentType=Design.ConditionParentType.Reference;_this.ParentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.Type=clauseType;_this.ComparisonType=comparisonType;_this.CompareTo=compareTo;if(parentItemGuid){_this.ParentItemGuid=parentItemGuid}if(parentAttributeGuid){_this.ParentAttributeGuid=parentAttributeGuid}_this.ParentType=parentType||Design.ConditionParentType.Reference;return _this}Condition.prototype.Add=function(newClause){var newCondition=newClause;switch(this.Type){case Intelledox.Model.ClauseType.Basic:this.Type=newCondition.Type;this.CompareTo=newCondition.CompareTo;this.ComparisonType=newCondition.ComparisonType;this.SubClauses=newCondition.SubClauses;this.ParentAttributeGuid=newCondition.ParentAttributeGuid;this.ParentItemGuid=newCondition.ParentItemGuid;this.ParentType=newCondition.ParentType;return this;case Intelledox.Model.ClauseType.Comparison:this.SubClauses=new Array;var newMe=new Condition(Intelledox.Model.ClauseType.Comparison,this.ParentItemGuid,this.ParentAttributeGuid,this.ComparisonType,this.CompareTo,this.ParentType);this.SubClauses.push(newMe);this.SubClauses.push(newCondition);this.Type=Intelledox.Model.ClauseType.AnyOf;return newCondition;default:this.SubClauses.push(newCondition);return newCondition}};Condition.prototype.Clone=function(){var cloned=new Condition(this.Type,this.ParentItemGuid,this.ParentAttributeGuid,this.ComparisonType,this.CompareTo,this.ParentType);if(this.HasSubClauses){for(var i=0;i<this.SubClauses.length;i++){cloned.SubClauses.push(this.SubClauses[i].Clone())}}return cloned};Condition.prototype.ComparisonContainsItem=function(item){if(this.Type===Intelledox.Model.ClauseType.Comparison){if(item instanceof Design.Question){return item.QuestionGuid===this.ParentItemGuid}else if(item instanceof Design.Answer){return item.AnswerGuid===this.ParentAttributeGuid}else if(item instanceof Design.Action){return item.ActionGuid===this.ParentItemGuid}}return false};Condition.prototype.HasStateComparison=function(){switch(this.Type){case Intelledox.Model.ClauseType.Basic:return false;case Intelledox.Model.ClauseType.Comparison:return this.ParentType===Design.ConditionParentType.State;default:if(this.HasSubClauses){for(var i=0;i<this.SubClauses.length;i++){if(this.SubClauses[i].HasStateComparison()){return true}}}return false}};Condition.prototype.PageVisible=function(stateId){switch(this.Type){case Intelledox.Model.ClauseType.Comparison:if(this.ParentType===Design.ConditionParentType.State){return this.checkCondition(stateId.toString())}else{return true}case Intelledox.Model.ClauseType.AllOf:for(var i=0;i<this.SubClauses.length;i++){if(!this.SubClauses[i].PageVisible(stateId)){return false}}return true;case Intelledox.Model.ClauseType.AnyOf:for(var i=0;i<this.SubClauses.length;i++){if(this.SubClauses[i].PageVisible(stateId)){return true}}return false;default:return true}};Condition.prototype.checkCondition=function(value){var result=false;switch(this.ComparisonType){case QAWizard.Design.ClauseComparisonType.Equals:result=value.toUpperCase()===this.CompareTo.toUpperCase();break;case QAWizard.Design.ClauseComparisonType.IsNotEqual:result=value.toUpperCase()!==this.CompareTo.toUpperCase();break;default:result=false;break}return result};return Condition}(Design.Clause));Design.Condition=Condition})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Action=(function(){function Action(){this.ActionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Name=null;this.RunActionWhen=Intelledox.Model.RunActionWhen.OnDocGenSuccess;this.ShowActionWhen=Intelledox.Model.RunActionWhen.Always;this.SubmissionStage=Intelledox.Model.SubmissionStage.Finish;this.IsRepeated=false;this.RepeaterGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.HasCustomDocuments=false;this.Retries=0;this.RetryWait=0;this.ActionGuid=Design.GeneralFunctions.NewGuid();this.Type=new Intelledox.Model.RoutingType;this.Conditions=new Design.Condition;this.CustomDocuments=new Array;this.Children=new Array}Object.defineProperty(Action.prototype,"ObjectId",{get:function(){return this.ActionGuid},set:function(value){this.ActionGuid=value},enumerable:true,configurable:true});Action.prototype.Clone=function(nextId,addQuestionsToPage){if(addQuestionsToPage===void 0){addQuestionsToPage=null}var result=new Action;result.Type=this.Type;result.Name=this.Name;result.RunActionWhen=this.RunActionWhen;result.ShowActionWhen=this.ShowActionWhen;result.SubmissionStage=this.SubmissionStage;result.Conditions=this.Conditions.Clone();result.IsRepeated=this.IsRepeated;result.RepeaterGuid=this.RepeaterGuid;result.HasCustomDocuments=this.HasCustomDocuments;result.Retries=this.Retries;result.RetryWait=this.RetryWait;for(var i=0;i<this.Children.length;i++){result.Children.push(this.Children[i].Clone(nextId,addQuestionsToPage))}for(var i=0;i<this.CustomDocuments.length;i++){result.CustomDocuments.push(this.CustomDocuments[i].Clone())}for(var i=0;i<this.ActionInputs.length;i++){result.ActionInputs.push(this.ActionInputs[i].Clone())}return result};Object.defineProperty(Action.prototype,"ActionInputs",{get:function(){if(this.m_ActionInputs==null){this.m_ActionInputs=new Array}return this.m_ActionInputs},enumerable:true,configurable:true});Action.prototype.HasChild=function(childGuid){for(var i=0;i<this.Children.length;i++){var a=this.Children[i];if(a.ActionGuid===childGuid||a.HasChild(childGuid)){return true}}return false};Action.prototype.HasLayoutInterface=function(){return true};Object.defineProperty(Action.prototype,"HasRetries",{get:function(){return this.Retries>0},enumerable:true,configurable:true});return Action}());Design.Action=Action})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ActionDocumentPanelViewModel=(function(){function ActionDocumentPanelViewModel($q,$filter,editorViewModel,lists){this._action=null;this._wizard=null;this._listManager=null;this._selectedDocument=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedFormat=Intelledox.Model.OutputType.None;this._actionDocumentsType=ActionDocumentsType.None;this.isFormatEnabled=false;this.isAddEnabled=false;this.isRemoveEnabled=false;this.existingDocuments=[];this.availableDocuments=[];this.availableFormats=[];this._q=$q;this._editorViewModel=editorViewModel;this._filter=$filter;this._listManager=lists}Object.defineProperty(ActionDocumentPanelViewModel.prototype,"actionDocumentsType",{get:function(){return this._actionDocumentsType},set:function(value){this._actionDocumentsType=value;switch(value){case ActionDocumentsType.All:this._action.HasCustomDocuments=false;break;case ActionDocumentsType.Custom:this._action.HasCustomDocuments=true;break;case ActionDocumentsType.None:this._action.HasCustomDocuments=true;this._action.CustomDocuments=[]}this._editorViewModel.wizChanged=true;this.checkAddRemove()},enumerable:true,configurable:true});Object.defineProperty(ActionDocumentPanelViewModel.prototype,"selectedDocument",{get:function(){return this._selectedDocument},set:function(value){this._selectedDocument=value;this.loadFormats();this.checkAddRemove()},enumerable:true,configurable:true});Object.defineProperty(ActionDocumentPanelViewModel.prototype,"selectedFormat",{get:function(){return this._selectedFormat},set:function(value){this._selectedFormat=value;this.checkAddRemove()},enumerable:true,configurable:true});ActionDocumentPanelViewModel.prototype.add=function(){var document=this.getSelectedDocument();var newActionDocument=new Intelledox.Model.ActionDocument;newActionDocument.DocumentGuid=this.selectedDocument;newActionDocument.Format=this.selectedFormat;if(document.tag instanceof Intelledox.QAWizard.Design.ContentItem){newActionDocument.Type=Intelledox.Model.ActionDocumentType.ContentItem}else if(document.tag instanceof Intelledox.QAWizard.Design.Question){newActionDocument.Type=Intelledox.Model.ActionDocumentType.Question}else if(document.tag instanceof Intelledox.QAWizard.Design.Action){newActionDocument.Type=Intelledox.Model.ActionDocumentType.Action}this._action.CustomDocuments.push(newActionDocument);this.loadCustomDocuments();this._editorViewModel.wizChanged=true};ActionDocumentPanelViewModel.prototype.remove=function(){var existingDocument=this.getSelectedExistingDocument();if(existingDocument!=null){if(confirm(this._filter('translate')('RemoveActionDocument'))){this._action.CustomDocuments.splice(this._action.CustomDocuments.indexOf(existingDocument),1);this.loadCustomDocuments();this.checkAddRemove();this._editorViewModel.wizChanged=true}}};ActionDocumentPanelViewModel.prototype.init=function(wiz,action){var vm=this;this._action=action;this._wizard=wiz;if(action.HasCustomDocuments){if(action.CustomDocuments==null||action.CustomDocuments.length===0){this._actionDocumentsType=ActionDocumentsType.None}else{this._actionDocumentsType=ActionDocumentsType.Custom}}else{this._actionDocumentsType=ActionDocumentsType.All}ActionDocumentPanelViewModel.getAllAvailableDocuments(this._q,this._filter,wiz,true,action,this._listManager).then(function(result){vm.availableDocuments=result;vm.loadCustomDocuments();vm.loadFormats();vm.checkAddRemove()})};ActionDocumentPanelViewModel.getAvailableDocuments=function($filter,wizard,includeNoneItem){var availableDocuments=[];if(includeNoneItem){availableDocuments.push({tag:null,name:$filter('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY})}for(var i=0;i<wizard.Documents.length;i++){var doc=wizard.Documents[i];availableDocuments.push({tag:doc,name:doc.Name,value:doc.DocumentGuid})}for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var currentPage=wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<currentPage.Questions.length;questionIndex++){var q=currentPage.Questions[questionIndex];if(q instanceof Intelledox.QAWizard.Design.ContentLibraryQuestion){for(var answerIndex=0;answerIndex<q.Answers.length;answerIndex++){for(var contentIndex=0;contentIndex<q.Answers[answerIndex].ContentItems.length;contentIndex++){var content=q.Answers[answerIndex].ContentItems[contentIndex];if(content.ContentTypeId===Intelledox.Model.ContentType.Attachment||content.ContentTypeId===Intelledox.Model.ContentType.Audio){availableDocuments.push({tag:content,name:content.AttachmentName,value:content.ContentItemGuid})}}}if(q.Visibility===true&&(q.ContentTypeRestriction===Intelledox.Model.ContentType.Attachment||q.ContentTypeRestriction===Intelledox.Model.ContentType.Audio)){availableDocuments.push({tag:q,name:(System.String.IsNullOrEmpty(q.AttachmentFileName)?q.TranslatedText:q.AttachmentFileName),value:q.QuestionGuid})}else if(q.RepeatParent!==Intelledox.Common.ConstantValues.GUID_EMPTY){var hasPlaceholders=false;for(var answerIndex=0;answerIndex<q.Answers.length;answerIndex++){hasPlaceholders=q.Answers[answerIndex].HasPlaceholders;if(hasPlaceholders){break}}if(!hasPlaceholders){availableDocuments.push({tag:q,name:q.TranslatedText,value:q.QuestionGuid})}}}}}return availableDocuments};ActionDocumentPanelViewModel.getAllAvailableDocuments=function($q,$filter,wizard,includeNoneItem,action,listManager){var availableDocuments=ActionDocumentPanelViewModel.getAvailableDocuments($filter,wizard,includeNoneItem);if(action!=null){var promises=[];var actionLocation=wizard.FindAction(action.ActionGuid,true);var siblingActions;if(actionLocation.stateTransition!=null){siblingActions=actionLocation.stateTransition.Actions}else if(actionLocation.actionButtonQuestion){siblingActions=wizard.getAllActionsForActionButtonQuestion(actionLocation.actionButtonQuestion)}else{siblingActions=wizard.Actions}for(var i=0;i<siblingActions.length;i++){var currentAction=siblingActions[i];if(currentAction===action){break}else{promises.push(listManager.actionAvailableDocuments(currentAction.Type.routingTypeId))}}return $q.all(promises).then(function(results){for(var i=0;i<results.length;i++){for(var docIndex=0;docIndex<results[i].length;docIndex++){availableDocuments.push({tag:siblingActions[i],name:results[i][docIndex].name,value:results[i][docIndex].documentGuid})}}}).then(function(){return availableDocuments})}else{return $q.when(availableDocuments)}};ActionDocumentPanelViewModel.prototype.loadFormats=function(){var selectedDoc=this.getSelectedDocument();this.availableFormats=[];this.availableFormats.push({name:this._filter('translate')('DefaultWithBrackets'),value:Intelledox.Model.OutputType.None});if(selectedDoc==null){this.isFormatEnabled=false}else if(selectedDoc.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate){if(selectedDoc.tag.FormatType===Intelledox.Model.TemplateFormatType.WordBinary||selectedDoc.tag.FormatType===Intelledox.Model.TemplateFormatType.WordDocm||selectedDoc.tag.FormatType===Intelledox.Model.TemplateFormatType.WordDocx){this.getDocumentOutputTypes()}else if(selectedDoc.tag.FormatType===Intelledox.Model.TemplateFormatType.PowerPointPptx){this.getPresentationOutputTypes()}else if(selectedDoc.tag.FormatType===Intelledox.Model.TemplateFormatType.ExcelXlsx){this.getNamedRangeOutputTypes()}this.isFormatEnabled=true}else if(selectedDoc.tag instanceof Intelledox.QAWizard.Design.ContentItem||selectedDoc.tag instanceof Intelledox.QAWizard.Design.Question){this.isFormatEnabled=false}};ActionDocumentPanelViewModel.prototype.checkAddRemove=function(){var addState=false;var removeState=false;if(this.getSelectedExistingDocument()!=null){removeState=true}if(this.actionDocumentsType===ActionDocumentsType.Custom&&this.selectedDocument!==Intelledox.Common.ConstantValues.GUID_EMPTY){var selectedDoc=this.getSelectedDocument();if(selectedDoc!=null){addState=true;for(var i=0;i<this._action.CustomDocuments.length;i++){var doc=this._action.CustomDocuments[i];if(doc.Type===Intelledox.Model.ActionDocumentType.Document){if(selectedDoc.tag instanceof Intelledox.QAWizard.Design.DocumentTemplate&&doc.DocumentGuid===this.selectedDocument&&this.convertOutputTypeToExtension(doc.Format)===this.convertOutputTypeToExtension(this.selectedFormat)){addState=false;break}}else if(doc.Type===Intelledox.Model.ActionDocumentType.ContentItem){if(selectedDoc.tag instanceof Intelledox.QAWizard.Design.ContentItem&&doc.DocumentGuid===this.selectedDocument){addState=false;break}}else if(doc.Type===Intelledox.Model.ActionDocumentType.Question){if(selectedDoc.tag instanceof Intelledox.QAWizard.Design.Question&&doc.DocumentGuid===this.selectedDocument){addState=false;break}}else if(doc.Type===Intelledox.Model.ActionDocumentType.Action){if(selectedDoc.tag instanceof Intelledox.QAWizard.Design.Action&&doc.DocumentGuid===this.selectedDocument){addState=false;break}}}}}this.isAddEnabled=addState;this.isRemoveEnabled=removeState};ActionDocumentPanelViewModel.prototype.loadCustomDocuments=function(){this.existingDocuments=[];for(var i=0;i<this._action.CustomDocuments.length;i++){var doc=this._action.CustomDocuments[i];switch(doc.Type){case Intelledox.Model.ActionDocumentType.Document:var docTemplate=null;for(var docIndex=0;docIndex<this._wizard.Documents.length;docIndex++){if(this._wizard.Documents[docIndex].DocumentGuid===doc.DocumentGuid){docTemplate=this._wizard.Documents[docIndex];break}}if(docTemplate!=null){this.existingDocuments.push({tag:doc,document:docTemplate.Name,format:this.convertOutputTypeToExtension(doc.Format),selected:false})}else{this.existingDocuments.push({tag:doc,document:this._filter('translate')('InvalidDocument'),format:'',selected:false})}break;case Intelledox.Model.ActionDocumentType.ContentItem:var contentItem={tag:doc,document:'',format:this._filter('translate')('NA'),selected:false};this.existingDocuments.push(contentItem);(function(id,content,list,$filter){list.getContentItems().then(function(items){for(var contentIndex=0;contentIndex<items.length;contentIndex++){if(items[contentIndex].contentItemGuid===id){content.document=items[contentIndex].name;return}}content.document=$filter('translate')('InvalidContentItem')})})(doc.DocumentGuid,contentItem,this._listManager,this._filter);break;case Intelledox.Model.ActionDocumentType.Question:var q=this._wizard.FindQuestion(doc.DocumentGuid);if(q==null){this.existingDocuments.push({tag:doc,document:this._filter('translate')('InvalidQuestion'),format:'',selected:false})}else{this.existingDocuments.push({tag:doc,document:(System.String.IsNullOrEmpty(q.AttachmentFileName)?q.TranslatedText:q.AttachmentFileName),format:this._filter('translate')('NA'),selected:false})}break;case Intelledox.Model.ActionDocumentType.Action:var action=this._wizard.FindAction(doc.DocumentGuid,true);if(action==null){this.existingDocuments.push({tag:doc,document:this._filter('translate')('Validate_InvalidActionDocument'),format:'',selected:false})}else{var found=false;var actionItem={tag:doc,document:'',format:this._filter('translate')('NA'),selected:false};this.existingDocuments.push(actionItem);for(var docIndex=0;docIndex<this.availableDocuments.length;docIndex++){if(this.availableDocuments[docIndex].value===doc.DocumentGuid){actionItem.document=this.availableDocuments[docIndex].name;found=true;break}}if(!found){actionItem.document=this._filter('translate')('Validate_InvalidActionDocument')}}break}}this.checkAddRemove()};ActionDocumentPanelViewModel.prototype.selectExistingDocument=function(doc){for(var i=0;i<this.existingDocuments.length;i++){if(this.existingDocuments[i].tag===doc){this.existingDocuments[i].selected=true;this.selectedDocument=doc.DocumentGuid;this.selectedFormat=doc.Format;this.checkAddRemove()}else{this.existingDocuments[i].selected=false}}};ActionDocumentPanelViewModel.prototype.getSelectedExistingDocument=function(){for(var i=0;i<this.existingDocuments.length;i++){if(this.existingDocuments[i].selected){return this.existingDocuments[i].tag}}return null};ActionDocumentPanelViewModel.prototype.getSelectedDocument=function(){for(var i=0;i<this.availableDocuments.length;i++){if(this.availableDocuments[i].value===this.selectedDocument){return this.availableDocuments[i]}}return null};ActionDocumentPanelViewModel.prototype.convertOutputTypeToExtension=function(outputType){switch(outputType){case Intelledox.Model.OutputType.None:return"Default";case Intelledox.Model.OutputType.Doc:return"doc";case Intelledox.Model.OutputType.Docx:case Intelledox.Model.OutputType.Docx2010:return"docx";case Intelledox.Model.OutputType.Pdf:case Intelledox.Model.OutputType.PdfA:case Intelledox.Model.OutputType.PresPdf:case Intelledox.Model.OutputType.PresPdfA:case Intelledox.Model.OutputType.SpreadPdf:case Intelledox.Model.OutputType.SpreadPdfA:return"pdf";case Intelledox.Model.OutputType.Rtf:return"rtf";case Intelledox.Model.OutputType.Odt:return"odt";case Intelledox.Model.OutputType.Xps:case Intelledox.Model.OutputType.PresXps:case Intelledox.Model.OutputType.SpreadXps:return"xps";case Intelledox.Model.OutputType.Mht:return"mht";case Intelledox.Model.OutputType.Pptx:return"pptx";case Intelledox.Model.OutputType.Odp:return"odp";case Intelledox.Model.OutputType.Ps:return"ps";case Intelledox.Model.OutputType.Xlsx:return"xlsx";case Intelledox.Model.OutputType.Xls:return"xls";case Intelledox.Model.OutputType.Ods:return"ods"}return null};ActionDocumentPanelViewModel.prototype.getDocumentOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('WordDocxDesc'),value:Intelledox.Model.OutputType.Docx});this.availableFormats.push({name:this._filter('translate')('WordDocx2010Desc'),value:Intelledox.Model.OutputType.Docx2010});this.availableFormats.push({name:this._filter('translate')('PDFDesc'),value:Intelledox.Model.OutputType.Pdf});this.availableFormats.push({name:this._filter('translate')('PDFADesc'),value:Intelledox.Model.OutputType.PdfA});this.availableFormats.push({name:this._filter('translate')('WordBinaryDesc'),value:Intelledox.Model.OutputType.Doc});this.availableFormats.push({name:this._filter('translate')('RtfDesc'),value:Intelledox.Model.OutputType.Rtf});this.availableFormats.push({name:this._filter('translate')('OdtDesc'),value:Intelledox.Model.OutputType.Odt});this.availableFormats.push({name:this._filter('translate')('XpsDesc'),value:Intelledox.Model.OutputType.Xps});this.availableFormats.push({name:this._filter('translate')('MhtDesc'),value:Intelledox.Model.OutputType.Mht});this.availableFormats.push({name:this._filter('translate')('PsDesc'),value:Intelledox.Model.OutputType.Ps})};ActionDocumentPanelViewModel.prototype.getPresentationOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('PowerPointPptxDesc'),value:Intelledox.Model.OutputType.Pptx});this.availableFormats.push({name:this._filter('translate')('PDFDesc'),value:Intelledox.Model.OutputType.PresPdf});this.availableFormats.push({name:this._filter('translate')('PDFADesc'),value:Intelledox.Model.OutputType.PresPdfA});this.availableFormats.push({name:this._filter('translate')('OdpDesc'),value:Intelledox.Model.OutputType.Odp});this.availableFormats.push({name:this._filter('translate')('XpsDesc'),value:Intelledox.Model.OutputType.PresXps})};ActionDocumentPanelViewModel.prototype.getNamedRangeOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('XlsxDesc'),value:Intelledox.Model.OutputType.Xlsx});this.availableFormats.push({name:this._filter('translate')('XlsDesc'),value:Intelledox.Model.OutputType.Xls});this.availableFormats.push({name:this._filter('translate')('XpsDesc'),value:Intelledox.Model.OutputType.SpreadXps});this.availableFormats.push({name:this._filter('translate')('OdsDesc'),value:Intelledox.Model.OutputType.Ods});this.availableFormats.push({name:this._filter('translate')('PDFDesc'),value:Intelledox.Model.OutputType.SpreadPdf});this.availableFormats.push({name:this._filter('translate')('PDFADesc'),value:Intelledox.Model.OutputType.SpreadPdfA})};return ActionDocumentPanelViewModel}());Design.ActionDocumentPanelViewModel=ActionDocumentPanelViewModel;var ActionDocumentsType;(function(ActionDocumentsType){ActionDocumentsType[ActionDocumentsType["None"]=0]="None";ActionDocumentsType[ActionDocumentsType["All"]=1]="All";ActionDocumentsType[ActionDocumentsType["Custom"]=2]="Custom"})(ActionDocumentsType=Design.ActionDocumentsType||(Design.ActionDocumentsType={}))})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var LogicQuestion=(function(_super){__extends(LogicQuestion,_super);function LogicQuestion(questionGuid){return _super.call(this,questionGuid)||this}return LogicQuestion}(Design.Question));Design.LogicQuestion=LogicQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var AutoLogicQuestion=(function(_super){__extends(AutoLogicQuestion,_super);function AutoLogicQuestion(questionGuid){return _super.call(this,questionGuid)||this}Object.defineProperty(AutoLogicQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.AutoLogic},enumerable:true,configurable:true});AutoLogicQuestion.prototype.IsValidRepeatParent=function(parent){return(parent.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Datasource&&parent.SelectionType===Intelledox.Model.SelectionType.Multiple)};Object.defineProperty(AutoLogicQuestion.prototype,"IsDisplayQuestionType",{get:function(){return false},enumerable:true,configurable:true});AutoLogicQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new AutoLogicQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);return result};return AutoLogicQuestion}(Design.LogicQuestion));Design.AutoLogicQuestion=AutoLogicQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var AutoLogicPropertiesViewModel=(function(_super){__extends(AutoLogicPropertiesViewModel,_super);function AutoLogicPropertiesViewModel(editorViewModel,question,wizard,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._isRepeated=false;_this.availableQuestions=null;_this._editor=editorViewModel;_this._wizard=wizard;_this._autoLogic=question;_this._filterLocal=$filter;_this._isRepeated=(_this._autoLogic.RepeatParent!==Intelledox.Common.ConstantValues.GUID_EMPTY);if(_this._isRepeated){_this.loadQuestions()}return _this}Object.defineProperty(AutoLogicPropertiesViewModel.prototype,"isRepeated",{get:function(){return this._isRepeated},set:function(value){this._isRepeated=value;if(value){if(this.availableQuestions==null){this.loadQuestions()}}else{this._autoLogic.RepeatParent=Intelledox.Common.ConstantValues.GUID_EMPTY}},enumerable:true,configurable:true});Object.defineProperty(AutoLogicPropertiesViewModel.prototype,"selectedQuestion",{get:function(){if(!this._isRepeated){return undefined}return this._autoLogic.RepeatParent},set:function(value){this._autoLogic.RepeatParent=value;this._editor.wizChanged=true},enumerable:true,configurable:true});AutoLogicPropertiesViewModel.prototype.loadQuestions=function(){this.availableQuestions=[];for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var pageItem=this._wizard.Pages[pageIndex];var found=false;for(var questionIndex=0;questionIndex<pageItem.Questions.length;questionIndex++){var questionItem=pageItem.Questions[questionIndex];if(questionItem.QuestionGuid===this._autoLogic.QuestionGuid){found=true;break}if(this._autoLogic.IsValidRepeatParent(questionItem)){this.availableQuestions.push(questionItem)}}if(found){break}}this.availableQuestions.sort(function(a,b){if(a.Text>b.Text){return 1}if(a.Text<b.Text){return-1}return 0});this.availableQuestions.splice(0,0,new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filterLocal('translate')('NoneWithBrackets')))};return AutoLogicPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.AutoLogicPropertiesViewModel=AutoLogicPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Rule=(function(_super){__extends(Rule,_super);function Rule(newType,qGuid,aGuid,comparison,comparer){if(newType===void 0){newType=Intelledox.Model.ClauseType.Basic}if(comparison===void 0){comparison=Design.ClauseComparisonType.None}if(comparer===void 0){comparer=null}var _this=_super.call(this)||this;_this.ParentType=Design.RuleParentType.Reference;_this.ComparisonType=Design.ClauseComparisonType.None;_this.CompareTo=null;_this.ParentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.EveryOrOneOf=Design.RepeaterChoice.NotRepeated;_this.Type=newType;_this.ComparisonType=comparison;_this.CompareTo=comparer;if(qGuid){_this.ParentItemGuid=qGuid}if(aGuid){_this.ParentAttributeGuid=aGuid}_this.EveryOrOneOf=Design.RepeaterChoice.NotRepeated;_this.Formula="";return _this}Rule.prototype.Clone=function(){var cloned=new Rule(this.Type);cloned.ParentItemGuid=this.ParentItemGuid;cloned.ParentAttributeGuid=this.ParentAttributeGuid;cloned.ComparisonType=this.ComparisonType;cloned.CompareTo=this.CompareTo;cloned.Formula=this.Formula;cloned.ParentType=this.ParentType;cloned.EveryOrOneOf=this.EveryOrOneOf;if(this.HasSubClauses){for(var i=0;i<this.SubClauses.length;i++){cloned.SubClauses.push(this.SubClauses[i].Clone())}}return cloned};Rule.prototype.Add=function(newClause){var newRule=newClause;switch(this.Type){case Intelledox.Model.ClauseType.Basic:this.Type=newRule.Type;this.CompareTo=newRule.CompareTo;this.ComparisonType=newRule.ComparisonType;this.SubClauses=newRule.SubClauses;this.ParentAttributeGuid=newRule.ParentAttributeGuid;this.ParentItemGuid=newRule.ParentItemGuid;this.ParentType=newRule.ParentType;this.Formula=newRule.Formula;this.EveryOrOneOf=newRule.EveryOrOneOf;return this;case Intelledox.Model.ClauseType.Comparison:this.SubClauses=new Array;var newMe=this.Clone();this.SubClauses.push(newMe);this.SubClauses.push(newRule);this.Type=Intelledox.Model.ClauseType.AnyOf;return newRule;default:this.SubClauses.push(newRule);return newRule}};Rule.prototype.ComparisonContainsItem=function(item){if(this.Type===Intelledox.Model.ClauseType.Comparison){if(item instanceof Design.Question){return item.QuestionGuid===this.ParentItemGuid}else if(item instanceof Design.Answer){return item.AnswerGuid===this.ParentAttributeGuid}}return false};return Rule}(Design.Clause));Design.Rule=Rule})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var RulePanelViewModel=(function(){function RulePanelViewModel($filter,editorViewModel){this._wizard=null;this._listManager=null;this._currentRules=null;this._currentPage=null;this._currentNode=null;this._isInitializing=false;this._selectedParentType=Intelledox.QAWizard.Design.RuleParentType.Reference;this._selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedComparisonType=Intelledox.QAWizard.Design.ClauseComparisonType.None;this._selectedInput=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedFragment=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedFragmentOutput=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedRepeaterChoice=Intelledox.QAWizard.Design.RepeaterChoice.NotRepeated;this._selectedProjectProperty=Intelledox.Common.ConstantValues.GUID_EMPTY;this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.isComparisonTypeEnabled=true;this.isInputVisible=true;this.isQuestionVisible=true;this.isAnswerVisible=true;this.isAnswerEnabled=false;this.isFragmentVisible=true;this.isProjectPropertyVisible=true;this.isCompareToListVisible=false;this.isCompareToTextVisible=false;this.isCompareToListEnabled=true;this.isCompareToTextEnabled=true;this.isFormulaVisible=false;this.isRepeaterChoiceVisible=false;this.availableParentTypes=[];this.availableInputs=[];this.availableFragments=[];this.availableFragmentOutputs=[];this.availableQuestions=[];this.availableAnswers=[];this.availableComparisonTypes=[];this.availableCompareTos=[];this.availableRepeaterChoice=[];this.formula="";this.compareTo="";var vm=this;this._editorViewModel=editorViewModel;this._filter=$filter;this.clauseDesignerModel=new Design.ClauseDesignerViewModel($filter,editorViewModel);this.clauseDesignerModel.replaceClause=function(node){vm.clauseViewReplaceClause(node)};this.clauseDesignerModel.clauseSelected=function(){if(vm.clauseDesignerModel.clausesTreeView.selectedNode.tag.Type===Intelledox.Model.ClauseType.Comparison){vm.loadRule(vm.clauseDesignerModel.clausesTreeView.selectedNode.tag)}vm.updateCompareButtons()};this.clauseDesignerModel.clauseDrop=function(dropNode,targetNode){vm.clauseDrop(dropNode,targetNode)}}Object.defineProperty(RulePanelViewModel.prototype,"availableProjectProperties",{get:function(){return this._wizard.Properties},enumerable:true,configurable:true});Object.defineProperty(RulePanelViewModel.prototype,"selectedParentType",{get:function(){return this._selectedParentType},set:function(value){this._selectedParentType=value;var isAutoChange=this._isInitializing;this._isInitializing=true;this.isQuestionVisible=false;this.isAnswerVisible=false;this.isFormulaVisible=false;this.isCompareToTextVisible=false;this.isInputVisible=false;this.isFragmentVisible=false;this.isProjectPropertyVisible=false;if(this.isReference()){this.isQuestionVisible=true;this.isAnswerVisible=true;this.formula="";this.enableComparisonTypeDropDownWithParent()}else if(this.isInput()){this.isInputVisible=true;this.formula="";this.enableComparisonTypeDropDown()}else if(this.isFragmentOutput()){this.isFragmentVisible=true;this.formula="";this.enableComparisonTypeDropDown()}else if(this.isProjectProperty()){this.isProjectPropertyVisible=true;this.enableComparisonTypeDropDown()}else{this.isFormulaVisible=true;this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.enableComparisonTypeDropDown()}this._isInitializing=isAutoChange;this.updateCompareButtons();this._isInitializing=isAutoChange},enumerable:true,configurable:true});Object.defineProperty(RulePanelViewModel.prototype,"selectedQuestionGuid",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;var isAutoChange=this._isInitializing;this._isInitializing=true;this.isRepeaterChoiceVisible=false;this.availableAnswers=[];if(value!=null&&value!==Intelledox.Common.ConstantValues.GUID_EMPTY){var currentQuestion=this.findSelectedQuestion(value);if(currentQuestion==null){this.compareTo=""}else if(currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric){this.isAnswerEnabled=false}else{for(var i=0;i<currentQuestion.Answers.length;i++){this.availableAnswers.push(currentQuestion.Answers[i])}this.isAnswerEnabled=true;this.compareTo=""}}else{this.compareTo=""}this.availableAnswers.sort(function(a,b){if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0});this.availableAnswers.splice(0,0,new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(!this.isAnswerEnabled){this.enableComparisonTypeDropDownWithParent()}this._isInitializing=isAutoChange;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(RulePanelViewModel.prototype,"selectedAnswerGuid",{get:function(){return this._selectedAnswerGuid},set:function(value){this._selectedAnswerGuid=value;if(value==null||value===Intelledox.Common.ConstantValues.GUID_EMPTY){this.isComparisonTypeEnabled=false;this.availableComparisonTypes=[];this.selectedComparisonType=Intelledox.QAWizard.Design.ClauseComparisonType.None;this.updateCompareToBox()}else{this.enableComparisonTypeDropDownWithParent()}},enumerable:true,configurable:true});Object.defineProperty(RulePanelViewModel.prototype,"selectedComparisonType",{get:function(){return this._selectedComparisonType},set:function(value){this._selectedComparisonType=value;this.updateCompareToBox()},enumerable:true,configurable:true});Object.defineProperty(RulePanelViewModel.prototype,"selectedInput",{get:function(){return this._selectedInput},set:function(value){this._selectedInput=value;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(RulePanelViewModel.prototype,"selectedProjectProperty",{get:function(){return this._selectedProjectProperty},set:function(value){this._selectedProjectProperty=value;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(RulePanelViewModel.prototype,"selectedFragment",{get:function(){return this._selectedFragment},set:function(value){this._selectedFragment=value;var vm=this;var isAutoChange=this._isInitializing;this._isInitializing=true;this.availableFragmentOutputs=[];var noneOutput=new Intelledox.QAWizard.Design.AvailableOutput;noneOutput.RoutingOptionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;noneOutput.Name=this._filter('translate')('NoneWithBrackets');this.availableFragmentOutputs.push(noneOutput);this.selectedFragmentOutput=Intelledox.Common.ConstantValues.GUID_EMPTY;if(value!==Intelledox.Common.ConstantValues.GUID_EMPTY){var currentFragment=null;for(var i=0;i<this.availableFragments.length;i++){if(this.availableFragments[i].ObjectId===value){currentFragment=this.availableFragments[i];break}}if(currentFragment!=null){this._listManager.projectFragment(currentFragment.ProjectGuid).then(function(fragment){for(var i=0;i<fragment.AvailableOutputs.length;i++){if(fragment.AvailableOutputs[i].SourceType!==Intelledox.Model.RoutingSourceType.Repeat){vm.availableFragmentOutputs.push(fragment.AvailableOutputs[i])}}vm.availableFragmentOutputs.sort(function(a,b){if(a.RoutingOptionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return-1}if(b.RoutingOptionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return 1}if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0})})}}this._isInitializing=isAutoChange;this.updateCompareButtons();this._isInitializing=isAutoChange},enumerable:true,configurable:true});Object.defineProperty(RulePanelViewModel.prototype,"selectedFragmentOutput",{get:function(){return this._selectedFragmentOutput},set:function(value){this._selectedFragmentOutput=value;if(value===Intelledox.Common.ConstantValues.GUID_EMPTY){this.isComparisonTypeEnabled=false;this.availableComparisonTypes=[];this.selectedComparisonType=null;this.updateCompareToBox()}else{this.enableComparisonTypeDropDown()}},enumerable:true,configurable:true});Object.defineProperty(RulePanelViewModel.prototype,"selectedRepeaterChoice",{get:function(){return this._selectedRepeaterChoice},set:function(value){this._selectedRepeaterChoice=value},enumerable:true,configurable:true});RulePanelViewModel.prototype.add=function(){var newRule=new Intelledox.QAWizard.Design.Rule;this.updateRuleDetails(newRule);this._editorViewModel.wizChanged=true;this._currentRules.Add(newRule);this.clauseDesignerModel.setParentClause(this._currentRules);this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(newRule)};RulePanelViewModel.prototype.update=function(){var r=this.clauseDesignerModel.clausesTreeView.selectedNode.tag;this.updateRuleDetails(r);this._editorViewModel.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting()};RulePanelViewModel.prototype.remove=function(){var node=this.clauseDesignerModel.clausesTreeView.selectedNode;var r=this.clauseDesignerModel.clausesTreeView.selectedNode.tag;if(node.parent==null){this._currentNode.Rules=new Intelledox.QAWizard.Design.Rule;this._currentRules=this._currentNode.Rules}else{node.parent.tag.SubClauses.splice(node.parent.tag.SubClauses.indexOf(r),1)}this._editorViewModel.wizChanged=true;this.clauseDesignerModel.setParentClause(this._currentRules);this.clauseDesignerModel.fillClauseViewFromExisting();this.updateCompareButtons()};RulePanelViewModel.prototype.init=function(wizard,currentPage,currentNode,lists){var isAutoChange=this._isInitializing;this._wizard=wizard;this._currentPage=currentPage;this._currentNode=currentNode;this._listManager=lists;this._isInitializing=true;this.fillRepeaterChoiceDropdown();this.fillTypeDropdown();this.availableQuestions=[];this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.availableAnswers=[];this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.isComparisonTypeEnabled=false;this.compareTo="";this.formula="";this.isRepeaterChoiceVisible=false;var selectedQuestion=currentNode.Question;this._currentRules=currentNode.Rules;this._repeatedQuestions=[];for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pageItem=wizard.Pages[pageIndex];this.addLayoutQuestionsToDropdown(pageItem.Children,selectedQuestion.QuestionGuid,pageItem.IsRepeated&&pageItem!==currentPage);if(pageItem===currentPage){break}}this.availableQuestions.sort(function(a,b){if(a.Text>b.Text){return 1}if(a.Text<b.Text){return-1}return 0});this.availableQuestions.splice(0,0,new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPage||this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){this.loadInputs()}this.loadFragments();this.clauseDesignerModel.init(this._currentRules,this._wizard,lists,currentNode);this.updateCompareButtons();this._isInitializing=isAutoChange};RulePanelViewModel.prototype.pickAnswerRef=function(){var _this=this;this._editorViewModel.treeView.pickEvent=function(node){_this.onPickAnswerRef(node)};this._editorViewModel.treeView.togglePickMode()};RulePanelViewModel.prototype.onPickAnswerRef=function(node){if(node.tag instanceof Intelledox.QAWizard.Design.Question){this.selectedQuestionGuid=node.tag.QuestionGuid}else if(node.tag instanceof Intelledox.QAWizard.Design.Answer){if(node.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||node.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||node.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||node.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic||node.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt){this.selectedQuestionGuid=node.parent.tag.QuestionGuid;this.selectedAnswerGuid=node.tag.AnswerGuid}else{this.selectedQuestionGuid=node.parent.tag.QuestionGuid}}};RulePanelViewModel.prototype.pickFormulaRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.formula=Design.HelperFunctions.onPickRef(_this._filter,_this.formula,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};RulePanelViewModel.prototype.pickComparisonRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.compareTo=Design.HelperFunctions.onPickRef(_this._filter,_this.compareTo,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};RulePanelViewModel.prototype.loadRule=function(r){if(r.Type===Intelledox.Model.ClauseType.Comparison){this.selectedParentType=r.ParentType;if(this.isFormulaVisible){this.formula=r.Formula}else if(this.isInputVisible){this.selectedInput=r.ParentItemGuid}else if(this.isFragmentVisible){this.selectedFragment=r.ParentItemGuid;this.selectedFragmentOutput=r.ParentAttributeGuid}else if(this.isProjectPropertyVisible){this.selectedProjectProperty=r.ParentItemGuid}else{this.selectedQuestionGuid=r.ParentItemGuid;if(r.ParentAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.selectedAnswerGuid=r.ParentAttributeGuid}this.selectedRepeaterChoice=r.EveryOrOneOf}this.selectedComparisonType=r.ComparisonType;if(this.isCompareToTextVisible){this.compareTo=Design.TranslationHelper.KeywordValueToTranslation(this._filter,r.CompareTo)}else{this.selectedCompareTo=r.CompareTo}}};RulePanelViewModel.prototype.enableComparisonTypeDropDownWithParent=function(){var questionTypeId=Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.None;this.availableComparisonTypes=[];this.selectedComparisonType=Intelledox.QAWizard.Design.ClauseComparisonType.None;if(this.selectedQuestionGuid!=null&&this.selectedQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var selectedQuestion=this.findSelectedQuestion(this.selectedQuestionGuid);if(selectedQuestion!=null){questionTypeId=selectedQuestion.QuestionTypeID}}if(questionTypeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.None){this.isComparisonTypeEnabled=false}else{if(questionTypeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||questionTypeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||questionTypeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||questionTypeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||questionTypeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt||questionTypeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric){this.availableComparisonTypes.push({name:this._filter('translate')('EqualsString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Equals});this.availableComparisonTypes.push({name:this._filter('translate')('NotEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.IsNotEqual});this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThan'),value:Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThan});this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThanorEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThanOrEquals});this.availableComparisonTypes.push({name:this._filter('translate')('LessThan'),value:Intelledox.QAWizard.Design.ClauseComparisonType.LessThan});this.availableComparisonTypes.push({name:this._filter('translate')('LessThanorEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.LessThanOrEquals});this.availableComparisonTypes.push({name:this._filter('translate')('Contains'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Contains})}this.availableComparisonTypes.push({name:this._filter('translate')('IsString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Is});this.availableComparisonTypes.push({name:this._filter('translate')('IsNotString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.IsNot});this.isComparisonTypeEnabled=true;this.selectedComparisonType=this.availableComparisonTypes[0].value}this.updateCompareToBox()};RulePanelViewModel.prototype.enableComparisonTypeDropDown=function(){this.availableComparisonTypes=[];this.availableComparisonTypes.push({name:this._filter('translate')('EqualsString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Equals});this.availableComparisonTypes.push({name:this._filter('translate')('NotEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.IsNotEqual});this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThan'),value:Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThan});this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThanorEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThanOrEquals});this.availableComparisonTypes.push({name:this._filter('translate')('LessThan'),value:Intelledox.QAWizard.Design.ClauseComparisonType.LessThan});this.availableComparisonTypes.push({name:this._filter('translate')('LessThanorEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.LessThanOrEquals});this.availableComparisonTypes.push({name:this._filter('translate')('IsString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Is});this.availableComparisonTypes.push({name:this._filter('translate')('IsNotString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.IsNot});if(this.isFragmentOutput()){this.isComparisonTypeEnabled=(this.selectedFragmentOutput!==Intelledox.Common.ConstantValues.GUID_EMPTY)}else{this.isComparisonTypeEnabled=true}this.selectedComparisonType=this.availableComparisonTypes[0].value;this.updateCompareToBox()};RulePanelViewModel.prototype.updateCompareToBox=function(){this.isCompareToTextVisible=true;if(this.isComparisonTypeEnabled===false){this.isCompareToListEnabled=false;this.isCompareToTextEnabled=false}else{if(this.selectedComparisonType===Intelledox.QAWizard.Design.ClauseComparisonType.Is||this.selectedComparisonType===Intelledox.QAWizard.Design.ClauseComparisonType.IsNot){this.isCompareToListVisible=true;this.isCompareToTextVisible=false;this.isCompareToListEnabled=true;this.availableCompareTos=[];var currentQuestion=this.findSelectedQuestion(this.selectedQuestionGuid);if(currentQuestion!=null&&(currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic)){this.availableCompareTos.push({name:this._filter('translate')('Selected'),value:"Selected"});this.selectedCompareTo=this.availableCompareTos[0].value}else{this.availableCompareTos.push({name:this._filter('translate')('TrueOption'),value:"True"});this.availableCompareTos.push({name:this._filter('translate')('FalseOption'),value:"False"});this.selectedCompareTo=this.availableCompareTos[0].value}}else{this.isCompareToListVisible=false;this.isCompareToTextVisible=true;this.isCompareToTextEnabled=true}}this.updateCompareButtons()};RulePanelViewModel.prototype.addLayoutQuestionsToDropdown=function(layout,stopQuestionGuid,inRepeater){var foundStopQuestion=false;for(var i=0;i<layout.length;i++){var n=layout[i];if(n instanceof Intelledox.QAWizard.Design.Question){var q=n;if(q.QuestionGuid===stopQuestionGuid){return true}if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric){this.availableQuestions.push(q);if(inRepeater||(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&q.SelectionType===Intelledox.Model.SelectionType.Multiple&&(this._currentNode.Question.RepeatParent===Intelledox.Common.ConstantValues.GUID_EMPTY||this._currentNode.Question.RepeatParent!==q.QuestionGuid))){this._repeatedQuestions.push(q.QuestionGuid)}}}else if(typeof n.HasContainerInterface!=="undefined"){if(!(n instanceof Intelledox.QAWizard.Design.Section&&n.IsRepeated)){foundStopQuestion=this.addLayoutQuestionsToDropdown(n.Children,stopQuestionGuid,inRepeater)}else if(this.containsQuestion(n.Children,stopQuestionGuid)){foundStopQuestion=this.addLayoutQuestionsToDropdown(n.Children,stopQuestionGuid,false)}else{foundStopQuestion=this.addLayoutQuestionsToDropdown(n.Children,stopQuestionGuid,true)}}if(foundStopQuestion){return true}}return false};RulePanelViewModel.prototype.containsQuestion=function(layout,questionGuid){for(var i=0;i<layout.length;i++){var l=layout[i];if(l!=null){if(l instanceof Intelledox.QAWizard.Design.Question){if(l.QuestionGuid===questionGuid){return true}}else if(typeof l.HasContainerInterface!=="undefined"){if(this.containsQuestion(l.Children,questionGuid)){return true}}}}return false};RulePanelViewModel.prototype.RuleActiveInstructions=function(){if(this._currentNode instanceof Intelledox.QAWizard.Design.Action){return this._filter('translate')('ActionRuleActiveInstructions')}else if(this._currentNode instanceof Intelledox.QAWizard.Design.DocumentTemplate){return this._filter('translate')('DocumentRuleActiveInstructions')}else if(this._currentNode instanceof Intelledox.QAWizard.Design.StateTransition){return this._filter('translate')('TransitionRuleActiveInstructions')}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Escalation){return this._filter('translate')('EscalationRulesActiveInstructions')}else if(this._currentNode instanceof Intelledox.QAWizard.Design.FinishPage){return this._filter('translate')('FinishPageRuleActiveInstructions')}else{return this._filter('translate')('RuleActiveInstructions')}};RulePanelViewModel.prototype.fillTypeDropdown=function(){this.availableParentTypes=[];this.availableParentTypes.push({name:this._filter('translate')('AnswerValue'),value:Intelledox.QAWizard.Design.RuleParentType.Reference});this.availableParentTypes.push({name:this._filter('translate')('Formula'),value:Intelledox.QAWizard.Design.RuleParentType.Formula});this.availableParentTypes.push({name:this._filter('translate')('Aggregate'),value:Intelledox.QAWizard.Design.RuleParentType.Aggregate});if(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPage||this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){this.availableParentTypes.push({name:this._filter('translate')('Input'),value:Intelledox.QAWizard.Design.RuleParentType.Input})}this.availableParentTypes.push({name:this._filter('translate')('FragmentOutput'),value:Intelledox.QAWizard.Design.RuleParentType.FragmentOutput});if(this._wizard.Properties.length>0){this.availableParentTypes.push({name:this._filter('translate')('ProjectProperty'),value:Intelledox.QAWizard.Design.RuleParentType.ProjectProperty})}this.selectedParentType=this.availableParentTypes[0].value};RulePanelViewModel.prototype.fillRepeaterChoiceDropdown=function(){this.availableRepeaterChoice=[];this.availableRepeaterChoice.push({name:this._filter('translate')('AtLeastOneMustMatch'),value:Intelledox.QAWizard.Design.RepeaterChoice.AtLeastOne});this.availableRepeaterChoice.push({name:this._filter('translate')('EveryOneMustMatch'),value:Intelledox.QAWizard.Design.RepeaterChoice.Every});this.selectedRepeaterChoice=this.availableRepeaterChoice[0].value};RulePanelViewModel.prototype.loadInputs=function(){this.availableInputs=[];for(var i=0;i<this._wizard.AvailableInputs.length;i++){if(this._wizard.AvailableInputs[i].valueType!==Intelledox.Model.ValueTypes.Repeat){this.availableInputs.push(this._wizard.AvailableInputs[i])}}if(this.availableInputs.length>0){this.selectedInput=this.availableInputs[0].routingElementTypeId}};RulePanelViewModel.prototype.loadFragments=function(){this.availableFragments=[];this.selectedFragment=null;for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var p=this._wizard.Pages[pageIndex];if(p instanceof Intelledox.QAWizard.Design.FragmentPage){this.availableFragments.push(p)}else{for(var i=0;i<p.Children.length;i++){this.loadFragmentsRecursive(p.Children[i])}}}if(this.availableFragments.length>0){this.selectedFragment=this.availableFragments[0].ObjectId}};RulePanelViewModel.prototype.loadFragmentsRecursive=function(node){if(node instanceof Intelledox.QAWizard.Design.FragmentReference){this.availableFragments.push(node)}else if(typeof node.HasContainerInterface!=="undefined"){for(var i=0;i<node.Children.length;i++){this.loadFragmentsRecursive(node.Children[i])}}};RulePanelViewModel.prototype.isReference=function(){return this.selectedParentType===Intelledox.QAWizard.Design.RuleParentType.Reference};RulePanelViewModel.prototype.isInput=function(){return this.selectedParentType===Intelledox.QAWizard.Design.RuleParentType.Input};RulePanelViewModel.prototype.isFragmentOutput=function(){return this.selectedParentType===Intelledox.QAWizard.Design.RuleParentType.FragmentOutput};RulePanelViewModel.prototype.isProjectProperty=function(){return this.selectedParentType===Intelledox.QAWizard.Design.RuleParentType.ProjectProperty};RulePanelViewModel.prototype.updateCompareButtons=function(){if(this.isCompareToListVisible&&this.isCompareToListEnabled){this.isAddEnabled=true}else if(this.isCompareToTextVisible&&this.isCompareToTextEnabled){this.isAddEnabled=true}else{this.isAddEnabled=false}var node=this.clauseDesignerModel.clausesTreeView.selectedNode;if(node!=null){if(node.tag.Type===Intelledox.Model.ClauseType.Comparison){this.isUpdateEnabled=this.isAddEnabled;this.isRemoveEnabled=true}else{this.isUpdateEnabled=false;this.isRemoveEnabled=false}}else{this.isUpdateEnabled=false;this.isRemoveEnabled=false}};RulePanelViewModel.prototype.findSelectedQuestion=function(questionGuid){for(var i=0;i<this.availableQuestions.length;i++){if(questionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};RulePanelViewModel.prototype.clauseViewReplaceClause=function(copyClause){var newRule=null;if(copyClause instanceof Intelledox.QAWizard.Design.Rule){newRule=copyClause.Clone()}else if(copyClause instanceof Intelledox.QAWizard.Design.Condition){var newCondition=copyClause;if(newCondition.Type===Intelledox.Model.ClauseType.AllOf||newCondition.Type===Intelledox.Model.ClauseType.AnyOf||newCondition.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Reference){newRule=new Intelledox.QAWizard.Design.Rule(newCondition.Type,newCondition.ParentItemGuid,newCondition.ParentAttributeGuid,newCondition.ComparisonType,newCondition.CompareTo);if(!this.addSubClauses(newCondition,newRule)){alert(this._filter('translate')('ErrorMsg_CanOnlyCopyReferenceConditionToRule'));return}}else{alert(this._filter('translate')('ErrorMsg_CanOnlyCopyReferenceConditionToRule'));return}}else if(copyClause instanceof Intelledox.QAWizard.Design.ValidationRule){alert(this._filter('translate')('ErrorMsg_CannotCopyValidatorRuleToOtherTabs'));return}else if(copyClause instanceof Intelledox.QAWizard.Design.Filter){alert(this._filter('translate')('ErrorMsg_CannotCopyDataFilterRuleToOtherTabs'));return}else{alert(this._filter('translate')('ErrorMsg_PasteError'));return}this._currentNode.Rules=newRule;this._currentRules=this._currentNode.Rules;this.clauseDesignerModel.setParentClause(this._currentRules);this.clauseDesignerModel.fillClauseViewFromExisting();this.updateCompareButtons();this._editorViewModel.wizChanged=true};RulePanelViewModel.prototype.addSubClauses=function(clause,parentRule){for(var i=0;i<clause.SubClauses.length;i++){var subClause=clause.SubClauses[i];var newSubClause=subClause;var newRule=null;if(newSubClause.Type===Intelledox.Model.ClauseType.AllOf||newSubClause.Type===Intelledox.Model.ClauseType.AnyOf||newSubClause.ParentType===Intelledox.QAWizard.Design.RuleParentType.Reference){newRule=new Intelledox.QAWizard.Design.Rule(newSubClause.Type,newSubClause.ParentItemGuid,newSubClause.ParentAttributeGuid,newSubClause.ComparisonType,newSubClause.CompareTo);parentRule.SubClauses.push(newRule)}else{return false}if(!this.addSubClauses(newSubClause,newRule)){return false}}return true};RulePanelViewModel.prototype.updateRuleDetails=function(r){r.ParentType=this.selectedParentType;if(this.isCompareToTextVisible){r.CompareTo=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.compareTo)}else{r.CompareTo=this.selectedCompareTo}r.ComparisonType=this.selectedComparisonType;r.Type=Intelledox.Model.ClauseType.Comparison;r.ParentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;r.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;switch(r.ParentType){case Intelledox.QAWizard.Design.RuleParentType.Reference:r.ParentAttributeGuid=this.selectedAnswerGuid;r.ParentItemGuid=this.selectedQuestionGuid;r.Formula='';if(this._repeatedQuestions.indexOf(r.ParentItemGuid)>-1){r.EveryOrOneOf=this.selectedRepeaterChoice}else{r.EveryOrOneOf=Intelledox.QAWizard.Design.RepeaterChoice.NotRepeated}break;case Intelledox.QAWizard.Design.RuleParentType.Input:r.ParentItemGuid=this.selectedInput;r.Formula='';r.EveryOrOneOf=Intelledox.QAWizard.Design.RepeaterChoice.NotRepeated;break;case Intelledox.QAWizard.Design.RuleParentType.FragmentOutput:r.ParentItemGuid=this.selectedFragment;if(this.selectedFragmentOutput!=null){r.ParentAttributeGuid=this.selectedFragmentOutput}r.Formula='';r.EveryOrOneOf=Intelledox.QAWizard.Design.RepeaterChoice.NotRepeated;break;case Intelledox.QAWizard.Design.RuleParentType.Formula:case Intelledox.QAWizard.Design.RuleParentType.Aggregate:r.Formula=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.formula);r.EveryOrOneOf=Intelledox.QAWizard.Design.RepeaterChoice.NotRepeated;break;case Intelledox.QAWizard.Design.RuleParentType.ProjectProperty:r.ParentItemGuid=this.selectedProjectProperty;r.Formula='';r.EveryOrOneOf=Intelledox.QAWizard.Design.RepeaterChoice.NotRepeated;break}};RulePanelViewModel.prototype.clauseDrop=function(dragNode,targetNode){if(dragNode.treeView===this.clauseDesignerModel.clausesTreeView){if(dragNode===targetNode||dragNode.isDecendantOf(targetNode)){alert(this._filter('translate')('ErrorMsg_MoveRuleToBeItsOwnChild'))}else{var hitRule=targetNode.tag;dragNode.parent.tag.SubClauses.splice(dragNode.parent.tag.SubClauses.indexOf(dragNode.tag),1);if(hitRule.Type===Intelledox.Model.ClauseType.Comparison){hitRule=targetNode.parent.tag}hitRule.Add(dragNode.tag);this._editorViewModel.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(hitRule)}}else{var newRule=null;var parentQuestion=null;var parentPage=null;var childObject=this._currentNode.Question;var childPage=this._currentPage;if(dragNode.tag instanceof Intelledox.QAWizard.Design.Question){switch(dragNode.tag.QuestionTypeID){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt:alert(this._filter('translate')('ErrorMsg_InvalidRuleQuestionType'));break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label:parentQuestion=dragNode.tag;parentPage=dragNode.treeView.findAncestorOrSelf(dragNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Page)}).tag;newRule=new Intelledox.QAWizard.Design.Rule(Intelledox.Model.ClauseType.Comparison,parentQuestion.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Equals,"");break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic:parentQuestion=dragNode.tag;parentPage=dragNode.treeView.findAncestorOrSelf(dragNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Page)}).tag;newRule=new Intelledox.QAWizard.Design.Rule(Intelledox.Model.ClauseType.Comparison,parentQuestion.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Is,"True");break}}else if(dragNode.tag instanceof Intelledox.QAWizard.Design.Answer){parentQuestion=dragNode.parent.tag;parentPage=dragNode.treeView.findAncestorOrSelf(dragNode,function(parentNode){return(parentNode.tag instanceof Intelledox.QAWizard.Design.Page)}).tag;switch(dragNode.parent.tag.QuestionTypeID){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic:newRule=new Intelledox.QAWizard.Design.Rule(Intelledox.Model.ClauseType.Comparison,parentQuestion.QuestionGuid,dragNode.tag.AnswerGuid,Intelledox.QAWizard.Design.ClauseComparisonType.Is,"Selected");break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label:newRule=new Intelledox.QAWizard.Design.Rule(Intelledox.Model.ClauseType.Comparison,parentQuestion.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Equals,"");break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic:newRule=new Intelledox.QAWizard.Design.Rule(Intelledox.Model.ClauseType.Comparison,parentQuestion.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Is,"True");break;case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable:case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt:newRule=new Intelledox.QAWizard.Design.Rule(Intelledox.Model.ClauseType.Comparison,parentQuestion.QuestionGuid,dragNode.tag.AnswerGuid,Intelledox.QAWizard.Design.ClauseComparisonType.Equals,"");break}}if(newRule!=null){if(this._repeatedQuestions.indexOf(newRule.ParentItemGuid)>-1){newRule.EveryOrOneOf=Intelledox.QAWizard.Design.RepeaterChoice.AtLeastOne}if(Design.ValidationWizard.isValidRuleParent(this._wizard,parentQuestion,parentPage,childObject,childPage)){if(targetNode==null){newRule=this._currentRules.Add(newRule)}else{if(targetNode.tag.Type===Intelledox.Model.ClauseType.AllOf||targetNode.tag.Type===Intelledox.Model.ClauseType.AnyOf){targetNode.tag.SubClauses.push(newRule)}else if(targetNode.parent!=null){targetNode.parent.tag.SubClauses.push(newRule)}else{newRule=this._currentRules.Add(newRule)}}this._editorViewModel.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(newRule)}else{alert(this._filter('translate')('ErrorMsg_InvalidParent'))}}}};return RulePanelViewModel}());Design.RulePanelViewModel=RulePanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var DatasourceQuestion=(function(_super){__extends(DatasourceQuestion,_super);function DatasourceQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.HasCustomDisplayFields=false;_this.DisplayField=null;_this.AnswerDisplayField=null;_this.DisplayFields=new Array;_this.ValueField=null;_this.RepeatPlaceholders=new Array;_this.SortFields=new Array;_this.AllowUserUpload=false;_this.DataSourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.DataObjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.DataObjectTypeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.TextBoxWidth=0;_this.DataSourceHierarchyGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.DataSourceRepeatXPath=null;_this.DefaultType=0;_this.ResultsPerPage=20;_this.SearchAll=true;_this.CreateMinimumRepeats=false;_this.RepeatSourceType=Design.RepeatSourceType.None;_this.RepeatSourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.RepeatSourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.IsEditableDrivenRepeat=false;_this.ShowFillDownButton=false;_this.LiveRefresh=false;_this.RefreshPeriod=0;_this.RepeatName=null;_this.GroupingField=null;_this.NoResultsMessage=null;_this.AllowSorting=false;_this.DisplayType=Intelledox.Model.QuestionDisplayType.List;return _this}Object.defineProperty(DatasourceQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Datasource},enumerable:true,configurable:true});DatasourceQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new DatasourceQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);result.HasCustomDisplayFields=this.HasCustomDisplayFields;result.DataSourceGuid=this.DataSourceGuid;result.DataObjectGuid=this.DataObjectGuid;result.DataObjectTypeGuid=this.DataObjectTypeGuid;result.DisplayField=this.DisplayField;result.AnswerDisplayField=this.AnswerDisplayField;result.ValueField=this.ValueField;result.AllowUserUpload=this.AllowUserUpload;result.TextBoxWidth=this.TextBoxWidth;result.DataSourceHierarchyGuid=this.DataSourceHierarchyGuid;result.DataSourceRepeatXPath=this.DataSourceRepeatXPath;result.DefaultType=this.DefaultType;result.ResultsPerPage=this.ResultsPerPage;result.SearchAll=this.SearchAll;result.CreateMinimumRepeats=this.CreateMinimumRepeats;result.IsEditableDrivenRepeat=this.IsEditableDrivenRepeat;result.ShowFillDownButton=this.ShowFillDownButton;result.LiveRefresh=this.LiveRefresh;result.RefreshPeriod=this.RefreshPeriod;result.RepeatName=this.RepeatName;result.GroupingField=this.GroupingField;result.NoResultsMessage=this.NoResultsMessage;for(var i=0;i<this.DisplayFields.length;i++){result.DisplayFields.push(this.DisplayFields[i].Clone())}for(var i=0;i<this.SortFields.length;i++){result.SortFields.push(this.SortFields[i].Clone())}if(this.Filters!=null){result.Filters=this.Filters.CloneFilter(this)}return result};Object.defineProperty(DatasourceQuestion.prototype,"IsRepeated",{get:function(){return this.RepeatPlaceholders.length>0},set:function(value){},enumerable:true,configurable:true});DatasourceQuestion.prototype.IsValidFilterParent=function(parent){if(this.Visibility===false){return true}else if(parent.Page.Questions.indexOf(this)>-1){switch(parent.QuestionTypeID){case Design.QuestionType.QuestionTypeEnum.Datasource:if((parent.SelectionType===Intelledox.Model.SelectionType.Single&&(parent.DisplayType===Intelledox.Model.QuestionDisplayType.List||parent.DisplayType===Intelledox.Model.QuestionDisplayType.AutoComplete))||parent.DisplayType===Intelledox.Model.QuestionDisplayType.Popup||parent.Visibility===false){return true}else{return false}case Design.QuestionType.QuestionTypeEnum.GroupLogic:case Design.QuestionType.QuestionTypeEnum.Label:case Design.QuestionType.QuestionTypeEnum.UserPrompt:case Design.QuestionType.QuestionTypeEnum.Variable:case Design.QuestionType.QuestionTypeEnum.Geolocation:case Design.QuestionType.QuestionTypeEnum.Numeric:return true;default:return false}}else{return true}};Object.defineProperty(DatasourceQuestion.prototype,"IsQARepeater",{get:function(){return(this.DataSourceGuid===Intelledox.Common.ConstantValues.QAREPEAT)},enumerable:true,configurable:true});DatasourceQuestion.prototype.GetRootDatasourceQuestion=function(wizard){var currentQuestion=this;while(currentQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){currentQuestion=wizard.FindQuestion(currentQuestion.DataSourceHierarchyGuid)}return currentQuestion};DatasourceQuestion.prototype.HasUserEnteredFilters=function(){if(this.Visibility===false||this.DisplayType!==Intelledox.Model.QuestionDisplayType.AutoComplete){return false}else{return this.HasUserEnteredFilterTypeRecursive(this.Filters)}};DatasourceQuestion.prototype.HasUserEnteredFilterTypeRecursive=function(filter){if(filter===null){return false}else if(filter.ParentType===Intelledox.QAWizard.Design.FilterParentType.UserEntered){return true}for(var i=0;i<filter.SubClauses.length;i++){if(this.HasUserEnteredFilterTypeRecursive(filter.SubClauses[i])){return true}}return false};DatasourceQuestion.SKIPWITHOUTVALUE="[SkipWithoutValue]";return DatasourceQuestion}(Design.Question));Design.DatasourceQuestion=DatasourceQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var DisplayField=(function(){function DisplayField(){this.name=null;this.displayName=null;this.dataObjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.columnTitle=null;this.link=null;this.sortable=true;this.operationsDropdown=false;this.formula=null}DisplayField.prototype.Clone=function(){var result=new DisplayField;result.name=this.name;result.displayName=this.displayName;result.dataObjectGuid=this.dataObjectGuid;result.columnTitle=this.columnTitle;result.sortable=this.sortable;result.operationsDropdown=this.operationsDropdown;result.formula=this.formula;result.link=this.link;return result};return DisplayField}());Model.DisplayField=DisplayField})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var DisplayFieldsPanelViewModel=(function(){function DisplayFieldsPanelViewModel($filter,editorViewModel,lists){this._wizard=null;this._question=null;this._selectedField='';this._selectedFieldColumnTitle='';this._selectedFieldLink=null;this._sortable=true;this._operationsDropdown=false;this._formula='';this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.isMoveUpEnabled=false;this.isMoveDownEnabled=false;this.availableFieldWidth=0;this.isFormulaVisible=false;this.existingDisplayFields=[];this.availableFields=[];this.availableLinks=[];this._editorViewModel=editorViewModel;this._filter=$filter;this._listManager=lists}Object.defineProperty(DisplayFieldsPanelViewModel.prototype,"isDataGrid",{get:function(){return this._question.DisplayType===Intelledox.Model.QuestionDisplayType.DataGrid},enumerable:true,configurable:true});Object.defineProperty(DisplayFieldsPanelViewModel.prototype,"hasAllFields",{get:function(){return!this._question.HasCustomDisplayFields},set:function(value){this._editorViewModel.wizChanged=true;this._question.HasCustomDisplayFields=!value},enumerable:true,configurable:true});Object.defineProperty(DisplayFieldsPanelViewModel.prototype,"formula",{get:function(){return this._formula},set:function(value){this._formula=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DisplayFieldsPanelViewModel.prototype,"sortable",{get:function(){return this._sortable},set:function(value){this._sortable=value},enumerable:true,configurable:true});Object.defineProperty(DisplayFieldsPanelViewModel.prototype,"operationsDropdown",{get:function(){return this._operationsDropdown},set:function(value){this._operationsDropdown=value},enumerable:true,configurable:true});Object.defineProperty(DisplayFieldsPanelViewModel.prototype,"selectedFieldFromDropDown",{get:function(){return this._selectedField},set:function(value){this._selectedField=value;var selectedDisplayField=null;for(var i=0;i<this.existingDisplayFields.length;i++){this.existingDisplayFields[i].selected=false;if(this.existingDisplayFields[i].tag.name===value){selectedDisplayField=this.existingDisplayFields[i].tag}}if(selectedDisplayField!==null){this.updateFields(selectedDisplayField)}else{if(value==="[Formula]"){this._selectedFieldColumnTitle=this.findFormulaName()}else{this._selectedFieldColumnTitle=value}}this.isFormulaVisible=(value==="[Formula]");this._sortable=true;this.updateButtons()},enumerable:true,configurable:true});Object.defineProperty(DisplayFieldsPanelViewModel.prototype,"selectedFieldLink",{get:function(){return this._selectedFieldLink},set:function(value){this._selectedFieldLink=value},enumerable:true,configurable:true});Object.defineProperty(DisplayFieldsPanelViewModel.prototype,"selectedFieldColumnTitle",{get:function(){return this._selectedFieldColumnTitle},set:function(value){this._selectedFieldColumnTitle=value;this.updateButtons()},enumerable:true,configurable:true});DisplayFieldsPanelViewModel.prototype.add=function(){var newField=new Intelledox.Model.DisplayField;var displayField=this._selectedField;if(this.questionHasDisplayField(displayField)){return}newField.name=displayField;newField.columnTitle=this.selectedFieldColumnTitle;newField.sortable=this.sortable;newField.operationsDropdown=this.operationsDropdown;if(this.selectedFieldLink!=null){newField.link=this.selectedFieldLink.value}if(displayField==="[Formula]"){newField.formula=this.formula;newField.name=this.findFormulaName()}this._question.DisplayFields.push(newField);this.fillDisplayFieldView(newField);this._editorViewModel.wizChanged=true};DisplayFieldsPanelViewModel.prototype.findFormulaName=function(){var index=1;var found=false;var formulaName="Formula";while(!found){for(var i=0;i<this._question.DisplayFields.length;i++){if(formulaName===this._question.DisplayFields[i].name){found=true;break}}if(!found){return formulaName}index++;formulaName="Formula"+index;var found=false;if(index>1000){break}}return formulaName};DisplayFieldsPanelViewModel.prototype.update=function(){var existingDisplay=this.getSelectedExistingDisplay();existingDisplay.columnTitle=this._selectedFieldColumnTitle;existingDisplay.sortable=this._sortable;existingDisplay.operationsDropdown=this._operationsDropdown;existingDisplay.formula=this._formula;existingDisplay.link=this._selectedFieldLink.value;this._editorViewModel.wizChanged=true};DisplayFieldsPanelViewModel.prototype.remove=function(){var existingDisplay=this.getSelectedExistingDisplay();this._question.DisplayFields.splice(this._question.DisplayFields.indexOf(existingDisplay),1);this.fillDisplayFieldView();this._editorViewModel.wizChanged=true;this.updateButtons()};DisplayFieldsPanelViewModel.prototype.moveUp=function(){var existingDisplay=this.getSelectedExistingDisplay();var index=this._question.DisplayFields.indexOf(existingDisplay);this._question.DisplayFields.splice(index,1);this._question.DisplayFields.splice(index-1,0,existingDisplay);this.fillDisplayFieldView(existingDisplay);this._editorViewModel.wizChanged=true};DisplayFieldsPanelViewModel.prototype.moveDown=function(){var existingDisplay=this.getSelectedExistingDisplay();var index=this._question.DisplayFields.indexOf(existingDisplay);this._question.DisplayFields.splice(index,1);this._question.DisplayFields.splice(index+1,0,existingDisplay);this.fillDisplayFieldView(existingDisplay);this._editorViewModel.wizChanged=true};DisplayFieldsPanelViewModel.prototype.init=function(wizard,question){var vm=this;this._wizard=wizard;this._question=question;this._loadedWithDataObjectGuid=question.DataObjectGuid;this._loadedWithDataSourceRepeatXPath=question.DataSourceRepeatXPath;this._formula="";this.availableFields=[];this.availableFields.push({name:this._filter('translate')('NoneWithBrackets'),value:''});if(this.isDataGrid){this.availableFields.push({name:"["+this._filter('translate')('Formula')+"]",value:'[Formula]'});this.availableLinks=this.getLinks(this._filter);vm.fillDisplayFieldView()}this.selectedFieldFromDropDown='';if(this._question.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){Design.HierarchyHelper.getDataFields(wizard,this._listManager,question,this.availableFieldWidth,false).then(function(fields){vm.availableFields.push.apply(vm.availableFields,fields);vm.fillDisplayFieldView()})}else if(this._question.IsQARepeater){var keyFields=Design.QARepeatHelper.getDataFields(this._filter,wizard,question);vm.availableFields.push.apply(vm.availableFields,keyFields);vm.fillDisplayFieldView()}else if(question.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this._listManager.dataFieldsList(question.DataObjectGuid,this.availableFieldWidth,false,"").then(function(fields){vm.availableFields.push.apply(vm.availableFields,fields);vm.fillDisplayFieldView()})}else{this.existingDisplayFields=[]}};DisplayFieldsPanelViewModel.prototype.updateButtons=function(){var existingDisplay=this.getSelectedExistingDisplay();this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.isMoveUpEnabled=false;this.isMoveDownEnabled=false;if(existingDisplay!=null){this.isRemoveEnabled=true;this.isUpdateEnabled=true;if(this.existingDisplayFields[0].tag!==existingDisplay){this.isMoveUpEnabled=true}if(this.existingDisplayFields[this.existingDisplayFields.length-1].tag!==existingDisplay){this.isMoveDownEnabled=true}}if(this._selectedField!==''){this.isAddEnabled=true}};DisplayFieldsPanelViewModel.prototype.showLinkDisplayName=function(display){var link=display.link;if(link!=null&&link!==Intelledox.Model.LinkType.NoneWithBrackets){return this._filter('translate')(Intelledox.Model.LinkType[link])}return""};DisplayFieldsPanelViewModel.prototype.selectedExistingDisplayInTable=function(display){for(var i=0;i<this.existingDisplayFields.length;i++){if(this.existingDisplayFields[i].tag===display){this.existingDisplayFields[i].selected=true}else{this.existingDisplayFields[i].selected=false}}this.showDisplayFieldDetails()};DisplayFieldsPanelViewModel.prototype.getSelectedExistingDisplay=function(){for(var i=0;i<this.existingDisplayFields.length;i++){if(this.existingDisplayFields[i].selected){return this.existingDisplayFields[i].tag}}return null};DisplayFieldsPanelViewModel.prototype.getLinks=function($filter){var availableLinks=[];var link={value:Intelledox.Model.LinkType.NoneWithBrackets,label:$filter('translate')(Intelledox.Model.LinkType[Intelledox.Model.LinkType.NoneWithBrackets])};availableLinks.push(link);this._listManager.links(this._question.DataObjectTypeGuid).then(function(fields){for(var i=0;i<fields.length;i++){var type=fields[i];var displayName=$filter('translate')(Intelledox.Model.LinkType[type]);availableLinks.push({value:type,label:displayName})}});this.selectedFieldLink=availableLinks[0];return availableLinks};DisplayFieldsPanelViewModel.prototype.fillDisplayFieldView=function(selectedField){if(selectedField===void 0){selectedField=null}var found=false;this.existingDisplayFields=[];for(var i=0;i<this._question.DisplayFields.length;i++){var field=this._question.DisplayFields[i];var displayField={tag:field,field:field.name,selected:false};found=false;for(var fieldIndex=0;fieldIndex<this.availableFields.length;fieldIndex++){if(this.availableFields[fieldIndex].value===field.name){found=true;break}else if(this.availableFields[fieldIndex].value==="[Formula]"&&System.String.StartsWith(field.name,"Formula")){found=true;break}}if(!found){displayField.field=this._filter('translate')('Invalid')}if(System.String.IsNullOrEmpty(field.columnTitle)){field.columnTitle=field.name}this.existingDisplayFields.push(displayField)}if(selectedField!==null){for(var i=0;i<this.existingDisplayFields.length;i++){if(this.existingDisplayFields[i].tag===selectedField){this.existingDisplayFields[i].selected=true;break}}}this.updateButtons()};DisplayFieldsPanelViewModel.prototype.showDisplayFieldDetails=function(){var existingDisplay=this.getSelectedExistingDisplay();if(existingDisplay==null){return}this.isFormulaVisible=(System.String.StartsWith(existingDisplay.name,"Formula"));this.updateFields(existingDisplay);this.updateButtons()};DisplayFieldsPanelViewModel.prototype.updateFields=function(display){if(System.String.StartsWith(display.name,"Formula")){this._selectedField="[Formula]"}else{this._selectedField=display.name}if(System.String.IsNullOrEmpty(display.columnTitle)){this.selectedFieldColumnTitle=display.name}else{this.selectedFieldColumnTitle=display.columnTitle}if(display.link!=null&&!isNaN(display.link)){this.selectedFieldLink={value:display.link,label:this._filter('translate')(Intelledox.Model.LinkType[display.link])}}else{this.selectedFieldLink=this.availableLinks[0]}this.sortable=display.sortable;this.operationsDropdown=display.operationsDropdown;this.formula=display.formula};DisplayFieldsPanelViewModel.prototype.findDisplayField=function(name){for(var i=0;i<this._question.DisplayFields.length;i++){if(this._question.DisplayFields[i].name===name){return this._question.DisplayFields[i]}}return null};DisplayFieldsPanelViewModel.prototype.questionHasDisplayField=function(name){if(this.findDisplayField(name)==null||name==="[Formula]"){return false}else{alert(this._filter('translate')('ErrorMsg_DisplayFieldAlreadyAdded'));return true}};Object.defineProperty(DisplayFieldsPanelViewModel.prototype,"isDashboardProject",{get:function(){return(this._wizard.TypeId===Intelledox.Model.ProjectType.Dashboard)},enumerable:true,configurable:true});DisplayFieldsPanelViewModel.prototype.activate=function(){if(this._question.DataObjectGuid!==this._loadedWithDataObjectGuid||this._question.DataSourceRepeatXPath!==this._loadedWithDataSourceRepeatXPath){this._question.HasCustomDisplayFields=false;this._question.DisplayFields=[];this.init(this._wizard,this._question)}};DisplayFieldsPanelViewModel.prototype.pickAceRef=function(id){var _this=this;var aceEditor=ace.edit(id);this._editorViewModel.treeView.pickEvent=function(node){aceEditor.insert(Design.HelperFunctions.createReferenceText(_this._filter,node));aceEditor.focus()};this._editorViewModel.treeView.togglePickMode()};DisplayFieldsPanelViewModel.prototype.onEditorLoad=function(){var vm=this;return function(editor){Design.AnswerPropertiesViewModel.configureAceEditor(editor,vm._filter)}};return DisplayFieldsPanelViewModel}());Design.DisplayFieldsPanelViewModel=DisplayFieldsPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var SortField=(function(){function SortField(){this.Name=null;this.Direction=Model.SortFieldDirection.Asc}SortField.prototype.Clone=function(){var result=new SortField;result.Name=this.Name;result.Direction=this.Direction;return result};return SortField}());Model.SortField=SortField})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var SortPanelViewModel=(function(){function SortPanelViewModel($filter,editorViewModel,lists){this._wizard=null;this._question=null;this._selectedField='';this._selectedDirection=Intelledox.Model.SortFieldDirection.Asc;this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.isMoveUpEnabled=false;this.isMoveDownEnabled=false;this.availableFieldWidth=0;this.existingSortFields=[];this.availableFields=[];this.availableDirections=[];this._editorViewModel=editorViewModel;this._filter=$filter;this._listManager=lists}Object.defineProperty(SortPanelViewModel.prototype,"selectedField",{get:function(){return this._selectedField},set:function(value){this._selectedField=value;this.updateButtons()},enumerable:true,configurable:true});Object.defineProperty(SortPanelViewModel.prototype,"selectedDirection",{get:function(){return this._selectedDirection},set:function(value){this._selectedDirection=value;this.updateButtons()},enumerable:true,configurable:true});SortPanelViewModel.prototype.add=function(){var newField=new Intelledox.Model.SortField;var sortField=this.selectedField;if(this.questionHasSortField(sortField)){return}newField.Name=sortField;newField.Direction=this.selectedDirection;this._question.SortFields.push(newField);this.fillSortFieldView();this._editorViewModel.wizChanged=true};SortPanelViewModel.prototype.update=function(){var existingSort=this.getSelectedExistingSort();var sortField=this.selectedField;if(existingSort.Name!==sortField&&this.questionHasSortField(sortField)){return}existingSort.Name=sortField;existingSort.Direction=this.selectedDirection;this.fillSortFieldView();this._editorViewModel.wizChanged=true};SortPanelViewModel.prototype.remove=function(){var existingSort=this.getSelectedExistingSort();this._question.SortFields.splice(this._question.SortFields.indexOf(existingSort),1);this.fillSortFieldView();this._editorViewModel.wizChanged=true};SortPanelViewModel.prototype.moveUp=function(){var existingSort=this.getSelectedExistingSort();var index=this._question.SortFields.indexOf(existingSort);this._question.SortFields.splice(index,1);this._question.SortFields.splice(index-1,0,existingSort);this.fillSortFieldView();this._editorViewModel.wizChanged=true};SortPanelViewModel.prototype.moveDown=function(){var existingSort=this.getSelectedExistingSort();var index=this._question.SortFields.indexOf(existingSort);this._question.SortFields.splice(index,1);this._question.SortFields.splice(index+1,0,existingSort);this.fillSortFieldView();this._editorViewModel.wizChanged=true};SortPanelViewModel.prototype.init=function(wizard,question){var vm=this;this._question=question;this._wizard=wizard;this._loadedWithDataObjectGuid=question.DataObjectGuid;this._loadedWithDataSourceRepeatXPath=question.DataSourceRepeatXPath;this.availableDirections=[];this.availableDirections.push({name:this._filter('translate')('Ascending'),value:Intelledox.Model.SortFieldDirection.Asc});this.availableDirections.push({name:this._filter('translate')('Descending'),value:Intelledox.Model.SortFieldDirection.Desc});this.selectedDirection=Intelledox.Model.SortFieldDirection.Asc;this.availableFields=[];this.availableFields.push({name:this._filter('translate')('NoneWithBrackets'),value:''});this.selectedField='';if(this._question.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){Design.HierarchyHelper.getDataFields(wizard,this._listManager,question,this.availableFieldWidth,false).then(function(fields){vm.availableFields.push.apply(vm.availableFields,fields);vm.fillSortFieldView()})}else if(this._question.IsQARepeater){var keyFields=Design.QARepeatHelper.getDataFields(this._filter,wizard,question);vm.availableFields.push.apply(vm.availableFields,keyFields);vm.fillSortFieldView()}else if(question.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this._listManager.dataFieldsList(question.DataObjectGuid,this.availableFieldWidth,false,"").then(function(fields){vm.availableFields.push.apply(vm.availableFields,fields);vm.fillSortFieldView()})}};SortPanelViewModel.prototype.directionToText=function(direction){if(direction===Intelledox.Model.SortFieldDirection.Asc){return this._filter('translate')('Ascending')}else{return this._filter('translate')('Descending')}};SortPanelViewModel.prototype.updateButtons=function(){var existingSort=this.getSelectedExistingSort();this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.isMoveUpEnabled=false;this.isMoveDownEnabled=false;if(existingSort!=null){if(this.selectedField!==''){this.isUpdateEnabled=true}this.isRemoveEnabled=true;if(this.existingSortFields[0].tag!==existingSort){this.isMoveUpEnabled=true}if(this.existingSortFields[this.existingSortFields.length-1].tag!==existingSort){this.isMoveDownEnabled=true}}if(this.selectedField!==''){this.isAddEnabled=true}};SortPanelViewModel.prototype.selectExistingSort=function(sort){for(var i=0;i<this.existingSortFields.length;i++){if(this.existingSortFields[i].tag===sort){this.existingSortFields[i].selected=true}else{this.existingSortFields[i].selected=false}}this.showSortFieldDetails()};SortPanelViewModel.prototype.getSelectedExistingSort=function(){for(var i=0;i<this.existingSortFields.length;i++){if(this.existingSortFields[i].selected){return this.existingSortFields[i].tag}}return null};SortPanelViewModel.prototype.fillSortFieldView=function(){var found=false;this.existingSortFields=[];for(var i=0;i<this._question.SortFields.length;i++){var field=this._question.SortFields[i];var displayField={tag:field,field:field.Name,direction:this.directionToText(field.Direction),selected:false};found=false;for(var fieldIndex=0;fieldIndex<this.availableFields.length;fieldIndex++){if(this.availableFields[fieldIndex].value===field.Name){found=true;break}}if(!found){displayField.field=this._filter('translate')('Invalid')}this.existingSortFields.push(displayField)}this.updateButtons()};SortPanelViewModel.prototype.showSortFieldDetails=function(){var existingSort=this.getSelectedExistingSort();if(existingSort==null){return}this.selectedField=existingSort.Name;this.selectedDirection=existingSort.Direction;this.updateButtons()};SortPanelViewModel.prototype.findSortField=function(name){for(var i=0;i<this._question.SortFields.length;i++){if(this._question.SortFields[i].Name===name){return this._question.SortFields[i]}}return null};SortPanelViewModel.prototype.questionHasSortField=function(name){if(this.findSortField(name)==null){return false}else{alert(this._filter('translate')('ErrorMsg_SortFieldAlreadyAdded'));return true}};SortPanelViewModel.prototype.activate=function(){if(this._question.DataObjectGuid!==this._loadedWithDataObjectGuid||this._question.DataSourceRepeatXPath!==this._loadedWithDataSourceRepeatXPath){this.init(this._wizard,this._question)}};return SortPanelViewModel}());Design.SortPanelViewModel=SortPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var AddressAnswer=(function(_super){__extends(AddressAnswer,_super);function AddressAnswer(){return _super!==null&&_super.apply(this,arguments)||this}AddressAnswer.prototype.Clone=function(){var result=new AddressAnswer;return _super.prototype.CloneInternal.call(this,result)};return AddressAnswer}(Design.Answer));Design.AddressAnswer=AddressAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var AddressAnswerPropertiesViewModel=(function(_super){__extends(AddressAnswerPropertiesViewModel,_super);function AddressAnswerPropertiesViewModel(editorViewModel,question,answer,$filter,designApi,lists){var _this=_super.call(this,editorViewModel,question,answer,$filter,lists)||this;_this.isImagePropertiesVisible=false;_this.availableFields=[];_this._filterLocal=$filter;_this._editor=editorViewModel;_this._addressAnswer=answer;_this.imageProperties=new Design.ImagePropertiesViewModel($filter,editorViewModel,answer.ImageSettings);_this.imageProperties.isAlternativeTextVisible=true;lists.addressFields().then(function(data){return _this.loadFields(data)});return _this}Object.defineProperty(AddressAnswerPropertiesViewModel.prototype,"field",{get:function(){return this._addressAnswer.DataField},set:function(value){this._addressAnswer.DataField=value;this._editor.wizChanged=true;this.checkImageProperties()},enumerable:true,configurable:true});AddressAnswerPropertiesViewModel.prototype.loadFields=function(data){this.availableFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:new Intelledox.Model.Variable('',0)});for(var i=0;i<data.length;i++){var item=data[i];this.availableFields.push({name:this.addressFieldToTranslation(item.name),value:item})}this.checkImageProperties()};AddressAnswerPropertiesViewModel.prototype.checkImageProperties=function(){for(var i=0;i<this.availableFields.length;i++){if(this._addressAnswer.DataField===this.availableFields[i].name){this.isImagePropertiesVisible=(this.availableFields[i].value.typeId===Intelledox.Model.ValidationType.Image);return}}};AddressAnswerPropertiesViewModel.prototype.addressFieldToTranslation=function(addressField){switch(addressField.toLowerCase()){case"address_id":return this._filterLocal('translate')('AddressId');case"addresstype_id":return this._filterLocal('translate')('AddressTypeId');case"user_id":return this._filterLocal('translate')('UserId');case"usergroup_id":return this._filterLocal('translate')('UserGroupId');case"address_reference":return this._filterLocal('translate')('AddressReference');case"prefix":return this._filterLocal('translate')('Prefix');case"first_name":return this._filterLocal('translate')('FirstName');case"last_name":return this._filterLocal('translate')('LastName');case"full_name":return this._filterLocal('translate')('FullName');case"salutation_name":return this._filterLocal('translate')('SalutationName');case"title":return this._filterLocal('translate')('Title');case"organisation_name":return this._filterLocal('translate')('OrganisationName');case"phone_number":return this._filterLocal('translate')('PhoneNumber');case"fax_number":return this._filterLocal('translate')('FaxNumber');case"email_address":return this._filterLocal('translate')('EmailAddress');case"street_address_1":return this._filterLocal('translate')('StreetAddress1');case"street_address_2":return this._filterLocal('translate')('StreetAddress2');case"street_address_suburb":return this._filterLocal('translate')('StreetAddressSuburb');case"street_address_state":return this._filterLocal('translate')('StreetAddressState');case"street_address_postcode":return this._filterLocal('translate')('StreetAddressPostcode');case"street_address_country":return this._filterLocal('translate')('StreetAddressCountry');case"postal_address_1":return this._filterLocal('translate')('PostalAddress1');case"postal_address_2":return this._filterLocal('translate')('PostalAddress2');case"postal_address_suburb":return this._filterLocal('translate')('PostalAddressSuburb');case"postal_address_state":return this._filterLocal('translate')('PostalAddressState');case"postal_address_postcode":return this._filterLocal('translate')('PostalAddressPostcode');case"postal_address_country":return this._filterLocal('translate')('PostalAddressCountry');default:return addressField}};return AddressAnswerPropertiesViewModel}(Design.AnswerPropertiesViewModel));Design.AddressAnswerPropertiesViewModel=AddressAnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var FileSelectionPropertiesViewModel=(function(_super){__extends(FileSelectionPropertiesViewModel,_super);function FileSelectionPropertiesViewModel(editorViewModel,question,designApi,$filter,lists,hasContentLibraryModule){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._hasLoadedContentFolders=false;_this._hasLoadedRestrictFolders=false;_this._filterLocal=$filter;_this._editor=editorViewModel;_this._fileSelection=question;_this._designApi=designApi;_this._hasContentLibraryModule=hasContentLibraryModule;_this.loadContentTypes();_this.loadDisplayTypes();_this.loadRestrictFolders();if((_this._fileSelection.DisplayType===Intelledox.Model.QuestionDisplayType.Upload||_this._fileSelection.DisplayType===Intelledox.Model.QuestionDisplayType.UploadOrSearch)&&_this._fileSelection.AllowAddToContentLibrary){_this.loadContentFolders()}return _this}Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"isFileSelection",{get:function(){return true},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"isAttachmentNameVisible",{get:function(){return(this.contentType===Intelledox.Model.ContentType.Attachment)},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"isValidExtensionsVisible",{get:function(){return((this.contentType===Intelledox.Model.ContentType.Attachment||this.contentType===Intelledox.Model.ContentType.Image||this.contentType===Intelledox.Model.ContentType.Audio)&&(this.displayType===Intelledox.Model.QuestionDisplayType.Upload||this.displayType===Intelledox.Model.QuestionDisplayType.UploadOrSearch))},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"isAddToContentLibraryVisible",{get:function(){return this._hasContentLibraryModule&&(this.displayType===Intelledox.Model.QuestionDisplayType.Upload||this.displayType===Intelledox.Model.QuestionDisplayType.UploadOrSearch)},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"isContentFolderVisible",{get:function(){return(this.isAddToContentLibraryVisible&&this.allowAddToContentLibrary)},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"isRestrictFolderVisible",{get:function(){return(this.displayType===Intelledox.Model.QuestionDisplayType.Search||this.displayType===Intelledox.Model.QuestionDisplayType.UploadOrSearch)},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"isKeepSourceFormattingVisible",{get:function(){return(this.contentType===Intelledox.Model.ContentType.DocumentFragment)},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"isAllowEditVisible",{get:function(){return(this.contentType===Intelledox.Model.ContentType.UnformattedText&&(this.displayType===Intelledox.Model.QuestionDisplayType.Search||this.displayType===Intelledox.Model.QuestionDisplayType.UploadOrSearch))},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"attachmentName",{get:function(){return this._fileSelection.AttachmentFileName},set:function(value){this._fileSelection.AttachmentFileName=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"validExtensions",{get:function(){return this._fileSelection.ValidExtensions},set:function(value){this._fileSelection.ValidExtensions=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"contentType",{get:function(){return this._fileSelection.ContentTypeRestriction},set:function(value){this._fileSelection.ContentTypeRestriction=value;this._editor.wizChanged=true;this.loadDisplayTypes();this._fileSelection.ExistingContentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"displayType",{get:function(){return this._fileSelection.DisplayType},set:function(value){this._fileSelection.DisplayType=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"keepSourceFormatting",{get:function(){return this._fileSelection.KeepSourceFormatting},set:function(value){this._fileSelection.KeepSourceFormatting=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"allowAddToContentLibrary",{get:function(){return this._fileSelection.AllowAddToContentLibrary},set:function(value){this._fileSelection.AllowAddToContentLibrary=value;this._editor.wizChanged=true;if(value){this.loadContentFolders()}},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"selectedRestrictByFolder",{get:function(){if(!this._hasLoadedRestrictFolders){return undefined}return this._fileSelection.ContentFolderRestriction},set:function(value){this._fileSelection.ContentFolderRestriction=value;this._editor.wizChanged=true;for(var i=0;i<this.availableRestrictFolders.length;i++){if(this.availableRestrictFolders[i].value===value){this._fileSelection.ContentFolderRestrictionName=this.availableRestrictFolders[i].name;break}}},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"selectedContentFolder",{get:function(){if(!this._hasLoadedContentFolders){return undefined}return this._fileSelection.ContentFolder},set:function(value){this._fileSelection.ContentFolder=value;this._editor.wizChanged=true;for(var i=0;i<this.availableContentFolders.length;i++){if(this.availableContentFolders[i].value===value){this._fileSelection.ContentFolderName=this.availableContentFolders[i].name;break}}},enumerable:true,configurable:true});Object.defineProperty(FileSelectionPropertiesViewModel.prototype,"allowEdit",{get:function(){return this._fileSelection.AllowEdit},set:function(value){this._fileSelection.AllowEdit=value;this._editor.wizChanged=true},enumerable:true,configurable:true});FileSelectionPropertiesViewModel.prototype.validateValidExtensions=function(){if(this._fileSelection.ContentTypeRestriction===Intelledox.Model.ContentType.Image){if(!System.String.IsNullOrEmpty(this._fileSelection.ValidExtensions)){var fileTypes=this._fileSelection.ValidExtensions.split(",");for(var i=0;i<fileTypes.length;i++){var fileType=fileTypes[i];fileType=fileType.trim();if(fileType.indexOf("*")===0){fileType=fileType.substring(1)}if(fileType.indexOf(".")===0){fileType=fileType.substring(1)}if(!(Intelledox.Common.Functions.EqualsIgnoreCase(fileType,"bmp")||Intelledox.Common.Functions.EqualsIgnoreCase(fileType,"jpg")||Intelledox.Common.Functions.EqualsIgnoreCase(fileType,"jpeg")||Intelledox.Common.Functions.EqualsIgnoreCase(fileType,"gif")||Intelledox.Common.Functions.EqualsIgnoreCase(fileType,"png"))){alert(System.String.Format(this._filterLocal('translate')('ErrorMsg_InvalidFileType'),"bmp, jpg, jpeg, gif, png"));this.validExtensions="";break}}}}};FileSelectionPropertiesViewModel.prototype.loadContentTypes=function(){this.availableContentTypes=[];this.availableContentTypes.push({name:this._filterLocal('translate')('DocumentFragment'),value:Intelledox.Model.ContentType.DocumentFragment});this.availableContentTypes.push({name:this._filterLocal('translate')('Image'),value:Intelledox.Model.ContentType.Image});this.availableContentTypes.push({name:this._filterLocal('translate')('Text'),value:Intelledox.Model.ContentType.UnformattedText});this.availableContentTypes.push({name:this._filterLocal('translate')('Attachment'),value:Intelledox.Model.ContentType.Attachment});this.availableContentTypes.push({name:this._filterLocal('translate')('Audio'),value:Intelledox.Model.ContentType.Audio})};FileSelectionPropertiesViewModel.prototype.loadDisplayTypes=function(){this.availableDisplayTypes=[];if(this.contentType!==Intelledox.Model.ContentType.Audio){this.availableDisplayTypes.push({name:this._filterLocal('translate')('Search'),value:Intelledox.Model.QuestionDisplayType.Search})}this.availableDisplayTypes.push({name:this._filterLocal('translate')('Upload'),value:Intelledox.Model.QuestionDisplayType.Upload});if(this.contentType!==Intelledox.Model.ContentType.Audio){this.availableDisplayTypes.push({name:this._filterLocal('translate')('UploadOrSearch'),value:Intelledox.Model.QuestionDisplayType.UploadOrSearch})}if(this.availableDisplayTypes.length===1){this.displayType=this.availableDisplayTypes[0].value}};FileSelectionPropertiesViewModel.prototype.loadRestrictFolders=function(){var vm=this;this.availableRestrictFolders=[];this.availableRestrictFolders.push({name:this._filterLocal('translate')('All'),value:Intelledox.Common.ConstantValues.GUID_EMPTY});this.availableRestrictFolders.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:"99999999-9999-9999-9999-999999999999"});this._designApi.getContentFolders(false).then(function(folders){for(var i=0;i<folders.length;i++){vm.availableRestrictFolders.push({name:folders[i].name,value:folders[i].folderGuid})}vm._hasLoadedRestrictFolders=true})};FileSelectionPropertiesViewModel.prototype.loadContentFolders=function(){var vm=this;this.availableContentFolders=[];this.availableContentFolders.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY});this._designApi.getContentFolders(true).then(function(folders){for(var i=0;i<folders.length;i++){vm.availableContentFolders.push({name:folders[i].name,value:folders[i].folderGuid})}vm._hasLoadedContentFolders=true})};return FileSelectionPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.FileSelectionPropertiesViewModel=FileSelectionPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var WizardExternalLookupService=(function(){function WizardExternalLookupService(listManager){this._listManager=listManager}WizardExternalLookupService.prototype.fieldNameToDisplayName=function(dataObjectGuid,fieldName){var vm=this;return this._listManager.dataFields(dataObjectGuid,true,"").then(function(fields){for(var i=0;i<fields.length;i++){if(fields[i].name===fieldName){return vm._listManager.dataFieldToTranslation(fields[i].displayName)}}return fieldName})};WizardExternalLookupService.prototype.keyFieldToDisplayName=function(dataObjectGuid,fieldName){return this._listManager.keyFields(dataObjectGuid,"").then(function(fields){for(var i=0;i<fields.length;i++){if(fields[i].name===fieldName){if(System.String.IsNullOrEmpty(fields[i].displayName)){return fields[i].name}else{return fields[i].displayName}}}return fieldName})};return WizardExternalLookupService}());Design.WizardExternalLookupService=WizardExternalLookupService})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ValidationWizard=(function(){function ValidationWizard(filter,listManager){this._filter=filter;this._listManager=listManager}ValidationWizard.prototype.validate=function(projWizard,availablePlaceholders,contentItems,dataSources,dataObjects,dataFields,keyFields,contentFolders,contentItemPlaceholders,actionAttributes,customQuestionInputs,escalationAttributes,fragmentOutputs,responseMetadataFields){this._wizard=projWizard;this._actionAttributes=actionAttributes;this._customQuestionInputs=customQuestionInputs;this._fragmentOutputs=fragmentOutputs;this._responseMetadataFields=responseMetadataFields;var foundQuestions=[];var answerFileLabels=[];var usedRepeatPlaceholders=[];var numQuestions=0;var questions=[];for(var pageIndex=0;pageIndex<projWizard.Pages.length;pageIndex++){questions.push.apply(questions,projWizard.Pages[pageIndex].Questions);numQuestions+=projWizard.Pages[pageIndex].Questions.length}var counter=0;var contentItemIDs=[];for(var i=0;i<contentItems.length;i++){contentItemIDs.push(contentItems[i].contentItemGuid)}var foundActions=projWizard.getAllActionQuestionActions();for(var pageIndex=0;pageIndex<projWizard.Pages.length;pageIndex++){var page=projWizard.Pages[pageIndex];var nextQuestionGuid;if(questions.length===0){nextQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}else{var indexOfNextQuestion=0;if(page.Questions.length===0){if(foundQuestions.length===0){indexOfNextQuestion=0}else{indexOfNextQuestion=foundQuestions.length}}else{indexOfNextQuestion=questions.indexOf(page.Questions[page.Questions.length-1])+1}if(indexOfNextQuestion<questions.length){nextQuestionGuid=questions[indexOfNextQuestion].QuestionGuid}else{nextQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}}if(page.IsRepeated){this.validateFormulaField(page.RepeatTitle,projWizard,page,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceRepeatTitle,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaRepeatTitle,nextQuestionGuid,fragmentOutputs,false,null);this.validateFormulaField(page.MaximumRepeats,projWizard,page,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMaximumRepeats,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMaximumRepeats,nextQuestionGuid,fragmentOutputs,false,null);this.validateFormulaField(page.MinimumRepeats,projWizard,page,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMinimumRepeats,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMinimumRepeats,nextQuestionGuid,fragmentOutputs,false,null);this.placeholdersInDocuments(page,page.RepeatPlaceholders,availablePlaceholders,contentItemPlaceholders);this.repeatPlaceholdersBeenUsed(page,page.RepeatPlaceholders,usedRepeatPlaceholders)}if(page instanceof Intelledox.QAWizard.Design.FragmentPage){this.validateFragment(page,projWizard,dataFields,fragmentOutputs,nextQuestionGuid,availablePlaceholders,contentItemPlaceholders)}this.validateCondition(page.ActiveConditions,projWizard,foundQuestions,page,fragmentOutputs);this.validateCondition(page.VisibleConditions,projWizard,foundQuestions,page,fragmentOutputs);this.validateCondition(page.EditableConditions,projWizard,foundQuestions,page,fragmentOutputs);if(foundQuestions.length===0){this.validateLayout(page.Children,projWizard,dataFields,null,questions,availablePlaceholders,contentItemPlaceholders,dataSources,dataObjects,keyFields,contentItemIDs,answerFileLabels,contentFolders,foundQuestions,counter,numQuestions,usedRepeatPlaceholders,customQuestionInputs,fragmentOutputs)}else{var lastQuestion=projWizard.FindQuestion(foundQuestions[foundQuestions.length-1]);this.validateLayout(page.Children,projWizard,dataFields,lastQuestion,questions,availablePlaceholders,contentItemPlaceholders,dataSources,dataObjects,keyFields,contentItemIDs,answerFileLabels,contentFolders,foundQuestions,counter,numQuestions,usedRepeatPlaceholders,customQuestionInputs,fragmentOutputs)}}this.validateCondition(this._wizard.FinishPageConditions,this._wizard,foundQuestions,Intelledox.Common.ConstantValues.FINISHPAGETAG,fragmentOutputs);this.validateFormulaField(this._wizard.GenerateButtonText,projWizard,Intelledox.Common.ConstantValues.FINISHPAGETAG,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishGenerateButtonText,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishGenerateButtonText,Intelledox.Common.ConstantValues.GUID_EMPTY,fragmentOutputs,false,null);this.validateFormulaField(this._wizard.GeneratingText,projWizard,Intelledox.Common.ConstantValues.FINISHPAGETAG,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishGeneratingText,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishGeneratingText,Intelledox.Common.ConstantValues.GUID_EMPTY,fragmentOutputs,false,null);this.validateFormulaField(this._wizard.DownloadPageTitle,projWizard,Intelledox.Common.ConstantValues.FINISHPAGETAG,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishDownloadPageTitle,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishDownloadPageTitle,Intelledox.Common.ConstantValues.GUID_EMPTY,fragmentOutputs,false,null);this.validateFormulaField(this._wizard.FinishTitle,projWizard,Intelledox.Common.ConstantValues.FINISHPAGETAG,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishPageTitle,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishPageTitle,Intelledox.Common.ConstantValues.GUID_EMPTY,fragmentOutputs,false,null);this.validateFormulaField(this._wizard.OfflineRedirectMessage,projWizard,Intelledox.Common.ConstantValues.FINISHPAGETAG,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadOfflineRedirectMessage,Intelledox.QAWizard.Design.ValidationErrorType.BadOfflineRedirectMessage,Intelledox.Common.ConstantValues.GUID_EMPTY,fragmentOutputs,false,null);this.validateFormulaField(this._wizard.OnlineRedirectMessage,projWizard,Intelledox.Common.ConstantValues.FINISHPAGETAG,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadOnlineRedirectMessage,Intelledox.QAWizard.Design.ValidationErrorType.BadOnlineRedirectMessage,Intelledox.Common.ConstantValues.GUID_EMPTY,fragmentOutputs,false,null);for(var i=0;i<projWizard.Actions.length;i++){this.validateAction(projWizard.Actions[i],foundActions,projWizard,foundQuestions,actionAttributes,dataFields,contentItemIDs,fragmentOutputs)}for(var i=0;i<projWizard.Documents.length;i++){this.validateConditionFull(projWizard.Documents[i].Conditions,projWizard,foundQuestions,true,projWizard.Documents[i],foundActions,fragmentOutputs);if(projWizard.Documents[i].HasPlaceholders){this.validatePlaceholders(projWizard.Documents[i].Placeholders,availablePlaceholders,contentItemPlaceholders)}}if(this._wizard.Workflow.HasWorkflow){var fullStateList=this._wizard.Workflow.FullStateList;if(fullStateList!=null){for(var stateIndex=0;stateIndex<fullStateList.length;stateIndex++){var state=fullStateList[stateIndex];for(var escalationIndex=0;escalationIndex<state.EscalationList.length;escalationIndex++){var escalation=state.EscalationList[escalationIndex];var foundInputs=[];for(var escalationInputIndex=0;escalationInputIndex<escalation.EscalationInputs.length;escalationInputIndex++){var input=escalation.EscalationInputs[escalationInputIndex];foundInputs.push(input.ElementTypeId);this.validateFormulaField(input.FixedValue,projWizard,escalation,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceEscalationAttribute,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceEscalationAttribute,Intelledox.Common.ConstantValues.GUID_EMPTY,fragmentOutputs,false,null)}for(var attributeIndex=0;attributeIndex<escalationAttributes[escalation.Type.routingTypeId].length;attributeIndex++){var attribute=escalationAttributes[escalation.Type.routingTypeId][attributeIndex];if(attribute.required){if(foundInputs.indexOf(attribute.routingElementTypeId)===-1){this.raiseValidationError(escalation,Intelledox.QAWizard.Design.ValidationErrorType.RequiredEscalationAttributeNotFound,0)}}}this.validateEscalationQuestionReference(escalation,projWizard,foundQuestions)}for(var tranIndex=0;tranIndex<state.Transitions.length;tranIndex++){var tran=state.Transitions[tranIndex];this.validateConditionFull(tran.Conditions,projWizard,foundQuestions,true,state,foundActions,fragmentOutputs);this.validateWorkflowQuestionReference(tran,projWizard,foundQuestions);for(var tranActionIndex=0;tranActionIndex<tran.Actions.length;tranActionIndex++){this.validateAction(tran.Actions[tranActionIndex],foundActions,projWizard,foundQuestions,actionAttributes,dataFields,contentItemIDs,fragmentOutputs)}}}}}if(this.validationCompleteCallback!=null){this.validationCompleteCallback()}};ValidationWizard.isValidParentAction=function(parent,child,projWizard){if(parent.IsRepeated&&parent.RepeaterGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(child.IsRepeated){if(child.RepeaterGuid!==parent.RepeaterGuid){if(!projWizard.FindLayoutNode(parent.RepeaterGuid).HasChild(child.RepeaterGuid)){return false}}}else{return false}}else if(child.IsRepeated&&child.RepeaterGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var i=0;i<projWizard.Documents.length;i++){if(projWizard.Documents[i].RepeatSourceGuid===child.RepeaterGuid){return false}}}return true};ValidationWizard.isValidRepeatPosition=function(nodes,parent,child){for(var i=0;i<nodes.length;i++){var n=nodes[i];if(parent===n){return true}else if(child===n){return false}if(typeof(n.HasContainerInterface)!=="undefined"){var container=n;if((n instanceof Intelledox.QAWizard.Design.Page&&n.IsRepeated)||(n instanceof Intelledox.QAWizard.Design.Section&&n.IsRepeated)){if(!ValidationWizard.containsLayoutNode(container.Children,child)){continue}}var result=ValidationWizard.isValidRepeatPosition(container.Children,parent,child);if(result!==null){return result}}}return null};ValidationWizard.isValidConditionParentQuestionType=function(parentQuestionType){if(parentQuestionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic||parentQuestionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||parentQuestionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||parentQuestionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||parentQuestionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||parentQuestionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt||parentQuestionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom||parentQuestionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation||parentQuestionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||parentQuestionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric){return true}else{return false}};ValidationWizard.isValidSamePageConditionParentQuestion=function(parentQuestion){if(parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic||parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom||parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation||parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric||(parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&(parentQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.List||parentQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.AutoComplete))){return true}else{return false}};ValidationWizard.isValidRuleParent=function(projWizard,parent,parentPage,child,childPage){if(child instanceof Intelledox.QAWizard.Design.Question){if((parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic||parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic||parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt||parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom||parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation||parent.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric)){if(parentPage===childPage){if(parentPage.Questions.indexOf(parent)<parentPage.Questions.indexOf(child)){return true}}else{if(projWizard.Pages.indexOf(parentPage)<projWizard.Pages.indexOf(childPage)){return true}}}}return false};ValidationWizard.prototype.validateFormulaField=function(field,projWizard,item,dataFields,referenceErrorMessage,formulaErrorMessage,stopQuestionGuid,fragmentOutputs,checkActionRef,subItem){if(!System.String.IsNullOrEmpty(field)){var expressionBuilder=new Intelledox.QAWizard.Design.AnswerExpressionBuilder;if(System.String.StartsWith(field,'=')){if(!expressionBuilder.IsValidFormula(field,projWizard,null,stopQuestionGuid,dataFields,checkActionRef,fragmentOutputs)){if(expressionBuilder.ErrorDescription!=null&&System.String.StartsWith(expressionBuilder.ErrorDescription,"@@REFERENCE ERROR:")){this.raiseValidationErrorWithMessage(item,referenceErrorMessage,0,this.getBadReference(expressionBuilder.ErrorDescription),subItem)}else{this.raiseValidationErrorWithMessage(item,formulaErrorMessage,0,"",subItem)}}}else{expressionBuilder.ValidateReferences(field,projWizard,null,stopQuestionGuid,dataFields,checkActionRef,fragmentOutputs);if(!System.String.IsNullOrEmpty(expressionBuilder.ErrorDescription)){this.raiseValidationErrorWithMessage(item,referenceErrorMessage,0,this.getBadReference(expressionBuilder.ErrorDescription),subItem)}}}};ValidationWizard.prototype.placeholdersInDocuments=function(errorItem,placeholders,availablePlaceholders,contentItemPlaceholders){for(var currentPlaceholderIndex=0;currentPlaceholderIndex<placeholders.length;currentPlaceholderIndex++){var placeholderName=placeholders[currentPlaceholderIndex];var foundPlaceholder=false;for(var docGuid in availablePlaceholders){if(!availablePlaceholders.hasOwnProperty(docGuid)){continue}for(var availablePlaceholderIndex=0;availablePlaceholderIndex<availablePlaceholders[docGuid].length;availablePlaceholderIndex++){var bm=availablePlaceholders[docGuid][availablePlaceholderIndex];if(bm.equals(placeholderName)){foundPlaceholder=true;break}}if(foundPlaceholder){break}}if(!foundPlaceholder){var found=false;for(var contentIndex=0;contentIndex<contentItemPlaceholders.length;contentIndex++){if(contentItemPlaceholders[contentIndex].equals(placeholderName)){found=true;break}}if(!found){}}}};ValidationWizard.prototype.repeatPlaceholdersBeenUsed=function(errorItem,repeats,usedRepeatPlaceholders){for(var repeatIndex=0;repeatIndex<repeats.length;repeatIndex++){var placeholderName=repeats[repeatIndex];var foundPlaceholder=false;for(var placeIndex=0;placeIndex<usedRepeatPlaceholders.length;placeIndex++){if(usedRepeatPlaceholders[placeIndex].equals(placeholderName)){foundPlaceholder=true;break}}if(foundPlaceholder){this.raiseValidationError(errorItem,Intelledox.QAWizard.Design.ValidationErrorType.RepeatPlaceholderAlreadyUsed,1)}else{usedRepeatPlaceholders.push(placeholderName)}}};ValidationWizard.prototype.validateFragment=function(fragment,projWizard,dataFields,fragmentOutputs,stopQuestionGuid,availablePlaceholders,contentItemPlaceholders){if(fragment.HasDocuments){for(var docIndex=0;docIndex<fragment.Documents.length;docIndex++){this.validatePlaceholders(fragment.Documents[docIndex].Placeholders,availablePlaceholders,contentItemPlaceholders)}}for(var inputIndex=0;inputIndex<fragment.Inputs.length;inputIndex++){var input=fragment.Inputs[inputIndex];if(input.SourceType===Intelledox.Model.RoutingSourceType.FixedValue){this.validateFormulaField(input.FixedValue,projWizard,fragment,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFragmentInput,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFragmentInput,stopQuestionGuid,fragmentOutputs,false,null)}}for(var outputIndex=0;outputIndex<fragment.Outputs.length;outputIndex++){var output=fragment.Outputs[outputIndex];var foundOutput=false;for(var availableIndex=0;availableIndex<fragmentOutputs[fragment.ObjectId].length;availableIndex++){var availableOutput=fragmentOutputs[fragment.ObjectId][availableIndex];if(availableOutput.RoutingOptionGuid===output.OutputGuid){foundOutput=true;break}}if(!foundOutput){this.raiseValidationError(output,Intelledox.QAWizard.Design.ValidationErrorType.OutputNotFoundInFragment,0)}}};ValidationWizard.prototype.validateCondition=function(condition,projWizard,foundQuestions,containingObject,fragmentOutputs){this.validateConditionFull(condition,projWizard,foundQuestions,false,containingObject,[],fragmentOutputs)};ValidationWizard.prototype.validateConditionFull=function(condition,projWizard,foundQuestions,allQuestionsFound,containingObject,foundActions,fragmentOutputs){if(condition==null||condition.Type===Intelledox.Model.ClauseType.Basic){return}switch(condition.Type){case Intelledox.Model.ClauseType.AllOf:case Intelledox.Model.ClauseType.AnyOf:for(var i=0;i<condition.SubClauses.length;i++){this.validateConditionFull(condition.SubClauses[i],projWizard,foundQuestions,allQuestionsFound,containingObject,foundActions,fragmentOutputs)}break;case Intelledox.Model.ClauseType.Comparison:if(condition.ParentType===Intelledox.QAWizard.Design.ConditionParentType.State){var stateFound=false;var fullStateList=projWizard.Workflow.FullStateList;for(var i=0;i<fullStateList.length;i++){if(fullStateList[i].Id.toString()===condition.CompareTo){stateFound=true;break}}if(!stateFound){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentState,1)}}else if(condition.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Action){var foundAction=false;if(foundActions.length===0){var rabqActions=projWizard.getAllActionQuestionActions();for(var i=0;i<rabqActions.length;i++){var a=rabqActions[i];if(a.ActionGuid===condition.ParentItemGuid){foundAction=true;if(containingObject instanceof Intelledox.QAWizard.Design.Action){if(!ValidationWizard.isValidParentAction(a,containingObject,projWizard)){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentAction,1)}}}}}else{for(var i=0;i<foundActions.length;i++){var a=foundActions[i];if(a.ActionGuid===condition.ParentItemGuid){foundAction=true;if(!ValidationWizard.isValidParentAction(a,containingObject,projWizard)){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentAction,1)}}}}if(!foundAction){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentAction,1)}}else if(condition.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Input){var foundInput=false;for(var i=0;i<projWizard.AvailableInputs.length;i++){if(projWizard.AvailableInputs[i].routingElementTypeId===condition.ParentItemGuid){foundInput=true;break}}if(!foundInput){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentInput,1)}}else if(condition.ParentType===Intelledox.QAWizard.Design.ConditionParentType.FragmentOutput){if(!fragmentOutputs.hasOwnProperty(condition.ParentItemGuid)){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentFragment,1)}else{var foundOutput=false;for(var i=0;i<fragmentOutputs[condition.ParentItemGuid].length;i++){if(fragmentOutputs[condition.ParentItemGuid][i].RoutingOptionGuid===condition.ParentAttributeGuid){foundOutput=true;break}}if(!foundOutput){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentOutput,1)}}}else{if(foundQuestions.indexOf(condition.ParentItemGuid)===-1){if(allQuestionsFound){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.ParentQuestionDeleted,1)}else{this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestionOrder,1)}}else{var refQuestion=null;var exitPageLoop=false;for(var pageIndex=0;pageIndex<projWizard.Pages.length;pageIndex++){var g=projWizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<g.Questions.length;questionIndex++){var q=g.Questions[questionIndex];if(q.QuestionGuid===condition.ParentItemGuid){refQuestion=q;exitPageLoop=true;if((condition.ComparisonType===Intelledox.QAWizard.Design.ClauseComparisonType.Is||condition.ComparisonType===Intelledox.QAWizard.Design.ClauseComparisonType.IsNot)&&condition.ParentAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var foundAnswer=false;for(var answerIndex=0;answerIndex<q.Answers.length;answerIndex++){if(q.Answers[answerIndex].AnswerGuid===condition.ParentAttributeGuid){foundAnswer=true;break}}if(!foundAnswer){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.ParentAnswerDeleted,1)}}if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&q.SelectionType!==Intelledox.Model.SelectionType.Single){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestion,1)}if(typeof(containingObject.HasLayoutInterface)!=="undefined"&&!(containingObject instanceof Intelledox.QAWizard.Design.Action)){var validRepeatPosition=ValidationWizard.isValidRepeatPosition(this._wizard.Pages,refQuestion,containingObject);if(validRepeatPosition===null||validRepeatPosition!==true){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestion,1)}}}if(containingObject instanceof Intelledox.QAWizard.Design.Question&&q.QuestionGuid===containingObject.QuestionGuid){if(refQuestion!=null){if(!ValidationWizard.isValidSamePageConditionParentQuestion(refQuestion)){this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestionSamePage,1)}}else{this.raiseValidationError(containingObject,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestionOrder,1)}exitPageLoop=true;break}}if(exitPageLoop){break}}}}break}};ValidationWizard.prototype.validateLayout=function(layout,projWizard,dataFields,questionBeforeThisLayout,questions,availablePlaceholders,contentItemPlaceholders,dataSources,dataObjects,keyFields,contentItemIDs,answerFileLabels,contentFolders,foundQuestions,counter,numQuestions,usedRepeatPlaceholders,customQuestionInputs,fragmentOutputs){var lastQuestion=questionBeforeThisLayout;for(var layoutIndex=0;layoutIndex<layout.length;layoutIndex++){var l=layout[layoutIndex];if(l instanceof Intelledox.QAWizard.Design.Question){this.validateQuestion(l,projWizard,dataSources,dataObjects,keyFields,dataFields,availablePlaceholders,contentItemPlaceholders,contentItemIDs,answerFileLabels,contentFolders,foundQuestions,counter,numQuestions,usedRepeatPlaceholders,customQuestionInputs,fragmentOutputs);lastQuestion=l}else if(l instanceof Intelledox.QAWizard.Design.Section){var s=l;var nextQuestionGuid;if(questions.indexOf(lastQuestion)===questions.length-1){nextQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}else{nextQuestionGuid=questions[questions.indexOf(lastQuestion)+1].QuestionGuid}this.validateFormulaField(s.Description,projWizard,s,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceSectionDescription,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaSectionDescription,nextQuestionGuid,fragmentOutputs,false,null);this.validateFormulaField(s.Description,projWizard,s,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMaximumRepeats,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMaximumRepeats,nextQuestionGuid,fragmentOutputs,false,null);this.validateFormulaField(s.Description,projWizard,s,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMinimumRepeats,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMinimumRepeats,nextQuestionGuid,fragmentOutputs,false,null);this.validateCondition(s.ActiveConditions,projWizard,foundQuestions,s,fragmentOutputs);this.validateCondition(s.VisibleConditions,projWizard,foundQuestions,s,fragmentOutputs);this.validateCondition(s.EditableConditions,projWizard,foundQuestions,s,fragmentOutputs);this.validateCondition(s.RepeatConditions,projWizard,foundQuestions,s,fragmentOutputs);if(l.IsRepeated){this.placeholdersInDocuments(l,l.RepeatPlaceholders,availablePlaceholders,contentItemPlaceholders);this.repeatPlaceholdersBeenUsed(l,l.RepeatPlaceholders,usedRepeatPlaceholders)}}else if(l instanceof Intelledox.QAWizard.Design.Column){var c=l;this.validateCondition(c.ActiveConditions,projWizard,foundQuestions,c,fragmentOutputs);this.validateCondition(c.VisibleConditions,projWizard,foundQuestions,c,fragmentOutputs);this.validateCondition(c.EditableConditions,projWizard,foundQuestions,c,fragmentOutputs)}else if(l instanceof Intelledox.QAWizard.Design.TabGroup){var tg=l;this.validateCondition(tg.ActiveConditions,projWizard,foundQuestions,tg,fragmentOutputs);this.validateCondition(tg.VisibleConditions,projWizard,foundQuestions,tg,fragmentOutputs);this.validateCondition(tg.EditableConditions,projWizard,foundQuestions,tg,fragmentOutputs)}else if(l instanceof Intelledox.QAWizard.Design.TabPage){var tp=l;this.validateCondition(tp.ActiveConditions,projWizard,foundQuestions,tp,fragmentOutputs);this.validateCondition(tp.VisibleConditions,projWizard,foundQuestions,tp,fragmentOutputs);this.validateCondition(tp.EditableConditions,projWizard,foundQuestions,tp,fragmentOutputs)}else if(l instanceof Intelledox.QAWizard.Design.FragmentReference){var nextQuestionGuid;if(questions.indexOf(lastQuestion)===questions.length-1){nextQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}else{nextQuestionGuid=questions[questions.indexOf(lastQuestion)+1].QuestionGuid}this.validateFragment(l,projWizard,dataFields,fragmentOutputs,nextQuestionGuid,availablePlaceholders,contentItemPlaceholders)}if(typeof(l.HasContainerInterface)!=="undefined"){lastQuestion=this.validateLayout(l.Children,projWizard,dataFields,lastQuestion,questions,availablePlaceholders,contentItemPlaceholders,dataSources,dataObjects,keyFields,contentItemIDs,answerFileLabels,contentFolders,foundQuestions,counter,numQuestions,usedRepeatPlaceholders,customQuestionInputs,fragmentOutputs)}}return lastQuestion};ValidationWizard.prototype.validateAction=function(a,foundActions,projWizard,foundQuestions,actionAttributes,dataFields,contentItemIDs,fragmentOutputs){foundActions.push(a);this.validateConditionFull(a.Conditions,projWizard,foundQuestions,true,a,foundActions,fragmentOutputs);if(a.IsRepeated){if(a.RepeaterGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||projWizard.FindRepeater(a.RepeaterGuid)==null){this.raiseValidationError(a,Intelledox.QAWizard.Design.ValidationErrorType.NoRepeaterDefined,0)}}if(!actionAttributes.hasOwnProperty(a.Type.routingTypeId)){this.raiseValidationError(a,Intelledox.QAWizard.Design.ValidationErrorType.ActionNotFound,0)}else{var foundInputs=[];this.validateActionInputs(a.ActionInputs,foundInputs,projWizard,a,dataFields,fragmentOutputs);for(var i=0;i<actionAttributes[a.Type.routingTypeId].length;i++){var attribute=actionAttributes[a.Type.routingTypeId][i];if(attribute.required){if(foundInputs.indexOf(attribute.routingElementTypeId)===-1){this.raiseValidationError(a,Intelledox.QAWizard.Design.ValidationErrorType.RequiredAttributeNotFound,0)}}}}this.validateActionDocuments(a,contentItemIDs);for(var i=0;i<a.Children.length;i++){this.validateAction(a.Children[i],foundActions,projWizard,foundQuestions,actionAttributes,dataFields,contentItemIDs,fragmentOutputs)}};ValidationWizard.prototype.validateActionInputs=function(inputs,foundInputs,projWizard,a,dataFields,fragmentOutputs){for(var i=0;i<inputs.length;i++){var input=inputs[i];foundInputs.push(input.ElementTypeId);if(input.SourceType===Intelledox.Model.RoutingSourceType.FixedValue){this.validateFormulaField(input.FixedValue,projWizard,a,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaAction,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaAction,Intelledox.Common.ConstantValues.GUID_EMPTY,fragmentOutputs,true,input)}if(input.ChildInputs!=null&&input.ChildInputs.length>0){this.validateActionInputs(input.ChildInputs,foundInputs,projWizard,a,dataFields,fragmentOutputs)}}};ValidationWizard.prototype.validateEscalationQuestionReference=function(escalation,projWizard,foundQuestions){if(escalation.InitialisationType===Intelledox.Model.EscalationInitialisationType.QuestionReference){var found=false;for(var i=0;i<foundQuestions.length;i++){if(escalation.ExpiryDateQuestionReference===foundQuestions[i]){found=true;break}}if(!found){this.raiseValidationError(escalation,Intelledox.QAWizard.Design.ValidationErrorType.WorkflowParentQuestionDeleted,1)}else{var valid=false;var nonRepeated=projWizard.GetNonRepeatedQuestions(Intelledox.Common.ConstantValues.GUID_EMPTY);for(var i=0;i<nonRepeated.length;i++){if(nonRepeated[i].QuestionGuid===escalation.ExpiryDateQuestionReference){valid=true;break}}if(!valid){this.raiseValidationError(escalation,Intelledox.QAWizard.Design.ValidationErrorType.WorkflowQuestionReferenceIsRepeated,1)}}}};ValidationWizard.prototype.validateWorkflowQuestionReference=function(tran,projWizard,foundQuestions){if(tran.SendToType===Intelledox.QAWizard.Design.StateTransitionSendToType.QuestionReference){if(tran.QuestionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){this.raiseValidationError(tran,Intelledox.QAWizard.Design.ValidationErrorType.WorkflowParentQuestionDeleted,1)}else{var found=false;for(var i=0;i<foundQuestions.length;i++){if(tran.QuestionGuid===foundQuestions[i]){found=true;break}}if(!found){this.raiseValidationError(tran,Intelledox.QAWizard.Design.ValidationErrorType.WorkflowParentQuestionDeleted,1)}else{var valid=false;var nonRepeats=projWizard.GetNonRepeatedQuestions(Intelledox.Common.ConstantValues.GUID_EMPTY);for(var i=0;i<nonRepeats.length;i++){if(nonRepeats[i].QuestionGuid===tran.QuestionGuid){valid=true;break}}if(!valid){this.raiseValidationError(tran,Intelledox.QAWizard.Design.ValidationErrorType.WorkflowQuestionReferenceIsRepeated,1)}}}}};ValidationWizard.prototype.validateAnswerResponseMetadataFields=function(answer){var vm=this;this.validateResponseMetadataFields(answer.ResponseMetadataFields);for(var i=0;i<answer.ResponseMetadataFields.length;i++){if(answer.Question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&answer.Question.SelectionType===Intelledox.Model.SelectionType.Multiple){this.raiseValidationError(answer.ResponseMetadataFields[i],Intelledox.QAWizard.Design.ValidationErrorType.ResponseMetadataFieldHasRepeatingParent,1)}}};ValidationWizard.prototype.validateResponseMetadataFields=function(responseMetadataFields){var vm=this;for(var i=0;i<responseMetadataFields.length;i++){if(this._responseMetadataFields.filter(function(r){return r.responseMetadataFieldGuid===responseMetadataFields[i].ResponseMetadataFieldGuid}).length===0){vm.raiseValidationError(responseMetadataFields[i],Intelledox.QAWizard.Design.ValidationErrorType.ResponseMetadataFieldNotFound,1)}}};ValidationWizard.prototype.validatePlaceholders=function(placeholders,availablePlaceholders,contentItemPlaceholders){for(var i=0;i<placeholders.length;i++){var bookmrk=placeholders[i];var bookmrkRef=bookmrk.Reference;if(!bookmrk.External){if(!availablePlaceholders.hasOwnProperty(bookmrk.DocumentGuid)){this.raiseValidationError(bookmrk,Intelledox.QAWizard.Design.ValidationErrorType.PlaceholderFromRemovedDocument,0)}else{var docPlaceholders=availablePlaceholders[bookmrk.DocumentGuid];var found=false;for(var docIndex=0;docIndex<docPlaceholders.length;docIndex++){if(docPlaceholders[docIndex].equals(bookmrkRef)){found=true;break}}if(!found){this.raiseValidationError(bookmrk,Intelledox.QAWizard.Design.ValidationErrorType.PlaceholderNotFound,0)}}}else{var found=false;for(var contentIndex=0;contentIndex<contentItemPlaceholders.length;contentIndex++){if(contentItemPlaceholders[contentIndex].equals(bookmrkRef)){found=true;break}}if(!found){}}}};ValidationWizard.prototype.validateQuestion=function(quest,projWizard,dataSources,dataObjects,keyFields,dataFields,availablePlaceholders,contentItemPlaceholders,contentItemIDs,answerFileLabels,contentFolders,foundQuestions,counter,numQuestions,usedRepeatPlaceholders,customQuestionInputs,fragmentOutputs){if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&quest.DataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var dsQuestion=quest;if(dsQuestion.DataSourceGuid===Intelledox.Common.ConstantValues.QAREPEAT){var repeater=projWizard.FindRepeater(dsQuestion.DataObjectGuid);if(repeater==null||!repeater.IsRepeated){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.DataObjectNotFound,1)}if(!System.String.IsNullOrEmpty(dsQuestion.ValueField)){var expressionBuilder=new Intelledox.QAWizard.Design.AnswerExpressionBuilder;expressionBuilder.ValidateReferences("["+dsQuestion.ValueField+"]",projWizard,null,quest.QuestionGuid,dataFields,false,fragmentOutputs);if(!System.String.IsNullOrEmpty(expressionBuilder.ErrorDescription)){this.raiseValidationErrorWithMessage(dsQuestion,Intelledox.QAWizard.Design.ValidationErrorType.BadUniqueField,1,this.getBadReference(expressionBuilder.ErrorDescription),null)}}}else if(dataSources.indexOf(dsQuestion.DataSourceGuid)===-1){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.DataSourceNotFound,1)}else{if(!System.String.IsNullOrEmpty(dsQuestion.ValueField)){if(!this.doesFieldExist(dataFields,dsQuestion.DataObjectGuid,dsQuestion.ValueField)){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.BadUniqueField,1)}}var foundDataObject=false;for(var i=0;i<dataObjects[dsQuestion.DataSourceGuid].length;i++){if(dataObjects[dsQuestion.DataSourceGuid][i].dataObjectGuid===dsQuestion.DataObjectGuid){foundDataObject=true;break}}if(!foundDataObject){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.DataObjectNotFound,1)}else{if((quest.DisplayType===Intelledox.Model.QuestionDisplayType.List||quest.DisplayType===Intelledox.Model.QuestionDisplayType.AutoComplete)&&quest.Visibility){if(System.String.IsNullOrEmpty(dsQuestion.DisplayField)){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.NoDisplayField,1)}}if(quest.Filters!=null){this.validateFilter(dsQuestion.Filters,keyFields,dsQuestion)}for(var i=0;i<dsQuestion.DisplayFields.length;i++){var displayFld=dsQuestion.DisplayFields[i];if(System.String.StartsWith(displayFld.name,"Formula")){this.validateFormulaField(displayFld.formula,projWizard,quest,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaDisplayField,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaDisplayField,quest.QuestionGuid,fragmentOutputs,false,null)}else if(!this.doesFieldExist(dataFields,dsQuestion.DataObjectGuid,displayFld.name)){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.InvalidDisplayField,1)}}if(dsQuestion.DisplayField==="[Answer]"&&System.String.IsNullOrEmpty(dsQuestion.AnswerDisplayField)){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.InvalidDisplayField,1)}if(dsQuestion.DisplayField==="[Answer]"){var foundAnswer=false;for(var answerIndex=0;answerIndex<quest.Answers.length;answerIndex++){var ans=quest.Answers[answerIndex];if(ans.AnswerGuid===dsQuestion.AnswerDisplayField){foundAnswer=true;break}}if(!foundAnswer){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.InvalidDisplayField,1)}}for(var i=0;i<dsQuestion.SortFields.length;i++){var sortFld=dsQuestion.SortFields[i];if(!this.doesFieldExist(dataFields,dsQuestion.DataObjectGuid,sortFld.Name)){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.InvalidSortField,1)}}if(quest.SelectionType===Intelledox.Model.SelectionType.Multiple){this.placeholdersInDocuments(quest,dsQuestion.RepeatPlaceholders,availablePlaceholders,contentItemPlaceholders);this.repeatPlaceholdersBeenUsed(quest,dsQuestion.RepeatPlaceholders,usedRepeatPlaceholders)}}}}if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary){if(quest.RepeatParent!==Intelledox.Common.ConstantValues.GUID_EMPTY){var parentQuestion=this._wizard.FindQuestion(quest.RepeatParent);if(parentQuestion==null||!quest.IsValidAutoAnswerParent(parentQuestion)){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.InvalidDynamicAnswering,0)}}if(quest.Visibility&&quest.DisplayType===Intelledox.Model.QuestionDisplayType.ExistingContentItem){if(contentItemIDs.indexOf(quest.ExistingContentItemGuid)===-1){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.ContentItemNotFound,1)}}}if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom){var foundInputs=[];var custQuest=quest;for(var i=0;i<custQuest.Inputs.length;i++){var input=custQuest.Inputs[i];foundInputs.push(input.ElementTypeId);if(input.SourceType===Intelledox.Model.RoutingSourceType.FixedValue){this.validateFormulaField(input.FixedValue,projWizard,custQuest,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaCustomInput,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaCustomInput,custQuest.QuestionGuid,fragmentOutputs,false,input)}}for(var i=0;i<customQuestionInputs[custQuest.CustomQuestionTypeId].length;i++){var attribute=customQuestionInputs[custQuest.CustomQuestionTypeId][i];if(attribute.required){if(foundInputs.indexOf(attribute.routingElementTypeId)===-1){this.raiseValidationError(custQuest,Intelledox.QAWizard.Design.ValidationErrorType.RequiredAttributeNotFound,0)}}}}if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator){this.validateValidationRule(quest.ValidationRule,projWizard,foundQuestions,quest,dataFields,fragmentOutputs)}else if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton){var allActionsForQuestion=projWizard.getAllActionsForActionButtonQuestion(quest);for(var i=0;i<allActionsForQuestion.length;i++){var name=allActionsForQuestion[i].Name.toUpperCase();for(var j=i+1;j<allActionsForQuestion.length;j++){if(allActionsForQuestion[j].Name.toUpperCase()===name){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.DuplicateActionName,0)}}}}else if(quest.Answers.length===0){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.AnswerNotFound,0)}for(var answerIndex=0;answerIndex<quest.Answers.length;answerIndex++){var ans=quest.Answers[answerIndex];if(ans.HasResponseMetadataFields){this.validateAnswerResponseMetadataFields(ans)}if(ans.HasPlaceholders){this.validatePlaceholders(ans.Placeholders,availablePlaceholders,contentItemPlaceholders)}for(var contentIndex=0;contentIndex<ans.ContentItems.length;contentIndex++){var contentItem=ans.ContentItems[contentIndex];if(contentItemIDs.indexOf(contentItem.ContentItemGuid)===-1){this.raiseValidationError(contentItem,Intelledox.QAWizard.Design.ValidationErrorType.ContentItemNotFound,1)}}if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary&&quest.Visibility&&ans.ContentItems.length>0){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.ContentItemOnVisibleContentLibrary,0)}if((quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource)&&(Intelledox.Common.Functions.EqualsIgnoreCase(ans.DataField,"[formula]")||Intelledox.Common.Functions.EqualsIgnoreCase(ans.DataField,"[aggregate]"))){var expressionBuilder=new Intelledox.QAWizard.Design.AnswerExpressionBuilder;var formula;if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable){formula=ans.Formula}else{formula=ans.Formula}if(!expressionBuilder.IsValidFormula(formula,projWizard,ans,quest.QuestionGuid,dataFields,false,fragmentOutputs)){if(expressionBuilder.ErrorDescription!=null&&System.String.StartsWith(expressionBuilder.ErrorDescription,"@@REFERENCE ERROR:")){this.raiseValidationErrorWithMessage(ans,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReference,0,this.getBadReference(expressionBuilder.ErrorDescription),null)}else{this.raiseValidationError(ans,Intelledox.QAWizard.Design.ValidationErrorType.BadFormula,0)}}}else if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&quest.DataSourceHierarchyGuid===Intelledox.Common.ConstantValues.GUID_EMPTY&&Intelledox.Common.Functions.NotEqualsIgnoreCase(ans.DataField,"[rowcount]")&&Intelledox.Common.Functions.NotEqualsIgnoreCase(ans.DataField,"[rownumber]")){var dsQuestion=quest;if(dsQuestion.DataSourceGuid!==Intelledox.Common.ConstantValues.QAREPEAT){if(!this.doesFieldExist(dataFields,dsQuestion.DataObjectGuid,ans.DataField)){this.raiseValidationError(ans,Intelledox.QAWizard.Design.ValidationErrorType.DataFieldNotFound,1)}}else{var parentRepeater=projWizard.FindLayoutNode(dsQuestion.DataObjectGuid);if(parentRepeater!=null){var expressionBuilder=new Intelledox.QAWizard.Design.AnswerExpressionBuilder;expressionBuilder.ValidateReferences("["+ans.DataField+"]",projWizard,ans,quest.QuestionGuid,dataFields,false,fragmentOutputs);if(!System.String.IsNullOrEmpty(expressionBuilder.ErrorDescription)){this.raiseValidationError(ans,Intelledox.QAWizard.Design.ValidationErrorType.DataFieldNotFound,1)}}}}if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic){this.validateRule(ans.Rules,projWizard,foundQuestions,ans,dataFields,fragmentOutputs)}this.validateCondition(ans.ActiveConditions,projWizard,foundQuestions,ans,fragmentOutputs);if(ans.SaveToAnswerFile&&ans.SaveToAnswerFileBy===Intelledox.QAWizard.Design.SaveAnswerByEnum.SaveByLabel&&!System.String.IsNullOrEmpty(ans.SaveToAnswerFileLabel)){if(answerFileLabels.indexOf(ans.SaveToAnswerFileLabel)>-1){this.raiseValidationError(ans,Intelledox.QAWizard.Design.ValidationErrorType.DuplicateUniqueLabel,0)}else{answerFileLabels.push(ans.SaveToAnswerFileLabel)}}}if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt){if(quest.HasValidationRules){for(var ruleIndex=0;ruleIndex<quest.Validations.length;ruleIndex++){var rule=quest.Validations[ruleIndex];this.validateFormulaField(rule.Expression,projWizard,quest,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceValidationValue,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceValidationValue,quest.QuestionGuid,fragmentOutputs,false,null);this.validateFormulaField(rule.Message,projWizard,quest,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMessage,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMessage,quest.QuestionGuid,fragmentOutputs,false,null)}}}this.validateFormulaField(quest.DefaultValue,projWizard,quest,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceDefaultValue,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaDefaultValue,quest.QuestionGuid,fragmentOutputs,false,null);this.validateFormulaField(quest.Text,projWizard,quest,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceQuestionText,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaQuestionText,quest.QuestionGuid,fragmentOutputs,false,null);this.validateCondition(quest.ActiveConditions,projWizard,foundQuestions,quest,fragmentOutputs);this.validateCondition(quest.VisibleConditions,projWizard,foundQuestions,quest,fragmentOutputs);this.validateCondition(quest.EditableConditions,projWizard,foundQuestions,quest,fragmentOutputs);this.validateCondition(quest.MandatoryConditions,projWizard,foundQuestions,quest,fragmentOutputs);if(quest.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary){if(quest.Visibility&&quest.SaveToAnswerFile){if(answerFileLabels.indexOf(quest.SaveToAnswerFileLabel)>-1){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.DuplicateUniqueLabel,0)}else{answerFileLabels.push(quest.SaveToAnswerFileLabel)}}if(!(quest.ContentFolder===Intelledox.Common.ConstantValues.GUID_EMPTY)){var folderFound=false;for(var folderIndex=0;folderIndex<contentFolders.length;folderIndex++){var folder=contentFolders[folderIndex];if(folder.folderGuid===quest.ContentFolder){folderFound=true;break}}if(!folderFound){this.raiseValidationError(quest,Intelledox.QAWizard.Design.ValidationErrorType.ContentFolderDeleted,0)}}}counter+=1;foundQuestions.push(quest.QuestionGuid);if(this.progressCallback!=null){this.progressCallback((counter/numQuestions)*100)}};ValidationWizard.prototype.validateActionDocuments=function(a,contentItemIDs){var found=false;if(a.HasCustomDocuments){for(var i=0;i<a.CustomDocuments.length;i++){var doc=a.CustomDocuments[i];switch(doc.Type){case Intelledox.Model.ActionDocumentType.Document:found=false;for(var docIndex=0;docIndex<this._wizard.Documents.length;docIndex++){if(this._wizard.Documents[docIndex].DocumentGuid===doc.DocumentGuid){found=true;break}}if(!found){this.raiseValidationError(a,Intelledox.QAWizard.Design.ValidationErrorType.InvalidActionDocument,0)}break;case Intelledox.Model.ActionDocumentType.ContentItem:if(contentItemIDs.indexOf(doc.DocumentGuid)===-1){this.raiseValidationError(a,Intelledox.QAWizard.Design.ValidationErrorType.InvalidActionDocument,0)}break;case Intelledox.Model.ActionDocumentType.Question:if(this._wizard.FindQuestion(doc.DocumentGuid)==null){this.raiseValidationError(a,Intelledox.QAWizard.Design.ValidationErrorType.InvalidActionDocument,0)}break}}}};ValidationWizard.prototype.validateRule=function(r,projWizard,foundQuestions,containingAnswer,dataFields,fragmentOutputs){switch(r.Type){case Intelledox.Model.ClauseType.AllOf:case Intelledox.Model.ClauseType.AnyOf:for(var i=0;i<r.SubClauses.length;i++){this.validateRule(r.SubClauses[i],projWizard,foundQuestions,containingAnswer,dataFields,fragmentOutputs)}break;case Intelledox.Model.ClauseType.Comparison:switch(r.ParentType){case Intelledox.QAWizard.Design.RuleParentType.Reference:if(foundQuestions.indexOf(r.ParentItemGuid)===-1){this.raiseValidationError(containingAnswer,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestionOrderRule,1)}else{var foundRefQuestion=false;for(var pageIndex=0;pageIndex<projWizard.Pages.length;pageIndex++){var g=projWizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<g.Questions.length;questionIndex++){var q=g.Questions[questionIndex];if(q.QuestionGuid===r.ParentItemGuid){foundRefQuestion=true;if(r.ParentAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var foundAnswer=false;for(var answerIndex=0;answerIndex<q.Answers.length;answerIndex++){var a=q.Answers[answerIndex];if(a.AnswerGuid===r.ParentAttributeGuid){foundAnswer=true;break}}if(!foundAnswer){this.raiseValidationError(containingAnswer,Intelledox.QAWizard.Design.ValidationErrorType.ParentAnswerDeletedRule,1)}}}if(q.QuestionGuid===containingAnswer.Question.QuestionGuid){if(!foundRefQuestion){this.raiseValidationError(containingAnswer,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestionOrderRule,1)}foundRefQuestion=true;break}}if(foundRefQuestion){break}}}break;case Intelledox.QAWizard.Design.RuleParentType.Input:var foundInput=false;for(var i=0;i<this._wizard.AvailableInputs.length;i++){if(this._wizard.AvailableInputs[i].routingElementTypeId===r.ParentItemGuid){foundInput=true;break}}if(!foundInput){this.raiseValidationError(containingAnswer,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentInput,0)}break;case Intelledox.QAWizard.Design.RuleParentType.FragmentOutput:if(!fragmentOutputs.hasOwnProperty(r.ParentItemGuid)){this.raiseValidationError(containingAnswer,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentFragment,1)}else{var foundOutput=false;for(var i=0;i<fragmentOutputs[r.ParentItemGuid].length;i++){if(fragmentOutputs[r.ParentItemGuid][i].RoutingOptionGuid===r.ParentAttributeGuid){foundOutput=true;break}}if(!foundOutput){this.raiseValidationError(containingAnswer,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentOutput,1)}}break;case Intelledox.QAWizard.Design.RuleParentType.Formula:case Intelledox.QAWizard.Design.RuleParentType.Aggregate:this.validateFormulaField(r.Formula,projWizard,containingAnswer,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceRule,Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaRule,containingAnswer.Question.QuestionGuid,fragmentOutputs,false,null);break}break}};ValidationWizard.prototype.validateValidationRule=function(r,projWizard,foundQuestions,containingQuestion,dataFields,fragmentOutputs){switch(r.Type){case Intelledox.Model.ClauseType.AllOf:case Intelledox.Model.ClauseType.AnyOf:for(var i=0;i<r.SubClauses.length;i++){this.validateValidationRule(r.SubClauses[i],projWizard,foundQuestions,containingQuestion,dataFields,fragmentOutputs)}break;case Intelledox.Model.ClauseType.Comparison:if(foundQuestions.indexOf(r.QuestionGuid)===-1){this.raiseValidationError(containingQuestion,Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestionOrderRule,1)}else{if(r.AnswerGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var refQuestion=projWizard.FindQuestion(r.QuestionGuid);var foundAnswer=false;for(var answerIndex=0;answerIndex<refQuestion.Answers.length;answerIndex++){if(refQuestion.Answers[answerIndex].AnswerGuid===r.AnswerGuid){foundAnswer=true;break}}if(!foundAnswer){this.raiseValidationError(containingQuestion,Intelledox.QAWizard.Design.ValidationErrorType.ParentAnswerDeletedRule,1)}}}this.validateFormulaField(r.Expression,projWizard,containingQuestion,dataFields,Intelledox.QAWizard.Design.ValidationErrorType.BadFormula,Intelledox.QAWizard.Design.ValidationErrorType.BadFormula,containingQuestion.QuestionGuid,fragmentOutputs,false,null);break}};ValidationWizard.prototype.validateFilter=function(filter,keyFields,containingQuestion){switch(filter.Type){case Intelledox.Model.ClauseType.AllOf:case Intelledox.Model.ClauseType.AnyOf:for(var i=0;i<filter.SubClauses.length;i++){this.validateFilter(filter.SubClauses[i],keyFields,containingQuestion)}break;case Intelledox.Model.ClauseType.Comparison:if(!this.doesKeyFieldExist(keyFields,containingQuestion.DataObjectGuid,filter.FieldName)){this.raiseValidationError(containingQuestion,Intelledox.QAWizard.Design.ValidationErrorType.InvalidDataFilter,0)}if(filter.ParentType===Intelledox.QAWizard.Design.FilterParentType.Input){var foundInput=false;for(var i=0;i<this._wizard.AvailableInputs.length;i++){if(this._wizard.AvailableInputs[i].routingElementTypeId===filter.ParentItemGuid){foundInput=true;break}}if(!foundInput){this.raiseValidationError(containingQuestion,Intelledox.QAWizard.Design.ValidationErrorType.InvalidDataFilter,0)}}else if(filter.ParentType===Intelledox.QAWizard.Design.FilterParentType.Reference&&filter.ParentItemGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var parentQuestion=this._wizard.FindQuestion(filter.ParentItemGuid);if(parentQuestion==null||!containingQuestion.IsValidFilterParent(parentQuestion)){this.raiseValidationError(containingQuestion,Intelledox.QAWizard.Design.ValidationErrorType.InvalidDataFilter,0)}if(parentQuestion!=null){if(filter.ParentAttributeGuid===Intelledox.Common.ConstantValues.GUID_EMPTY&&System.String.IsNullOrEmpty(filter.ParentFieldName)){if(parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt||parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic||parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||parentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable){this.raiseValidationError(containingQuestion,Intelledox.QAWizard.Design.ValidationErrorType.InvalidDataFilter,0)}}else if(filter.ParentAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var parentAnswer=parentQuestion.FindAnswer(filter.ParentAttributeGuid);if(parentAnswer==null){this.raiseValidationError(containingQuestion,Intelledox.QAWizard.Design.ValidationErrorType.InvalidDataFilter,0)}}}}break}};ValidationWizard.containsLayoutNode=function(layout,node){for(var i=0;i<layout.length;i++){var l=layout[i];if(l===node){return true}if(typeof(l.HasContainerInterface)!=="undefined"){if(ValidationWizard.containsLayoutNode(l.Children,node)){return true}}}return false};ValidationWizard.prototype.doesFieldExist=function(dataFields,dataObjectGuid,fieldName){if(!dataFields.hasOwnProperty(dataObjectGuid)){return false}for(var i=0;i<dataFields[dataObjectGuid].length;i++){if(dataFields[dataObjectGuid][i].name===fieldName){return true}}return false};ValidationWizard.prototype.doesKeyFieldExist=function(dataFields,dataObjectGuid,fieldName){if(!dataFields.hasOwnProperty(dataObjectGuid)){return false}for(var i=0;i<dataFields[dataObjectGuid].length;i++){if(dataFields[dataObjectGuid][i].name===fieldName){return true}}return false};ValidationWizard.prototype.getBadReference=function(errorMessage){return System.String.Substring(errorMessage,19,errorMessage.length-21)};ValidationWizard.prototype.raiseValidationError=function(item,errorType,errorLevel){this.raiseValidationErrorWithMessage(item,errorType,errorLevel,"",null)};ValidationWizard.prototype.raiseValidationErrorWithMessage=function(item,errorType,errorLevel,message,subItem){var result=new Design.ValidationError;result.item=item;result.subItem=subItem;var subItemName=this.getAttribute(item,result.subItem);var name;var resultRow=new Design.FoundItem;resultRow.tag=result;if(item instanceof Intelledox.QAWizard.Design.Answer){name=" ("+item.Name+")"}else if(item instanceof Intelledox.QAWizard.Design.Question){if(subItem!=null){name=" ("+item.Text+" - "+subItemName+")"}else{name=" ("+item.Text+")"}}else if(item instanceof Intelledox.QAWizard.Design.Placeholder){name=" ("+item.Name+")"}else if(item instanceof Intelledox.QAWizard.Design.ContentItem){name=""}else if(item instanceof Intelledox.QAWizard.Design.Page){name=" ("+item.Name+")"}else if(item instanceof Intelledox.QAWizard.Design.Section){name=" ("+item.Title+")"}else if(typeof item==='string'&&item===Intelledox.Common.ConstantValues.FINISHPAGETAG){name=" ("+this._filter('translate')('FinishPage')+")"}else if(item instanceof Intelledox.QAWizard.Design.Action){if(subItem!=null){name=" ("+item.Name+" - "+subItemName+")"}else{name=" ("+item.Name+")"}}else if(item instanceof Intelledox.QAWizard.Design.DocumentTemplate){name=" ("+this._filter('translate')('Document')+": "+item.Name+")"}else if(item instanceof Intelledox.QAWizard.Design.WorkflowState){name=" ("+this._filter('translate')('State')+": "+item.Name+")"}else if(item instanceof Intelledox.QAWizard.Design.StateTransition){var trans=item;var fullList=this._wizard.Workflow.FullStateList;for(var i=0;i<fullList.length;i++){if(fullList[i].Id===trans.StateId){name=" ("+fullList[i].Name+")";break}}}else if(typeof item.HasFragmentInterface!=="undefined"){name=" ("+item.Name+")"}else if(item instanceof Intelledox.QAWizard.Design.FragmentOutput){name="";var thisOutput=item;for(var i=0;i<this._fragmentOutputs[thisOutput.Parent.ProjectGuid].length;i++){var availableOutput=this._fragmentOutputs[thisOutput.Parent.ProjectGuid][i];if(availableOutput.RoutingOptionGuid===thisOutput.OutputGuid){name=" ("+availableOutput.Name+")";break}}}else{name=""}switch(errorLevel){case 0:resultRow.type=this._filter('translate')('Validate_Warning');resultRow.icon="icon-warning";break;case 1:resultRow.type=this._filter('translate')('Validate_Error');resultRow.icon="icon-error";break;case 2:resultRow.type=this._filter('translate')('Validate_Message');resultRow.icon="icon-information";break}name=Design.TranslationHelper.KeywordValueToTranslation(this._filter,name);switch(errorType){case Intelledox.QAWizard.Design.ValidationErrorType.PlaceholderNotFound:resultRow.message=this._filter('translate')('Validate_PlaceholderNotFound')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.ContentItemNotFound:resultRow.message=this._filter('translate')('Validate_ContentNotFound');break;case Intelledox.QAWizard.Design.ValidationErrorType.DataSourceNotFound:resultRow.message=this._filter('translate')('Validate_DataSourceInvalid')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.DataObjectNotFound:resultRow.message=this._filter('translate')('Validate_DataObjectInvalid')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.DataFieldNotFound:resultRow.message=this._filter('translate')('Validate_DataFieldInvalid')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReference:resultRow.message=System.String.Format(this._filter('translate')('Validate_FormulaReferenceInvalid'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidDynamicAnswering:resultRow.message=this._filter('translate')('Validate_AutoAnswerInvalid')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestion:resultRow.message=this._filter('translate')('Validate_InvalidParentQuestion')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestionOrder:resultRow.message=this._filter('translate')('Validate_InvalidParentQuestionOrder')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestionSamePage:resultRow.message=this._filter('translate')('Validate_InvalidParentQuestionSameGroup')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.AnswerNotFound:resultRow.message=this._filter('translate')('Validate_AnswerNotFound')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.NoDisplayField:resultRow.message=this._filter('translate')('Validate_NoDisplayField')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidDataFilter:resultRow.message=this._filter('translate')('Validate_InvalidDataFilter')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidDisplayField:resultRow.message=this._filter('translate')('Validate_InvalidDisplayField')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidSortField:resultRow.message=this._filter('translate')('Validate_InvalidSortField')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormula:resultRow.message=this._filter('translate')('Validate_BadFormula')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.PlaceholderFromRemovedDocument:resultRow.message=this._filter('translate')('Validate_PlaceholderFromRemovedDocument')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceDefaultValue:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadFormulaReferenceDefaultValue'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaDefaultValue:resultRow.message=this._filter('translate')('Validate_BadFormulaDefaultValue')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceValidationValue:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadReferenceValidationValue'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceEscalationAttribute:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadReferenceEscalationAttribute'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMaximumRepeats:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadReferenceMaximumRepeats'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMinimumRepeats:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadReferenceMinimumRepeats'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceRepeatTitle:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadFormulaReferenceRepeatTitle'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaRepeatTitle:resultRow.message=this._filter('translate')('Validate_BadFormulaRepeatTitle')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceSectionDescription:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadFormulaReferenceSectionDescription'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaSectionDescription:resultRow.message=this._filter('translate')('Validate_BadFormulaSectionDescription')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceQuestionText:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadFormulaReferenceQuestionText'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaQuestionText:resultRow.message=this._filter('translate')('Validate_BadFormulaQuestionText')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.ParentAnswerDeleted:resultRow.message=this._filter('translate')('Validate_ParentAnswerDeleted')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentQuestionOrderRule:resultRow.message=this._filter('translate')('Validate_InvalidParentQuestionOrderRule')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.ParentAnswerDeletedRule:resultRow.message=this._filter('translate')('Validate_ParentAnswerDeletedRule')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceRule:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadFormulaReferenceRule'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaReferenceMessage:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadFormulaReferenceMessage'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaRule:resultRow.message=this._filter('translate')('Validate_BadFormulaRule')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.DuplicateUniqueLabel:resultRow.message=this._filter('translate')('Validate_DuplicateUniqueLabel')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.ContentFolderDeleted:resultRow.message=this._filter('translate')('Validate_ContentFolderDeleted')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.ContentItemOnVisibleContentLibrary:resultRow.message=this._filter('translate')('Validate_ContentItemOnVisibleContentLibrary')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.ExternalPlaceholderNotInContentItem:resultRow.message=this._filter('translate')('Validate_ExternalPlaceholderNotInContentItem')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.RepeatPlaceholderNotFound:resultRow.message=this._filter('translate')('Validate_RepeatPlaceholderNotFound')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishGenerateButtonText:resultRow.message=this._filter('translate')('Validate_BadFormulaFinishGenerateButtonText')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishGeneratingText:resultRow.message=this._filter('translate')('Validate_BadFormulaFinishGeneratingText')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishDownloadPageTitle:resultRow.message=this._filter('translate')('Validate_BadFormulaFinishDownloadPageTitle')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFinishPageTitle:resultRow.message=this._filter('translate')('Validate_BadFormulaFinishPageTitle')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadOfflineRedirectMessage:resultRow.message=this._filter('translate')('Validate_BadOfflineRedirectMessage')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadOnlineRedirectMessage:resultRow.message=this._filter('translate')('Validate_BadOnlineRedirectMessage')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentAction:resultRow.message=this._filter('translate')('Validate_InvalidParentAction')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentState:resultRow.message=this._filter('translate')('Validate_InvalidParentState')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidActionOrder:resultRow.message=this._filter('translate')('Validate_InvalidActionOrder')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.RequiredAttributeNotFound:resultRow.message=this._filter('translate')('Validate_RequiredAttributeNotFound')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.RequiredEscalationAttributeNotFound:resultRow.message=this._filter('translate')('Validate_RequiredEscalationAttributeNotFound')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.ActionNotFound:resultRow.message=this._filter('translate')('Validate_ActionNotFound')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.ParentQuestionDeleted:resultRow.message=this._filter('translate')('Validate_ParentQuestionDeleted')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.NoRepeaterDefined:resultRow.message=this._filter('translate')('Validate_NoRepeaterDefined')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidActionDocument:resultRow.message=this._filter('translate')('Validate_InvalidActionDocument')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaAction:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadFormulaAction'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.WorkflowQuestionReferenceIsRepeated:resultRow.message=this._filter('translate')('Validate_WorkflowQuestionReferenceIsRepeated')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.WorkflowParentQuestionDeleted:resultRow.message=this._filter('translate')('Validate_WorkflowParentQuestionDeleted')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.RepeatPlaceholderAlreadyUsed:resultRow.message=this._filter('translate')('Validate_RepeatPlaceholderAlreadyUsed')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaCustomInput:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadFormulaCustomInput'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentInput:resultRow.message=System.String.Format(this._filter('translate')('Validate_InvalidParentInput'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentOutput:resultRow.message=System.String.Format(this._filter('translate')('Validate_InvalidParentOutput'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.InvalidParentFragment:resultRow.message=System.String.Format(this._filter('translate')('Validate_InvalidParentFragment'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaFragmentInput:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadFormulaFragmentInput'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.OutputNotFoundInFragment:resultRow.message=System.String.Format(this._filter('translate')('Validate_OutputNotFoundInFragment'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadUniqueField:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadUniqueField'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.ResponseMetadataFieldNotFound:resultRow.message=this._filter('translate')('Validate_ResponseMetadataFieldNotFound');break;case Intelledox.QAWizard.Design.ValidationErrorType.ResponseMetadataFieldHasRepeatingParent:resultRow.message=this._filter('translate')('Validate_ResponseMetadataFieldHasRepeatingParent')+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.BadFormulaDisplayField:resultRow.message=System.String.Format(this._filter('translate')('Validate_BadFormulaDisplayField'),message)+name;break;case Intelledox.QAWizard.Design.ValidationErrorType.DuplicateActionName:resultRow.message=this._filter('translate')('Validate_DuplicateActionName')+name;break}if(this.validationErrorCallback!=null){this.validationErrorCallback(resultRow)}};ValidationWizard.prototype.attributeTypes=function(item){if(item instanceof Intelledox.QAWizard.Design.Action){return this._actionAttributes[item.Type.routingTypeId]}else if(item instanceof Intelledox.QAWizard.Design.CustomQuestion){return this._customQuestionInputs[item.CustomQuestionTypeId]}return null};ValidationWizard.prototype.getAttribute=function(item,subItem){if(subItem==null||!(subItem instanceof Intelledox.Model.RoutingOption)){return""}var attrTypes=this.attributeTypes(item);for(var i=0;i<attrTypes.length;i++){var element=attrTypes[i];if(element.routingElementTypeId===subItem.ElementTypeId){return this._listManager.nameToTranslation(element.description)}}return""};return ValidationWizard}());Design.ValidationWizard=ValidationWizard})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var TranslationHelper=(function(){function TranslationHelper(){}TranslationHelper.KeywordValueToTranslation=function($filter,keywordValue){if(System.String.IsNullOrEmpty(keywordValue)){return""}var result=keywordValue;if(result.indexOf("]")>-1){result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,Intelledox.Common.ConstantValues.ROW_COUNT+"]",$filter('translate')('RowCount')+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,Intelledox.Common.ConstantValues.ROW_NUMBER+"]",$filter('translate')('RowNumber')+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,Intelledox.Common.ConstantValues.ROW_ID+"]",$filter('translate')('RowId')+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"."+Intelledox.Common.ConstantValues.FILENAME+"]","."+$filter('translate')('FileNameWithoutBlanks')+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,Intelledox.QAWizard.Design.DatasourceQuestion.SKIPWITHOUTVALUE,$filter('translate')('SkipWithoutValue'));result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+Intelledox.Common.ConstantValues.INPUT+".","["+$filter('translate')('Input')+".");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+Intelledox.Common.ConstantValues.FRAGMENT+".","["+$filter('translate')('Fragment')+".");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+Intelledox.Common.ConstantValues.PREVIOUS+".","["+$filter('translate')('Previous')+".");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+Intelledox.Common.ConstantValues.PROTECT+".","["+$filter('translate')('Protect')+".")}return result};TranslationHelper.TranslationToKeywordValue=function($filter,translation){if(System.String.IsNullOrEmpty(translation)){return""}var result=translation;if(result.indexOf("]")>-1){result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,$filter('translate')('RowCount')+"]",Intelledox.Common.ConstantValues.ROW_COUNT+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,$filter('translate')('RowNumber')+"]",Intelledox.Common.ConstantValues.ROW_NUMBER+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,$filter('translate')('RowId')+"]",Intelledox.Common.ConstantValues.ROW_ID+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"."+$filter('translate')('FileNameWithoutBlanks')+"]","."+Intelledox.Common.ConstantValues.FILENAME+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,$filter('translate')('SkipWithoutValue'),Intelledox.QAWizard.Design.DatasourceQuestion.SKIPWITHOUTVALUE);result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+$filter('translate')('Input')+".","["+Intelledox.Common.ConstantValues.INPUT+".");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+$filter('translate')('Fragment')+".","["+Intelledox.Common.ConstantValues.FRAGMENT+".");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+$filter('translate')('Previous')+".","["+Intelledox.Common.ConstantValues.PREVIOUS+".");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+$filter('translate')('Protect')+".","["+Intelledox.Common.ConstantValues.PROTECT+".")}return result};return TranslationHelper}());Design.TranslationHelper=TranslationHelper})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var QuestionSetDesignerFactory=(function(){function QuestionSetDesignerFactory(){}QuestionSetDesignerFactory.getQuestionSetTreenode=function($filter,treeview,node,wiz,listManager){var returnNode=null;if(node instanceof Intelledox.QAWizard.Design.Question){return this.prepareQuestionNode($filter,treeview,node,listManager,wiz)}else if(node instanceof Intelledox.QAWizard.Design.FragmentPage){var frag=node;var grpTitle=frag.Name;if(System.String.IsNullOrEmpty(grpTitle)){grpTitle=System.String.Format($filter('translate')('LayoutDefaultFormat'),$filter('translate')('Fragment'))}returnNode=new Design.TreeNode(grpTitle,frag);returnNode.treeView=treeview;returnNode.imageKey="icon-projectfragment";this.prepareFragmentNode($filter,treeview,listManager,wiz,returnNode,frag.ProjectGuid,frag.Documents,frag.Outputs)}else if(node instanceof Intelledox.QAWizard.Design.Page){var grp=node;var grpTitle=Design.TranslationHelper.KeywordValueToTranslation($filter,grp.Name);if(System.String.IsNullOrEmpty(grpTitle)){grpTitle=System.String.Format($filter('translate')('LayoutDefaultFormat'),$filter('translate')('Page'))}returnNode=new Design.TreeNode(grpTitle,grp);returnNode.treeView=treeview;if(grp.IsRepeated){returnNode.imageKey="icon-page icon-repeatingpage"}else{returnNode.imageKey="icon-page"}}else if(node instanceof Intelledox.QAWizard.Design.Section){var sect=node;var sectTitle=Design.SectionPropertiesViewModel.getTreeNodeText($filter,sect);returnNode=new Design.TreeNode(sectTitle,sect);returnNode.treeView=treeview;if(sect.IsRepeated){returnNode.imageKey="icon-section icon-repeatingsection"}else{returnNode.imageKey="icon-section"}}else if(node instanceof Intelledox.QAWizard.Design.Column){var col=node;var colTitle=Design.TranslationHelper.KeywordValueToTranslation($filter,col.Title);if(System.String.IsNullOrEmpty(colTitle)){colTitle=System.String.Format($filter('translate')('LayoutDefaultFormat'),$filter('translate')('Column'))}returnNode=new Design.TreeNode(colTitle,col);returnNode.treeView=treeview;returnNode.imageKey="icon-column"}else if(node instanceof Intelledox.QAWizard.Design.TabGroup){var tabgrp=node;returnNode=new Design.TreeNode(System.String.Format($filter('translate')('LayoutDefaultFormat'),$filter('translate')('TabGroup')),tabgrp);returnNode.treeView=treeview;returnNode.imageKey="icon-tabgroup"}else if(node instanceof Intelledox.QAWizard.Design.TabPage){var tabpg=node;var tabTitle=Design.TranslationHelper.KeywordValueToTranslation($filter,tabpg.Title);if(System.String.IsNullOrEmpty(tabTitle)){tabTitle=System.String.Format($filter('translate')('LayoutDefaultFormat'),$filter('translate')('TabPage'))}returnNode=new Design.TreeNode(tabTitle,tabpg);returnNode.treeView=treeview;returnNode.imageKey="icon-tabpage"}else if(node instanceof Intelledox.QAWizard.Design.Action){returnNode=QuestionSetDesignerFactory.prepareActionTreeNode($filter,treeview,node,listManager)}else if(node instanceof Intelledox.QAWizard.Design.FragmentReference){var fragRef=node;var grpTitle=fragRef.Name;if(System.String.IsNullOrEmpty(grpTitle)){grpTitle=System.String.Format($filter('translate')('LayoutDefaultFormat'),$filter('translate')('Fragment'))}returnNode=new Design.TreeNode(grpTitle,fragRef);returnNode.treeView=treeview;returnNode.imageKey="icon-projectfragment";this.prepareFragmentNode($filter,treeview,listManager,wiz,returnNode,fragRef.ProjectGuid,fragRef.Documents,fragRef.Outputs)}else if(node instanceof Intelledox.QAWizard.Design.AvailableOutput){returnNode=QuestionSetDesignerFactory.prepareAvailableOutputTreeNode(treeview,node)}return returnNode};QuestionSetDesignerFactory.prepareFragmentNode=function($filter,treeview,listManager,wiz,node,projectGuid,documents,outputs){var vm=this;var tempNode=new Design.TreeNode('loading...',null);node.addChild(tempNode);listManager.projectFragment(projectGuid).then(function(fragWizard){var availableOutputs=new Array;var i=0;node.nodes[0].remove();if(fragWizard!=null){for(var fragDocIndex=0;fragDocIndex<fragWizard.Documents.length;fragDocIndex++){var fragDoc=fragWizard.Documents[fragDocIndex];var found=false;for(var existingIndex=0;existingIndex<documents.length;existingIndex++){if(documents[existingIndex].DocumentGuid===fragDoc.DocumentGuid){found=true;break}}if(!found){var newFragDoc=new Intelledox.QAWizard.Design.FragmentDocument;newFragDoc.DocumentGuid=fragDoc.DocumentGuid;newFragDoc.FormatType=fragDoc.FormatType;documents.push(newFragDoc)}}for(i=0;i<fragWizard.AvailableOutputs.length;i++){availableOutputs.push(fragWizard.AvailableOutputs[i])}}for(i=0;i<documents.length;i++){var doc=documents[i];var docNode=null;if(fragWizard==null){docNode=new Design.TreeNode($filter('translate')('DocumentNotFound'),doc)}else{var fragDoc=null;for(var docIndex=0;docIndex<fragWizard.Documents.length;docIndex++){if(fragWizard.Documents[docIndex].DocumentGuid===doc.DocumentGuid){fragDoc=fragWizard.Documents[docIndex]}}if(fragDoc==null){docNode=new Design.TreeNode($filter('translate')('DocumentNotFound'),doc)}else{docNode=new Design.TreeNode(fragDoc.Name,doc)}}if(doc.AttachmentFormat===Intelledox.Model.OutputType.None){if(doc.FormatType===Intelledox.Model.TemplateFormatType.Pdf){doc.AttachmentFormat=Intelledox.Model.OutputType.Pdf}else if(doc.FormatType===Intelledox.Model.TemplateFormatType.Xsd){doc.AttachmentFormat=Intelledox.Model.OutputType.Xml}else if(doc.FormatType===Intelledox.Model.TemplateFormatType.Txt){doc.AttachmentFormat=Intelledox.Model.OutputType.Txt}else if(doc.FormatType===Intelledox.Model.TemplateFormatType.Html){doc.AttachmentFormat=Intelledox.Model.OutputType.Html}else if(doc.FormatType===Intelledox.Model.TemplateFormatType.Csv){doc.AttachmentFormat=Intelledox.Model.OutputType.Csv}else if(doc.FormatType===Intelledox.Model.TemplateFormatType.Json){doc.AttachmentFormat=Intelledox.Model.OutputType.Json}}docNode.treeView=treeview;docNode.imageKey="icon-document";for(var placeholderIndex=0;placeholderIndex<doc.Placeholders.length;placeholderIndex++){var bookmarkNode=vm.prepareBookmarkTreeNode(treeview,doc.Placeholders[placeholderIndex],wiz,doc.Placeholders[placeholderIndex].XmlNamespace);docNode.addChild(bookmarkNode)}node.addChild(docNode)}var foundOutputs=new Array;for(var i=0;i<availableOutputs.length;i++){var availableOutput=availableOutputs[i];foundOutputs.push(availableOutput.RoutingOptionGuid);var foundMatch=false;var availableOutputNode=new Design.TreeNode(availableOutput.Name,null);availableOutputNode.treeView=treeview;availableOutputNode.imageKey="icon-fragmentoutput";for(var outputIndex=0;outputIndex<outputs.length;outputIndex++){var fragmentOutput=outputs[outputIndex];if(availableOutput.RoutingOptionGuid===fragmentOutput.OutputGuid){availableOutputNode.tag=fragmentOutput;for(var placeholderIndex=0;placeholderIndex<fragmentOutput.Placeholders.length;placeholderIndex++){var bookmarkNode=vm.prepareBookmarkTreeNode(treeview,fragmentOutput.Placeholders[placeholderIndex],wiz,fragmentOutput.Placeholders[placeholderIndex].XmlNamespace);availableOutputNode.addChild(bookmarkNode)}for(var responseMetadataIndex=0;responseMetadataIndex<fragmentOutput.ResponseMetadataFields.length;responseMetadataIndex++){var responseMetadataNode=vm.prepareResponseMetadataTreeNode($filter,treeview,fragmentOutput.ResponseMetadataFields[responseMetadataIndex],listManager);availableOutputNode.addChild(responseMetadataNode)}foundMatch=true;break}}if(!foundMatch){var newFragmentOutput=new Intelledox.QAWizard.Design.FragmentOutput(node.tag);newFragmentOutput.OutputGuid=availableOutput.RoutingOptionGuid;availableOutputNode.tag=newFragmentOutput;if(fragWizard!=null){outputs.push(newFragmentOutput)}}node.addChild(availableOutputNode)}for(var outputIndex=0;outputIndex<outputs.length;outputIndex++){var fragmentOutput=outputs[outputIndex];if(foundOutputs.indexOf(fragmentOutput.OutputGuid)===-1){var deadOutputNode=new Design.TreeNode($filter('translate')('DeletedOutput'),fragmentOutput);deadOutputNode.imageKey="icon-fragmentoutputblack";deadOutputNode.treeView=treeview;for(var placeholderIndex=0;placeholderIndex<fragmentOutput.Placeholders.length;placeholderIndex++){var bookmarkNode=vm.prepareBookmarkTreeNode(treeview,fragmentOutput.Placeholders[placeholderIndex],wiz,fragmentOutput.Placeholders[placeholderIndex].XmlNamespace);deadOutputNode.addChild(bookmarkNode)}node.addChild(deadOutputNode)}}})};QuestionSetDesignerFactory.prepareResponseMetadataTreeNode=function($filter,treeview,responseMetadataField,lists){var returnNode;returnNode=new Design.TreeNode($filter('translate')('ResponseMetdata'),responseMetadataField);returnNode.treeView=treeview;returnNode.imageKey="icon-responsemetadata";(function(responseMetdataNode,listManager,responseMetdataFieldGuid){lists.responseMetadataFields().then(function(responseMetadataFields){var found=false;for(var i=0;i<responseMetadataFields.length;i++){if(responseMetadataFields[i].responseMetadataFieldGuid===responseMetdataFieldGuid.ResponseMetadataFieldGuid){found=true;responseMetdataNode.text=responseMetadataFields[i].name;break}}if(!found){responseMetdataNode.text=$filter('translate')('InvalidResponseMetadataField')}})})(returnNode,lists,responseMetadataField);return returnNode};QuestionSetDesignerFactory.prepareBookmarkTreeNode=function(treeview,bookmark,wiz,targetNamespace){var returnNode;returnNode=new Design.TreeNode(bookmark.Name,bookmark);returnNode.treeView=treeview;if(bookmark.External){if(bookmark.PlaceholderType===Intelledox.Model.PlaceholderType.Bookmark){returnNode.imageKey="icon-externalbookmark"}else if(bookmark.PlaceholderType===Intelledox.Model.PlaceholderType.Slide||bookmark.PlaceholderType===Intelledox.Model.PlaceholderType.PdfField){returnNode.imageKey=""}else{returnNode.imageKey="icon-externalmustache"}}else{var bmImage=this.getPlaceholderImage(bookmark.PlaceholderType,bookmark.DocumentGuid,wiz);returnNode.imageKey=bmImage}if(System.String.IsNullOrEmpty(targetNamespace)===false){returnNode.text=bookmark.Name.replace(targetNamespace,"ns")}return returnNode};QuestionSetDesignerFactory.prepareQuestionNode=function($filter,treeview,question,lists,wiz){var removePlaceholders=new Array;var questionNode=new Design.TreeNode(question.TranslatedText,question);questionNode.treeView=treeview;if(question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom){questionNode.imageKey='url('+Intelledox.Common.ConstantValues.DATA_URI_BLANK+')';lists.customQuestionType(question.CustomQuestionTypeId).then(function(customType){if(!System.String.IsNullOrEmpty(customType.icon16)){questionNode.imageKey='url('+Intelledox.Common.ConstantValues.DATA_URI_PREFIX+customType.icon16+')'}})}else{questionNode.imageKey=this.getQuestionTypeImageKey(question)}if(question.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator&&question.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary&&question.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton){for(var answerIndex=0;answerIndex<question.Answers.length;answerIndex++){var a=question.Answers[answerIndex];var answerNode=this.prepareAnswerTreeNode(treeview,a);questionNode.addChild(answerNode);for(var contentIndex=0;contentIndex<a.ContentItems.length;contentIndex++){var contentItem=a.ContentItems[contentIndex];var imgkey;switch(contentItem.ContentTypeId){case Intelledox.Model.ContentType.UnformattedText:imgkey="icon-contenttext";break;case Intelledox.Model.ContentType.Image:imgkey="icon-contentimage";break;case Intelledox.Model.ContentType.DocumentFragment:imgkey="icon-contentfragment";break;case Intelledox.Model.ContentType.Attachment:imgkey="icon-contentattachment";break;default:imgkey="icon-contentlibrary";break}var contentItemNode=new Design.TreeNode($filter('translate')('ContentItem'),contentItem);contentItemNode.treeView=treeview;contentItemNode.imageKey=imgkey;(function(contentNode,listManager,contentItemGuid){lists.getContentItems().then(function(contentItems){var found=false;for(var i=0;i<contentItems.length;i++){if(contentItems[i].contentItemGuid===contentItemGuid){found=true;contentNode.text=contentItems[i].name;break}}if(!found){contentNode.text=$filter('translate')('InvalidContentItem')}})})(contentItemNode,lists,contentItem.ContentItemGuid);answerNode.addChild(contentItemNode)}for(var placeholderIndex=0;placeholderIndex<a.Placeholders.length;placeholderIndex++){var b=a.Placeholders[placeholderIndex];if(b.ContentId!==Intelledox.Common.ConstantValues.GUID_EMPTY){var found=false;for(var contentNodeIndex=0;contentNodeIndex<answerNode.nodes.length;contentNodeIndex++){var contentNode=answerNode.nodes[contentNodeIndex];if(contentNode.tag instanceof Intelledox.QAWizard.Design.ContentItem){if(contentNode.tag.ContentInstanceId===b.ContentId){found=true;contentNode.addChild(this.prepareBookmarkTreeNode(treeview,b,wiz,b.XmlNamespace));break}}}if(!found){removePlaceholders.push(b)}}else{var bookmarkNode=this.prepareBookmarkTreeNode(treeview,b,wiz,b.XmlNamespace);answerNode.addChild(bookmarkNode)}}if(a.HasResponseMetadataFields){for(var responseMetadataFieldIndex=0;responseMetadataFieldIndex<a.ResponseMetadataFields.length;responseMetadataFieldIndex++){var responseMetadataFieldNode=this.prepareResponseMetadataTreeNode($filter,treeview,a.ResponseMetadataFields[responseMetadataFieldIndex],lists);answerNode.addChild(responseMetadataFieldNode)}}for(var removeIndex=0;removeIndex<removePlaceholders.length;removeIndex++){for(var existingIndex=0;existingIndex<a.Placeholders.length;existingIndex++){if(a.Placeholders[existingIndex]===removePlaceholders[removeIndex]){a.Placeholders.splice(existingIndex,1)}}}removePlaceholders=[]}}else if(question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton){for(var actionIndex=0;actionIndex<question.Actions.length;actionIndex++){var actionTreeNode=QuestionSetDesignerFactory.prepareActionTreeNode($filter,treeview,question.Actions[actionIndex],lists);questionNode.addChild(actionTreeNode)}}return questionNode};QuestionSetDesignerFactory.prepareActionTreeNode=function($filter,treeview,action,listManager){var vm=this;var returnNode;returnNode=new Design.TreeNode(Design.TranslationHelper.KeywordValueToTranslation($filter,action.Name),action);returnNode.treeView=treeview;returnNode.imageKey="icon-deliveryaction";listManager.actionOutputs(action.Type.routingTypeId).then(function(outputs){for(var i=0;i<outputs.length;i++){var outputNode=QuestionSetDesignerFactory.prepareActionOutputTreeNode(outputs[i]);returnNode.addChild(outputNode)}for(var childIndex=0;childIndex<action.Children.length;childIndex++){var nestedAction=vm.prepareActionTreeNode($filter,treeview,action.Children[childIndex],listManager);returnNode.addChild(nestedAction)}});if(System.String.IsNullOrEmpty(action.Name)){listManager.getActionName(action.Type.routingTypeId).then(function(name){action.Name=name;returnNode.text=Design.TranslationHelper.KeywordValueToTranslation($filter,name)})}return returnNode};QuestionSetDesignerFactory.prepareActionOutputTreeNode=function(actionOutput){var returnNode=new Design.TreeNode(actionOutput.name,actionOutput);returnNode.imageKey="icon-actionoutput";return returnNode};QuestionSetDesignerFactory.getWorkflowTypeName=function($filter,node){if(node!=null){if(node instanceof Intelledox.QAWizard.Design.WorkflowState){return $filter('translate')('State')}else if(node instanceof Design.WorkflowTransitionCollection){return $filter('translate')('Transition')}else if(node instanceof Intelledox.QAWizard.Design.Workflow){return $filter('translate')('ParallelSection')}else if(node instanceof Intelledox.QAWizard.Design.Escalation){return $filter('translate')('Escalation')}}return""};QuestionSetDesignerFactory.getQuestionSetTypeName=function($filter,node){if(node!=null&&node.tag!=null){if(node.tag instanceof Intelledox.QAWizard.Design.Page){return $filter('translate')('Page')}else if(node.tag instanceof Intelledox.QAWizard.Design.Section){return $filter('translate')('Section')}else if(node.tag instanceof Intelledox.QAWizard.Design.Column){return $filter('translate')('Column')}else if(node.tag instanceof Intelledox.QAWizard.Design.TabGroup){return $filter('translate')('TabGroup')}else if(node.tag instanceof Intelledox.QAWizard.Design.TabPage){return $filter('translate')('TabPage')}else if(node.tag instanceof Intelledox.QAWizard.Design.Question){return $filter('translate')('Question')}else if(node.tag instanceof Intelledox.QAWizard.Design.Answer){return $filter('translate')('Answer')}else if(node.tag instanceof Intelledox.QAWizard.Design.Placeholder){return $filter('translate')('Placeholder')}else if(node.tag instanceof Intelledox.QAWizard.Design.ContentItem){return $filter('translate')('ContentItem')}else if(node.tag instanceof Intelledox.QAWizard.Design.ResponseMetadataField){return $filter('translate')('ResponseMetadataField')}}return""};QuestionSetDesignerFactory.prepareAnswerTreeNode=function(treeview,answer){var returnNode;var nameText;if(System.String.IsNullOrEmpty(answer.Name)){nameText="Answer "+answer.ID.toString()}else{nameText=answer.Name}returnNode=new Design.TreeNode(nameText,answer);returnNode.treeView=treeview;returnNode.imageKey="icon-answer";return returnNode};QuestionSetDesignerFactory.prepareTemplateTreeNode=function(treeview,doc,wiz){var returnNode=new Design.TreeNode(doc.Name,doc);returnNode.treeView=treeview;switch(doc.FormatType){case Intelledox.Model.TemplateFormatType.WordBinary:case Intelledox.Model.TemplateFormatType.WordDocm:case Intelledox.Model.TemplateFormatType.WordDocx:returnNode.imageKey="tool-word";break;case Intelledox.Model.TemplateFormatType.ExcelXlsm:case Intelledox.Model.TemplateFormatType.ExcelXlsx:returnNode.imageKey="tool-excel";break;case Intelledox.Model.TemplateFormatType.PowerPointPptx:returnNode.imageKey="tool-powerpoint";break;case Intelledox.Model.TemplateFormatType.Pdf:returnNode.imageKey="tool-pdf";break;case Intelledox.Model.TemplateFormatType.Json:returnNode.imageKey="tool-json";break;case Intelledox.Model.TemplateFormatType.Xsd:returnNode.imageKey="tool-xsd";break;case Intelledox.Model.TemplateFormatType.Csv:returnNode.imageKey="tool-csv";break;case Intelledox.Model.TemplateFormatType.Txt:returnNode.imageKey="tool-txt";break;case Intelledox.Model.TemplateFormatType.Html:returnNode.imageKey="tool-html";break;case Intelledox.Model.TemplateFormatType.ProjectResults:returnNode.imageKey="tool-projectresults";break;default:returnNode.imageKey="icon-template";break}if(doc.HasPlaceholders){for(var placeholderIndex=0;placeholderIndex<doc.Placeholders.length;placeholderIndex++){var b=doc.Placeholders[placeholderIndex];var bookmarkNode=this.prepareBookmarkTreeNode(treeview,b,wiz,b.XmlNamespace);returnNode.addChild(bookmarkNode)}}return returnNode};QuestionSetDesignerFactory.prepareFragmentInputTreeNode=function(treeview,input){var returnNode=new Design.TreeNode(input.description,input);returnNode.treeView=treeview;returnNode.imageKey="icon-fragmentinput";return returnNode};QuestionSetDesignerFactory.prepareAvailableOutputTreeNode=function(treeview,output){var returnNode=new Design.TreeNode(output.Name,output);returnNode.treeView=treeview;returnNode.imageKey="icon-fragmentoutput";return returnNode};QuestionSetDesignerFactory.getQuestionTypeImageKey=function(question){switch(question.QuestionTypeID){case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt:return"icon-addressprompt";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource:return"icon-datasource";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:return"icon-grouplogic";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic:return"icon-simplelogic";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:return"icon-userprompt";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable:return"icon-variable";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary:if(question.IsFileSelection){return"icon-fileselection"}return"icon-contentlibrary";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label:return"icon-label";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic:return"icon-autologic";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Chart:return"icon-chart";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode:return"icon-barcode";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RichText:return"icon-richtext";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Ink:return"icon-ink";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator:return"icon-validator";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation:return"icon-geolocation";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric:return"icon-numeric";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button:return"icon-button";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary:return"icon-summary";case Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton:return"icon-runactionbutton";default:return"icon-userprompt"}};QuestionSetDesignerFactory.getPlaceholderImage=function(type,docGuid,wiz){switch(type){case Intelledox.Model.PlaceholderType.Bookmark:return this.getBookmarkImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.Slide:return this.getSlideImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.Xml:return this.getXmlImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.XmlRepeat:return this.getXmlRepeatImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.Worksheet:return this.getWorksheetImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.NamedRange:return this.getNamedRangeImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.Broken:return this.getBrokenImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.PdfField:return this.getPdfImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.Json:return this.getJsonImage(docGuid,wiz);default:return this.getMustacheImage(docGuid,wiz)}};QuestionSetDesignerFactory.getUsedPlaceholderImage=function(type,docGuid,wiz){switch(type){case Intelledox.Model.PlaceholderType.Bookmark:return this.getUsedBookmarkImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.Slide:return this.getUsedSlideImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.Xml:return this.getUsedXmlImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.XmlRepeat:return this.getUsedXmlRepeatImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.Worksheet:return this.getUsedWorksheetImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.NamedRange:return this.getUsedNamedRangeImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.Broken:return this.getBrokenImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.PdfField:return this.getUsedPdfImage(docGuid,wiz);case Intelledox.Model.PlaceholderType.Json:return this.getUsedJsonImage(docGuid,wiz);default:return this.getUsedMustacheImage(docGuid,wiz)}};QuestionSetDesignerFactory.getBrokenImage=function(docGuid,wiz){return"icon-placeholderbroken"};QuestionSetDesignerFactory.getBookmarkImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-bookmarkgreen";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-bookmarkblue";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-bookmarkcyan";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-bookmarkorange";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-bookmarkpurple";default:return"icon-bookmarkgreen"}}else{return"icon-bookmarkblack"}};QuestionSetDesignerFactory.getUsedBookmarkImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-bookmarkgreenused";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-bookmarkblueused";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-bookmarkcyanused";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-bookmarkorangeused";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-bookmarkpurpleused";default:return"icon-bookmarkgreenused"}}else{return"icon-bookmarkblackused"}};QuestionSetDesignerFactory.getSlideImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-slidegreen";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-slideblue";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-slidecyan";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-slideorange";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-slidepurple";default:return"icon-slidegreen"}}else{return"icon-slideblack"}};QuestionSetDesignerFactory.getUsedSlideImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-slidegreenused";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-slideblueused";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-slidecyanused";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-slideorangeused";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-slidepurpleused";default:return"icon-slidegreenused"}}else{return"icon-slideblackused"}};QuestionSetDesignerFactory.getXmlImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-xmlgreen";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-xmlblue";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-xmlcyan";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-xmlorange";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-xmlpurple";default:return"icon-xmlgreen"}}else{return"icon-xmlblack"}};QuestionSetDesignerFactory.getUsedXmlImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-xmlgreenused";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-xmlblueused";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-xmlcyanused";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-xmlorangeused";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-xmlpurpleused";default:return"icon-xmlgreenused"}}else{return"icon-xmlblackused"}};QuestionSetDesignerFactory.getXmlRepeatImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-xmlrepeatgreen";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-xmlrepeatblue";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-xmlrepeatcyan";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-xmlrepeatorange";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-xmlrepeatpurple";default:return"icon-xmlrepeatgreen"}}else{return"icon-xmlrepeatblack"}};QuestionSetDesignerFactory.getUsedXmlRepeatImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-xmlrepeatgreenused";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-xmlrepeatblueused";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-xmlrepeatcyanused";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-xmlrepeatorangeused";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-xmlrepeatpurpleused";default:return"icon-xmlrepeatgreenused"}}else{return"icon-xmlrepeatblackused"}};QuestionSetDesignerFactory.getWorksheetImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-worksheetgreen";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-worksheetblue";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-worksheetcyan";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-worksheetorange";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-worksheetpurple";default:return"icon-worksheetgreen"}}else{return"icon-worksheetblack"}};QuestionSetDesignerFactory.getUsedWorksheetImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-worksheetgreenused";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-worksheetblueused";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-worksheetcyanused";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-worksheetorangeused";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-worksheetpurpleused";default:return"icon-worksheetgreenused"}}else{return"icon-worksheetblackused"}};QuestionSetDesignerFactory.getNamedRangeImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-namedrangegreen";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-namedrangeblue";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-namedrangecyan";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-namedrangeorange";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-namedrangepurple";default:return"icon-namedrangegreen"}}else{return"icon-namedrangeblack"}};QuestionSetDesignerFactory.getUsedNamedRangeImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-namedrangegreenused";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-namedrangeblueused";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-namedrangecyanused";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-namedrangeorangeused";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-namedrangepurpleused";default:return"icon-namedrangegreenused"}}else{return"icon-namedrangeblackused"}};QuestionSetDesignerFactory.getPdfImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-pdffieldgreen";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-pdffieldblue";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-pdffieldcyan";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-pdffieldorange";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-pdffieldpurple";default:return"icon-pdffieldgreen"}}else{return"icon-pdffieldblack"}};QuestionSetDesignerFactory.getUsedPdfImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-pdffieldgreenused";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-pdffieldblueused";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-pdffieldcyanused";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-pdffieldorangeused";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-pdffieldpurpleused";default:return"icon-pdffieldgreenused"}}else{return"icon-pdffieldblackused"}};QuestionSetDesignerFactory.getJsonImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-jsongreen";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-jsonblue";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-jsoncyan";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-jsonorange";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-jsonpurple";default:return"icon-jsongreen"}}else{return"icon-jsonblack"}};QuestionSetDesignerFactory.getUsedJsonImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-jsongreenused";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-jsonblueused";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-jsoncyanused";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-jsonorangeused";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-jsonpurpleused";default:return"icon-jsongreenused"}}else{return"icon-jsonblackused"}};QuestionSetDesignerFactory.getMustacheImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-mustachegreen";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-mustacheblue";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-mustachecyan";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-mustacheorange";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-mustachepurple";default:return"icon-mustachegreen"}}else{return"icon-mustacheblack"}};QuestionSetDesignerFactory.getUsedMustacheImage=function(docGuid,wiz){var doc=wiz.FindDocumentByGuid(docGuid);if(doc!=null){switch(doc.Colour){case Intelledox.QAWizard.Design.PlaceholderColour.Green:return"icon-mustachegreenused";case Intelledox.QAWizard.Design.PlaceholderColour.Blue:return"icon-mustacheblueused";case Intelledox.QAWizard.Design.PlaceholderColour.Cyan:return"icon-mustachecyanused";case Intelledox.QAWizard.Design.PlaceholderColour.Orange:return"icon-mustacheorangeused";case Intelledox.QAWizard.Design.PlaceholderColour.Purple:return"icon-mustachepurpleused";default:return"icon-mustachegreenused"}}else{return"icon-mustacheblackused"}};return QuestionSetDesignerFactory}());Design.QuestionSetDesignerFactory=QuestionSetDesignerFactory})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var FinishPage=(function(_super){__extends(FinishPage,_super);function FinishPage(wizard,pageGuid){var _this=_super.call(this,pageGuid)||this;_this._wizard=wizard;return _this}Object.defineProperty(FinishPage.prototype,"Name",{get:function(){return this._wizard.FinishTitle},set:function(value){if(value===null){return}this._wizard.FinishTitle=value},enumerable:true,configurable:true});return FinishPage}(Design.Page));Design.FinishPage=FinishPage})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){angular.module("Design").directive('toolboxDraggable',function(){return function(scope,element){var el=element[0];el.draggable=true;el.addEventListener('dragstart',function(e){e.dataTransfer.dropEffect='move';e.dataTransfer.setData('Text',this.id);window['ix-dragMode']="toolbox";window['ix-dragObject']=this.id;return false},false)}}).directive('doubleclickToAdd',function(){return{restrict:'A',scope:{editorViewModel:'=doubleclickToAdd'},link:function(scope,element,attr){var el=element[0];el.addEventListener('dblclick',function(e){var id=this.id;e.preventDefault();e.stopPropagation();var targetNode=scope.editorViewModel.treeView.selectedNode;do if(Design.DragDropMatch.canDropItem(window['ix-wiz'],'toolbox',id,targetNode)){scope.$apply(function(){scope.editorViewModel.editorDrop(id,targetNode)});break}else if(targetNode==null){break}else{targetNode=targetNode.parent}while(true);return false},false)}}}).directive('treeviewDraggable',['$filter',function($filter){return function(scope,element){var el=element[0];el.draggable=true;el.addEventListener('dragstart',function(e){e.dataTransfer.dropEffect='move';e.dataTransfer.setData('Text',Design.HelperFunctions.createReferenceText($filter,scope.node));window['ix-dragMode']="treeview";window['ix-dragObject']=scope.node;return false},false)}}]).directive('propertiesDroppable',function(){return{restrict:'A',scope:{currentModel:'=propertiesDroppable'},link:function(scope,element,attr){var el=element[0];el.addEventListener('dragover',function(e){e.dataTransfer.dropEffect='none';e.stopPropagation();e.preventDefault();return false},false);el.addEventListener('dragenter',function(e){e.dataTransfer.dropEffect='none';e.stopPropagation();e.preventDefault();return false},false);el.addEventListener('drop',function(e){e.dataTransfer.dropEffect='none';e.stopPropagation();e.preventDefault();return false},false)}}}).directive('editorDroppable',function(){return{restrict:'A',scope:{currentModel:'=editorDroppable',onEditorDrop:'&'},link:function(scope,element,attr){var el=element[0];el.addEventListener('dragover',function(e){if(Design.DragDropMatch.canDropItem(window['ix-wiz'],window['ix-dragMode'],window['ix-dragObject'],scope.currentModel)){e.dataTransfer.dropEffect='move';e.stopPropagation();e.preventDefault();this.classList.add('over');return false}},false);el.addEventListener('dragenter',function(e){if(scope.currentModel instanceof Design.TreeNode){window.clearTimeout(scope.currentModel.treeView.hoverTimer);if(!scope.currentModel.isExpanded){var vm=scope.currentModel;scope.currentModel.treeView.hoverTimer=window.setTimeout(function(){scope.$apply(function(){scope.currentModel.expand()})},500)}}if(Design.DragDropMatch.canDropItem(window['ix-wiz'],window['ix-dragMode'],window['ix-dragObject'],scope.currentModel)){this.classList.add('over');e.stopPropagation();e.preventDefault();return false}},false);el.addEventListener('dragleave',function(e){this.classList.remove('over');return false},false);el.addEventListener('drop',function(e){e.preventDefault();e.stopPropagation();this.classList.remove('over');scope.onEditorDrop({mode:window['ix-dragMode'],dropped:window['ix-dragObject'],targetNode:scope.currentModel});window['ix-dragMode']='';window['ix-dragObject']=null;return false},false)}}}).directive('clauseDroppable',function(){var canDropItem=function(mode,dragObject){if(!(dragObject instanceof Design.TreeNode)){return false}return(dragObject.tag instanceof Intelledox.QAWizard.Design.Answer||dragObject.tag instanceof Intelledox.QAWizard.Design.Question||dragObject.tag instanceof Intelledox.QAWizard.Design.Action||dragObject.tag instanceof Intelledox.QAWizard.Design.Clause||dragObject.tag instanceof Intelledox.QAWizard.Design.AvailableInput||dragObject.tag instanceof Intelledox.QAWizard.Design.FragmentOutput)};return{restrict:'A',scope:{currentModel:'=clauseDroppable'},link:function(scope,element,attr){var el=element[0];el.addEventListener('dragover',function(e){if(canDropItem(window['ix-dragMode'],window['ix-dragObject'])){e.dataTransfer.dropEffect='move';e.stopPropagation();e.preventDefault();this.classList.add('over');return false}},false);el.addEventListener('dragenter',function(e){if(canDropItem(window['ix-dragMode'],window['ix-dragObject'])){this.classList.add('over');e.stopPropagation();e.preventDefault();return false}},false);el.addEventListener('dragleave',function(e){this.classList.remove('over');return false},false);el.addEventListener('drop',function(e){e.preventDefault();e.stopPropagation();this.classList.remove('over');scope.$apply(function(){if(scope.currentModel instanceof Design.TreeView){scope.currentModel.dropEvent(window['ix-dragObject'],null)}else{scope.currentModel.treeView.dropEvent(window['ix-dragObject'],scope.currentModel)}});window['ix-dragMode']='';window['ix-dragObject']=null;return false},false)}}})})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var HelperFunctions=(function(){function HelperFunctions(){}HelperFunctions.comparisonTypeIdToText=function($filter,typeID,validationType){switch(validationType){case Intelledox.Model.ValidationRuleType.Compare:switch(typeID){case Intelledox.Model.ComparisonType.BeginsWith:return $filter('translate')('BeginsWith');case Intelledox.Model.ComparisonType.Contains:return $filter('translate')('Contains');case Intelledox.Model.ComparisonType.NotContain:return $filter('translate')('DoesntContain');case Intelledox.Model.ComparisonType.EndsWith:return $filter('translate')('EndsWith');case Intelledox.Model.ComparisonType.Equals:return $filter('translate')('EqualsString');case Intelledox.Model.ComparisonType.GreaterThan:return $filter('translate')('GreaterThan');case Intelledox.Model.ComparisonType.GreaterThanOrEquals:return $filter('translate')('GreaterThanorEquals');case Intelledox.Model.ComparisonType.LessThan:return $filter('translate')('LessThan');case Intelledox.Model.ComparisonType.LessThanOrEquals:return $filter('translate')('LessThanorEquals');case Intelledox.Model.ComparisonType.NotEqualTo:return $filter('translate')('NotEqualTo');default:return $filter('translate')('NoneWithBrackets')}case Intelledox.Model.ValidationRuleType.FieldLength:switch(typeID){case Intelledox.Model.ComparisonType.GreaterThanOrEquals:return $filter('translate')('Minimum');case Intelledox.Model.ComparisonType.LessThanOrEquals:return $filter('translate')('Maximum');default:return $filter('translate')('NoneWithBrackets')}case Intelledox.Model.ValidationRuleType.RegularExpression:return $filter('translate')('Match');default:return $filter('translate')('NoneWithBrackets')}};HelperFunctions.ForAllResponseMetadataFields=function(wizard,method){for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var page=wizard.Pages[pageIndex];if(page instanceof Intelledox.QAWizard.Design.FragmentPage){for(var outIndex=0;outIndex<page.Outputs.length;outIndex++){for(var rmfIndex=0;rmfIndex<page.Outputs[outIndex].ResponseMetadataFields.length;rmfIndex++){method(page.Outputs[outIndex].ResponseMetadataFields[rmfIndex])}}}this.ForAllResponseMetadaFieldsInternal(method,page)}};HelperFunctions.ForAllResponseMetadaFieldsInternal=function(method,node){for(var childIndex=0;childIndex<node.Children.length;childIndex++){var child=node.Children[childIndex];if(child instanceof Intelledox.QAWizard.Design.Question){for(var answerIndex=0;answerIndex<child.Answers.length;answerIndex++){for(var rmfIndex=0;rmfIndex<child.Answers[answerIndex].ResponseMetadataFields.length;rmfIndex++){method(child.Answers[answerIndex].ResponseMetadataFields[rmfIndex])}}}else if(child instanceof Intelledox.QAWizard.Design.FragmentReference){for(var outIndex=0;outIndex<child.Outputs.length;outIndex++){for(var rmfIndex=0;rmfIndex<child.Outputs[outIndex].ResponseMetadataFields.length;rmfIndex++){method(child.Outputs[outIndex].ResponseMetadataFields[rmfIndex])}}}else if(typeof(child.HasContainerInterface)!=="undefined"){this.ForAllResponseMetadaFieldsInternal(method,child)}}};HelperFunctions.ForAllPlaceholders=function(wizard,method){for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var page=wizard.Pages[pageIndex];if(page instanceof Intelledox.QAWizard.Design.FragmentPage){for(var fragDocIndex=0;fragDocIndex<page.Documents.length;fragDocIndex++){var doc=page.Documents[fragDocIndex];for(var placeIndex=0;placeIndex<doc.Placeholders.length;placeIndex++){method(doc.Placeholders[placeIndex])}}for(var outIndex=0;outIndex<page.Outputs.length;outIndex++){for(var bmIndex=0;bmIndex<page.Outputs[outIndex].Placeholders.length;bmIndex++){method(page.Outputs[outIndex].Placeholders[bmIndex])}}}this.ForAllPlaceholdersInternal(method,page)}for(var docIndex=0;docIndex<wizard.Documents.length;docIndex++){for(var placeIndex=0;placeIndex<wizard.Documents[docIndex].Placeholders.length;placeIndex++){method(wizard.Documents[docIndex].Placeholders[placeIndex])}}};HelperFunctions.ForAllPlaceholdersInternal=function(method,node){for(var childIndex=0;childIndex<node.Children.length;childIndex++){var child=node.Children[childIndex];if(child instanceof Intelledox.QAWizard.Design.Question){for(var answerIndex=0;answerIndex<child.Answers.length;answerIndex++){for(var answerPlaceIndex=0;answerPlaceIndex<child.Answers[answerIndex].Placeholders.length;answerPlaceIndex++){method(child.Answers[answerIndex].Placeholders[answerPlaceIndex])}}}else if(child instanceof Intelledox.QAWizard.Design.FragmentReference){for(var docIndex=0;docIndex<child.Documents.length;docIndex++){for(var docPlaceIndex=0;docPlaceIndex<child.Documents[docIndex].Placeholders.length;docPlaceIndex++){method(child.Documents[docIndex].Placeholders[docPlaceIndex])}}for(var outIndex=0;outIndex<child.Outputs.length;outIndex++){for(var outPlaceIndex=0;outPlaceIndex<child.Outputs[outIndex].Placeholders.length;outPlaceIndex++){method(child.Outputs[outIndex].Placeholders[outPlaceIndex])}}}else if(typeof(child.HasContainerInterface)!=="undefined"){this.ForAllPlaceholdersInternal(method,child)}}};HelperFunctions.isNegativeZero=function(n){return(n===0)&&(((n=+n)||1/n)<0)};HelperFunctions.isPlaceholderNameAllowed=function(wizard,placeholderName,parentNode,docGuid,dragPlaceholder){if(dragPlaceholder===void 0){dragPlaceholder=null}if(System.String.IsNullOrEmpty(placeholderName.name)){return true}if(parentNode.tag instanceof Intelledox.QAWizard.Design.Placeholder){parentNode=parentNode.parent}var parentQuestionNode=parentNode.treeView.findAncestorOrSelf(parentNode,function(parentNode){return parentNode.tag instanceof Intelledox.QAWizard.Design.Question});var parentQuestion=null;if(parentQuestionNode!=null){parentQuestion=parentQuestionNode.tag}var dragQuestionIsLogic=parentQuestion instanceof Intelledox.QAWizard.Design.LogicQuestion;for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){for(var questionIndex=0;questionIndex<wizard.Pages[pageIndex].Questions.length;questionIndex++){var q=wizard.Pages[pageIndex].Questions[questionIndex];if(q instanceof Intelledox.QAWizard.Design.DatasourceQuestion&&q.SelectionType===Intelledox.Model.SelectionType.Multiple){for(var dsIndex=0;dsIndex<q.RepeatPlaceholders.length;dsIndex++){if(q.RepeatPlaceholders[dsIndex].equals(placeholderName)){return false}}}for(var answerIndex=0;answerIndex<q.Answers.length;answerIndex++){var a=q.Answers[answerIndex];for(var placeholderIndex=0;placeholderIndex<a.Placeholders.length;placeholderIndex++){var b=a.Placeholders[placeholderIndex];if(b.Reference.equals(placeholderName)&&(b.DocumentGuid===docGuid||b.DocumentGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY)){if(dragPlaceholder==null||b!==dragPlaceholder.tag){var isAllowed=false;if(q===parentQuestion){if((parentQuestion instanceof Intelledox.QAWizard.Design.GroupLogicQuestion&&!(parentQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelect&&b.Reference.purpose===Intelledox.Model.PlaceholderPurpose.Insert))||parentQuestion instanceof Intelledox.QAWizard.Design.SimpleLogicQuestion||parentQuestion instanceof Intelledox.QAWizard.Design.AutoLogicQuestion){isAllowed=true}}if(b.PlaceholderType===Intelledox.Model.PlaceholderType.Xml){if(dragQuestionIsLogic){if(a.Question!==parentQuestion&&a.Question instanceof Intelledox.QAWizard.Design.LogicQuestion){return false}else{continue}}else{if(a.Question instanceof Intelledox.QAWizard.Design.LogicQuestion){continue}else{return false}}}if(!isAllowed){return false}}}}}}var sectionPlaceholders={};var fragmentPlaceholders={};sectionPlaceholders[docGuid]=null;fragmentPlaceholders[docGuid]=null;for(var innerPageIndex=0;innerPageIndex<wizard.Pages.length;innerPageIndex++){var p=wizard.Pages[innerPageIndex];if(p instanceof Intelledox.QAWizard.Design.FragmentPage){for(var fragPageDocIndex=0;fragPageDocIndex<p.Documents.length;fragPageDocIndex++){var doc=p.Documents[fragPageDocIndex];for(var placeIndex=0;placeIndex<doc.Placeholders.length;placeIndex++){var bm=doc.Placeholders[placeIndex];if(bm.Reference.equals(placeholderName)&&(bm.DocumentGuid===docGuid||bm.DocumentGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY)){return false}}}for(var outIndex=0;outIndex<p.Outputs.length;outIndex++){var out=p.Outputs[outIndex];for(var placeIndex=0;placeIndex<out.Placeholders.length;placeIndex++){var bm=out.Placeholders[placeIndex];if(bm.Reference.equals(placeholderName)&&(bm.DocumentGuid===docGuid||bm.DocumentGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY)){return false}}}}for(var placeIndex=0;placeIndex<p.RepeatPlaceholders.length;placeIndex++){var bmr=p.RepeatPlaceholders[placeIndex];if(bmr.equals(placeholderName)){return false}}sectionPlaceholders[docGuid]=new Array;this.findSectionPlaceholders(p.Children,sectionPlaceholders);for(var placeIndex=0;placeIndex<sectionPlaceholders[docGuid].length;placeIndex++){var bmr=sectionPlaceholders[docGuid][placeIndex];if(bmr.equals(placeholderName)){return false}}fragmentPlaceholders[docGuid]=new Array;this.findFragmentPlaceholders(p.Children,fragmentPlaceholders);for(var placeIndex=0;placeIndex<fragmentPlaceholders[docGuid].length;placeIndex++){var bm=fragmentPlaceholders[docGuid][placeIndex];if(bm.Reference.equals(placeholderName)&&(bm.DocumentGuid===docGuid||bm.DocumentGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY)){return false}}}}for(var docIndex=0;docIndex<wizard.Documents.length;docIndex++){if(wizard.Documents[docIndex].HasPlaceholders){for(var placeIndex=0;placeIndex<wizard.Documents[docIndex].Placeholders.length;placeIndex++){var bm=wizard.Documents[docIndex].Placeholders[placeIndex];if(bm.Reference.equals(placeholderName)&&(bm.DocumentGuid===docGuid||bm.DocumentGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||docGuid===Intelledox.Common.ConstantValues.GUID_EMPTY)){return false}}}}return true};HelperFunctions.findSectionPlaceholders=function(layout,placeholders){for(var i=0;i<layout.length;i++){var l=layout[i];if(l instanceof Intelledox.QAWizard.Design.Section){var s=l;if(s.IsRepeated){for(var placeIndex=0;placeIndex<s.RepeatPlaceholders.length;placeIndex++){for(var docGuid in placeholders){if(placeholders.hasOwnProperty(docGuid)){placeholders[docGuid].push(s.RepeatPlaceholders[placeIndex])}}}}}if(typeof(l.HasContainerInterface)!=="undefined"){this.findSectionPlaceholders(l.Children,placeholders)}}};HelperFunctions.findFragmentPlaceholders=function(layout,placeholders){for(var i=0;i<layout.length;i++){var l=layout[i];if(l instanceof Intelledox.QAWizard.Design.FragmentReference){var f=l;for(var docIndex=0;docIndex<f.Documents.length;docIndex++){var doc=f.Documents[docIndex];for(var placeIndex=0;placeIndex<doc.Placeholders.length;placeIndex++){for(var docGuid in placeholders){if(placeholders.hasOwnProperty(docGuid)){placeholders[docGuid].push(doc.Placeholders[placeIndex])}}}}for(var outIndex=0;outIndex<f.Outputs.length;outIndex++){var out=f.Outputs[outIndex];for(var placeIndex=0;placeIndex<out.Placeholders.length;placeIndex++){for(var docGuid in placeholders){if(placeholders.hasOwnProperty(docGuid)){placeholders[docGuid].push(out.Placeholders[placeIndex])}}}}}if(typeof(l.HasContainerInterface)!=="undefined"){this.findFragmentPlaceholders(l.Children,placeholders)}}};HelperFunctions.createReferenceText=function($filter,node){var refText="";if(node.tag instanceof Intelledox.QAWizard.Design.Question){refText=Intelledox.QAWizard.Design.AnswerExpressionBuilder.CreateReference(node.tag)}else if(node.tag instanceof Intelledox.QAWizard.Design.Answer){refText=Intelledox.QAWizard.Design.AnswerExpressionBuilder.CreateReference(node.parent.tag,node.tag)}else if(node.tag instanceof Intelledox.Model.ActionOutput){refText=Intelledox.QAWizard.Design.AnswerExpressionBuilder.CreateActionReference(node,node.parent.tag,node.tag)}else if(node.tag instanceof Intelledox.QAWizard.Design.AvailableInput){refText="["+$filter('translate')('Input')+"."+node.tag.description+"]"}else if(node.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){var parentFragment=node.parent.tag;refText="["+$filter('translate')('Fragment')+"."+parentFragment.Name+"."+node.text+"]"}return refText};HelperFunctions.onPickRef=function($filter,value,node,insertPoint){if(value==null){value=''}if(insertPoint!==undefined){value=System.String.Insert(value,insertPoint,HelperFunctions.createReferenceText($filter,node))}else{value+=HelperFunctions.createReferenceText($filter,node)}return value};return HelperFunctions}());Design.HelperFunctions=HelperFunctions})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var DocumentBinary=(function(){function DocumentBinary(){this.documentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.formatType=Model.TemplateFormatType.None;this.templateEditGuid=null}return DocumentBinary}());Model.DocumentBinary=DocumentBinary})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var MetadataElement=(function(){function MetadataElement(){this.MetadataGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Name=null;this.ElementTypeId=0;this.FixedValue=null;this.AnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}return MetadataElement}());Model.MetadataElement=MetadataElement})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var ProjectDefinitionRequest=(function(){function ProjectDefinitionRequest(){this.projectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.xml=null;this.documents=null;this.isNewVersion=false;this.originalProjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.folderGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}return ProjectDefinitionRequest}());Model.ProjectDefinitionRequest=ProjectDefinitionRequest})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var System;(function(System){'use strict';var DateTime=(function(){function DateTime(){}DateTime.MinValue=function(){return new Date(Date.parse("0001-01-01T00:00:00Z"))};return DateTime}());System.DateTime=DateTime})(System||(System={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var RecurrencePattern=(function(){function RecurrencePattern(){this.RecurrencePatternId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.JobDefinitionId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Frequency=Model.FrequencyEnum.Hourly;this.RepeatCount=0;this.Interval=1;this.RepeatDays=0;this.WorkingDays=false;this.RecurDateQuestionReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this.RecurDateAnswerReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this.BySetPosition=0;this.WeekStart=Model.DayOfWeekEnum.MO;this.Timezone=null;this.StartDateUtc=System.DateTime.MinValue();this.RepeatUntilUtc=System.DateTime.MinValue();this.ByDay=new Array;this.ByMonthDay=new Array;this.ByYearDay=new Array;this.ByWeekNo=new Array;this.ByMonth=new Array}RecurrencePattern.prototype.Clear=function(){this.ByDay=new Array;this.ByMonthDay=new Array;this.ByYearDay=new Array;this.ByWeekNo=new Array;this.ByMonth=new Array};return RecurrencePattern}());Model.RecurrencePattern=RecurrencePattern})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Model;(function(Model){var Project=(function(){function Project(){this.name=null;this.projectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.projectTypeId=Model.ProjectType.None;this.folderGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}return Project}());Model.Project=Project})(Model=Intelledox.Model||(Intelledox.Model={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ActionInput=(function(_super){__extends(ActionInput,_super);function ActionInput(){return _super!==null&&_super.apply(this,arguments)||this}ActionInput.prototype.Clone=function(){var result=new ActionInput;_super.prototype.CloneInternal.call(this,result);return result};return ActionInput}(Intelledox.Model.RoutingOption));Design.ActionInput=ActionInput})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var AnswerFactory=(function(){function AnswerFactory(){}AnswerFactory.Create=function(questionType){switch(questionType){case QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt:return new Design.AddressAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic:return new Design.AutoLogicAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode:return new Design.BarcodeAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource:return new Design.DatasourceAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:return new Design.GroupLogicAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.Label:return new Design.LabelAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic:return new Design.SimpleLogicAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:return new Design.UserPromptAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.Variable:return new Design.VariableAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.RichText:return new Design.RichTextAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.Custom:return new Design.CustomAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation:return new Design.GeolocationAnswer;case QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric:return new Design.NumericAnswer;default:return new Design.Answer}};return AnswerFactory}());Design.AnswerFactory=AnswerFactory})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var LogicAnswer=(function(_super){__extends(LogicAnswer,_super);function LogicAnswer(answerGuid,answerName){var _this=_super.call(this,answerGuid,answerName)||this;_this.HideValue=false;_this.TagValue="";return _this}LogicAnswer.prototype.CloneLogic=function(result){result.TagValue=this.TagValue;result.HideValue=this.HideValue;return _super.prototype.CloneInternal.call(this,result)};return LogicAnswer}(Design.Answer));Design.LogicAnswer=LogicAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var AutoLogicAnswer=(function(_super){__extends(AutoLogicAnswer,_super);function AutoLogicAnswer(answerGuid,answerName){var _this=_super.call(this,answerGuid,answerName)||this;_this.Rules=new Design.Rule;return _this}AutoLogicAnswer.prototype.Clone=function(){var result=new AutoLogicAnswer;result.Rules=this.Rules.Clone();return _super.prototype.CloneLogic.call(this,result)};return AutoLogicAnswer}(Design.LogicAnswer));Design.AutoLogicAnswer=AutoLogicAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var BarcodeAnswer=(function(_super){__extends(BarcodeAnswer,_super);function BarcodeAnswer(){return _super!==null&&_super.apply(this,arguments)||this}BarcodeAnswer.prototype.Clone=function(){var result=new BarcodeAnswer;return _super.prototype.CloneInternal.call(this,result)};return BarcodeAnswer}(Design.Answer));Design.BarcodeAnswer=BarcodeAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var CustomAnswer=(function(_super){__extends(CustomAnswer,_super);function CustomAnswer(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.OutputTypeId=Intelledox.Common.ConstantValues.GUID_EMPTY;return _this}CustomAnswer.prototype.Clone=function(){var result=new CustomAnswer;result.SaveToAnswerFileBy=Design.SaveAnswerByEnum.SaveById;result.OutputTypeId=this.OutputTypeId;return _super.prototype.CloneInternal.call(this,result)};return CustomAnswer}(Design.Answer));Design.CustomAnswer=CustomAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var DatasourceAnswer=(function(_super){__extends(DatasourceAnswer,_super);function DatasourceAnswer(){var _this=_super.call(this)||this;_this.Concatenate=false;_this.DataConvertType=Design.DataConvertType.None;_this.DataConvertPattern=null;_this.Formula="";return _this}DatasourceAnswer.prototype.Clone=function(){var result=new DatasourceAnswer;result.Concatenate=this.Concatenate;result.DataConvertType=this.DataConvertType;result.DataConvertPattern=this.DataConvertPattern;result.Formula=this.Formula;return _super.prototype.CloneInternal.call(this,result)};return DatasourceAnswer}(Design.Answer));Design.DatasourceAnswer=DatasourceAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var GeolocationAnswer=(function(_super){__extends(GeolocationAnswer,_super);function GeolocationAnswer(){var _this=_super.call(this)||this;_this.DataField="latitude,longitude";return _this}GeolocationAnswer.prototype.Clone=function(){var result=new GeolocationAnswer;return _super.prototype.CloneInternal.call(this,result)};return GeolocationAnswer}(Design.Answer));Design.GeolocationAnswer=GeolocationAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var GroupLogicAnswer=(function(_super){__extends(GroupLogicAnswer,_super);function GroupLogicAnswer(answerGuid,answerName){var _this=_super.call(this,answerGuid,answerName)||this;_this.IsDefaultSelected=false;_this.DefaultQuestionReference=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.DefaultAnswerReference=Intelledox.Common.ConstantValues.GUID_EMPTY;return _this}Object.defineProperty(GroupLogicAnswer.prototype,"DisplayText",{get:function(){if(System.String.IsNullOrEmpty(this.m_DisplayText)){return""}return this.m_DisplayText},set:function(value){if(value===this.Name){this.m_DisplayText=this.Name}else{this.m_DisplayText=value}},enumerable:true,configurable:true});GroupLogicAnswer.prototype.Clone=function(){var result=new GroupLogicAnswer;result.DisplayText=this.DisplayText;result.IsDefaultSelected=this.IsDefaultSelected;result.DefaultQuestionReference=this.DefaultQuestionReference;result.DefaultAnswerReference=this.DefaultAnswerReference;result.SaveToAnswerFileBy=Design.SaveAnswerByEnum.SaveById;return _super.prototype.CloneLogic.call(this,result)};return GroupLogicAnswer}(Design.LogicAnswer));Design.GroupLogicAnswer=GroupLogicAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var LabelAnswer=(function(_super){__extends(LabelAnswer,_super);function LabelAnswer(){return _super!==null&&_super.apply(this,arguments)||this}LabelAnswer.prototype.Clone=function(){var result=new LabelAnswer;return _super.prototype.CloneInternal.call(this,result)};return LabelAnswer}(Design.Answer));Design.LabelAnswer=LabelAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var NumericAnswer=(function(_super){__extends(NumericAnswer,_super);function NumericAnswer(){return _super!==null&&_super.apply(this,arguments)||this}NumericAnswer.prototype.Clone=function(){var result=new NumericAnswer;result.SaveToAnswerFileBy=Design.SaveAnswerByEnum.SaveById;return _super.prototype.CloneInternal.call(this,result)};return NumericAnswer}(Design.Answer));Design.NumericAnswer=NumericAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var RichTextAnswer=(function(_super){__extends(RichTextAnswer,_super);function RichTextAnswer(){return _super!==null&&_super.apply(this,arguments)||this}RichTextAnswer.prototype.Clone=function(){var result=new RichTextAnswer;result.SaveToAnswerFileBy=Design.SaveAnswerByEnum.SaveById;return _super.prototype.CloneInternal.call(this,result)};return RichTextAnswer}(Design.Answer));Design.RichTextAnswer=RichTextAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var SimpleLogicAnswer=(function(_super){__extends(SimpleLogicAnswer,_super);function SimpleLogicAnswer(){return _super!==null&&_super.apply(this,arguments)||this}SimpleLogicAnswer.prototype.Clone=function(){var result=new SimpleLogicAnswer;result.SaveToAnswerFileBy=Design.SaveAnswerByEnum.SaveById;return _super.prototype.CloneLogic.call(this,result)};return SimpleLogicAnswer}(Design.LogicAnswer));Design.SimpleLogicAnswer=SimpleLogicAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var UserPromptAnswer=(function(_super){__extends(UserPromptAnswer,_super);function UserPromptAnswer(){return _super!==null&&_super.apply(this,arguments)||this}UserPromptAnswer.prototype.Clone=function(){var result=new UserPromptAnswer;result.SaveToAnswerFileBy=Design.SaveAnswerByEnum.SaveById;return _super.prototype.CloneInternal.call(this,result)};return UserPromptAnswer}(Design.Answer));Design.UserPromptAnswer=UserPromptAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var VariableAnswer=(function(_super){__extends(VariableAnswer,_super);function VariableAnswer(){var _this=_super.call(this)||this;_this.DataField="[Formula]";_this.Formula="";return _this}VariableAnswer.prototype.Clone=function(){var result=new VariableAnswer;result.Formula=this.Formula;return _super.prototype.CloneInternal.call(this,result)};return VariableAnswer}(Design.Answer));Design.VariableAnswer=VariableAnswer})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var AvailableInput=(function(_super){__extends(AvailableInput,_super);function AvailableInput(){return _super!==null&&_super.apply(this,arguments)||this}return AvailableInput}(Intelledox.Model.RoutingElementType));Design.AvailableInput=AvailableInput})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var AvailableOutput=(function(_super){__extends(AvailableOutput,_super);function AvailableOutput(){return _super!==null&&_super.apply(this,arguments)||this}AvailableOutput.prototype.Copy=function(wiz){var result=new AvailableOutput;_super.prototype.CloneInternal.call(this,result);result.Name=this.Name;var outputCounter=2;for(var i=0;i<wiz.AvailableOutputs.length;i++){if(wiz.AvailableOutputs[i].Name===result.Name){result.Name=this.Name+" "+outputCounter.toString();outputCounter+=1;i=-1}}result.RoutingOptionGuid=Design.GeneralFunctions.NewGuid();return result};return AvailableOutput}(Intelledox.Model.RoutingOption));Design.AvailableOutput=AvailableOutput})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Axis=(function(){function Axis(){this.HideTitle=false;this.Title="";this.Alignment=Design.StringAlignment.Center;this.HideLabels=false;this.HideFirstAndLastLabels=false;this.BorderlineColour=-8355712;this.BorderlineDashStyle=Design.ChartBorderlineDashStyle.Solid;this.BorderlineWidth=1}Axis.prototype.Clone=function(){var result=new Axis;result.HideTitle=this.HideTitle;result.Title=this.Title;result.Alignment=this.Alignment;result.HideLabels=this.HideLabels;result.HideFirstAndLastLabels=this.HideFirstAndLastLabels;result.BorderlineColour=this.BorderlineColour;result.BorderlineDashStyle=this.BorderlineDashStyle;result.BorderlineWidth=this.BorderlineWidth;return result};return Axis}());Design.Axis=Axis})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ChartArea=(function(){function ChartArea(){this.BackColour=0;this.BorderlineColour=-8355712;this.BorderlineDashStyle=Design.ChartBorderlineDashStyle.NotSet;this.BorderlineWidth=1;this.Is3D=false}ChartArea.prototype.Clone=function(){var result=new ChartArea;result.BackColour=this.BackColour;result.BorderlineColour=this.BorderlineColour;result.BorderlineDashStyle=this.BorderlineDashStyle;result.BorderlineWidth=this.BorderlineWidth;result.Is3D=this.Is3D;return result};return ChartArea}());Design.ChartArea=ChartArea})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ChartProperties=(function(){function ChartProperties(){this.Title=null;this.ColourPalette=Design.ChartColourPalette.Pastel;this.BackColour=-1;this.BorderlineColour=-1;this.BorderlineDashStyle=Design.ChartBorderlineDashStyle.Solid;this.BorderlineWidth=1;this.Series=new Array}ChartProperties.prototype.Clone=function(){var result=new ChartProperties;result.Title=this.Title;result.ColourPalette=this.ColourPalette;result.BackColour=this.BackColour;result.BorderlineColour=this.BorderlineColour;result.BorderlineDashStyle=this.BorderlineDashStyle;result.BorderlineWidth=this.BorderlineWidth;if(this.Legend!=null){result.Legend=this.Legend.Clone()}if(this.ChartArea!=null){result.ChartArea=this.ChartArea.Clone()}if(this.AxisX!=null){result.AxisX=this.AxisX.Clone()}if(this.AxisY!=null){result.AxisY=this.AxisY.Clone()}for(var i=0;i<this.Series.length;i++){result.Series.push(this.Series[i].Clone())}return result};return ChartProperties}());Design.ChartProperties=ChartProperties})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Legend=(function(){function Legend(){this.IsVisible=true;this.Docking=Design.Docking.Right;this.Alignment=Design.StringAlignment.Near;this.BackColour=0;this.BorderlineColour=0;this.BorderlineDashStyle=Design.ChartBorderlineDashStyle.Solid;this.BorderlineWidth=1}Legend.prototype.Clone=function(){var result=new Legend;result.IsVisible=this.IsVisible;result.Docking=this.Docking;result.Alignment=this.Alignment;result.BackColour=this.BackColour;result.BorderlineColour=this.BorderlineColour;result.BorderlineDashStyle=this.BorderlineDashStyle;result.BorderlineWidth=this.BorderlineWidth;return result};return Legend}());Design.Legend=Legend})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Column=(function(){function Column(){this.m_LayoutNodes=new Array;this.ColumnGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Title="";this.HelpText="";this.WidthType=Design.WidthType.Percentage;this.Width=0;this.GroupBy=false;this.CssStyle=null;this.ColumnGuid=Design.GeneralFunctions.NewGuid()}Object.defineProperty(Column.prototype,"ObjectId",{get:function(){return this.ColumnGuid},set:function(value){this.ColumnGuid=value},enumerable:true,configurable:true});Column.prototype.Clone=function(nextId,addQuestionsToPage){if(addQuestionsToPage===void 0){addQuestionsToPage=null}var result=new Column;result.Title=this.Title;result.HelpText=this.HelpText;result.WidthType=this.WidthType;result.Width=this.Width;result.GroupBy=this.GroupBy;result.CssStyle=this.CssStyle;if(this.ActiveConditions!=null){result.ActiveConditions=this.ActiveConditions.Clone()}if(this.VisibleConditions!=null){result.VisibleConditions=this.VisibleConditions.Clone()}if(this.EditableConditions!=null){result.EditableConditions=this.EditableConditions.Clone()}for(var i=0;i<this.Children.length;i++){result.Children.push(this.Children[i].Clone(nextId,addQuestionsToPage))}return result};Object.defineProperty(Column.prototype,"Children",{get:function(){return this.m_LayoutNodes},enumerable:true,configurable:true});Column.prototype.HasContainerInterface=function(){return true};Column.prototype.HasQAContainerInterface=function(){return true};Column.prototype.HasLayoutInterface=function(){return true};Column.prototype.HasChild=function(childGuid){if(childGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return false}else if(this.ColumnGuid===childGuid){return true}else{for(var i=0;i<this.Children.length;i++){if(this.Children[i].HasChild(childGuid)){return true}}return false}};return Column}());Design.Column=Column})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ContentItem=(function(){function ContentItem(){this.ContentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.AttachmentName=null;this.ContentTypeId=Intelledox.Model.ContentType.None;this.KeepSourceFormatting=false;this.ContentInstanceId=Design.GeneralFunctions.NewGuid()}Object.defineProperty(ContentItem.prototype,"ImageSettings",{get:function(){if(this.m_ImageSettings==null){this.m_ImageSettings=new Design.ImageSettings}return this.m_ImageSettings},enumerable:true,configurable:true});ContentItem.prototype.Clone=function(){var result=new ContentItem;result.ContentItemGuid=this.ContentItemGuid;result.ImageSettings.MaxHeight=this.ImageSettings.MaxHeight;result.ImageSettings.MaxWidth=this.ImageSettings.MaxWidth;result.ImageSettings.UnitOfMeasure=this.ImageSettings.UnitOfMeasure;result.ImageSettings.StretchToFit=this.ImageSettings.StretchToFit;result.ImageSettings.AlternativeText=this.ImageSettings.AlternativeText;result.ContentInstanceId=this.ContentInstanceId;result.AttachmentName=this.AttachmentName;result.ContentTypeId=this.ContentTypeId;result.KeepSourceFormatting=this.KeepSourceFormatting;return result};return ContentItem}());Design.ContentItem=ContentItem})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Filter=(function(_super){__extends(Filter,_super);function Filter(newType){if(newType===void 0){newType=Intelledox.Model.ClauseType.Comparison}var _this=_super.call(this)||this;_this.ConstantValue=null;_this.ID=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.FieldName=null;_this.ParentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.ParentFieldName=null;_this.ComparisonType=Intelledox.Model.ComparisonType.None;_this.IsAggregate=false;_this.ParentType=Design.FilterParentType.Reference;_this.Type=newType;_this.ID=Design.GeneralFunctions.NewGuid();_this.ParentType=Design.FilterParentType.Reference;return _this}Filter.prototype.Add=function(newClause){var newFilter=newClause;switch(this.Type){case Intelledox.Model.ClauseType.Basic:this.Type=newFilter.Type;this.FieldName=newFilter.FieldName;this.ParentItemGuid=newFilter.ParentItemGuid;this.SubClauses=newFilter.SubClauses;this.ParentAttributeGuid=newFilter.ParentAttributeGuid;this.ParentFieldName=newFilter.ParentFieldName;this.ComparisonType=newFilter.ComparisonType;this.ConstantValue=newFilter.ConstantValue;this.Question=newFilter.Question;this.ParentType=newFilter.ParentType;this.IsAggregate=newFilter.IsAggregate;return this;case Intelledox.Model.ClauseType.Comparison:this.SubClauses=new Array;var newMe=this.Clone();this.SubClauses.push(newMe);this.SubClauses.push(newFilter);this.Type=Intelledox.Model.ClauseType.AllOf;return newFilter;default:this.SubClauses.push(newFilter);return newFilter}};Filter.prototype.CloneFilter=function(question){var cloned=this.CloneMe();cloned.Question=question;if(this.HasSubClauses){for(var i=0;i<this.SubClauses.length;i++){cloned.SubClauses.push(this.SubClauses[i].CloneFilter(question))}}return cloned};Filter.prototype.Clone=function(){var cloned=this.CloneMe();if(this.HasSubClauses){for(var i=0;i<this.SubClauses.length;i++){cloned.SubClauses.push(this.SubClauses[i].Clone())}}return cloned};Filter.prototype.CloneMe=function(){var cloned=new Filter(this.Type);cloned.FieldName=this.FieldName;cloned.ParentItemGuid=this.ParentItemGuid;cloned.ParentAttributeGuid=this.ParentAttributeGuid;cloned.ParentFieldName=this.ParentFieldName;cloned.ComparisonType=this.ComparisonType;cloned.ConstantValue=this.ConstantValue;cloned.Question=this.Question;cloned.ParentType=this.ParentType;cloned.IsAggregate=this.IsAggregate;return cloned};Filter.prototype.ComparisonContainsItem=function(item){if(this.Type===Intelledox.Model.ClauseType.Comparison){if(item instanceof Design.Question){return item.QuestionGuid===this.ParentItemGuid}else if(item instanceof Design.Answer){return item.AnswerGuid===this.ParentAttributeGuid}}return false};return Filter}(Design.Clause));Design.Filter=Filter})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var DocumentTemplate=(function(){function DocumentTemplate(){this.Name="New Document";this.DocumentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.FormatType=Intelledox.Model.TemplateFormatType.None;this.FileName="";this.AllowNameChange=true;this.Colour=Design.PlaceholderColour.Green;this.RepeatSourceType=QAWizard.Design.RepeatSourceType.None;this.RepeatSourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.RepeatSourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}Object.defineProperty(DocumentTemplate.prototype,"HasPlaceholders",{get:function(){return(this.m_Placeholders!=null&&this.m_Placeholders.length>0)},enumerable:true,configurable:true});Object.defineProperty(DocumentTemplate.prototype,"Placeholders",{get:function(){if(this.m_Placeholders==null){this.m_Placeholders=new Array}return this.m_Placeholders},enumerable:true,configurable:true});Object.defineProperty(DocumentTemplate.prototype,"HasBinary",{get:function(){return this.FormatType!==Intelledox.Model.TemplateFormatType.ProjectResults},enumerable:true,configurable:true});return DocumentTemplate}());Design.DocumentTemplate=DocumentTemplate})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var EscalationInput=(function(_super){__extends(EscalationInput,_super);function EscalationInput(){var _this=_super.call(this)||this;_this.SourceType=Intelledox.Model.RoutingSourceType.FixedValue;_this.RoutingOptionGuid=Design.GeneralFunctions.NewGuid();return _this}return EscalationInput}(Intelledox.Model.RoutingOption));Design.EscalationInput=EscalationInput})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var FragmentDocument=(function(){function FragmentDocument(){this.DocumentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.FormatType=0;this.IsAttachment=false;this.AttachmentFormat=0}Object.defineProperty(FragmentDocument.prototype,"HasPlaceholders",{get:function(){return(this.m_Placeholders!=null&&this.m_Placeholders.length>0)},enumerable:true,configurable:true});Object.defineProperty(FragmentDocument.prototype,"Placeholders",{get:function(){if(this.m_Placeholders==null){this.m_Placeholders=new Array}return this.m_Placeholders},enumerable:true,configurable:true});return FragmentDocument}());Design.FragmentDocument=FragmentDocument})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var FragmentOutput=(function(){function FragmentOutput(parentFragment){this.OutputGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Parent=parentFragment}Object.defineProperty(FragmentOutput.prototype,"Placeholders",{get:function(){if(this.m_Placeholders==null){this.m_Placeholders=new Array}return this.m_Placeholders},enumerable:true,configurable:true});Object.defineProperty(FragmentOutput.prototype,"ResponseMetadataFields",{get:function(){if(this.m_ResponseMetadataFields==null){this.m_ResponseMetadataFields=new Array}return this.m_ResponseMetadataFields},enumerable:true,configurable:true});return FragmentOutput}());Design.FragmentOutput=FragmentOutput})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var FragmentPage=(function(_super){__extends(FragmentPage,_super);function FragmentPage(pageGuid){var _this=_super.call(this,pageGuid)||this;_this.ProjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;return _this}FragmentPage.prototype.Clone=function(nextId,addQuestionsToPage){if(addQuestionsToPage===void 0){addQuestionsToPage=null}var result=new FragmentPage(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutChildren.call(this,result);result.ProjectGuid=this.ProjectGuid;for(var i=0;i<this.Inputs.length;i++){result.Inputs.push(this.Inputs[i].Clone())}return result};Object.defineProperty(FragmentPage.prototype,"HasDocuments",{get:function(){return(this.m_Documents!=null&&this.m_Documents.length>0)},enumerable:true,configurable:true});Object.defineProperty(FragmentPage.prototype,"Documents",{get:function(){if(this.m_Documents==null){this.m_Documents=new Array}return this.m_Documents},enumerable:true,configurable:true});Object.defineProperty(FragmentPage.prototype,"Inputs",{get:function(){if(this.m_Inputs==null){this.m_Inputs=new Array}return this.m_Inputs},enumerable:true,configurable:true});Object.defineProperty(FragmentPage.prototype,"Outputs",{get:function(){if(this.m_Outputs==null){this.m_Outputs=new Array}return this.m_Outputs},enumerable:true,configurable:true});FragmentPage.prototype.HasFragmentInterface=function(){return true};return FragmentPage}(Design.Page));Design.FragmentPage=FragmentPage})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var FragmentReference=(function(){function FragmentReference(){this.ProjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Name=null;this.FragmentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Preview=null}Object.defineProperty(FragmentReference.prototype,"ObjectId",{get:function(){return this.FragmentGuid},set:function(value){this.FragmentGuid=value},enumerable:true,configurable:true});FragmentReference.prototype.Clone=function(nextId,addQuestionsToPage){if(addQuestionsToPage===void 0){addQuestionsToPage=null}var result=new FragmentReference;result.FragmentGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();result.ProjectGuid=this.ProjectGuid;result.Name=this.Name;result.Preview=this.Preview;if(this.ActiveConditions!=null){result.ActiveConditions=this.ActiveConditions.Clone()}if(this.VisibleConditions!=null){result.VisibleConditions=this.VisibleConditions.Clone()}if(this.EditableConditions!=null){result.EditableConditions=this.EditableConditions.Clone()}for(var i=0;i<this.Inputs.length;i++){result.Inputs.push(this.Inputs[i].Clone())}return result};FragmentReference.prototype.HasChild=function(childGuid){return false};Object.defineProperty(FragmentReference.prototype,"HasDocuments",{get:function(){return(this.m_Documents!=null&&this.m_Documents.length>0)},enumerable:true,configurable:true});Object.defineProperty(FragmentReference.prototype,"Documents",{get:function(){if(this.m_Documents==null){this.m_Documents=new Array}return this.m_Documents},enumerable:true,configurable:true});Object.defineProperty(FragmentReference.prototype,"Inputs",{get:function(){if(this.m_Inputs==null){this.m_Inputs=new Array}return this.m_Inputs},enumerable:true,configurable:true});Object.defineProperty(FragmentReference.prototype,"Outputs",{get:function(){if(this.m_Outputs==null){this.m_Outputs=new Array}return this.m_Outputs},enumerable:true,configurable:true});FragmentReference.prototype.HasFragmentInterface=function(){return true};FragmentReference.prototype.HasLayoutInterface=function(){return true};return FragmentReference}());Design.FragmentReference=FragmentReference})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ImageSettings=(function(){function ImageSettings(){this.MaxHeight=0;this.MaxWidth=0;this.StretchToFit=false;this.UnitOfMeasure=Intelledox.Model.UnitsOfMeasure.Pixels;this.SizeScale=0;this.AlternativeText=null}return ImageSettings}());Design.ImageSettings=ImageSettings})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Placeholder=(function(){function Placeholder(){this.External=false;this.ReverseHideValue=false;this.ContentId=Intelledox.Common.ConstantValues.GUID_EMPTY;this.ContentImageScale=0;this.DocumentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.PlaceholderType=0;this.Behaviour=0}Object.defineProperty(Placeholder.prototype,"HasCloseGap",{get:function(){return this.CloseGapPlaceholder!=null&&!System.String.IsNullOrEmpty(this.CloseGapPlaceholder.name)},enumerable:true,configurable:true});Object.defineProperty(Placeholder.prototype,"Reference",{get:function(){var place=new Intelledox.Model.PlaceholderReference;place.name=this.Name;place.type=this.PlaceholderType;place.schemaNamespace=this.XmlNamespace;return place},enumerable:true,configurable:true});return Placeholder}());Design.Placeholder=Placeholder})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var QuestionType;(function(QuestionType){var QuestionTypeEnum;(function(QuestionTypeEnum){QuestionTypeEnum[QuestionTypeEnum["None"]=0]="None";QuestionTypeEnum[QuestionTypeEnum["AddressPrompt"]=1]="AddressPrompt";QuestionTypeEnum[QuestionTypeEnum["DataField"]=2]="DataField";QuestionTypeEnum[QuestionTypeEnum["GroupLogic"]=3]="GroupLogic";QuestionTypeEnum[QuestionTypeEnum["Image"]=4]="Image";QuestionTypeEnum[QuestionTypeEnum["SignOff"]=5]="SignOff";QuestionTypeEnum[QuestionTypeEnum["SimpleLogic"]=6]="SimpleLogic";QuestionTypeEnum[QuestionTypeEnum["UserPrompt"]=7]="UserPrompt";QuestionTypeEnum[QuestionTypeEnum["Variable"]=8]="Variable";QuestionTypeEnum[QuestionTypeEnum["DataTable"]=9]="DataTable";QuestionTypeEnum[QuestionTypeEnum["ExternalDocument"]=10]="ExternalDocument";QuestionTypeEnum[QuestionTypeEnum["ContentLibrary"]=11]="ContentLibrary";QuestionTypeEnum[QuestionTypeEnum["DataList"]=12]="DataList";QuestionTypeEnum[QuestionTypeEnum["ConstantValue"]=13]="ConstantValue";QuestionTypeEnum[QuestionTypeEnum["Datasource"]=14]="Datasource";QuestionTypeEnum[QuestionTypeEnum["Label"]=15]="Label";QuestionTypeEnum[QuestionTypeEnum["AutoLogic"]=16]="AutoLogic";QuestionTypeEnum[QuestionTypeEnum["Chart"]=17]="Chart";QuestionTypeEnum[QuestionTypeEnum["Barcode"]=18]="Barcode";QuestionTypeEnum[QuestionTypeEnum["RichText"]=19]="RichText";QuestionTypeEnum[QuestionTypeEnum["Ink"]=20]="Ink";QuestionTypeEnum[QuestionTypeEnum["Validator"]=21]="Validator";QuestionTypeEnum[QuestionTypeEnum["Custom"]=22]="Custom";QuestionTypeEnum[QuestionTypeEnum["Geolocation"]=23]="Geolocation";QuestionTypeEnum[QuestionTypeEnum["Numeric"]=24]="Numeric";QuestionTypeEnum[QuestionTypeEnum["Button"]=25]="Button";QuestionTypeEnum[QuestionTypeEnum["Summary"]=26]="Summary";QuestionTypeEnum[QuestionTypeEnum["RunActionButton"]=27]="RunActionButton"})(QuestionTypeEnum=QuestionType.QuestionTypeEnum||(QuestionType.QuestionTypeEnum={}))})(QuestionType=Design.QuestionType||(Design.QuestionType={}))})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var AddressQuestion=(function(_super){__extends(AddressQuestion,_super);function AddressQuestion(questionGuid){return _super.call(this,questionGuid)||this}Object.defineProperty(AddressQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.AddressPrompt},enumerable:true,configurable:true});AddressQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new AddressQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);return result};return AddressQuestion}(Design.Question));Design.AddressQuestion=AddressQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var BarcodeQuestion=(function(_super){__extends(BarcodeQuestion,_super);function BarcodeQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.BarcodeType=0;_this.BarcodeSubType=0;_this.BarcodeCodeLocation=Design.BarcodeCodeLocation.Below;_this.Rotation=0;_this.Columns=0;_this.Rows=0;return _this}Object.defineProperty(BarcodeQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Barcode},enumerable:true,configurable:true});BarcodeQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new BarcodeQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);result.BarcodeType=this.BarcodeType;result.BarcodeSubType=this.BarcodeSubType;result.BarcodeCodeLocation=this.BarcodeCodeLocation;result.Rotation=this.Rotation;result.Columns=this.Columns;result.Rows=this.Rows;return result};Object.defineProperty(BarcodeQuestion.prototype,"IsDisplayQuestionType",{get:function(){return false},enumerable:true,configurable:true});return BarcodeQuestion}(Design.Question));Design.BarcodeQuestion=BarcodeQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var CustomQuestion=(function(_super){__extends(CustomQuestion,_super);function CustomQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.CustomQuestionTypeId=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.Preview=null;_this.Inputs=new Array;return _this}Object.defineProperty(CustomQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Custom},enumerable:true,configurable:true});CustomQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new CustomQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);result.CustomQuestionTypeId=this.CustomQuestionTypeId;result.Preview=this.Preview;for(var i=0;i<this.Inputs.length;i++){result.Inputs.push(this.Inputs[i].Clone())}return result};return CustomQuestion}(Design.Question));Design.CustomQuestion=CustomQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var GeolocationQuestion=(function(_super){__extends(GeolocationQuestion,_super);function GeolocationQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.HighAccuracy=false;return _this}Object.defineProperty(GeolocationQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Geolocation},enumerable:true,configurable:true});GeolocationQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new GeolocationQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());result.HighAccuracy=this.HighAccuracy;_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);return result};return GeolocationQuestion}(Design.Question));Design.GeolocationQuestion=GeolocationQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var GroupLogicQuestion=(function(_super){__extends(GroupLogicQuestion,_super);function GroupLogicQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.DisplayDirection=Intelledox.Model.DisplayDirection.Vertical;_this.DefaultQuestionReference=Intelledox.Common.ConstantValues.GUID_EMPTY;return _this}Object.defineProperty(GroupLogicQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.GroupLogic},enumerable:true,configurable:true});GroupLogicQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new GroupLogicQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);result.DisplayDirection=this.DisplayDirection;result.DefaultQuestionReference=this.DefaultQuestionReference;return result};Object.defineProperty(GroupLogicQuestion.prototype,"DefaultValue",{get:function(){if(System.String.IsNullOrEmpty(this.m_LocalDefaultValue)){this.m_LocalDefaultValue=Intelledox.Common.ConstantValues.GUID_EMPTY}return this.m_LocalDefaultValue},set:function(value){this.m_LocalDefaultValue=value},enumerable:true,configurable:true});return GroupLogicQuestion}(Design.LogicQuestion));Design.GroupLogicQuestion=GroupLogicQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var LabelQuestion=(function(_super){__extends(LabelQuestion,_super);function LabelQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.TextPosition=QAWizard.Design.TextPosition.None;return _this}Object.defineProperty(LabelQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Label},enumerable:true,configurable:true});LabelQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new LabelQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);return result};return LabelQuestion}(Design.Question));Design.LabelQuestion=LabelQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var NumericQuestion=(function(_super){__extends(NumericQuestion,_super);function NumericQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.MinimumValue=0;_this.MaximumValue=100.0;_this.Width=0;_this.Increment=1;return _this}Object.defineProperty(NumericQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Numeric},enumerable:true,configurable:true});NumericQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new NumericQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);result.MinimumValue=this.MinimumValue;result.MaximumValue=this.MaximumValue;result.Width=this.Width;result.Increment=this.Increment;return result};return NumericQuestion}(Design.Question));Design.NumericQuestion=NumericQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var QuestionFactory=(function(){function QuestionFactory(){}QuestionFactory.Create=function(questionGuid,questionType){switch(questionType){case QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt:return new Design.AddressQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic:return new Design.AutoLogicQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Barcode:return new Design.BarcodeQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Chart:return new Design.ChartQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary:return new Design.ContentLibraryQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource:return new Design.DatasourceQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic:return new Design.GroupLogicQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Label:return new Design.LabelQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic:return new Design.SimpleLogicQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt:return new Design.UserPromptQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Variable:return new Design.VariableQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.RichText:return new Design.RichTextQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Ink:return new Design.InkQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Validator:return new Design.ValidationQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Custom:return new Design.CustomQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation:return new Design.GeolocationQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric:return new Design.NumericQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Button:return new Design.ButtonQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.Summary:return new Design.SummaryQuestion(questionGuid);case QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton:return new Design.RunActionButtonQuestion(questionGuid);default:return new Design.Question(questionGuid)}};return QuestionFactory}());Design.QuestionFactory=QuestionFactory})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var RichTextQuestion=(function(_super){__extends(RichTextQuestion,_super);function RichTextQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.TextRows=20;_this.ShowBullets=false;_this.ShowCopyAndPaste=false;_this.ShowHyperlink=false;_this.ShowSpellCheck=false;_this.ShowStyles=false;_this.ShowTables=false;_this.ShowProtectedFields=false;return _this}Object.defineProperty(RichTextQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.RichText},enumerable:true,configurable:true});RichTextQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new RichTextQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);result.TextRows=this.TextRows;result.ShowBullets=this.ShowBullets;result.ShowCopyAndPaste=this.ShowCopyAndPaste;result.ShowHyperlink=this.ShowHyperlink;result.ShowSpellCheck=this.ShowSpellCheck;result.ShowStyles=this.ShowStyles;result.ShowTables=this.ShowTables;result.ShowProtectedFields=this.ShowProtectedFields;return result};return RichTextQuestion}(Design.Question));Design.RichTextQuestion=RichTextQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var SimpleLogicQuestion=(function(_super){__extends(SimpleLogicQuestion,_super);function SimpleLogicQuestion(questionGuid){return _super.call(this,questionGuid)||this}Object.defineProperty(SimpleLogicQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.SimpleLogic},enumerable:true,configurable:true});SimpleLogicQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new SimpleLogicQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);return result};return SimpleLogicQuestion}(Design.LogicQuestion));Design.SimpleLogicQuestion=SimpleLogicQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var UserPromptQuestion=(function(_super){__extends(UserPromptQuestion,_super);function UserPromptQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.MaxLength=0;_this.TextRows=0;_this.TextBoxWidth=0;_this.ValidationType=Intelledox.Model.ValidationType.Text;_this.IsRightAligned=false;_this.DecimalPlaces=2;_this.CurrencyCode='$';_this.CurrencySymbol='$';_this.CurrencyPositivePattern=0;_this.CurrencyNegativePattern=1;_this.WeekdaysOnly=false;return _this}Object.defineProperty(UserPromptQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.UserPrompt},enumerable:true,configurable:true});UserPromptQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new UserPromptQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);result.MaxLength=this.MaxLength;result.TextRows=this.TextRows;result.TextBoxWidth=this.TextBoxWidth;result.ValidationType=this.ValidationType;result.IsRightAligned=this.IsRightAligned;result.DecimalPlaces=this.DecimalPlaces;result.CurrencyCode=this.CurrencyCode;result.CurrencySymbol=this.CurrencySymbol;result.CurrencyPositivePattern=this.CurrencyPositivePattern;result.CurrencyNegativePattern=this.CurrencyNegativePattern;result.WeekdaysOnly=this.WeekdaysOnly;return result};return UserPromptQuestion}(Design.Question));Design.UserPromptQuestion=UserPromptQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ValidationQuestion=(function(_super){__extends(ValidationQuestion,_super);function ValidationQuestion(questionGuid){var _this=_super.call(this,questionGuid)||this;_this.ValidationRule=new Design.ValidationRule;_this.TextPosition=Design.TextPosition.None;return _this}Object.defineProperty(ValidationQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Validator},enumerable:true,configurable:true});ValidationQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new ValidationQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);result.ValidationRule=this.ValidationRule.Clone();return result};return ValidationQuestion}(Design.Question));Design.ValidationQuestion=ValidationQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var VariableQuestion=(function(_super){__extends(VariableQuestion,_super);function VariableQuestion(questionGuid){return _super.call(this,questionGuid)||this}Object.defineProperty(VariableQuestion.prototype,"QuestionTypeID",{get:function(){return Design.QuestionType.QuestionTypeEnum.Variable},enumerable:true,configurable:true});Object.defineProperty(VariableQuestion.prototype,"IsDisplayQuestionType",{get:function(){return false},enumerable:true,configurable:true});VariableQuestion.prototype.CloneWithoutAnswers=function(nextId){var result=new VariableQuestion(Intelledox.QAWizard.Design.GeneralFunctions.NewGuid());_super.prototype.CloneWithoutAnswersInternal.call(this,nextId,result);return result};return VariableQuestion}(Design.Question));Design.VariableQuestion=VariableQuestion})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Resources;(function(Resources){var Strings=(function(){function Strings(){}Object.defineProperty(Strings,"DefaultOnlineRedirectMessage",{get:function(){return window["QAWizardDesignRes"]["DefaultOnlineRedirectMessage"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"ProjectName",{get:function(){return window["QAWizardDesignRes"]["ProjectName"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"DefaultWorkflowTransitionEmail",{get:function(){return window["QAWizardDesignRes"]["DefaultWorkflowTransitionEmail"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"DefaultFinishTitle",{get:function(){return window["QAWizardDesignRes"]["DefaultFinishTitle"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"NoNextState",{get:function(){return window["QAWizardDesignRes"]["NoNextState"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"StartState",{get:function(){return window["QAWizardDesignRes"]["StartState"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"RowNumber",{get:function(){return window["QAWizardDesignRes"]["RowNumber"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"Comments",{get:function(){return window["QAWizardDesignRes"]["Comments"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"FinishState",{get:function(){return window["QAWizardDesignRes"]["FinishState"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"NumericType",{get:function(){return window["QAWizardDesignRes"]["NumericType"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"AssigneeFullName",{get:function(){return window["QAWizardDesignRes"]["AssigneeFullName"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"DefaultWorkflowTransitionEmailSubject",{get:function(){return window["QAWizardDesignRes"]["DefaultWorkflowTransitionEmailSubject"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"ProjectLink",{get:function(){return window["QAWizardDesignRes"]["ProjectLink"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"FormDefaultDownloadPageTitle",{get:function(){return window["QAWizardDesignRes"]["FormDefaultDownloadPageTitle"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"WorkflowId",{get:function(){return window["QAWizardDesignRes"]["WorkflowId"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"StateName",{get:function(){return window["QAWizardDesignRes"]["StateName"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"RowCount",{get:function(){return window["QAWizardDesignRes"]["RowCount"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"PleaseEnterAComment",{get:function(){return window["QAWizardDesignRes"]["PleaseEnterAComment"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"DefaultGeneratingText",{get:function(){return window["QAWizardDesignRes"]["DefaultGeneratingText"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"FormDefaultGeneratingText",{get:function(){return window["QAWizardDesignRes"]["FormDefaultGeneratingText"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"PleaseSelectNextState",{get:function(){return window["QAWizardDesignRes"]["PleaseSelectNextState"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"FormQueueMessage",{get:function(){return window["QAWizardDesignRes"]["FormQueueMessage"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"NotEqual",{get:function(){return window["QAWizardDesignRes"]["NotEqual"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"WorkflowStepCompleteDefault",{get:function(){return window["QAWizardDesignRes"]["WorkflowStepCompleteDefault"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"FileNameWithoutBlanks",{get:function(){return window["QAWizardDesignRes"]["FileNameWithoutBlanks"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"AccessCode",{get:function(){return window["QAWizardDesignRes"]["AccessCode"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"DefaultInvalidProjectText",{get:function(){return window["QAWizardDesignRes"]["DefaultInvalidProjectText"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"PleaseSelectNextUser",{get:function(){return window["QAWizardDesignRes"]["PleaseSelectNextUser"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"RowId",{get:function(){return window["QAWizardDesignRes"]["RowId"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"CurrentlySubmittingDefault",{get:function(){return window["QAWizardDesignRes"]["CurrentlySubmittingDefault"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"PublishedProjectNotFound",{get:function(){return window["QAWizardDesignRes"]["PublishedProjectNotFound"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"DefaultDownloadPageTitle",{get:function(){return window["QAWizardDesignRes"]["DefaultDownloadPageTitle"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"FormDefaultGenerateButtonText",{get:function(){return window["QAWizardDesignRes"]["FormDefaultGenerateButtonText"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"FirstNameAndLastNameRequired",{get:function(){return window["QAWizardDesignRes"]["FirstNameAndLastNameRequired"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"None",{get:function(){return window["QAWizardDesignRes"]["None"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"Printer",{get:function(){return window["QAWizardDesignRes"]["Printer"]},enumerable:true,configurable:true});Object.defineProperty(Strings,"NotContain",{get:function(){return window["QAWizardDesignRes"]["NotContain"]},enumerable:true,configurable:true});return Strings}());Resources.Strings=Strings})(Resources=Design.Resources||(Design.Resources={}))})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var TabPage=(function(){function TabPage(){this.m_LayoutNodes=new Array;this.TabPageGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.CssStyle=null;this.Title="";this.TabPageGuid=Design.GeneralFunctions.NewGuid()}Object.defineProperty(TabPage.prototype,"ObjectId",{get:function(){return this.TabPageGuid},set:function(value){this.TabPageGuid=value},enumerable:true,configurable:true});TabPage.prototype.Clone=function(nextId,addQuestionsToPage){if(addQuestionsToPage===void 0){addQuestionsToPage=null}var result=new TabPage;result.Title=this.Title;result.CssStyle=this.CssStyle;if(this.ActiveConditions!=null){result.ActiveConditions=this.ActiveConditions.Clone()}if(this.VisibleConditions!=null){result.VisibleConditions=this.VisibleConditions.Clone()}if(this.EditableConditions!=null){result.EditableConditions=this.EditableConditions.Clone()}for(var i=0;i<this.Children.length;i++){result.Children.push(this.Children[i].Clone(nextId,addQuestionsToPage))}return result};Object.defineProperty(TabPage.prototype,"Children",{get:function(){return this.m_LayoutNodes},enumerable:true,configurable:true});TabPage.prototype.HasContainerInterface=function(){return true};TabPage.prototype.HasQAContainerInterface=function(){return true};TabPage.prototype.HasLayoutInterface=function(){return true};TabPage.prototype.HasChild=function(childGuid){if(this.TabPageGuid===childGuid){return true}else{for(var i=0;i<this.Children.length;i++){if(this.Children[i].HasChild(childGuid)){return true}}return false}};return TabPage}());Design.TabPage=TabPage})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var ValidationRule=(function(_super){__extends(ValidationRule,_super);function ValidationRule(newType){if(newType===void 0){newType=Intelledox.Model.ClauseType.Basic}var _this=_super.call(this)||this;_this.Message=null;_this.QuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.AnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.Id=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.RuleType=Intelledox.Model.ValidationRuleType.Compare;_this.ComparisonType=Intelledox.Model.ComparisonType.None;_this.Type=newType;_this.Expression="";return _this}ValidationRule.prototype.Clone=function(){var result=new ValidationRule(this.Type);result.RuleType=this.RuleType;result.ComparisonType=this.ComparisonType;result.Expression=this.Expression;result.Message=this.Message;result.QuestionGuid=this.QuestionGuid;result.AnswerGuid=this.AnswerGuid;if(this.HasSubClauses){for(var i=0;i<this.SubClauses.length;i++){result.SubClauses.push(this.SubClauses[i].Clone())}}return result};ValidationRule.prototype.Add=function(newClause){var newRule=newClause;switch(this.Type){case Intelledox.Model.ClauseType.Basic:this.Type=newRule.Type;this.RuleType=newRule.RuleType;this.ComparisonType=newRule.ComparisonType;this.SubClauses=newRule.SubClauses;this.Expression=newRule.Expression;this.QuestionGuid=newRule.QuestionGuid;this.AnswerGuid=newRule.AnswerGuid;this.Message=newRule.Message;return this;case Intelledox.Model.ClauseType.Comparison:this.SubClauses=new Array;var newMe=this.Clone();this.SubClauses.push(newMe);this.SubClauses.push(newRule);this.Type=Intelledox.Model.ClauseType.AllOf;return newRule;default:this.SubClauses.push(newRule);return newRule}};ValidationRule.prototype.ComparisonContainsItem=function(item){return false};return ValidationRule}(Design.Clause));Design.ValidationRule=ValidationRule})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var WizardController=(function(){function WizardController(){this.m_EditMode=false}WizardController.prototype.CreateFromXTF=function(xtf,editMode){var xmlDoc;if(window['DOMParser']){var parser=new DOMParser;xmlDoc=parser.parseFromString(xtf,"text/xml")}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async=false;xmlDoc.loadXML(xtf)}this.m_EditMode=editMode;this.m_Wizard=new Design.Wizard;this.LoadProjectFromXml(xmlDoc);this.SetLayout();return this.m_Wizard};WizardController.prototype.SerializeToXTF=function(source){var xmlDom=this.SerializeProject(source);return(new XMLSerializer).serializeToString(xmlDom)};WizardController.prototype.LoadProjectFromXml=function(xmlDOM){var xmlNode=xmlDOM.documentElement;if(xmlNode!=null){var binaryInfo=xmlNode.getElementsByTagName("BinaryInfo")[0];if(binaryInfo!=null){var childNodes=binaryInfo.getElementsByTagName("TemplateBinary");for(var i=0;i<childNodes.length;i++){var doc=new Design.DocumentTemplate;doc.Conditions=new Design.Condition;this.ExtractNode(childNodes[i],doc,null);this.m_Wizard.Documents.push(doc)}}this.ExtractNode(xmlNode,null,null)}};WizardController.prototype.ExtractNode=function(xmlNode,projectObject,parent,currentPage){if(currentPage===void 0){currentPage=null}var objCurrentObject=null;var childNodes=xmlNode.attributes;for(var i=0;i<childNodes.length;i++){var xmlAttribute=childNodes[i];switch(xmlAttribute.nodeName){case Intelledox.Common.ConstantValues.XTF_GUID:if(projectObject instanceof Design.Page){if(System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.PageGuid=Design.GeneralFunctions.NewGuid()}else{projectObject.PageGuid=xmlAttribute.value}}else if(projectObject instanceof Design.Question){projectObject.QuestionGuid=xmlAttribute.value}else if(projectObject instanceof Design.Answer){projectObject.AnswerGuid=xmlAttribute.value}else if(projectObject instanceof Design.Section){projectObject.SectionGuid=xmlAttribute.value}else if(projectObject instanceof Design.Column){projectObject.ColumnGuid=xmlAttribute.value}else if(projectObject instanceof Design.TabGroup){projectObject.TabGroupGuid=xmlAttribute.value}else if(projectObject instanceof Design.TabPage){projectObject.TabPageGuid=xmlAttribute.value}else if(projectObject instanceof Design.ResponseMetadataField){projectObject.ResponseMetadataFieldGuid=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_NAME:if(projectObject instanceof Design.Page){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof Design.Answer){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}else if(projectObject instanceof Design.Placeholder){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof Intelledox.Model.DisplayField){projectObject.name=xmlAttribute.value}else if(projectObject instanceof Intelledox.Model.SortField){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof Design.Series){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.Action){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof Design.WorkflowState){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof Design.StateTransition){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof Array){var repeatType=Intelledox.Model.PlaceholderType.Bookmark;if(xmlNode.getAttribute(Intelledox.Common.ConstantValues.XTF_TYPEID)!=null){repeatType=parseInt(xmlNode.getAttribute(Intelledox.Common.ConstantValues.XTF_TYPEID),10)}var placeRef=new Intelledox.Model.PlaceholderReference;placeRef.name=xmlAttribute.value;placeRef.type=repeatType;projectObject.push(placeRef)}else if(projectObject instanceof QAWizard.Design.Escalation){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.FragmentReference){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof Intelledox.Model.RoutingElementType){projectObject.description=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.AvailableOutput){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.Workflow){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.ProtectedField){projectObject.Name=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.ProjectProperty){projectObject.Name=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_TEXT:if(projectObject instanceof Design.Question){projectObject.Text=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_TYPEID:if(projectObject instanceof Design.Question){}else if(projectObject instanceof Design.AutoLogicAnswer){}else if(projectObject instanceof QAWizard.Design.Action){projectObject.Type.routingTypeId=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.Placeholder){projectObject.PlaceholderType=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof QAWizard.Design.Escalation){projectObject.Type.routingTypeId=xmlAttribute.value}else{}break;case Intelledox.Common.ConstantValues.XTF_VALIDATIONTYPE:if(projectObject instanceof Design.UserPromptQuestion){projectObject.ValidationType=parseInt(xmlAttribute.value,10)}break;case"AllowComments":if(projectObject instanceof Design.Question){projectObject.AllowComments=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case Intelledox.Common.ConstantValues.XTF_HELPTEXT:if(projectObject instanceof Design.Question){projectObject.HelpText=xmlAttribute.value}else if(projectObject instanceof Design.Column){projectObject.HelpText=xmlAttribute.value}else if(projectObject instanceof Design.StateTransition){projectObject.HelpText=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case"AlternativeText":if(projectObject instanceof QAWizard.Design.ContentItem){projectObject.ImageSettings.AlternativeText=xmlAttribute.value}else if(projectObject instanceof Design.Answer){projectObject.ImageSettings.AlternativeText=xmlAttribute.value}break;case"Mandatory":if(projectObject instanceof Design.Question){projectObject.Mandatory=parseInt(xmlAttribute.value,10)}break;case"DisplayType":if(projectObject instanceof Design.Question){projectObject.DisplayType=parseInt(xmlAttribute.value,10);if(projectObject instanceof Design.ButtonQuestion&&projectObject.DisplayType===Intelledox.Model.QuestionDisplayType.MultiChoice){projectObject.DisplayType=Intelledox.Model.QuestionDisplayType.TileButton}}else if(projectObject instanceof Design.TabGroup){projectObject.DisplayType=parseInt(xmlAttribute.value,10)}break;case Intelledox.Common.ConstantValues.XTF_SELECTIONTYPE:if(projectObject instanceof Design.Question){projectObject.SelectionType=parseInt(xmlAttribute.value,10)}break;case"Visibility":if(projectObject instanceof Design.Question){projectObject.Visibility=Design.GeneralFunctions.ToBool(xmlAttribute.value)}else if(projectObject instanceof Design.Legend){projectObject.IsVisible=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"RepeatParentGuid":if(projectObject instanceof Design.Question){projectObject.RepeatParent=xmlAttribute.value}break;case"RepeatParentAnswerGuid":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.RepeatParentAnswer=xmlAttribute.value}break;case"RepeatParentFieldName":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.RepeatParentField=xmlAttribute.value}break;case"ConstantValue":if(projectObject instanceof Design.Filter){projectObject.ParentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;projectObject.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;projectObject.ParentFieldName="";projectObject.IsAggregate=false;projectObject.ParentType=Design.FilterParentType.Constant;projectObject.ConstantValue=xmlAttribute.value}break;case"ParentQuestionGuid":if(projectObject instanceof Design.Filter&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.ParentItemGuid=xmlAttribute.value}break;case"ParentAnswerGuid":if(projectObject instanceof Design.Filter&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.ParentAttributeGuid=xmlAttribute.value}break;case"ParentFieldName":if(projectObject instanceof Design.Filter){projectObject.ParentFieldName=xmlAttribute.value}break;case"IsAggregate":if(projectObject instanceof Design.Filter){projectObject.IsAggregate=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ChildField":if(projectObject instanceof Design.Filter){projectObject.FieldName=xmlAttribute.value}break;case"ComparisonType":if(projectObject instanceof Design.Filter&&Intelledox.Common.Functions.IsUInt(xmlAttribute.value)){projectObject.ComparisonType=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.ValidationRule){projectObject.ComparisonType=parseInt(xmlAttribute.value,10)}break;case"DataServiceGuid":if(projectObject instanceof Design.DatasourceQuestion&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.DataSourceGuid=xmlAttribute.value}break;case"DataObjectGuid":if(projectObject instanceof Design.DatasourceQuestion&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.DataObjectGuid=xmlAttribute.value}break;case"DataObjectTypeGuid":if(projectObject instanceof Design.DatasourceQuestion&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.DataObjectTypeGuid=xmlAttribute.value}break;case"DataSourceHierarchyGuid":if(projectObject instanceof Design.DatasourceQuestion&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.DataSourceHierarchyGuid=xmlAttribute.value}break;case"DataSourceRepeatXPath":if(projectObject instanceof Design.DatasourceQuestion&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.DataSourceRepeatXPath=xmlAttribute.value}break;case"DefaultType":if(projectObject instanceof Design.DatasourceQuestion&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.DefaultType=parseInt(xmlAttribute.value,10)}break;case"DisplayField":if(projectObject instanceof Design.DatasourceQuestion){projectObject.DisplayField=xmlAttribute.value}break;case"AnswerDisplayField":if(projectObject instanceof Design.DatasourceQuestion){projectObject.AnswerDisplayField=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_VALUEFIELD:if(projectObject instanceof Design.DatasourceQuestion){projectObject.ValueField=xmlAttribute.value}break;case"GroupingField":if(projectObject instanceof Design.DatasourceQuestion){projectObject.GroupingField=xmlAttribute.value}break;case"RepeatSource":if(projectObject instanceof Design.Action){projectObject.RepeaterGuid=xmlAttribute.value}break;case"MaxLength":if(projectObject instanceof Design.UserPromptQuestion){projectObject.MaxLength=parseInt(xmlAttribute.value,10)}break;case"TextRows":if(projectObject instanceof Design.UserPromptQuestion){projectObject.TextRows=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.RichTextQuestion){projectObject.TextRows=parseInt(xmlAttribute.value,10)}break;case"RightAligned":if(projectObject instanceof Design.UserPromptQuestion){projectObject.IsRightAligned=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"DecimalPlaces":if(projectObject instanceof Design.UserPromptQuestion){projectObject.DecimalPlaces=parseInt(xmlAttribute.value,10)}break;case"CurrencyCode":if(projectObject instanceof Design.UserPromptQuestion){projectObject.CurrencyCode=xmlAttribute.value}break;case"CurrencySymbol":if(projectObject instanceof Design.UserPromptQuestion){projectObject.CurrencySymbol=xmlAttribute.value}break;case"PositivePattern":if(projectObject instanceof Design.UserPromptQuestion){projectObject.CurrencyPositivePattern=parseInt(xmlAttribute.value,10)}break;case"NegativePattern":if(projectObject instanceof Design.UserPromptQuestion){projectObject.CurrencyNegativePattern=parseInt(xmlAttribute.value,10)}break;case Intelledox.Common.ConstantValues.XTF_WATERMARK:if(projectObject instanceof Design.Question){projectObject.Watermark=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case"WeekdaysOnly":if(projectObject instanceof Design.UserPromptQuestion){projectObject.WeekdaysOnly=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"DataTableRepeatBookmark":if(projectObject instanceof Design.DatasourceQuestion&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.RepeatPlaceholders=new Array;var dataTableRepeats=xmlAttribute.value.split(",");for(var dataTableIndex=0;dataTableIndex<dataTableRepeats.length;dataTableIndex++){var dataTableRepeat=new Intelledox.Model.PlaceholderReference;dataTableRepeat.name=dataTableRepeats[dataTableIndex];dataTableRepeat.type=Intelledox.Model.PlaceholderType.Bookmark;projectObject.RepeatPlaceholders.push(dataTableRepeat)}}break;case"AllowUserUpload":if(projectObject instanceof Design.DatasourceQuestion){projectObject.AllowUserUpload=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ContentTypeRestriction":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.ContentTypeRestriction=parseInt(xmlAttribute.value,10)}break;case"FormatString":if(projectObject instanceof Design.Answer){projectObject.FormatString=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_DEFAULTVALUE:if(projectObject instanceof Design.Question){projectObject.DefaultValue=xmlAttribute.value;if(!System.String.IsNullOrEmpty(projectObject.DefaultValue)){if(projectObject instanceof Design.DatasourceQuestion&&projectObject.DefaultType===Intelledox.Model.DefaultValueType.None){projectObject.DefaultType=Intelledox.Model.DefaultValueType.Index}}}else if(projectObject instanceof Design.AvailableInput){projectObject.DefaultValue=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case"DefaultQuestionReference":if(projectObject instanceof Design.GroupLogicQuestion){projectObject.DefaultQuestionReference=xmlAttribute.value}else if(projectObject instanceof Design.GroupLogicAnswer){projectObject.DefaultQuestionReference=xmlAttribute.value}break;case"DefaultAnswerReference":if(projectObject instanceof Design.GroupLogicAnswer){projectObject.DefaultAnswerReference=xmlAttribute.value}break;case"OutputTypeId":if(projectObject instanceof Design.CustomAnswer){projectObject.OutputTypeId=xmlAttribute.value}break;case"AllowAddToContentLibrary":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.AllowAddToContentLibrary=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ContentFolder":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.ContentFolder=xmlAttribute.value}break;case"ContentFolderName":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.ContentFolderName=xmlAttribute.value}break;case"BarcodeType":if(projectObject instanceof Design.BarcodeQuestion){projectObject.BarcodeType=parseInt(xmlAttribute.value,10)}break;case"AllowEdit":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.AllowEdit=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"KeepSourceFormatting":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.KeepSourceFormatting=Design.GeneralFunctions.ToBool(xmlAttribute.value)}else if(projectObject instanceof QAWizard.Design.ContentItem){projectObject.KeepSourceFormatting=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ContentItemGuid":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.ExistingContentItemGuid=xmlAttribute.value}break;case"RestrictionFolder":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.ContentFolderRestriction=xmlAttribute.value}break;case"RestrictionFolderName":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.ContentFolderRestrictionName=xmlAttribute.value}break;case"AttachmentFileName":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.AttachmentFileName=xmlAttribute.value}break;case"ValidExtensions":if(projectObject instanceof Design.ContentLibraryQuestion){projectObject.ValidExtensions=xmlAttribute.value}break;case"BarcodeSubType":if(projectObject instanceof Design.BarcodeQuestion){projectObject.BarcodeSubType=parseInt(xmlAttribute.value,10)}break;case"BarcodeCodeLocation":if(projectObject instanceof Design.BarcodeQuestion){projectObject.BarcodeCodeLocation=parseInt(xmlAttribute.value,10)}break;case"Rotation":if(projectObject instanceof Design.BarcodeQuestion){projectObject.Rotation=parseFloat(xmlAttribute.value)}break;case"Columns":if(projectObject instanceof Design.BarcodeQuestion){projectObject.Columns=parseInt(xmlAttribute.value,10)}break;case"Rows":if(projectObject instanceof Design.BarcodeQuestion){projectObject.Rows=parseInt(xmlAttribute.value,10)}break;case"Formula":if(projectObject instanceof Design.VariableAnswer){projectObject.Formula=xmlAttribute.value}else if(projectObject instanceof Design.DatasourceAnswer){projectObject.Formula=xmlAttribute.value}else if(projectObject instanceof Design.Rule){projectObject.Formula=xmlAttribute.value}else if(projectObject instanceof Intelledox.Model.DisplayField){projectObject.formula=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_TAGVALUE:if(projectObject instanceof Design.LogicAnswer){projectObject.TagValue=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case"ImageMaxHeight":if(projectObject instanceof Design.Answer){projectObject.ImageSettings.MaxHeight=parseFloat(xmlAttribute.value)}break;case"BackMaxHeight":if(projectObject instanceof Design.InkQuestion){projectObject.ImageSettings.MaxHeight=parseFloat(xmlAttribute.value)}break;case"ImageMaxWidth":if(projectObject instanceof Design.Answer){projectObject.ImageSettings.MaxWidth=parseFloat(xmlAttribute.value)}break;case"BackMaxWidth":if(projectObject instanceof Design.InkQuestion){projectObject.ImageSettings.MaxWidth=parseFloat(xmlAttribute.value)}break;case"ImageStretchToFit":if(projectObject instanceof Design.Answer){projectObject.ImageSettings.StretchToFit=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"BackStretchToFit":if(projectObject instanceof Design.InkQuestion){projectObject.ImageSettings.StretchToFit=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ImageUnitOfMeasure":if(projectObject instanceof Design.Answer){var measureUnit=parseInt(xmlAttribute.value,10);if(measureUnit===-1){projectObject.ImageSettings.UnitOfMeasure=Intelledox.Model.UnitsOfMeasure.Pixels}else{projectObject.ImageSettings.UnitOfMeasure=measureUnit}}break;case"BackUnitOfMeasure":if(projectObject instanceof Design.InkQuestion){projectObject.ImageSettings.UnitOfMeasure=parseInt(xmlAttribute.value,10)}break;case"FieldName":if(projectObject instanceof Design.Answer){switch(parent.QuestionTypeID){case Design.QuestionType.QuestionTypeEnum.AddressPrompt:case Design.QuestionType.QuestionTypeEnum.Datasource:case Design.QuestionType.QuestionTypeEnum.Variable:case Design.QuestionType.QuestionTypeEnum.Geolocation:projectObject.DataField=xmlAttribute.value;if(parent!=null&&parent.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Datasource){if(System.String.IsNullOrEmpty(projectObject.DataField)){if(System.String.StartsWith(projectObject.FormatString,"[")&&System.String.EndsWith(projectObject.FormatString,"]")){projectObject.Concatenate=true}}else{projectObject.Concatenate=false}}break}}break;case"HideValue":if(projectObject instanceof Design.LogicAnswer){switch(xmlAttribute.value){case"Y":case"y":case"T":case"t":case"1":projectObject.HideValue=true;break;default:projectObject.HideValue=false;break}}break;case"WritebackField":if(projectObject instanceof Design.Answer){projectObject.WritebackField=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_DISPLAYTEXT:if(projectObject instanceof Design.GroupLogicAnswer){projectObject.DisplayText=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_SAVETOANSWERFILE:var saveToAnswerFile=Design.GeneralFunctions.ToBool(xmlAttribute.value);if(projectObject instanceof Design.Answer){if(!saveToAnswerFile){projectObject.SaveToAnswerFileBy=Design.SaveAnswerByEnum.None}else if(projectObject.SaveToAnswerFileBy===Design.SaveAnswerByEnum.None){projectObject.SaveToAnswerFileBy=Design.SaveAnswerByEnum.SaveById}}else if(projectObject instanceof Design.Question){projectObject.SaveToAnswerFile=saveToAnswerFile}break;case Intelledox.Common.ConstantValues.XTF_SAVETOANSWERFILEBY:if(projectObject instanceof Design.Answer){projectObject.SaveToAnswerFileBy=parseInt(xmlAttribute.value,10)}break;case Intelledox.Common.ConstantValues.XTF_ANSWERFILELABEL:if(projectObject instanceof Design.Answer){projectObject.SaveToAnswerFileLabel=xmlAttribute.value}else if(projectObject instanceof Design.Question){projectObject.SaveToAnswerFileLabel=xmlAttribute.value}break;case"DataConvertType":if(projectObject instanceof Design.DatasourceAnswer){projectObject.DataConvertType=parseInt(xmlAttribute.value,10)}break;case"DataConvertPattern":if(projectObject instanceof Design.DatasourceAnswer){projectObject.DataConvertPattern=xmlAttribute.value}break;case"DefaultSelected":if(projectObject instanceof Design.GroupLogicAnswer){projectObject.IsDefaultSelected=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"CloseGap":break;case"CloseGapBookmark":if(projectObject instanceof Design.Placeholder){var closeType=Intelledox.Model.PlaceholderType.Bookmark;if(xmlNode.getAttribute("CloseGapType")!=null){closeType=parseInt(xmlNode.getAttribute("CloseGapType"),10)}var closePlaceholder=new Intelledox.Model.PlaceholderReference;closePlaceholder.name=xmlAttribute.value;closePlaceholder.type=closeType;projectObject.CloseGapPlaceholder=closePlaceholder}break;case"XmlNamespace":if(projectObject instanceof Design.Placeholder){projectObject.XmlNamespace=xmlAttribute.value}break;case"Behaviour":if(projectObject instanceof Design.Placeholder){projectObject.Behaviour=parseInt(xmlAttribute.value,10)}break;case"CloseGapType":break;case"External":if(projectObject instanceof Design.Placeholder){projectObject.External=Design.GeneralFunctions.ToBool(xmlAttribute.value);if(projectObject.External){projectObject.DocumentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}}break;case"ReverseHideValue":if(projectObject instanceof Design.Placeholder){projectObject.ReverseHideValue=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ContentImageSizeScale":if(projectObject instanceof Design.Placeholder&&!System.String.IsNullOrEmpty(xmlAttribute.value)&&Intelledox.Common.Functions.IsNumeric(xmlAttribute.value)){projectObject.ContentImageScale=parseFloat(xmlAttribute.value)}break;case"Id":if(projectObject instanceof QAWizard.Design.ContentItem){projectObject.ContentItemGuid=xmlAttribute.value}else if(projectObject instanceof Intelledox.Model.RoutingElementType){projectObject.routingElementTypeId=xmlAttribute.value;projectObject.routingTypeId=xmlAttribute.value}else if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.ElementTypeId=xmlAttribute.value;projectObject.RoutingOptionGuid=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.FragmentOutput){projectObject.OutputGuid=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.ProjectProperty){projectObject.Id=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.AlterProperty){projectObject.Id=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_ID:if(projectObject instanceof Design.WorkflowState){projectObject.Id=xmlAttribute.value}else if(projectObject instanceof QAWizard.Design.Action){projectObject.ActionGuid=xmlAttribute.value}break;case"InstanceId":if(projectObject instanceof QAWizard.Design.ContentItem){projectObject.ContentInstanceId=xmlAttribute.value}else if(projectObject instanceof Design.Placeholder){projectObject.ContentId=xmlAttribute.value}break;case"ContentTypeId":if(projectObject instanceof QAWizard.Design.ContentItem){projectObject.ContentTypeId=parseInt(xmlAttribute.value,10)}break;case"Description":if(projectObject instanceof QAWizard.Design.Section){projectObject.Description=xmlAttribute.value}break;case"MaxHeight":if(projectObject instanceof QAWizard.Design.ContentItem){projectObject.ImageSettings.MaxHeight=parseFloat(xmlAttribute.value)}break;case"MaxWidth":if(projectObject instanceof QAWizard.Design.ContentItem){projectObject.ImageSettings.MaxWidth=parseFloat(xmlAttribute.value)}break;case"UnitOfMeasure":if(projectObject instanceof QAWizard.Design.ContentItem){projectObject.ImageSettings.UnitOfMeasure=parseInt(xmlAttribute.value,10)}break;case"StretchToFit":if(projectObject instanceof QAWizard.Design.ContentItem){projectObject.ImageSettings.StretchToFit=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"AttachmentName":if(projectObject instanceof QAWizard.Design.ContentItem){projectObject.AttachmentName=xmlAttribute.value}break;case"MetadataGuid":if(projectObject instanceof Intelledox.Model.MetadataElement){projectObject.MetadataGuid=xmlAttribute.value}break;case"MetadataName":if(projectObject instanceof Intelledox.Model.MetadataElement){projectObject.Name=xmlAttribute.value}break;case"MetadataTypeId":if(projectObject instanceof Intelledox.Model.MetadataElement){projectObject.ElementTypeId=parseInt(xmlAttribute.value,10)}break;case"MetadataText":if(projectObject instanceof Intelledox.Model.MetadataElement){projectObject.FixedValue=xmlAttribute.value}break;case"MetadataAnswerGuid":if(projectObject instanceof Intelledox.Model.MetadataElement){projectObject.AnswerGuid=xmlAttribute.value}break;case"RoutingOptionGuid":case Intelledox.Common.ConstantValues.XTF_ACTIONINPUTGUID:case Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUTGUID:case"InputGuid":case"OutputGuid":if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.RoutingOptionGuid=xmlAttribute.value}break;case"RoutingTypeId":if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.RoutingTypeId=xmlAttribute.value}break;case"RoutingElementTypeId":case"ActionAttributeId":case"EscalationInputTypeId":case"InputTypeId":if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.ElementTypeId=xmlAttribute.value}break;case"RoutingSourceTypeId":case"ActionAttributeSourceTypeId":case"EscalationInputSourceTypeId":case"InputSourceTypeId":case"OutputSourceTypeId":if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.SourceType=parseInt(xmlAttribute.value,10)}break;case"RoutingQuestionGuid":case"ActionAttributeQuestionGuid":case"EscalationInputQuestionReference":case"InputQuestionGuid":case"OutputQuestionGuid":if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.SourceGuid=xmlAttribute.value}break;case"RoutingAnswerGuid":case"ActionAttributeAnswerGuid":case"EscalationInputAnswerReference":case"InputAnswerGuid":case"OutputAnswerGuid":if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.SourceAttributeGuid=xmlAttribute.value}break;case"RoutingFieldName":case"ActionAttributeFieldName":case"EscalationInputFieldName":case"InputFieldName":case"OutputFieldName":if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.FieldName=xmlAttribute.value}break;case"RoutingFixedValue":case"InputFixedValue":case"OutputFixedValue":case Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUTVALUE:case Intelledox.Common.ConstantValues.XTF_ACTIONATTRIBUTEFIXEDVALUE:if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.FixedValue=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case"ActionAttributeTypeValue":case"InputTypeValue":if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.TypeValue=xmlAttribute.value}break;case"ActionAttributeKey":case"InputKey":if(projectObject instanceof Intelledox.Model.RoutingOption){projectObject.Key=xmlAttribute.value}break;case"DocumentGuid":if(projectObject instanceof Design.DocumentTemplate){projectObject.DocumentGuid=xmlAttribute.value}else if(projectObject instanceof Design.Placeholder){if(projectObject.External){projectObject.DocumentGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}else{projectObject.DocumentGuid=xmlAttribute.value}}else if(projectObject instanceof Intelledox.Model.ActionDocument){projectObject.DocumentGuid=xmlAttribute.value}else if(projectObject instanceof Design.FragmentDocument){projectObject.DocumentGuid=xmlAttribute.value}break;case"DocumentName":if(projectObject instanceof Design.DocumentTemplate){projectObject.Name=xmlAttribute.value}break;case"FormatType":if(projectObject instanceof Design.DocumentTemplate){projectObject.FormatType=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.FragmentDocument){projectObject.FormatType=parseInt(xmlAttribute.value,10)}break;case"FileName":if(projectObject instanceof Design.DocumentTemplate){projectObject.FileName=xmlAttribute.value}break;case"AllowNameChange":if(projectObject instanceof Design.DocumentTemplate){projectObject.AllowNameChange=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"Colour":if(projectObject instanceof Design.DocumentTemplate){projectObject.Colour=parseInt(xmlAttribute.value,10)}break;case"ImageSizeScale":if(projectObject instanceof Design.Answer){projectObject.ImageSettings.SizeScale=parseFloat(xmlAttribute.value)}break;case"ProviderName":break;case"RuleType":if(projectObject instanceof Design.ValidationRule){projectObject.RuleType=parseInt(xmlAttribute.value,10)}break;case"Expression":if(projectObject instanceof Design.ValidationRule){projectObject.Expression=xmlAttribute.value}break;case"Message":if(projectObject instanceof Design.ValidationRule){projectObject.Message=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_TITLE:if(projectObject instanceof Design.Section){projectObject.Title=xmlAttribute.value}else if(projectObject instanceof Design.Column){projectObject.Title=xmlAttribute.value}else if(projectObject instanceof Design.TabPage){projectObject.Title=xmlAttribute.value}else if(projectObject instanceof Design.ChartProperties){projectObject.Title=xmlAttribute.value}else if(projectObject instanceof Design.Axis){projectObject.Title=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}else if(projectObject instanceof Design.ButtonQuestion){projectObject.Title=xmlAttribute.value}break;case"TextPosition":if(projectObject instanceof Design.Question){projectObject.TextPosition=Design.TextPosition[xmlAttribute.value]}break;case"CssClass":if(projectObject instanceof Design.Page){projectObject.CssStyle=xmlAttribute.value}else if(projectObject instanceof Design.Section){projectObject.CssStyle=xmlAttribute.value}else if(projectObject instanceof Design.Column){projectObject.CssStyle=xmlAttribute.value}else if(projectObject instanceof Design.TabGroup){projectObject.CssStyle=xmlAttribute.value}else if(projectObject instanceof Design.TabPage){projectObject.CssStyle=xmlAttribute.value}else if(projectObject instanceof Design.Question){projectObject.CssStyle=xmlAttribute.value}break;case"Increment":if(projectObject instanceof Design.NumericQuestion){projectObject.Increment=parseInt(xmlAttribute.value,10)}break;case"Width":if(projectObject instanceof Design.Column){projectObject.Width=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.UserPromptQuestion){projectObject.TextBoxWidth=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.DatasourceQuestion){projectObject.TextBoxWidth=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.NumericQuestion){projectObject.Width=parseInt(xmlAttribute.value,10)}break;case"LQWidth":if(projectObject instanceof Design.Question){projectObject.LeftQuestionWidth=parseInt(xmlAttribute.value,10)}break;case"WidthType":if(projectObject instanceof Design.Column){projectObject.WidthType=Design.WidthType[xmlAttribute.value]}else if(projectObject instanceof Design.Question){projectObject.WidthType=Design.WidthType[xmlAttribute.value]}break;case Intelledox.Common.ConstantValues.XTF_REPEATED:if(projectObject instanceof Design.Section){projectObject.IsRepeated=Design.GeneralFunctions.ToBool(xmlAttribute.value)}else if(projectObject instanceof Design.Page){projectObject.IsRepeated=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"RepeatBookmark":var bookmarks=xmlAttribute.value.split(',');if(projectObject instanceof Design.Section&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.RepeatPlaceholders=new Array;for(var sectionPlaceholderIndex=0;sectionPlaceholderIndex<bookmarks.length;sectionPlaceholderIndex++){var placeRef=new Intelledox.Model.PlaceholderReference;placeRef.name=bookmarks[sectionPlaceholderIndex];placeRef.type=Intelledox.Model.PlaceholderType.Bookmark;projectObject.RepeatPlaceholders.push(placeRef)}}else if(projectObject instanceof Design.Page&&!System.String.IsNullOrEmpty(xmlAttribute.value)){projectObject.RepeatPlaceholders=new Array;for(var pagePlaceholderIndex=0;pagePlaceholderIndex<bookmarks.length;pagePlaceholderIndex++){var placeRef=new Intelledox.Model.PlaceholderReference;placeRef.name=bookmarks[pagePlaceholderIndex];placeRef.type=Intelledox.Model.PlaceholderType.Bookmark;projectObject.RepeatPlaceholders.push(placeRef)}}break;case"RepeatTitle":if(projectObject instanceof Design.Page){projectObject.RepeatTitle=xmlAttribute.value}break;case"GroupBy":if(projectObject instanceof Design.Column){projectObject.GroupBy=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"QID":if(projectObject instanceof Design.Condition){projectObject.ParentItemGuid=xmlAttribute.value}else if(projectObject instanceof Design.Rule){projectObject.ParentItemGuid=xmlAttribute.value}else if(projectObject instanceof Design.ValidationRule){projectObject.QuestionGuid=xmlAttribute.value}break;case"AID":if(!System.String.IsNullOrEmpty(xmlAttribute.value)){if(projectObject instanceof Design.Condition){projectObject.ParentAttributeGuid=xmlAttribute.value}else if(projectObject instanceof Design.Rule){projectObject.ParentAttributeGuid=xmlAttribute.value}else if(projectObject instanceof Design.ValidationRule){projectObject.AnswerGuid=xmlAttribute.value}}break;case"ActionId":if(!System.String.IsNullOrEmpty(xmlAttribute.value)){if(projectObject instanceof Design.Condition){projectObject.ParentItemGuid=xmlAttribute.value}}break;case"ActionOutput":if(!System.String.IsNullOrEmpty(xmlAttribute.value)){if(projectObject instanceof Design.Condition){projectObject.ParentAttributeGuid=xmlAttribute.value}}break;case"Compare":if(projectObject instanceof Design.Condition){projectObject.ComparisonType=Design.ClauseComparisonType[xmlAttribute.value]}else if(projectObject instanceof Design.Rule){projectObject.ComparisonType=Design.ClauseComparisonType[xmlAttribute.value]}break;case"Value":if(projectObject instanceof Design.Condition){projectObject.CompareTo=xmlAttribute.value}else if(projectObject instanceof Design.Rule){projectObject.CompareTo=xmlAttribute.value}else if(projectObject instanceof Design.ProjectProperty){projectObject.InitialValue=xmlAttribute.value}else if(projectObject instanceof Design.AlterProperty){projectObject.Value=xmlAttribute.value}break;case"DisplayDirection":if(projectObject instanceof Design.GroupLogicQuestion){projectObject.DisplayDirection=parseInt(xmlAttribute.value,10)}break;case"Direction":if(projectObject instanceof Intelledox.Model.SortField){projectObject.Direction=parseInt(xmlAttribute.value,10)}break;case"ParentType":if(projectObject instanceof Design.Condition){projectObject.ParentType=Design.ConditionParentType[xmlAttribute.value]}else if(projectObject instanceof Design.Rule){projectObject.ParentType=Design.RuleParentType[xmlAttribute.value]}else if(projectObject instanceof Design.Filter){projectObject.ParentType=Design.FilterParentType[xmlAttribute.value]}break;case"RepChoice":if(projectObject instanceof Design.Rule){projectObject.EveryOrOneOf=parseInt(xmlAttribute.value,10)}break;case"ColourPalette":if(projectObject instanceof Design.ChartProperties){projectObject.ColourPalette=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Series){projectObject.ColourPalette=parseInt(xmlAttribute.value,10)}break;case"BackColour":if(projectObject instanceof Design.ChartProperties){projectObject.BackColour=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Series){projectObject.BackColour=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Legend){projectObject.BackColour=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.ChartArea){projectObject.BackColour=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.ButtonQuestion){projectObject.BackColour=xmlAttribute.value}break;case"BorderlineColour":if(projectObject instanceof Design.ChartProperties){projectObject.BorderlineColour=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Series){projectObject.BorderlineColour=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Legend){projectObject.BorderlineColour=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.ChartArea){projectObject.BorderlineColour=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Axis){projectObject.BorderlineColour=parseInt(xmlAttribute.value,10)}break;case"BorderlineDashStyle":if(projectObject instanceof Design.ChartProperties){projectObject.BorderlineDashStyle=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Series){projectObject.BorderlineDashStyle=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Legend){projectObject.BorderlineDashStyle=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.ChartArea){projectObject.BorderlineDashStyle=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Axis){projectObject.BorderlineDashStyle=parseInt(xmlAttribute.value,10)}break;case"BorderlineWidth":if(projectObject instanceof Design.ChartProperties){projectObject.BorderlineWidth=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Series){projectObject.BorderlineWidth=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Legend){projectObject.BorderlineWidth=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.ChartArea){projectObject.BorderlineWidth=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Axis){projectObject.BorderlineWidth=parseInt(xmlAttribute.value,10)}break;case"Enable3D":if(projectObject instanceof Design.ChartArea){projectObject.Is3D=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ChartType":if(projectObject instanceof Design.Series){projectObject.ChartType=parseInt(xmlAttribute.value,10)}break;case"DataPointLabel":if(projectObject instanceof Design.Series){projectObject.DataPointLabel=parseInt(xmlAttribute.value,10)}break;case"DataQuestionGuid":if(projectObject instanceof Design.Series){projectObject.DataQuestionGuid=(xmlAttribute.value)}break;case"CategoriesAnswer":if(projectObject instanceof Design.Series){projectObject.CategoriesAnswer=(xmlAttribute.value)}break;case"ValueAnswer":if(projectObject instanceof Design.Series){projectObject.ValueAnswer=(xmlAttribute.value)}break;case"Docking":if(projectObject instanceof Design.Legend){projectObject.Docking=parseInt(xmlAttribute.value,10)}break;case"Alignment":if(projectObject instanceof Design.Legend){projectObject.Alignment=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Axis){projectObject.Alignment=parseInt(xmlAttribute.value,10)}break;case"HideTitle":if(projectObject instanceof Design.Axis){projectObject.HideTitle=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"HideLabels":if(projectObject instanceof Design.Axis){projectObject.HideLabels=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"HideFirstAndLastLabels":if(projectObject instanceof Design.Axis){projectObject.HideFirstAndLastLabels=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"StyleName":if(projectObject instanceof Design.Placeholder){projectObject.StyleName=xmlAttribute.value}break;case"DisplayImportOptions":if(projectObject instanceof Design.Section){projectObject.DisplayImportOptions=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ShowBullets":if(projectObject instanceof Design.RichTextQuestion){projectObject.ShowBullets=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ShowCopyAndPaste":if(projectObject instanceof Design.RichTextQuestion){projectObject.ShowCopyAndPaste=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ShowHyperlink":if(projectObject instanceof Design.RichTextQuestion){projectObject.ShowHyperlink=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ShowSpellCheck":if(projectObject instanceof Design.RichTextQuestion){projectObject.ShowSpellCheck=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ShowStyles":if(projectObject instanceof Design.RichTextQuestion){projectObject.ShowStyles=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ShowTables":if(projectObject instanceof Design.RichTextQuestion){projectObject.ShowTables=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ShowProtectedFields":if(projectObject instanceof Design.RichTextQuestion){projectObject.ShowProtectedFields=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"TransitionType":if(projectObject instanceof Design.WorkflowState){projectObject.TransitionType=parseInt(xmlAttribute.value,10)}break;case"AllowCancellation":if(projectObject instanceof Design.WorkflowState){projectObject.AllowCancellation=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"InitiateType":if(projectObject instanceof Design.Escalation){projectObject.InitialisationType=parseInt(xmlAttribute.value,10)}break;case"ExpireAfter":if(projectObject instanceof Design.Escalation){projectObject.ExpireAfter=parseInt(xmlAttribute.value,10)}break;case"ExpireDateQR":if(projectObject instanceof Design.Escalation){projectObject.InitialisationType=Intelledox.Model.EscalationInitialisationType.QuestionReference;projectObject.ExpiryDateQuestionReference=xmlAttribute.value}break;case"ExpireDateAR":if(projectObject instanceof Design.Escalation){projectObject.ExpiryDateAnswerReference=xmlAttribute.value}break;case"WorkingDays":if(projectObject instanceof Design.Escalation){projectObject.WorkingDays=Design.GeneralFunctions.ToBool(xmlAttribute.value)}else if(projectObject instanceof Intelledox.Model.RecurrencePattern){projectObject.WorkingDays=Design.GeneralFunctions.ToBool(xmlAttribute.value)}else if(projectObject instanceof Design.WorkflowState){projectObject.WorkingDays=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"DueDateQR":if(projectObject instanceof Design.WorkflowState){projectObject.DueType=Intelledox.Model.WorkflowStateDueType.QuestionReference;projectObject.DueDateQuestionReference=xmlAttribute.value}break;case"DueDateAR":if(projectObject instanceof Design.WorkflowState){projectObject.DueDateAnswerReference=xmlAttribute.value}break;case"DueAfter":if(projectObject instanceof Design.WorkflowState){projectObject.DueType=Intelledox.Model.WorkflowStateDueType.Days;projectObject.DueAfter=parseInt(xmlAttribute.value,10)}break;case"StateId":if(projectObject instanceof Design.StateTransition){projectObject.StateId=xmlAttribute.value}break;case"SendTo":if(projectObject instanceof Design.StateTransition){projectObject.SendTo=parseInt(xmlAttribute.value,10)}break;case"SendToType":if(projectObject instanceof Design.StateTransition){projectObject.SendToType=parseInt(xmlAttribute.value,10)}break;case"TransQuestionReference":if(projectObject instanceof Design.StateTransition){projectObject.QuestionGuid=xmlAttribute.value}break;case"TransAnswerReference":if(projectObject instanceof Design.StateTransition){projectObject.AnswerGuid=xmlAttribute.value}break;case"SendToUser":if(projectObject instanceof Design.StateTransition){projectObject.SendToUser=xmlAttribute.value}break;case"SendToGroup":if(projectObject instanceof Design.StateTransition){projectObject.SendToGroup=xmlAttribute.value}break;case"SendToName":if(projectObject instanceof Design.StateTransition){projectObject.SendToName=xmlAttribute.value}break;case"SentToRestrictSearch":if(projectObject instanceof Design.StateTransition){projectObject.SendToRestrictSearch=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"SendToRestrictGroup":if(projectObject instanceof Design.StateTransition){projectObject.SendToRestrictGroup=xmlAttribute.value}break;case"SendToRestrictName":if(projectObject instanceof Design.StateTransition){projectObject.SendToRestrictName=xmlAttribute.value}break;case"AllowReassign":if(projectObject instanceof Design.StateTransition){projectObject.AllowReassign=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"SendEmail":if(projectObject instanceof Design.StateTransition){projectObject.SendEmail=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case Intelledox.Common.ConstantValues.XTF_STARTPAGE:if(projectObject instanceof Design.StateTransition){projectObject.StartPageGuid=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_EMAILTEXT:if(projectObject instanceof Design.StateTransition){projectObject.EmailText=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_EMAILSUBJECT:if(projectObject instanceof Design.StateTransition){projectObject.EmailSubject=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case"ShowNextSteps":if(projectObject instanceof Design.StateTransition){projectObject.ShowNextSteps=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ShowSendTo":if(projectObject instanceof Design.StateTransition){projectObject.ShowSendTo=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ShowComment":if(projectObject instanceof Design.StateTransition){projectObject.ShowComment=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"AnonymousRecipientNameQ":if(projectObject instanceof Design.StateTransition){projectObject.TemporaryRecipientNameQuestion=xmlAttribute.value}break;case"AnonymousRecipientNameA":if(projectObject instanceof Design.StateTransition){if(xmlAttribute.value!=="null"){projectObject.TemporaryRecipientNameAnswer=xmlAttribute.value}}break;case Intelledox.Common.ConstantValues.XTF_DEFAULTCOMMENT:if(projectObject instanceof Design.StateTransition){projectObject.DefaultComment=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case"CommentMandatory":if(projectObject instanceof Design.StateTransition){projectObject.CommentMandatory=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case Intelledox.Common.ConstantValues.XTF_PAGETITLE:if(projectObject instanceof Design.StateTransition){projectObject.PageTitle=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_SUBMITBUTTONTEXT:if(projectObject instanceof Design.StateTransition){projectObject.SubmitButtonText=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_SUBMITTINGTEXT:if(projectObject instanceof Design.StateTransition){projectObject.SubmittingText=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_DOWNLOADABLEDOCUMENTS:if(projectObject instanceof Design.StateTransition){projectObject.DownloadableDocuments=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_RESPONSESUBMITTEDTEXT:if(projectObject instanceof Design.StateTransition){projectObject.ResponsesSubmittedText=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_OFFLINEREDIRECTMESSAGE:if(projectObject instanceof Design.StateTransition){projectObject.OfflineRedirectMessage=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_REDIRECTTOHOME:if(projectObject instanceof Design.StateTransition){projectObject.RedirectToHome=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case Intelledox.Common.ConstantValues.XTF_WAITFORPROJECT:if(projectObject instanceof Design.StateTransition){projectObject.WaitForProject=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"PriorityExit":if(projectObject instanceof Design.StateTransition){projectObject.PriorityExit=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"IsRepeated":if(projectObject instanceof Design.Action){projectObject.IsRepeated=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"HasCustomDocuments":if(projectObject instanceof Design.Action){projectObject.HasCustomDocuments=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"Format":if(projectObject instanceof Intelledox.Model.ActionDocument){projectObject.Format=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.FragmentDocument){projectObject.AttachmentFormat=parseInt(xmlAttribute.value,10)}break;case"Type":if(projectObject instanceof Intelledox.Model.ActionDocument){projectObject.Type=Intelledox.Model.ActionDocumentType[xmlAttribute.value]}break;case"Maximum":if(projectObject instanceof Design.Section){projectObject.MaximumRepeats=xmlAttribute.value}else if(projectObject instanceof Design.Page){projectObject.MaximumRepeats=xmlAttribute.value}else if(projectObject instanceof Design.NumericQuestion){projectObject.MaximumValue=parseFloat(xmlAttribute.value)}break;case"Minimum":if(projectObject instanceof Design.Section){projectObject.MinimumRepeats=xmlAttribute.value}else if(projectObject instanceof Design.Page){projectObject.MinimumRepeats=xmlAttribute.value}else if(projectObject instanceof Design.NumericQuestion){projectObject.MinimumValue=parseFloat(xmlAttribute.value)}break;case Intelledox.Common.ConstantValues.XTF_REPEATNAME:if(projectObject instanceof Design.Section){projectObject.RepeatName=xmlAttribute.value}else if(projectObject instanceof Design.Page){projectObject.RepeatName=xmlAttribute.value}break;case"CreateMinimum":if(projectObject instanceof Design.Section){projectObject.CreateMinimumRepeats=Design.GeneralFunctions.ToBool(xmlAttribute.value)}else if(projectObject instanceof Design.Page){projectObject.CreateMinimumRepeats=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ShowFillDown":if(projectObject instanceof Design.Section){projectObject.ShowFillDownButton=Design.GeneralFunctions.ToBool(xmlAttribute.value)}else if(projectObject instanceof Design.Page){projectObject.ShowFillDownButton=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"DatasourceQuestionDefaultGuid":if(projectObject instanceof Design.Section){projectObject.RepeatSourceType=Design.RepeatSourceType.DataSource;projectObject.RepeatSourceGuid=xmlAttribute.value}else if(projectObject instanceof Design.Page){projectObject.RepeatSourceType=Design.RepeatSourceType.DataSource;projectObject.RepeatSourceGuid=xmlAttribute.value}break;case"RepeatSourceType":if(projectObject instanceof Design.Section){projectObject.RepeatSourceType=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.Page){projectObject.RepeatSourceType=parseInt(xmlAttribute.value,10)}else if(projectObject instanceof Design.DocumentTemplate){projectObject.RepeatSourceType=parseInt(xmlAttribute.value,10)}break;case"RepeatSourceGuid":if(projectObject instanceof Design.Section){projectObject.RepeatSourceGuid=xmlAttribute.value}else if(projectObject instanceof Design.Page){projectObject.RepeatSourceGuid=xmlAttribute.value}else if(projectObject instanceof Design.DocumentTemplate){projectObject.RepeatSourceGuid=xmlAttribute.value}break;case"RepeatSourceAttributeGuid":if(projectObject instanceof Design.Section){projectObject.RepeatSourceAttributeGuid=xmlAttribute.value}else if(projectObject instanceof Design.Page){projectObject.RepeatSourceAttributeGuid=xmlAttribute.value}else if(projectObject instanceof Design.DocumentTemplate){projectObject.RepeatSourceAttributeGuid=xmlAttribute.value}break;case"ValueType":if(projectObject instanceof Design.AvailableInput){projectObject.valueType=parseInt(xmlAttribute.value,10)}break;case"IsEditableDrivenRepeat":if(projectObject instanceof Design.Section){projectObject.IsEditableDrivenRepeat=Design.GeneralFunctions.ToBool(xmlAttribute.value)}else if(projectObject instanceof Design.Page){projectObject.IsEditableDrivenRepeat=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"Frequency":if(projectObject instanceof Intelledox.Model.RecurrencePattern){projectObject.Frequency=Intelledox.Model.FrequencyEnum[xmlAttribute.value]}break;case"Interval":if(projectObject instanceof Intelledox.Model.RecurrencePattern){projectObject.Interval=parseInt(xmlAttribute.value,10)}break;case"ByDay":if(projectObject instanceof Intelledox.Model.RecurrencePattern){var days=xmlAttribute.value.split(',');for(var dayIndex=0;dayIndex<days.length;dayIndex++){projectObject.ByDay.push(days[dayIndex])}}break;case"ByMonthDay":if(projectObject instanceof Intelledox.Model.RecurrencePattern){var days=xmlAttribute.value.split(',');for(var monthDayIndex=0;monthDayIndex<days.length;monthDayIndex++){projectObject.ByMonthDay.push(days[monthDayIndex])}}break;case"BySetPosition":if(projectObject instanceof Intelledox.Model.RecurrencePattern){projectObject.BySetPosition=parseInt(xmlAttribute.value,10)}break;case"RepeatOccurences":if(projectObject instanceof Intelledox.Model.RecurrencePattern){projectObject.RepeatCount=parseInt(xmlAttribute.value,10)}break;case"RepeatDays":if(projectObject instanceof Intelledox.Model.RecurrencePattern){projectObject.RepeatDays=parseInt(xmlAttribute.value,10)}break;case"RecurDateQR":if(projectObject instanceof Intelledox.Model.RecurrencePattern){projectObject.RecurDateQuestionReference=xmlAttribute.value}break;case"RecurDateAR":if(projectObject instanceof Intelledox.Model.RecurrencePattern){projectObject.RecurDateAnswerReference=xmlAttribute.value}break;case"BGSource":if(projectObject instanceof Design.InkQuestion){projectObject.BackgroundSource=parseInt(xmlAttribute.value,10)}break;case"BackgroundImage":if(projectObject instanceof Design.InkQuestion){projectObject.BackgroundImage=xmlAttribute.value}break;case"BackgroundQR":if(projectObject instanceof Design.InkQuestion){projectObject.BackgroundQRQuestionGuid=(xmlAttribute.value)}break;case"BackgroundAR":if(projectObject instanceof Design.InkQuestion){projectObject.BackgroundQRAnswerGuid=(xmlAttribute.value)}break;case"IncludeBackground":if(projectObject instanceof Design.InkQuestion){projectObject.IncludeBackground=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"AllowBackgroundUpload":if(projectObject instanceof Design.InkQuestion){projectObject.AllowBackgroundUpload=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"AllowZoom":if(projectObject instanceof Design.InkQuestion){projectObject.AllowZoom=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ThumbnailMaxWidth":if(projectObject instanceof Design.InkQuestion){projectObject.ThumbnailMaxWidth=parseInt(xmlAttribute.value,10)}break;case"ThumbnailMaxHeight":if(projectObject instanceof Design.InkQuestion){projectObject.ThumbnailMaxHeight=parseInt(xmlAttribute.value,10)}break;case"ResizeBackgroundImage":if(projectObject instanceof Design.InkQuestion){projectObject.ResizeBackgroundImage=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"InkColour":if(projectObject instanceof Design.InkQuestion){projectObject.InkColour=parseInt(xmlAttribute.value,10)}break;case"AllowInkColourChoice":if(projectObject instanceof Design.InkQuestion){projectObject.AllowInkColourChoice=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"BusinessUnitGuid":case"AnswerGuid":break;case"RunActionWhen":if(projectObject instanceof Design.Action){projectObject.RunActionWhen=parseInt(xmlAttribute.value,10)}break;case"ShowActionWhen":if(projectObject instanceof Design.Action){projectObject.ShowActionWhen=parseInt(xmlAttribute.value,10)}break;case"SubmissionStage":if(projectObject instanceof Design.Action){projectObject.SubmissionStage=parseInt(xmlAttribute.value,10)}break;case"Retries":if(projectObject instanceof Design.Action){projectObject.Retries=parseInt(xmlAttribute.value);break}break;case"RetryWait":if(projectObject instanceof Design.Action){projectObject.RetryWait=parseInt(xmlAttribute.value);break}break;case"CustomQuestionTypeId":if(projectObject instanceof Design.CustomQuestion){projectObject.CustomQuestionTypeId=xmlAttribute.value}break;case"HighAccuracy":if(projectObject instanceof Design.GeolocationQuestion){projectObject.HighAccuracy=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case Intelledox.Common.ConstantValues.XTF_PROJECTGUID:var fragmentWizard=null;var projectGuid=xmlAttribute.value;if(projectObject instanceof Design.FragmentReference){projectObject.ProjectGuid=projectGuid;projectObject.WizardFragment=fragmentWizard}else if(projectObject instanceof Design.FragmentPage){projectObject.ProjectGuid=projectGuid;projectObject.WizardFragment=fragmentWizard}break;case"IsAttachment":if(projectObject instanceof Design.FragmentDocument){projectObject.IsAttachment=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case Intelledox.Common.ConstantValues.XTF_FRAGMENTGUID:if(projectObject instanceof Design.FragmentReference){projectObject.FragmentGuid=xmlAttribute.value}break;case"ParallelSectionGuid":if(projectObject instanceof Design.Workflow){projectObject.ParallelSectionGuid=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_REFERENCE:if(projectObject instanceof Design.ProtectedField){projectObject.Reference=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_LANGUAGE:if(projectObject instanceof Design.LanguageTranslation){projectObject.lang=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_TRANSLATIONGUID:if(projectObject instanceof Design.LanguageTranslation){if(xmlAttribute.value.indexOf("|")===-1){projectObject.controlGuid=xmlAttribute.value}else{var values=xmlAttribute.value.split("|");projectObject.controlGuid=values[0];projectObject.parentGuid=values[1]}}break;case Intelledox.Common.ConstantValues.XTF_TRANSLATIONDESCRIPTION:if(projectObject instanceof Design.LanguageTranslation){projectObject.description=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_DEFAULTANSWERFILENAME:case Intelledox.Common.ConstantValues.XTF_DEFAULTINPROGRESSANSWERFILENAME:case Intelledox.Common.ConstantValues.XTF_FINISHTITLE:case Intelledox.Common.ConstantValues.XTF_GENERATEBUTTONTEXT:case Intelledox.Common.ConstantValues.XTF_GENERATINGTEXT:case Intelledox.Common.ConstantValues.XTF_DOWNLOADPAGETITLE:case Intelledox.Common.ConstantValues.XTF_INVALIDPROJECTEXT:case Intelledox.Common.ConstantValues.XTF_ANONSAVEHELPTEXT:case Intelledox.Common.ConstantValues.XTF_ANONSAVEEMAILSUBJECT:case Intelledox.Common.ConstantValues.XTF_ANONSAVEEMAILBODY:case Intelledox.Common.ConstantValues.XTF_ANONSAVERESUMETEXT:case Intelledox.Common.ConstantValues.XTF_ANONREASSIGNTEXT:if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case"ButtonType":if(projectObject instanceof Design.ButtonQuestion){projectObject.ButtonType=parseInt(xmlAttribute.value,10)}break;case Intelledox.Common.ConstantValues.XTF_BADGE:if(projectObject instanceof Design.ButtonQuestion){projectObject.Badge=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_BACKTOGGLECOLOUR:if(projectObject instanceof Design.ButtonQuestion){projectObject.BackToggleColour=xmlAttribute.value}break;case"BackColourDark":if(projectObject instanceof Design.ButtonQuestion){projectObject.BackColourDark=xmlAttribute.value}break;case"BackToggleColourDark":if(projectObject instanceof Design.ButtonQuestion){projectObject.BackToggleColourDark=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_FOCUSRINGCOLOUR:if(projectObject instanceof Design.ButtonQuestion){projectObject.FocusRingColour=xmlAttribute.value}break;case"ButtonSize":if(projectObject instanceof Design.ButtonQuestion){projectObject.Size=parseInt(xmlAttribute.value,10)}break;case"Icon":if(projectObject instanceof Design.ButtonQuestion){projectObject.Icon=xmlAttribute.value}break;case"LaunchUrl":if(projectObject instanceof Design.ButtonQuestion){projectObject.LaunchUrl=xmlAttribute.value}break;case"NewTab":if(projectObject instanceof Design.ButtonQuestion){projectObject.NewTab=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"GoToPageGuid":if(projectObject instanceof Design.ButtonQuestion){projectObject.GoToPageGuid=xmlAttribute.value}break;case"GoToProjectGroupGuid":if(projectObject instanceof Design.ButtonQuestion){projectObject.GoToProjectGroupGuid=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_DISPLAYFIELDCOLUMNTITLE:if(projectObject instanceof Intelledox.Model.DisplayField){projectObject.columnTitle=xmlAttribute.value}else if(projectObject instanceof Design.LanguageTranslation){projectObject.translations[xmlAttribute.name]=xmlAttribute.value}break;case Intelledox.Common.ConstantValues.XTF_DISPLAYFIELDLINK:if(projectObject instanceof Intelledox.Model.DisplayField){projectObject.link=parseInt(xmlAttribute.value,10);;}break;case Intelledox.Common.ConstantValues.XTF_DISPLAYFIELDOPERATIONSDROPDOWN:if(projectObject instanceof Intelledox.Model.DisplayField){projectObject.operationsDropdown=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"Sortable":if(projectObject instanceof Intelledox.Model.DisplayField){projectObject.sortable=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ResultsPerPage":if(projectObject instanceof Design.DatasourceQuestion){projectObject.ResultsPerPage=parseInt(xmlAttribute.value,10)}break;case"SearchAll":if(projectObject instanceof Design.DatasourceQuestion){projectObject.SearchAll=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"LiveRefresh":if(projectObject instanceof Design.DatasourceQuestion){projectObject.LiveRefresh=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"RefreshPeriod":if(projectObject instanceof Design.DatasourceQuestion){projectObject.RefreshPeriod=parseInt(xmlAttribute.value,10)}break;case"NoResultsMessage":if(projectObject instanceof Design.DatasourceQuestion){projectObject.NoResultsMessage=xmlAttribute.value}break;case"VisitedPagesOnly":if(projectObject instanceof Design.SummaryQuestion){projectObject.Settings.UpToCurrentPageOnly=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"CollapsiblePages":if(projectObject instanceof Design.SummaryQuestion){projectObject.Settings.CollapsiblePages=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"IncludePageLinks":if(projectObject instanceof Design.SummaryQuestion){projectObject.Settings.IncludePageLinks=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"IncludeComments":if(projectObject instanceof Design.SummaryQuestion){projectObject.Settings.IncludeComments=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"IncludeAllChoices":if(projectObject instanceof Design.SummaryQuestion){projectObject.Settings.IncludeAllChoices=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"Include":if(projectObject instanceof Design.Page){this.CreatePageSummary(projectObject);projectObject.Summary.Include=Design.GeneralFunctions.ToBool(xmlAttribute.value)}else if(projectObject instanceof Design.Question){this.CreateQuestionSummary(projectObject);projectObject.Summary.Include=Design.QuestionSummaryInclude[xmlAttribute.value]}break;case"Collapsible":if(projectObject instanceof Design.Page){this.CreatePageSummary(projectObject);projectObject.Summary.Collapsible=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"OverrideTitle":if(projectObject instanceof Design.Question){this.CreateQuestionSummary(projectObject);projectObject.Summary.Title=xmlAttribute.value}else if(projectObject instanceof Design.Page){this.CreatePageSummary(projectObject);projectObject.Summary.Title=xmlAttribute.value}break;case"ShowAll":if(projectObject instanceof Design.Question){this.CreateQuestionSummary(projectObject);projectObject.Summary.ShowAll=Design.GeneralFunctions.ToBool(xmlAttribute.value)}break;case"ClassName":if(projectObject instanceof QAWizard.Design.RunActionButtonQuestion){projectObject.ClassName=xmlAttribute.value}break;case"AllowSorting":if(projectObject instanceof QAWizard.Design.Section){projectObject.AllowSorting=Design.GeneralFunctions.ToBool(xmlAttribute.value)}else if(projectObject instanceof QAWizard.Design.Page){projectObject.AllowSorting=Design.GeneralFunctions.ToBool(xmlAttribute.value)}}}var childElements=xmlNode.childNodes;for(var i=0;i<childElements.length;i++){var xmlTraverseNode=childElements[i];switch(xmlTraverseNode.nodeName){case"HeaderInfo":case Intelledox.Common.ConstantValues.XTF_WIZARDINFO:case"BinaryInfo":case"MetadataInfo":case"RoutingInfo":case"ProtectedFields":case"Properties":this.m_NodeGroup=xmlTraverseNode.nodeName;this.ExtractNode(xmlTraverseNode,null,null);break;case"CompletionInfo":this.m_NodeGroup=xmlTraverseNode.nodeName;this.ExtractNode(xmlTraverseNode,this.m_Wizard,null);break;case"TemplateGuid":if(this.m_NodeGroup==="HeaderInfo"&&!System.String.IsNullOrEmpty(xmlTraverseNode.textContent)){this.m_Wizard.ProjectGuid=xmlTraverseNode.textContent}break;case Intelledox.Common.ConstantValues.XTF_NAME:if(this.m_NodeGroup==="HeaderInfo"){this.m_Wizard.Name=xmlTraverseNode.textContent;this.m_Wizard.ProjectGroupName=xmlTraverseNode.textContent}break;case"TemplateTypeId":if(this.m_NodeGroup==="HeaderInfo"){this.m_Wizard.TypeId=parseInt(xmlTraverseNode.textContent,10)}break;case"Compatibility":if(this.m_NodeGroup==="HeaderInfo"){this.m_Wizard.Compatibility=parseInt(xmlTraverseNode.textContent,10)}break;case"ContentBookmark":var contentType=Intelledox.Model.PlaceholderType.Bookmark;var contentTypeNode=xmlNode.getElementsByTagName("ContentBookmarkType");if(contentTypeNode!=null&&contentTypeNode.length===1){contentType=parseInt(contentTypeNode[0].textContent,10)}if(this.m_NodeGroup==="HeaderInfo"){this.m_Wizard.ContentPlaceholder=new Intelledox.Model.PlaceholderReference;this.m_Wizard.ContentPlaceholder.name=xmlTraverseNode.textContent;this.m_Wizard.ContentPlaceholder.type=contentType}break;case"LayoutQuestionsFirst":if(this.m_NodeGroup==="HeaderInfo"){this.m_Wizard.LayoutQuestionsFirst=Design.GeneralFunctions.ToBool(xmlTraverseNode.textContent)}break;case"DefaultAnswerFileName":this.m_Wizard.DefaultAnswerFileName=xmlTraverseNode.textContent;break;case"DefaultInProgressFileName":this.m_Wizard.DefaultInProgressFileName=xmlTraverseNode.textContent;break;case"AnonSaveAccessGen":this.m_Wizard.TemporaryUserSaveSettings.AccessCodeGeneration=parseInt(xmlTraverseNode.textContent);break;case"AnonSaveAccessGenQ":this.m_Wizard.TemporaryUserSaveSettings.AccessCodeGenerationQuestion=xmlTraverseNode.textContent;break;case"AnonSaveAccessGenA":this.m_Wizard.TemporaryUserSaveSettings.AccessCodeGenerationAnswer=xmlTraverseNode.textContent;break;case Intelledox.Common.ConstantValues.XTF_ANONSAVEHELPTEXT:this.m_Wizard.TemporaryUserSaveSettings.HelpText=xmlTraverseNode.textContent;break;case"AnonSaveEmailTo":this.m_Wizard.TemporaryUserSaveSettings.EmailTo=xmlTraverseNode.textContent;break;case Intelledox.Common.ConstantValues.XTF_ANONSAVEEMAILSUBJECT:this.m_Wizard.TemporaryUserSaveSettings.EmailSubject=xmlTraverseNode.textContent;break;case Intelledox.Common.ConstantValues.XTF_ANONSAVEEMAILBODY:this.m_Wizard.TemporaryUserSaveSettings.EmailBody=xmlTraverseNode.textContent;break;case Intelledox.Common.ConstantValues.XTF_ANONSAVERESUMETEXT:this.m_Wizard.TemporaryUserSaveSettings.ResumeText=xmlTraverseNode.textContent;break;case Intelledox.Common.ConstantValues.XTF_ANONREASSIGNTEXT:this.m_Wizard.TemporaryUserSaveSettings.ReassignText=xmlTraverseNode.textContent;break;case Intelledox.Common.ConstantValues.XTF_ANONRECIPIENTNAMETEXT:this.m_Wizard.TemporaryUserSaveSettings.RecipientName=xmlTraverseNode.textContent;break;case Intelledox.Common.ConstantValues.XTF_BOOKMARKGROUP:if(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_PROJECTGUID)!=null){objCurrentObject=new Design.FragmentPage(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_GUID))}else{if(!xmlTraverseNode.hasAttribute(Intelledox.Common.ConstantValues.XTF_GUID)){objCurrentObject=new Design.Page(Design.GeneralFunctions.NewGuid())}else{objCurrentObject=new Design.Page(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_GUID))}}objCurrentObject.ID=parseInt(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_ID),10);this.m_Wizard.Pages.push(objCurrentObject);this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case Intelledox.Common.ConstantValues.XTF_QUESTION:objCurrentObject=Design.QuestionFactory.Create(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_GUID),parseInt(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_TYPEID),10));objCurrentObject.ID=parseInt(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_ID),10);if(projectObject instanceof Design.Page){objCurrentObject.Page=projectObject;projectObject.Questions.push(objCurrentObject)}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case Intelledox.Common.ConstantValues.XTF_ANSWER:objCurrentObject=Design.AnswerFactory.Create(projectObject.QuestionTypeID);objCurrentObject.ID=parseInt(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_ID),10);objCurrentObject.AnswerGuid=xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_GUID);if(projectObject instanceof Design.Question){objCurrentObject.Question=projectObject;projectObject.Answers.push(objCurrentObject)}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"ContentItem":objCurrentObject=new QAWizard.Design.ContentItem;objCurrentObject.ContentItemGuid=Design.GeneralFunctions.NewGuid();if(projectObject instanceof Design.Answer){projectObject.ContentItems.push(objCurrentObject)}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"Bookmark":objCurrentObject=new Design.Placeholder;if(this.m_Wizard.Documents.length===1){objCurrentObject.DocumentGuid=this.m_Wizard.Documents[0].DocumentGuid}if(projectObject instanceof Design.Answer){projectObject.Placeholders.push(objCurrentObject)}else if(projectObject instanceof Design.FragmentDocument){projectObject.Placeholders.push(objCurrentObject)}else if(projectObject instanceof Design.FragmentOutput){projectObject.Placeholders.push(objCurrentObject)}else if(projectObject instanceof Design.DocumentTemplate){projectObject.Placeholders.push(objCurrentObject)}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case Intelledox.Common.ConstantValues.XTF_RESPONSEMETADATAFIELD:objCurrentObject=new Design.ResponseMetadataField;if(projectObject instanceof Design.Answer){projectObject.ResponseMetadataFields.push(objCurrentObject)}else if(projectObject instanceof Design.FragmentOutput){projectObject.ResponseMetadataFields.push(objCurrentObject)}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"MetadataElement":objCurrentObject=new Intelledox.Model.MetadataElement;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);this.m_Wizard.MetadataElements.push(objCurrentObject);break;case"RoutingOption":break;case Intelledox.Common.ConstantValues.XTF_ACTIONINPUT:objCurrentObject=new QAWizard.Design.ActionInput;objCurrentObject.TemplateGuid=this.m_Wizard.ProjectGuid;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);if(projectObject instanceof QAWizard.Design.Action){projectObject.ActionInputs.push(objCurrentObject)}else if(projectObject instanceof QAWizard.Design.ActionInput){if(projectObject.ChildInputs==null){projectObject.ChildInputs=[]}projectObject.ChildInputs.push(objCurrentObject)}break;case"Input":if(projectObject instanceof QAWizard.Design.CustomQuestion){objCurrentObject=new Intelledox.Model.RoutingOption;objCurrentObject.TemplateGuid=this.m_Wizard.ProjectGuid;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.Inputs.push(objCurrentObject)}else if(projectObject instanceof QAWizard.Design.Wizard){objCurrentObject=new QAWizard.Design.AvailableInput;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.AvailableInputs.push(objCurrentObject)}else if(projectObject instanceof QAWizard.Design.FragmentPage){objCurrentObject=new Intelledox.Model.RoutingOption;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.Inputs.push(objCurrentObject)}else if(projectObject instanceof QAWizard.Design.FragmentReference){objCurrentObject=new Intelledox.Model.RoutingOption;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.Inputs.push(objCurrentObject)}break;case"Output":if(projectObject instanceof QAWizard.Design.Wizard){objCurrentObject=new Design.AvailableOutput;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.AvailableOutputs.push(objCurrentObject)}else if(projectObject instanceof QAWizard.Design.FragmentPage){objCurrentObject=new Design.FragmentOutput(projectObject);this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.Outputs.push(objCurrentObject)}else if(projectObject instanceof QAWizard.Design.FragmentReference){objCurrentObject=new Design.FragmentOutput(projectObject);this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.Outputs.push(objCurrentObject)}break;case Intelledox.Common.ConstantValues.XTF_LAYOUT:objCurrentObject=projectObject.Children;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject,currentPage||projectObject);break;case Intelledox.Common.ConstantValues.XTF_CONTROL:projectObject.push(currentPage.QuestionByGuid(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_GUID)));break;case Intelledox.Common.ConstantValues.XTF_SECTION:objCurrentObject=new QAWizard.Design.Section;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject,currentPage);projectObject.push(objCurrentObject);break;case Intelledox.Common.ConstantValues.XTF_COLUMN:objCurrentObject=new QAWizard.Design.Column;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject,currentPage);projectObject.Columns.push(objCurrentObject);break;case Intelledox.Common.ConstantValues.XTF_TABGROUP:objCurrentObject=new QAWizard.Design.TabGroup;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject,currentPage);projectObject.push(objCurrentObject);break;case Intelledox.Common.ConstantValues.XTF_TABPAGE:objCurrentObject=new QAWizard.Design.TabPage;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject,currentPage);projectObject.TabPages.push(objCurrentObject);break;case Intelledox.Common.ConstantValues.XTF_FRAGMENT:objCurrentObject=new QAWizard.Design.FragmentReference;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject,currentPage);projectObject.push(objCurrentObject);break;case"Conditions":case"VisibleConditions":case"EditableConditions":case"RepeatConditions":case"MandatoryConditions":case"ExcludedPages":this.ExtractNode(xmlTraverseNode,projectObject,parent);break;case"ValidationRules":if(projectObject!=null){if(projectObject instanceof Design.ValidationQuestion){this.ExtractNode(xmlTraverseNode,projectObject,parent)}else{if(projectObject instanceof Design.Question){objCurrentObject=projectObject.Validations}else if(projectObject instanceof Design.Answer){objCurrentObject=projectObject.Validations}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject)}}break;case"Rule":if(projectObject instanceof Array){objCurrentObject=new Design.ValidationRule(Intelledox.Model.ClauseType.Comparison);objCurrentObject.Id=(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_ID));projectObject.push(objCurrentObject)}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"Rules":this.ExtractNode(xmlTraverseNode,projectObject,parent);break;case"Filters":this.ExtractNode(xmlTraverseNode,projectObject,parent);break;case"Cond":case"Or":case"And":case"alRule":case"vqRule":case"Filter":if(projectObject instanceof Design.Rule||(projectObject instanceof Design.Answer&&projectObject.Question.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.AutoLogic)){objCurrentObject=new Design.Rule;switch(xmlTraverseNode.nodeName){case"And":objCurrentObject.Type=Intelledox.Model.ClauseType.AllOf;break;case"Or":objCurrentObject.Type=Intelledox.Model.ClauseType.AnyOf;break;default:objCurrentObject.Type=Intelledox.Model.ClauseType.Comparison;break}if(projectObject instanceof Design.Rule){projectObject.Add(objCurrentObject)}else if(projectObject instanceof Design.AutoLogicAnswer){projectObject.Rules=objCurrentObject}}else if(projectObject instanceof Design.Filter||(projectObject instanceof Design.Question&&projectObject.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Datasource&&xmlTraverseNode.parentNode.nodeName==="Filters")){objCurrentObject=new Design.Filter;switch(xmlTraverseNode.nodeName){case"And":objCurrentObject.Type=Intelledox.Model.ClauseType.AllOf;break;case"Or":objCurrentObject.Type=Intelledox.Model.ClauseType.AnyOf;break;default:objCurrentObject.Type=Intelledox.Model.ClauseType.Comparison;break}if(projectObject instanceof Design.Filter){objCurrentObject.Question=projectObject.Question;projectObject.Add(objCurrentObject)}else if(projectObject instanceof Design.DatasourceQuestion){objCurrentObject.Question=projectObject;projectObject.Filters=objCurrentObject}}else if(projectObject instanceof Design.ValidationRule||(projectObject instanceof Design.ValidationQuestion&&xmlTraverseNode.parentNode.nodeName==="ValidationRules")){objCurrentObject=new Design.ValidationRule;switch(xmlTraverseNode.nodeName){case"And":objCurrentObject.Type=Intelledox.Model.ClauseType.AllOf;break;case"Or":objCurrentObject.Type=Intelledox.Model.ClauseType.AnyOf;break;default:objCurrentObject.Type=Intelledox.Model.ClauseType.Comparison;break}if(projectObject instanceof Design.ValidationQuestion){projectObject.ValidationRule=objCurrentObject}else{projectObject.Add(objCurrentObject)}}else{objCurrentObject=new Design.Condition;switch(xmlTraverseNode.nodeName){case"And":objCurrentObject.Type=Intelledox.Model.ClauseType.AllOf;break;case"Or":objCurrentObject.Type=Intelledox.Model.ClauseType.AnyOf;break;default:objCurrentObject.Type=Intelledox.Model.ClauseType.Comparison;break}if(projectObject instanceof Design.Condition){projectObject.Add(objCurrentObject)}else if(projectObject instanceof Design.Question&&xmlTraverseNode.parentNode.nodeName==="VisibleConditions"){projectObject.VisibleConditions=objCurrentObject}else if(projectObject instanceof Design.Question&&xmlTraverseNode.parentNode.nodeName==="EditableConditions"){projectObject.EditableConditions=objCurrentObject}else if(projectObject instanceof Design.Question&&xmlTraverseNode.parentNode.nodeName==="MandatoryConditions"){projectObject.MandatoryConditions=objCurrentObject}else if(projectObject instanceof Design.TabGroup&&xmlTraverseNode.parentNode.nodeName==="VisibleConditions"){projectObject.VisibleConditions=objCurrentObject}else if(projectObject instanceof Design.TabGroup&&xmlTraverseNode.parentNode.nodeName==="EditableConditions"){projectObject.EditableConditions=objCurrentObject}else if(projectObject instanceof Design.TabPage&&xmlTraverseNode.parentNode.nodeName==="VisibleConditions"){projectObject.VisibleConditions=objCurrentObject}else if(projectObject instanceof Design.TabPage&&xmlTraverseNode.parentNode.nodeName==="EditableConditions"){projectObject.EditableConditions=objCurrentObject}else if(projectObject instanceof Design.Section&&xmlTraverseNode.parentNode.nodeName==="VisibleConditions"){projectObject.VisibleConditions=objCurrentObject}else if(projectObject instanceof Design.Section&&xmlTraverseNode.parentNode.nodeName==="EditableConditions"){projectObject.EditableConditions=objCurrentObject}else if(projectObject instanceof Design.Section&&xmlTraverseNode.parentNode.nodeName==="RepeatConditions"){projectObject.RepeatConditions=objCurrentObject}else if(projectObject instanceof Design.Column&&xmlTraverseNode.parentNode.nodeName==="VisibleConditions"){projectObject.VisibleConditions=objCurrentObject}else if(projectObject instanceof Design.Column&&xmlTraverseNode.parentNode.nodeName==="EditableConditions"){projectObject.EditableConditions=objCurrentObject}else if(projectObject instanceof Design.FragmentReference&&xmlTraverseNode.parentNode.nodeName==="VisibleConditions"){projectObject.VisibleConditions=objCurrentObject}else if(projectObject instanceof Design.FragmentReference&&xmlTraverseNode.parentNode.nodeName==="EditableConditions"){projectObject.EditableConditions=objCurrentObject}else if(projectObject instanceof Design.Question){projectObject.ActiveConditions=objCurrentObject}else if(projectObject instanceof Design.TabGroup){projectObject.ActiveConditions=objCurrentObject}else if(projectObject instanceof Design.TabPage){projectObject.ActiveConditions=objCurrentObject}else if(projectObject instanceof Design.Section){projectObject.ActiveConditions=objCurrentObject}else if(projectObject instanceof Design.Column){projectObject.ActiveConditions=objCurrentObject}else if(projectObject instanceof Design.FragmentReference){projectObject.ActiveConditions=objCurrentObject}else if(projectObject instanceof Design.Page&&xmlTraverseNode.parentNode.nodeName==="VisibleConditions"){projectObject.VisibleConditions=objCurrentObject}else if(projectObject instanceof Design.Page&&xmlTraverseNode.parentNode.nodeName==="EditableConditions"){projectObject.EditableConditions=objCurrentObject}else if(projectObject instanceof Design.Page&&xmlTraverseNode.parentNode.nodeName==="RepeatConditions"){projectObject.RepeatConditions=objCurrentObject}else if(projectObject instanceof Design.Page){projectObject.ActiveConditions=objCurrentObject}else if(projectObject instanceof Design.Answer){projectObject.ActiveConditions=objCurrentObject}else if(projectObject instanceof Design.DocumentTemplate){projectObject.Conditions=objCurrentObject}else if(projectObject instanceof Design.StateTransition){projectObject.Conditions=objCurrentObject}else if(projectObject instanceof Design.Escalation){projectObject.Conditions=objCurrentObject}else if(projectObject instanceof Intelledox.QAWizard.Design.Action){projectObject.Conditions=objCurrentObject}else if(projectObject instanceof Design.Wizard){this.m_Wizard.FinishPageConditions=objCurrentObject}}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"DisplayField":objCurrentObject=new Intelledox.Model.DisplayField;if(projectObject instanceof Design.DatasourceQuestion){projectObject.HasCustomDisplayFields=true;projectObject.DisplayFields.push(objCurrentObject)}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"SortField":objCurrentObject=new Intelledox.Model.SortField;if(projectObject instanceof Design.DatasourceQuestion){projectObject.SortFields.push(objCurrentObject)}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"ChartProperties":objCurrentObject=new Design.ChartProperties;if(projectObject instanceof Design.ChartQuestion){projectObject.Chart=objCurrentObject}this.ExtractNode(xmlTraverseNode,projectObject.Chart,projectObject);break;case"Series":objCurrentObject=new Design.Series;if(projectObject instanceof Design.ChartProperties){projectObject.Series.push(objCurrentObject);if(xmlTraverseNode.parentNode.getAttribute("ChartType")!=null){projectObject.Series[0].ChartType=parseInt(xmlTraverseNode.parentNode.getAttribute("ChartType"),10)}}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"Legend":objCurrentObject=new Design.Legend;if(projectObject instanceof Design.ChartProperties){projectObject.Legend=objCurrentObject}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"ChartArea":objCurrentObject=new Design.ChartArea;if(projectObject instanceof Design.ChartProperties){projectObject.ChartArea=objCurrentObject}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"AxisX":objCurrentObject=new Design.Axis;if(projectObject instanceof Design.ChartProperties){projectObject.AxisX=objCurrentObject}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"AxisY":objCurrentObject=new Design.Axis;if(projectObject instanceof Design.ChartProperties){projectObject.AxisY=objCurrentObject}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);break;case"FinishTitle":this.m_Wizard.FinishTitle=xmlTraverseNode.textContent;break;case"FinishPageVisible":this.m_Wizard.FinishPageVisible=Design.GeneralFunctions.ToBool(xmlTraverseNode.textContent);break;case"GenerateButtonText":this.m_Wizard.GenerateButtonText=xmlTraverseNode.textContent;break;case"GeneratingText":this.m_Wizard.GeneratingText=xmlTraverseNode.textContent;break;case"AllowDocumentDownload":this.m_Wizard.AllowDocumentDownload=Design.GeneralFunctions.ToBool(xmlTraverseNode.textContent);break;case Intelledox.Common.ConstantValues.XTF_DOWNLOADABLEDOCUMENTS:this.m_Wizard.DownloadableDocuments=xmlTraverseNode.textContent;break;case Intelledox.Common.ConstantValues.XTF_REDIRECTTOHOME:this.m_Wizard.RedirectToHome=Design.GeneralFunctions.ToBool(xmlTraverseNode.textContent);break;case Intelledox.Common.ConstantValues.XTF_WAITFORPROJECT:this.m_Wizard.WaitForProject=Design.GeneralFunctions.ToBool(xmlTraverseNode.textContent);break;case Intelledox.Common.ConstantValues.XTF_ONLINEREDIRECTMESSAGE:this.m_Wizard.OnlineRedirectMessage=xmlTraverseNode.textContent;break;case Intelledox.Common.ConstantValues.XTF_OFFLINEREDIRECTMESSAGE:this.m_Wizard.OfflineRedirectMessage=xmlTraverseNode.textContent;break;case"DownloadPageTitle":this.m_Wizard.DownloadPageTitle=xmlTraverseNode.textContent;break;case"InvalidProjectText":this.m_Wizard.InvalidProjectText=xmlTraverseNode.textContent;break;case"GenerateButtonLocation":this.m_Wizard.GenerateButtonLocation=Design.GenerateButtonLocation[xmlTraverseNode.textContent];break;case"LiveRefresh":this.m_Wizard.LiveRefresh=Design.GeneralFunctions.ToBool(xmlTraverseNode.textContent);break;case"RefreshPeriod":this.m_Wizard.RefreshPeriod=parseInt(xmlTraverseNode.textContent,10);break;case"Action":objCurrentObject=new QAWizard.Design.Action;this.ExtractNode(xmlTraverseNode,objCurrentObject,null);if(projectObject instanceof Design.StateTransition){projectObject.Actions.push(objCurrentObject)}else if(projectObject instanceof Design.Action){projectObject.Children.push(objCurrentObject)}else if(projectObject instanceof Design.RunActionButtonQuestion){projectObject.Actions.push(objCurrentObject)}else{this.m_Wizard.Actions.push(objCurrentObject)}break;case"Workflow":this.m_Wizard.Workflow=new Design.Workflow;this.m_Wizard.Workflow.ParallelSectionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.ExtractNode(xmlTraverseNode,this.m_Wizard.Workflow,parent);break;case"State":if(projectObject instanceof QAWizard.Design.Workflow){if(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_ID)===Design.StartWorkflowState.FixedId){objCurrentObject=new Design.StartWorkflowState}else if(xmlTraverseNode.getAttribute(Intelledox.Common.ConstantValues.XTF_ID)===Design.FinishWorkflowState.FixedId){objCurrentObject=new Design.FinishWorkflowState}else{objCurrentObject=new Design.WorkflowState}this.ExtractNode(xmlTraverseNode,objCurrentObject,null);var currentWorkflowObject=projectObject;if(currentWorkflowObject.States==null){currentWorkflowObject.States=new Array}if(currentWorkflowObject.ParallelSectionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){objCurrentObject.ParallelSectionGuid=currentWorkflowObject.ParallelSectionGuid}currentWorkflowObject.States.push(objCurrentObject)}break;case"Transition":objCurrentObject=new Design.StateTransition;objCurrentObject.Conditions=new Design.Condition;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);if(projectObject.Transitions==null){projectObject.Transitions=new Array}projectObject.Transitions.push(objCurrentObject);break;case Intelledox.Common.ConstantValues.XTF_ESCALATION:objCurrentObject=new Design.Escalation;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.EscalationList.push(objCurrentObject);break;case Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUT:if(projectObject instanceof QAWizard.Design.Escalation){objCurrentObject=new QAWizard.Design.EscalationInput;objCurrentObject.TemplateGuid=this.m_Wizard.ProjectGuid;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.EscalationInputs.push(objCurrentObject)}break;case"Recurrence":objCurrentObject=new Intelledox.Model.RecurrencePattern;if(projectObject instanceof Design.Escalation){projectObject.Recurs=true;this.ExtractNode(xmlTraverseNode,projectObject.Recurrence,projectObject)}break;case"RepeatPlaceholder":if(projectObject instanceof Design.Page){this.ExtractNode(xmlTraverseNode,projectObject.RepeatPlaceholders,parent)}else if(projectObject instanceof Design.Section){this.ExtractNode(xmlTraverseNode,projectObject.RepeatPlaceholders,parent)}else if(projectObject instanceof Design.DatasourceQuestion){this.ExtractNode(xmlTraverseNode,projectObject.RepeatPlaceholders,parent)}break;case"Document":if(projectObject instanceof QAWizard.Design.Action){objCurrentObject=new Intelledox.Model.ActionDocument;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.CustomDocuments.push(objCurrentObject)}break;case"FragmentDocument":if(projectObject instanceof QAWizard.Design.FragmentPage){objCurrentObject=new Design.FragmentDocument;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.Documents.push(objCurrentObject)}else if(projectObject instanceof QAWizard.Design.FragmentReference){objCurrentObject=new Design.FragmentDocument;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.Documents.push(objCurrentObject)}break;case"AvailableInputs":this.ExtractNode(xmlTraverseNode,this.m_Wizard,null);break;case"AvailableOutputs":this.ExtractNode(xmlTraverseNode,this.m_Wizard,null);break;case Intelledox.Common.ConstantValues.XTF_PROTECTEDFIELD:objCurrentObject=new Design.ProtectedField;this.ExtractNode(xmlTraverseNode,objCurrentObject,null);this.m_Wizard.ProtectedFields.push(objCurrentObject);break;case"Parallel":if(projectObject instanceof QAWizard.Design.Workflow){objCurrentObject=new QAWizard.Design.Workflow;objCurrentObject.States=new Array;this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);projectObject.ParallelSections.push(objCurrentObject)}break;case Intelledox.Common.ConstantValues.XTF_TRANSLATION:objCurrentObject=new Design.LanguageTranslation;var description=xmlTraverseNode.parentNode.localName;xmlTraverseNode.setAttribute("Trans_Description",description);switch(description){case Intelledox.Common.ConstantValues.XTF_BOOKMARKGROUP:case Intelledox.Common.ConstantValues.XTF_QUESTION:case Intelledox.Common.ConstantValues.XTF_ANSWER:case Intelledox.Common.ConstantValues.XTF_SECTION:case Intelledox.Common.ConstantValues.XTF_COLUMN:case Intelledox.Common.ConstantValues.XTF_TABPAGE:{xmlTraverseNode.setAttribute(Intelledox.Common.ConstantValues.XTF_TRANSLATIONGUID,xmlTraverseNode.parentNode.attributes.getNamedItem(Intelledox.Common.ConstantValues.XTF_GUID).value);break}case Intelledox.Common.ConstantValues.XTF_STATE:case Intelledox.Common.ConstantValues.XTF_RULE:{xmlTraverseNode.setAttribute(Intelledox.Common.ConstantValues.XTF_TRANSLATIONGUID,xmlTraverseNode.parentNode.attributes.getNamedItem(Intelledox.Common.ConstantValues.XTF_ID).value);break}case Intelledox.Common.ConstantValues.XTF_TRANSITION:{xmlTraverseNode.setAttribute(Intelledox.Common.ConstantValues.XTF_TRANSLATIONGUID,xmlTraverseNode.parentNode.attributes.getNamedItem(Intelledox.Common.ConstantValues.XTF_STATEID).value+"|"+xmlTraverseNode.parentNode.parentNode.attributes.getNamedItem(Intelledox.Common.ConstantValues.XTF_ID).value);break}case Intelledox.Common.ConstantValues.XTF_HEADERINFO:case Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO:{xmlTraverseNode.setAttribute(Intelledox.Common.ConstantValues.XTF_TRANSLATIONGUID,this.m_Wizard.ProjectGuid);break}case Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUT:{xmlTraverseNode.setAttribute(Intelledox.Common.ConstantValues.XTF_TRANSLATIONGUID,xmlTraverseNode.parentNode.attributes.getNamedItem(Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUTGUID).value);break}case Intelledox.Common.ConstantValues.XTF_ACTIONINPUT:{xmlTraverseNode.setAttribute(Intelledox.Common.ConstantValues.XTF_TRANSLATIONGUID,xmlTraverseNode.parentNode.attributes.getNamedItem(Intelledox.Common.ConstantValues.XTF_ACTIONINPUTGUID).value);break}}this.ExtractNode(xmlTraverseNode,objCurrentObject,projectObject);this.m_Wizard.LanguageTranslations.push(objCurrentObject);break;case"Property":if(projectObject instanceof QAWizard.Design.StateTransition){objCurrentObject=new Design.AlterProperty;this.ExtractNode(xmlTraverseNode,objCurrentObject,null);projectObject.Properties.push(objCurrentObject)}else{objCurrentObject=new Design.ProjectProperty;this.ExtractNode(xmlTraverseNode,objCurrentObject,null);this.m_Wizard.Properties.push(objCurrentObject)}break;case"ExcludedPage":if(projectObject instanceof QAWizard.Design.SummaryQuestion){if(projectObject.Settings.ExcludedPages==null){projectObject.Settings.ExcludedPages=[]}projectObject.Settings.ExcludedPages.push(xmlTraverseNode.textContent)}break;case"XmlInfo":case"LayoutId":case"TemplateVersion":case"DynamicParent":case"ContentDefinition":break}}};WizardController.prototype.SetLayout=function(){for(var index=0;index<this.m_Wizard.Pages.length;index++){var g=this.m_Wizard.Pages[index];if(g.Children.length===0&&g.Questions.length>0){for(var questionIndex=0;questionIndex<g.Questions.length;questionIndex++){g.Children.push(g.Questions[questionIndex])}}}};WizardController.prototype.SerializeProject=function(source){var xmlRootElement=null;var xmlElement=null;var xmlPage=null;var writeLayoutNode=false;var xmlDOM=(new DOMParser).parseFromString("<Intelledox_TemplateFile />",'text/xml');var multiDoc=(source.Documents.length>1);xmlRootElement=xmlDOM.documentElement;xmlRootElement.setAttribute("version",Intelledox.Common.ConstantValues.XTFFILE_VERSION);xmlElement=xmlDOM.createElement("HeaderInfo");xmlElement.appendChild(xmlDOM.createElement("TemplateGuid")).appendChild(xmlDOM.createTextNode(source.ProjectGuid));xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_NAME)).appendChild(xmlDOM.createTextNode(source.Name));xmlElement.appendChild(xmlDOM.createElement("TemplateTypeId")).appendChild(xmlDOM.createTextNode(source.TypeId.toString()));if(source.Compatibility!==Design.CompatibilityLevel.Version2001){xmlElement.appendChild(xmlDOM.createElement("Compatibility")).appendChild(xmlDOM.createTextNode(source.Compatibility.toString()))}if(source.ContentPlaceholder==null){xmlElement.appendChild(xmlDOM.createElement("ContentBookmark")).appendChild(xmlDOM.createTextNode(""))}else{xmlElement.appendChild(xmlDOM.createElement("ContentBookmark")).appendChild(xmlDOM.createTextNode(source.ContentPlaceholder.name));if(source.ContentPlaceholder.type!==Intelledox.Model.PlaceholderType.Bookmark){xmlElement.appendChild(xmlDOM.createElement("ContentBookmarkType")).appendChild(xmlDOM.createTextNode(source.ContentPlaceholder.type.toString()))}}xmlElement.appendChild(xmlDOM.createElement("LayoutQuestionsFirst")).appendChild(xmlDOM.createTextNode(Design.GeneralFunctions.FromBool(source.LayoutQuestionsFirst)));if(!System.String.IsNullOrEmpty(source.DefaultAnswerFileName)){xmlElement.appendChild(xmlDOM.createElement("DefaultAnswerFileName")).appendChild(xmlDOM.createTextNode(source.DefaultAnswerFileName))}if(!System.String.IsNullOrEmpty(source.DefaultInProgressFileName)){xmlElement.appendChild(xmlDOM.createElement("DefaultInProgressFileName")).appendChild(xmlDOM.createTextNode(source.DefaultInProgressFileName))}if(source.TemporaryUserSaveSettings.AccessCodeGeneration!==Intelledox.Model.AccessCodeGeneration.None){xmlElement.appendChild(xmlDOM.createElement("AnonSaveAccessGen")).appendChild(xmlDOM.createTextNode(source.TemporaryUserSaveSettings.AccessCodeGeneration.toString()))}if(source.TemporaryUserSaveSettings.AccessCodeGeneration!==Intelledox.Model.AccessCodeGeneration.None){if(source.TemporaryUserSaveSettings.AccessCodeGenerationQuestion!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlElement.appendChild(xmlDOM.createElement("AnonSaveAccessGenQ")).appendChild(xmlDOM.createTextNode(source.TemporaryUserSaveSettings.AccessCodeGenerationQuestion))}if(source.TemporaryUserSaveSettings.AccessCodeGenerationAnswer!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlElement.appendChild(xmlDOM.createElement("AnonSaveAccessGenA")).appendChild(xmlDOM.createTextNode(source.TemporaryUserSaveSettings.AccessCodeGenerationAnswer))}if(!System.String.IsNullOrEmpty(source.TemporaryUserSaveSettings.HelpText)){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_ANONSAVEHELPTEXT)).appendChild(xmlDOM.createTextNode(source.TemporaryUserSaveSettings.HelpText))}if(!System.String.IsNullOrEmpty(source.TemporaryUserSaveSettings.EmailTo)){xmlElement.appendChild(xmlDOM.createElement("AnonSaveEmailTo")).appendChild(xmlDOM.createTextNode(source.TemporaryUserSaveSettings.EmailTo))}if(!System.String.IsNullOrEmpty(source.TemporaryUserSaveSettings.EmailSubject)){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_ANONSAVEEMAILSUBJECT)).appendChild(xmlDOM.createTextNode(source.TemporaryUserSaveSettings.EmailSubject))}if(!System.String.IsNullOrEmpty(source.TemporaryUserSaveSettings.EmailBody)){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_ANONSAVEEMAILBODY)).appendChild(xmlDOM.createTextNode(source.TemporaryUserSaveSettings.EmailBody))}if(!System.String.IsNullOrEmpty(source.TemporaryUserSaveSettings.ResumeText)){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_ANONSAVERESUMETEXT)).appendChild(xmlDOM.createTextNode(source.TemporaryUserSaveSettings.ResumeText))}if(!System.String.IsNullOrEmpty(source.TemporaryUserSaveSettings.ReassignText)){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_ANONREASSIGNTEXT)).appendChild(xmlDOM.createTextNode(source.TemporaryUserSaveSettings.ReassignText))}if(!System.String.IsNullOrEmpty(source.TemporaryUserSaveSettings.RecipientName)){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_ANONRECIPIENTNAMETEXT)).appendChild(xmlDOM.createTextNode(source.TemporaryUserSaveSettings.RecipientName))}}xmlRootElement.appendChild(xmlElement);xmlElement=xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_WIZARDINFO);if(source.Properties.length>0){var xmlProperties=xmlDOM.createElement("Properties");for(var propIndex=0;propIndex<source.Properties.length;propIndex++){var property=source.Properties[propIndex];var xmlProp=xmlDOM.createElement("Property");xmlProp.setAttribute("Id",property.Id);xmlProp.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,property.Name);xmlProp.setAttribute("Value",property.InitialValue);xmlProperties.appendChild(xmlProp)}xmlElement.appendChild(xmlProperties)}for(var pageIndex=0;pageIndex<source.Pages.length;pageIndex++){var page=source.Pages[pageIndex];xmlPage=xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_BOOKMARKGROUP);xmlPage.setAttribute(Intelledox.Common.ConstantValues.XTF_ID,page.ID.toString());xmlPage.setAttribute(Intelledox.Common.ConstantValues.XTF_GUID,page.PageGuid);xmlPage.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,page.Name);if(page.CssStyle!==""&&page.CssStyle!==null){xmlPage.setAttribute("CssClass",page.CssStyle)}if(page.Summary!=null){if(page.Summary.Include!==null){xmlPage.setAttribute("Include",Design.GeneralFunctions.FromBool(page.Summary.Include))}if(page.Summary.Collapsible!==null){xmlPage.setAttribute("Collapsible",Design.GeneralFunctions.FromBool(page.Summary.Collapsible))}if(!System.String.IsNullOrEmpty(page.Summary.Title)){xmlPage.setAttribute("OverrideTitle",page.Summary.Title)}}if(page instanceof Design.FragmentPage){xmlPage.setAttribute(Intelledox.Common.ConstantValues.XTF_PROJECTGUID,page.ProjectGuid);this.AddFragmentInputsNode(xmlDOM,xmlPage,page.Inputs);this.AddFragmentDocumentsNode(xmlDOM,xmlPage,page.Documents,multiDoc);this.AddFragmentOutputsNode(xmlDOM,xmlPage,page.Outputs,multiDoc)}writeLayoutNode=false;for(var qanodeIndex=0;qanodeIndex<page.Children.length;qanodeIndex++){var qaNode=page.Children[qanodeIndex];if(!(qaNode instanceof Design.Question)){writeLayoutNode=true;break}}var xmlLayout=this.CreateXtfLayoutContainer(page,xmlDOM,multiDoc,xmlPage,source);if(writeLayoutNode){xmlPage.appendChild(xmlLayout)}this.AddConditionsNode(xmlDOM,xmlPage,page.ActiveConditions);this.AddConditionsNode(xmlDOM,xmlPage,page.VisibleConditions,"VisibleConditions");this.AddConditionsNode(xmlDOM,xmlPage,page.EditableConditions,"EditableConditions");if(page.IsRepeated){this.AddConditionsNode(xmlDOM,xmlPage,page.RepeatConditions,"RepeatConditions");xmlPage.setAttribute(Intelledox.Common.ConstantValues.XTF_REPEATED,"True");xmlPage.setAttribute("RepeatTitle",page.RepeatTitle);if(!System.String.IsNullOrEmpty(page.MaximumRepeats)){xmlPage.setAttribute("Maximum",page.MaximumRepeats)}if(!System.String.IsNullOrEmpty(page.MinimumRepeats)){xmlPage.setAttribute("Minimum",page.MinimumRepeats)}if(!System.String.IsNullOrEmpty(page.RepeatName)){xmlPage.setAttribute(Intelledox.Common.ConstantValues.XTF_REPEATNAME,page.RepeatName)}if(!page.AllowSorting){xmlPage.setAttribute("AllowSorting","False")}if(page.CreateMinimumRepeats){xmlPage.setAttribute("CreateMinimum","True")}if(page.RepeatSourceType!==Design.RepeatSourceType.None){xmlPage.setAttribute("RepeatSourceType",page.RepeatSourceType.toString());xmlPage.setAttribute("RepeatSourceGuid",page.RepeatSourceGuid);if(page.RepeatSourceAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlPage.setAttribute("RepeatSourceAttributeGuid",page.RepeatSourceAttributeGuid)}if(!page.IsEditableDrivenRepeat){xmlPage.setAttribute("IsEditableDrivenRepeat","False")}}else{if(page.ShowFillDownButton){xmlPage.setAttribute("ShowFillDown","True")}}if(page.RepeatPlaceholders.length>0){this.CreateRepeatPlaceholders(xmlDOM,xmlPage,page.RepeatPlaceholders)}}xmlElement.appendChild(xmlPage)}xmlRootElement.appendChild(xmlElement);if(source.MetadataElements!=null&&source.MetadataElements.length>0){xmlElement=xmlDOM.createElement("MetadataInfo");for(var metaIndex=0;metaIndex<source.MetadataElements.length;metaIndex++){var metaElement=source.MetadataElements[metaIndex];var xmlMetaElement=xmlDOM.createElement("MetadataElement");xmlMetaElement.setAttribute("MetadataGuid",metaElement.MetadataGuid);xmlMetaElement.setAttribute("MetadataName",metaElement.Name);xmlMetaElement.setAttribute("MetadataTypeId",metaElement.ElementTypeId.toString());xmlMetaElement.setAttribute("MetadataText",metaElement.FixedValue);xmlMetaElement.setAttribute("MetadataAnswerGuid",metaElement.AnswerGuid);xmlElement.appendChild(xmlMetaElement)}xmlRootElement.appendChild(xmlElement)}xmlElement=xmlDOM.createElement("CompletionInfo");if(source.FinishTitle!==Design.Resources.Strings.DefaultFinishTitle){xmlElement.appendChild(xmlDOM.createElement("FinishTitle")).appendChild(xmlDOM.createTextNode(source.FinishTitle))}if(!source.FinishPageVisible){xmlElement.appendChild(xmlDOM.createElement("FinishPageVisible")).appendChild(xmlDOM.createTextNode("0"))}if(source.GenerateButtonText!==Design.Resources.Strings.FormDefaultGenerateButtonText){xmlElement.appendChild(xmlDOM.createElement("GenerateButtonText")).appendChild(xmlDOM.createTextNode(source.GenerateButtonText))}if(source.Documents.length===0){if(source.GeneratingText!==Design.Resources.Strings.FormDefaultGeneratingText){xmlElement.appendChild(xmlDOM.createElement("GeneratingText")).appendChild(xmlDOM.createTextNode(source.GeneratingText))}if(source.DownloadPageTitle!==Design.Resources.Strings.FormDefaultDownloadPageTitle){xmlElement.appendChild(xmlDOM.createElement("DownloadPageTitle")).appendChild(xmlDOM.createTextNode(source.DownloadPageTitle))}}else{if(source.GeneratingText!==Design.Resources.Strings.DefaultGeneratingText){xmlElement.appendChild(xmlDOM.createElement("GeneratingText")).appendChild(xmlDOM.createTextNode(source.GeneratingText))}if(source.DownloadPageTitle!==Design.Resources.Strings.DefaultDownloadPageTitle){xmlElement.appendChild(xmlDOM.createElement("DownloadPageTitle")).appendChild(xmlDOM.createTextNode(source.DownloadPageTitle))}}if(!source.AllowDocumentDownload){xmlElement.appendChild(xmlDOM.createElement("AllowDocumentDownload")).appendChild(xmlDOM.createTextNode("0"))}if(source.RedirectToHome){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_REDIRECTTOHOME)).appendChild(xmlDOM.createTextNode("1"));if(!source.WaitForProject){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_WAITFORPROJECT)).appendChild(xmlDOM.createTextNode("0"))}if(source.OnlineRedirectMessage!==Design.Resources.Strings.DefaultOnlineRedirectMessage){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_ONLINEREDIRECTMESSAGE)).appendChild(xmlDOM.createTextNode(source.OnlineRedirectMessage))}if(source.OfflineRedirectMessage!==Design.Resources.Strings.FormQueueMessage){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_OFFLINEREDIRECTMESSAGE)).appendChild(xmlDOM.createTextNode(source.OfflineRedirectMessage))}}if(source.InvalidProjectText!==Design.Resources.Strings.DefaultInvalidProjectText){xmlElement.appendChild(xmlDOM.createElement("InvalidProjectText")).appendChild(xmlDOM.createTextNode(source.InvalidProjectText))}if(source.GenerateButtonLocation!==Design.GenerateButtonLocation.BottomMiddle_Default){xmlElement.appendChild(xmlDOM.createElement("GenerateButtonLocation")).appendChild(xmlDOM.createTextNode(source.GenerateButtonLocation.toString()))}if(source.LiveRefresh){xmlElement.appendChild(xmlDOM.createElement("LiveRefresh")).appendChild(xmlDOM.createTextNode("True"));xmlElement.appendChild(xmlDOM.createElement("RefreshPeriod")).appendChild(xmlDOM.createTextNode(source.RefreshPeriod.toString()))}if(source.DownloadableDocuments!=="ALL"){xmlElement.appendChild(xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_DOWNLOADABLEDOCUMENTS)).appendChild(xmlDOM.createTextNode(source.DownloadableDocuments))}this.AddConditionsNode(xmlDOM,xmlElement,source.FinishPageConditions);xmlRootElement.appendChild(xmlElement);this.CreateActions(xmlDOM,xmlRootElement,source.Actions);if(source.TypeId===Intelledox.Model.ProjectType.FragmentPage||source.TypeId===Intelledox.Model.ProjectType.FragmentPortion){if(source.AvailableInputs.length>0){xmlElement=xmlDOM.createElement("AvailableInputs");for(var availableInputIndex=0;availableInputIndex<source.AvailableInputs.length;availableInputIndex++){var availableInput=(source.AvailableInputs[availableInputIndex]);var inputElement=xmlDOM.createElement("Input");inputElement.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,availableInput.description);inputElement.setAttribute("Id",availableInput.routingElementTypeId.toString());if(availableInput.valueType===Intelledox.Model.ValueTypes.Repeat){inputElement.setAttribute("ValueType",availableInput.valueType.toString())}else if(!System.String.IsNullOrEmpty(availableInput.DefaultValue)){inputElement.setAttribute("DefaultValue",availableInput.DefaultValue)}xmlElement.appendChild(inputElement)}xmlRootElement.appendChild(xmlElement)}if(source.AvailableOutputs.length>0){xmlElement=xmlDOM.createElement("AvailableOutputs");for(var availableOutputIndex=0;availableOutputIndex<source.AvailableOutputs.length;availableOutputIndex++){var output=source.AvailableOutputs[availableOutputIndex];var outputElement=xmlDOM.createElement("Output");outputElement.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,output.Name);outputElement.setAttribute("OutputGuid",output.RoutingOptionGuid);outputElement.setAttribute("OutputSourceTypeId",output.SourceType.toString());if(output.SourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){outputElement.setAttribute("OutputQuestionGuid",output.SourceGuid)}if(output.SourceAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){outputElement.setAttribute("OutputAnswerGuid",output.SourceAttributeGuid)}if(!System.String.IsNullOrEmpty(output.FieldName)){outputElement.setAttribute("OutputFieldName",output.FieldName)}if(!System.String.IsNullOrEmpty(output.FixedValue)){outputElement.setAttribute("OutputFixedValue",output.FixedValue)}xmlElement.appendChild(outputElement)}xmlRootElement.appendChild(xmlElement)}}if(source.Workflow!=null&&source.Workflow.States!=null){xmlElement=xmlDOM.createElement("Workflow");for(var stateIndex=0;stateIndex<source.Workflow.States.length;stateIndex++){xmlElement.appendChild(this.CreateStateNode(xmlDOM,source.Workflow.States[stateIndex]))}for(var parallelIndex=0;parallelIndex<source.Workflow.ParallelSections.length;parallelIndex++){xmlElement.appendChild(this.CreateParallelNode(xmlDOM,source.Workflow.ParallelSections[parallelIndex]))}xmlRootElement.appendChild(xmlElement)}xmlElement=xmlDOM.createElement("ProtectedFields");this.CreateProtectedFields(xmlDOM,xmlElement,source.ProtectedFields);xmlRootElement.appendChild(xmlElement);xmlElement=xmlDOM.createElement("BinaryInfo");for(var templateIndex=0;templateIndex<source.Documents.length;templateIndex++){var doc=source.Documents[templateIndex];var xmlBinaryElement=xmlDOM.createElement("TemplateBinary");xmlBinaryElement.setAttribute("DocumentGuid",doc.DocumentGuid);xmlBinaryElement.setAttribute("DocumentName",doc.Name);xmlBinaryElement.setAttribute("FormatType",doc.FormatType.toString());xmlBinaryElement.setAttribute("FileName",doc.FileName);xmlBinaryElement.setAttribute("AllowNameChange",Design.GeneralFunctions.FromBool(doc.AllowNameChange));if(doc.Colour!==null){xmlBinaryElement.setAttribute("Colour",doc.Colour.toString())}if(doc.RepeatSourceType!==Design.RepeatSourceType.None){xmlBinaryElement.setAttribute("RepeatSourceType",doc.RepeatSourceType.toString());xmlBinaryElement.setAttribute("RepeatSourceGuid",doc.RepeatSourceGuid);if(doc.RepeatSourceAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlBinaryElement.setAttribute("RepeatSourceAttributeGuid",doc.RepeatSourceAttributeGuid)}}this.AddConditionsNode(xmlDOM,xmlBinaryElement,doc.Conditions);if(doc.HasPlaceholders){this.AddPlaceholderNode(xmlDOM,xmlBinaryElement,doc.Placeholders,multiDoc,source)}xmlElement.appendChild(xmlBinaryElement)}xmlRootElement.appendChild(xmlElement);for(var languageTranslationIndex=0;languageTranslationIndex<source.LanguageTranslations.length;languageTranslationIndex++){var languageTranslation=source.LanguageTranslations[languageTranslationIndex];var parentElement;switch(languageTranslation.description){case Intelledox.Common.ConstantValues.XTF_BOOKMARKGROUP:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_BOOKMARKGROUP+"["+Intelledox.Common.ConstantValues.XTF_GUID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_QUESTION:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_QUESTION+"["+Intelledox.Common.ConstantValues.XTF_GUID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_RULE:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_RULE+"["+Intelledox.Common.ConstantValues.XTF_ID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_ANSWER:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_ANSWER+"["+Intelledox.Common.ConstantValues.XTF_GUID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_SECTION:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_SECTION+"["+Intelledox.Common.ConstantValues.XTF_GUID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_COLUMN:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_COLUMN+"["+Intelledox.Common.ConstantValues.XTF_GUID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_TABPAGE:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_TABPAGE+"["+Intelledox.Common.ConstantValues.XTF_GUID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_STATE:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_STATE+"["+Intelledox.Common.ConstantValues.XTF_ID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_TRANSITION:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_STATE+"["+Intelledox.Common.ConstantValues.XTF_ID+"='"+languageTranslation.parentGuid+"']").querySelector(Intelledox.Common.ConstantValues.XTF_TRANSITION+"["+Intelledox.Common.ConstantValues.XTF_STATEID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUT:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUT+"["+Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUTGUID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_ACTIONINPUT:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_ACTIONINPUT+"["+Intelledox.Common.ConstantValues.XTF_ACTIONINPUTGUID+"='"+languageTranslation.controlGuid+"']");break;case Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_COMPLETIONINFO);break;case Intelledox.Common.ConstantValues.XTF_HEADERINFO:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_HEADERINFO);break;case Intelledox.Common.ConstantValues.XTF_DISPLAYFIELDCOLUMNTITLE:parentElement=xmlDOM.querySelector(Intelledox.Common.ConstantValues.XTF_QUESTION+"["+Intelledox.Common.ConstantValues.XTF_GUID+"='"+languageTranslation.controlGuid+"']");parentElement=parentElement.querySelector(Intelledox.Common.ConstantValues.XTF_DISPLAYFIELD+"["+Intelledox.Common.ConstantValues.XTF_NAME+"="+languageTranslation.parentGuid+"]");break}if(parentElement!=null){var xmlTranslationElement=xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_TRANSLATION);xmlTranslationElement.setAttribute(Intelledox.Common.ConstantValues.XTF_LANGUAGE,languageTranslation.lang);for(var key in languageTranslation.translations){xmlTranslationElement.setAttribute(key,languageTranslation.translations[key])}parentElement.appendChild(xmlTranslationElement)}}return xmlDOM};WizardController.prototype.SerializeQuestion=function(xmlDOM,oQuestion,multiDoc,source){var xmlAnswer;var xmlDisplayField;var xmlSortField;var xmlActive;var isStaticImage=false;isStaticImage=(oQuestion instanceof Design.ContentLibraryQuestion&&oQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.Image&&oQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.ExistingContentItem);var xmlQuestion=xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_QUESTION);xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_ID,oQuestion.ID.toString());xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_GUID,oQuestion.QuestionGuid);xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_TEXT,oQuestion.Text);xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_TYPEID,oQuestion.QuestionTypeID.toString());if(!System.String.IsNullOrEmpty(oQuestion.HelpText)&&!isStaticImage){xmlQuestion.setAttribute("HelpText",oQuestion.HelpText)}if(oQuestion.AllowComments){xmlQuestion.setAttribute("AllowComments",Design.GeneralFunctions.FromBool(oQuestion.AllowComments))}xmlQuestion.setAttribute("DisplayType",oQuestion.DisplayType.toString());if(oQuestion.SelectionType!==Intelledox.Model.SelectionType.Single){xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_SELECTIONTYPE,oQuestion.SelectionType.toString())}xmlQuestion.setAttribute("Visibility",Design.GeneralFunctions.FromBool(oQuestion.Visibility));if(oQuestion.Mandatory!==Design.MandatoryType.No&&!isStaticImage){xmlQuestion.setAttribute("Mandatory",oQuestion.Mandatory.toString())}if(oQuestion.RepeatParent!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlQuestion.setAttribute("RepeatParentGuid",oQuestion.RepeatParent)}if(!System.String.IsNullOrEmpty(oQuestion.Watermark)){xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_WATERMARK,oQuestion.Watermark)}if(oQuestion instanceof Design.DatasourceQuestion){if(oQuestion.DataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlQuestion.setAttribute("DataServiceGuid",oQuestion.DataSourceGuid)}if(oQuestion.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlQuestion.setAttribute("DataObjectGuid",oQuestion.DataObjectGuid)}if(oQuestion.DataObjectTypeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlQuestion.setAttribute("DataObjectTypeGuid",oQuestion.DataObjectTypeGuid)}if(!System.String.IsNullOrEmpty(oQuestion.DisplayField)){xmlQuestion.setAttribute("DisplayField",oQuestion.DisplayField)}if(!System.String.IsNullOrEmpty(oQuestion.AnswerDisplayField)&&oQuestion.DisplayField==="[Answer]"){xmlQuestion.setAttribute("AnswerDisplayField",oQuestion.AnswerDisplayField)}if(!System.String.IsNullOrEmpty(oQuestion.ValueField)){xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_VALUEFIELD,oQuestion.ValueField)}if(!System.String.IsNullOrEmpty(oQuestion.GroupingField)){xmlQuestion.setAttribute("GroupingField",oQuestion.GroupingField)}if(oQuestion.RepeatPlaceholders.length>0){this.CreateRepeatPlaceholders(xmlDOM,xmlQuestion,oQuestion.RepeatPlaceholders)}if(oQuestion.TextBoxWidth>0){xmlQuestion.setAttribute("Width",oQuestion.TextBoxWidth.toString())}if(oQuestion.ResultsPerPage>0&&oQuestion.ResultsPerPage!=20){xmlQuestion.setAttribute("ResultsPerPage",oQuestion.ResultsPerPage.toString())}if(!oQuestion.SearchAll){xmlQuestion.setAttribute("SearchAll","False")}if(oQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlQuestion.setAttribute("DataSourceHierarchyGuid",oQuestion.DataSourceHierarchyGuid)}if(!System.String.IsNullOrEmpty(oQuestion.DataSourceRepeatXPath)){xmlQuestion.setAttribute("DataSourceRepeatXPath",oQuestion.DataSourceRepeatXPath)}if(oQuestion.DefaultType!==Intelledox.Model.DefaultValueType.None){xmlQuestion.setAttribute("DefaultType",oQuestion.DefaultType.toString())}if(oQuestion.LiveRefresh){xmlQuestion.setAttribute("LiveRefresh","True");xmlQuestion.setAttribute("RefreshPeriod",oQuestion.RefreshPeriod.toString())}if(!System.String.IsNullOrEmpty(oQuestion.NoResultsMessage)){xmlQuestion.setAttribute("NoResultsMessage",oQuestion.NoResultsMessage)}}if(oQuestion instanceof Design.UserPromptQuestion){if(oQuestion.ValidationType===Intelledox.Model.ValidationType.Text){if(oQuestion.TextRows>0){xmlQuestion.setAttribute("TextRows",oQuestion.TextRows.toString())}}else{xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_VALIDATIONTYPE,oQuestion.ValidationType.toString())}if(oQuestion.MaxLength>0&&(oQuestion.ValidationType!==Intelledox.Model.ValidationType.Date)&&(oQuestion.ValidationType!==Intelledox.Model.ValidationType.Currency)){xmlQuestion.setAttribute("MaxLength",oQuestion.MaxLength.toString())}if(oQuestion.TextBoxWidth>0){xmlQuestion.setAttribute("Width",oQuestion.TextBoxWidth.toString())}if(oQuestion.IsRightAligned){if(oQuestion.ValidationType===Intelledox.Model.ValidationType.Numeric||oQuestion.ValidationType===Intelledox.Model.ValidationType.Currency){xmlQuestion.setAttribute("RightAligned",Design.GeneralFunctions.FromBool(oQuestion.IsRightAligned))}}if(oQuestion.DecimalPlaces!==2){xmlQuestion.setAttribute("DecimalPlaces",oQuestion.DecimalPlaces.toString())}if(oQuestion.CurrencyCode!=="$"){xmlQuestion.setAttribute("CurrencyCode",oQuestion.CurrencyCode)}if(oQuestion.CurrencySymbol!=="$"){xmlQuestion.setAttribute("CurrencySymbol",oQuestion.CurrencySymbol)}if(oQuestion.CurrencyPositivePattern!==0){xmlQuestion.setAttribute("PositivePattern",oQuestion.CurrencyPositivePattern.toString())}if(oQuestion.CurrencyNegativePattern!==1){xmlQuestion.setAttribute("NegativePattern",oQuestion.CurrencyNegativePattern.toString())}if(oQuestion.WeekdaysOnly){xmlQuestion.setAttribute("WeekdaysOnly","True")}}if((oQuestion.QuestionTypeID!==Design.QuestionType.QuestionTypeEnum.Label&&oQuestion.TextPosition!==Design.TextPosition.Top)||(oQuestion.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Label&&oQuestion.TextPosition!==Design.TextPosition.None)){xmlQuestion.setAttribute("TextPosition",Design.TextPosition[oQuestion.TextPosition]);if(oQuestion.TextPosition===Design.TextPosition.Left&&(oQuestion.WidthType!==Design.WidthType.Pixel||oQuestion.LeftQuestionWidth!==Intelledox.Common.ConstantValues.DEFAULTLEFTQUESTIONWIDTH_PIXELS)){xmlQuestion.setAttribute("WidthType",Design.WidthType[oQuestion.WidthType]);xmlQuestion.setAttribute("LQWidth",oQuestion.LeftQuestionWidth.toString())}}if((oQuestion.CssStyle!==""&&oQuestion.CssStyle!==null)){xmlQuestion.setAttribute("CssClass",oQuestion.CssStyle)}if(!System.String.IsNullOrEmpty(oQuestion.DefaultValue)){xmlQuestion.setAttribute("DefaultValue",oQuestion.DefaultValue)}if(oQuestion instanceof Design.GroupLogicQuestion){if(oQuestion.DefaultQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY&&oQuestion.DisplayType!==Intelledox.Model.QuestionDisplayType.MultiSelect&&oQuestion.DisplayType!==Intelledox.Model.QuestionDisplayType.MultiSelectToggleButton){xmlQuestion.setAttribute("DefaultQuestionReference",oQuestion.DefaultQuestionReference)}if(oQuestion.DisplayDirection!==Intelledox.Model.DisplayDirection.Vertical){xmlQuestion.setAttribute("DisplayDirection",oQuestion.DisplayDirection.toString())}}if(oQuestion instanceof Design.ContentLibraryQuestion){if(oQuestion.Visibility){if(oQuestion.AllowAddToContentLibrary){if(oQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.Upload||oQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.UploadOrSearch){if(oQuestion.AllowAddToContentLibrary){xmlQuestion.setAttribute("AllowAddToContentLibrary","True")}if(oQuestion.ContentFolder!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlQuestion.setAttribute("ContentFolder",oQuestion.ContentFolder)}if(!System.String.IsNullOrEmpty(oQuestion.ContentFolderName)){xmlQuestion.setAttribute("ContentFolderName",oQuestion.ContentFolderName)}}}if(oQuestion.ContentTypeRestriction!==Intelledox.Model.ContentType.None){xmlQuestion.setAttribute("ContentTypeRestriction",oQuestion.ContentTypeRestriction.toString())}if(oQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.ExistingContentItem){xmlQuestion.setAttribute("ContentItemGuid",oQuestion.ExistingContentItemGuid)}if(oQuestion.ContentFolderRestriction!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlQuestion.setAttribute("RestrictionFolder",oQuestion.ContentFolderRestriction)}if(!System.String.IsNullOrEmpty(oQuestion.ContentFolderRestrictionName)){xmlQuestion.setAttribute("RestrictionFolderName",oQuestion.ContentFolderRestrictionName)}if(oQuestion.AllowEdit){xmlQuestion.setAttribute("AllowEdit","True")}if(oQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.DocumentFragment&&oQuestion.KeepSourceFormatting){xmlQuestion.setAttribute("KeepSourceFormatting","True")}if(oQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.Attachment||oQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.Audio){if(!System.String.IsNullOrEmpty(oQuestion.AttachmentFileName)){xmlQuestion.setAttribute("AttachmentFileName",oQuestion.AttachmentFileName)}}if(oQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.Attachment||oQuestion.ContentTypeRestriction===Intelledox.Model.ContentType.Image){if(!System.String.IsNullOrEmpty(oQuestion.ValidExtensions)){xmlQuestion.setAttribute("ValidExtensions",oQuestion.ValidExtensions)}}}}if(oQuestion instanceof Design.RichTextQuestion){if(oQuestion.TextRows>0){xmlQuestion.setAttribute("TextRows",oQuestion.TextRows.toString())}if(oQuestion.ShowBullets){xmlQuestion.setAttribute("ShowBullets","True")}if(oQuestion.ShowCopyAndPaste){xmlQuestion.setAttribute("ShowCopyAndPaste","True")}if(oQuestion.ShowHyperlink){xmlQuestion.setAttribute("ShowHyperlink","True")}if(oQuestion.ShowSpellCheck){xmlQuestion.setAttribute("ShowSpellCheck","True")}if(oQuestion.ShowStyles){xmlQuestion.setAttribute("ShowStyles","True")}if(oQuestion.ShowTables){xmlQuestion.setAttribute("ShowTables","True")}if(oQuestion.ShowProtectedFields){xmlQuestion.setAttribute("ShowProtectedFields","True")}}if(oQuestion instanceof Design.NumericQuestion){if(oQuestion.Width>0){xmlQuestion.setAttribute("Width",oQuestion.Width.toString())}if(oQuestion.MaximumValue!==100.0){xmlQuestion.setAttribute("Maximum",oQuestion.MaximumValue.toString())}if(oQuestion.MinimumValue!==0.0){xmlQuestion.setAttribute("Minimum",oQuestion.MinimumValue.toString())}if(oQuestion.Increment>1){xmlQuestion.setAttribute("Increment",oQuestion.Increment.toString())}}if(oQuestion instanceof Design.ButtonQuestion){if(oQuestion.ButtonType!==Intelledox.Model.ButtonType.Toggle){xmlQuestion.setAttribute("ButtonType",oQuestion.ButtonType.toString())}if(!System.String.IsNullOrEmpty(oQuestion.Title)){xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_TITLE,oQuestion.Title)}if(!System.String.IsNullOrEmpty(oQuestion.Badge)){xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_BADGE,oQuestion.Badge)}if(!System.String.IsNullOrEmpty(oQuestion.BackColour)){xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_BACKCOLOUR,oQuestion.BackColour)}if(!System.String.IsNullOrEmpty(oQuestion.BackToggleColour)){xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_BACKTOGGLECOLOUR,oQuestion.BackToggleColour)}if(!System.String.IsNullOrEmpty(oQuestion.BackToggleColourDark)){xmlQuestion.setAttribute("BackToggleColourDark",oQuestion.BackToggleColourDark)}if(!System.String.IsNullOrEmpty(oQuestion.BackColourDark)){xmlQuestion.setAttribute("BackColourDark",oQuestion.BackColourDark)}if(!System.String.IsNullOrEmpty(oQuestion.FocusRingColour)){xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_FOCUSRINGCOLOUR,oQuestion.FocusRingColour)}if(oQuestion.Size!==Intelledox.Model.ButtonSize.Medium){xmlQuestion.setAttribute("ButtonSize",oQuestion.Size.toString())}if(!System.String.IsNullOrEmpty(oQuestion.Icon)){xmlQuestion.setAttribute("Icon",oQuestion.Icon)}if(!System.String.IsNullOrEmpty(oQuestion.LaunchUrl)){xmlQuestion.setAttribute("LaunchUrl",oQuestion.LaunchUrl);xmlQuestion.setAttribute("NewTab",Design.GeneralFunctions.FromBool(oQuestion.NewTab))}if(oQuestion.GoToPageGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&oQuestion.ButtonType===Intelledox.Model.ButtonType.GoToPage){xmlQuestion.setAttribute("GoToPageGuid",oQuestion.GoToPageGuid)}if(oQuestion.GoToProjectGroupGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&oQuestion.ButtonType===Intelledox.Model.ButtonType.GoToProject){xmlQuestion.setAttribute("GoToProjectGroupGuid",oQuestion.GoToProjectGroupGuid)}}if(oQuestion instanceof Design.RunActionButtonQuestion){this.CreateActions(xmlDOM,xmlQuestion,oQuestion.Actions);if(oQuestion.ClassName!==''){xmlQuestion.setAttribute("ClassName",oQuestion.ClassName)}}if(oQuestion instanceof Design.SummaryQuestion){if(oQuestion.Settings.UpToCurrentPageOnly){xmlQuestion.setAttribute("VisitedPagesOnly","True")}if(oQuestion.Settings.CollapsiblePages){xmlQuestion.setAttribute("CollapsiblePages","True")}if(oQuestion.Settings.IncludePageLinks){xmlQuestion.setAttribute("IncludePageLinks","True")}if(oQuestion.Settings.IncludeComments){xmlQuestion.setAttribute("IncludeComments","True")}if(oQuestion.Settings.IncludeAllChoices){xmlQuestion.setAttribute("IncludeAllChoices","True")}if(oQuestion.Settings.ExcludedPages!=null){var xmlExcludedPages=xmlDOM.createElement("ExcludedPages");for(var excludeIndex=0;excludeIndex<oQuestion.Settings.ExcludedPages.length;excludeIndex++){var xmlExcludedPage=xmlDOM.createElement("ExcludedPage");xmlExcludedPage.appendChild(xmlDOM.createTextNode(oQuestion.Settings.ExcludedPages[excludeIndex]));xmlExcludedPages.appendChild(xmlExcludedPage)}xmlQuestion.appendChild(xmlExcludedPages)}}if(oQuestion.Summary!=null){if(oQuestion.Summary.Include!==Design.QuestionSummaryInclude.Default){xmlQuestion.setAttribute("Include",Design.QuestionSummaryInclude[oQuestion.Summary.Include])}if(!System.String.IsNullOrEmpty(oQuestion.Summary.Title)){xmlQuestion.setAttribute("OverrideTitle",oQuestion.Summary.Title)}if(oQuestion.Summary.ShowAll!==null){xmlQuestion.setAttribute("ShowAll",Design.GeneralFunctions.FromBool(oQuestion.Summary.ShowAll))}}if(oQuestion.Visibility){if(oQuestion.SaveToAnswerFile&&!isStaticImage){xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_SAVETOANSWERFILE,"True");xmlQuestion.setAttribute(Intelledox.Common.ConstantValues.XTF_ANSWERFILELABEL,oQuestion.SaveToAnswerFileLabel)}}if(oQuestion.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Datasource&&oQuestion.AllowUserUpload){xmlQuestion.setAttribute("AllowUserUpload","True")}if(oQuestion.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Datasource){if(oQuestion.HasCustomDisplayFields){for(var displayFieldIndex=0;displayFieldIndex<oQuestion.DisplayFields.length;displayFieldIndex++){var display=oQuestion.DisplayFields[displayFieldIndex];xmlDisplayField=xmlDOM.createElement("DisplayField");xmlDisplayField.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,display.name);if(!System.String.IsNullOrEmpty(display.columnTitle)&&(!System.String.IsNullOrEmpty(display.formula)||(display.columnTitle!==display.name))){xmlDisplayField.setAttribute(Intelledox.Common.ConstantValues.XTF_DISPLAYFIELDCOLUMNTITLE,display.columnTitle)}if(!display.sortable){xmlDisplayField.setAttribute("Sortable","False")}if(display.operationsDropdown){xmlDisplayField.setAttribute("OperationsDropdown","True")}if(!System.String.IsNullOrEmpty(display.formula)){xmlDisplayField.setAttribute("Formula",display.formula)}if(display.link!=null&&display.link!==Intelledox.Model.LinkType.NoneWithBrackets){xmlDisplayField.setAttribute(Intelledox.Common.ConstantValues.XTF_DISPLAYFIELDLINK,String(display.link))}xmlQuestion.appendChild(xmlDisplayField)}}for(var sortFieldIndex=0;sortFieldIndex<oQuestion.SortFields.length;sortFieldIndex++){var sortField=oQuestion.SortFields[sortFieldIndex];xmlSortField=xmlDOM.createElement("SortField");xmlSortField.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,sortField.Name);xmlSortField.setAttribute("Direction",sortField.Direction.toString());xmlQuestion.appendChild(xmlSortField)}}if(oQuestion.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Barcode){xmlQuestion.setAttribute("BarcodeType",oQuestion.BarcodeType.toString());xmlQuestion.setAttribute("BarcodeSubType",oQuestion.BarcodeSubType.toString());xmlQuestion.setAttribute("BarcodeCodeLocation",oQuestion.BarcodeCodeLocation.toString());xmlQuestion.setAttribute("Rotation",oQuestion.Rotation.toString());if(oQuestion.Columns>0){xmlQuestion.setAttribute("Columns",oQuestion.Columns.toString())}if(oQuestion.Rows>0){xmlQuestion.setAttribute("Rows",oQuestion.Rows.toString())}}if(oQuestion instanceof Design.ContentLibraryQuestion){if(oQuestion.RepeatParentAnswer!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlQuestion.setAttribute("RepeatParentAnswerGuid",oQuestion.RepeatParentAnswer)}else if(!System.String.IsNullOrEmpty(oQuestion.RepeatParentField)){xmlQuestion.setAttribute("RepeatParentFieldName",oQuestion.RepeatParentField)}}if(oQuestion instanceof Design.InkQuestion){if(oQuestion.BackgroundSource===Intelledox.Model.BackgroundSource.StaticImage){if(!System.String.IsNullOrEmpty(oQuestion.BackgroundImage)){xmlQuestion.setAttribute("BackgroundImage",oQuestion.BackgroundImage)}if(oQuestion.AllowBackgroundUpload){xmlQuestion.setAttribute("AllowBackgroundUpload","True")}}else{xmlQuestion.setAttribute("BGSource",oQuestion.BackgroundSource.toString());if(oQuestion.BackgroundQRQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlQuestion.setAttribute("BackgroundQR",oQuestion.BackgroundQRQuestionGuid);if(oQuestion.BackgroundQRAnswerGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlQuestion.setAttribute("BackgroundAR",oQuestion.BackgroundQRAnswerGuid)}}}if(oQuestion.AllowZoom){xmlQuestion.setAttribute("AllowZoom","True");if(oQuestion.ThumbnailMaxWidth!==0){xmlQuestion.setAttribute("ThumbnailMaxWidth",oQuestion.ThumbnailMaxWidth.toString())}if(oQuestion.ThumbnailMaxHeight!==0){xmlQuestion.setAttribute("ThumbnailMaxHeight",oQuestion.ThumbnailMaxHeight.toString())}}if(oQuestion.IncludeBackground){xmlQuestion.setAttribute("IncludeBackground","True")}if(oQuestion.InkColour!==-16777216){xmlQuestion.setAttribute("InkColour",oQuestion.InkColour.toString())}if(oQuestion.AllowInkColourChoice){xmlQuestion.setAttribute("AllowInkColourChoice","True")}if(oQuestion.ResizeBackgroundImage){xmlQuestion.setAttribute("ResizeBackgroundImage","True");if(oQuestion.ImageSettings.MaxHeight!==0){xmlQuestion.setAttribute("BackMaxHeight",oQuestion.ImageSettings.MaxHeight.toString())}if(oQuestion.ImageSettings.MaxWidth!==0){xmlQuestion.setAttribute("BackMaxWidth",oQuestion.ImageSettings.MaxWidth.toString())}if(oQuestion.ImageSettings.StretchToFit){xmlQuestion.setAttribute("BackStretchToFit","True")}if(oQuestion.ImageSettings.UnitOfMeasure!==Intelledox.Model.UnitsOfMeasure.Pixels){xmlQuestion.setAttribute("BackUnitOfMeasure",oQuestion.ImageSettings.UnitOfMeasure.toString())}}}if(oQuestion instanceof Design.CustomQuestion){xmlQuestion.setAttribute("CustomQuestionTypeId",oQuestion.CustomQuestionTypeId);for(var customInputIndex=0;customInputIndex<oQuestion.Inputs.length;customInputIndex++){var input=oQuestion.Inputs[customInputIndex];var xmlRoutingOption=xmlDOM.createElement("Input");xmlRoutingOption.setAttribute("InputGuid",input.RoutingOptionGuid);xmlRoutingOption.setAttribute("InputTypeId",input.ElementTypeId);xmlRoutingOption.setAttribute("RoutingTypeId",input.RoutingTypeId);xmlRoutingOption.setAttribute("InputSourceTypeId",input.SourceType.toString());if(input.SourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlRoutingOption.setAttribute("InputQuestionGuid",input.SourceGuid)}if(input.SourceAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlRoutingOption.setAttribute("InputAnswerGuid",input.SourceAttributeGuid)}if(!System.String.IsNullOrEmpty(input.FieldName)){xmlRoutingOption.setAttribute("InputFieldName",input.FieldName)}if(!System.String.IsNullOrEmpty(input.FixedValue)){xmlRoutingOption.setAttribute("InputFixedValue",input.FixedValue)}if(!System.String.IsNullOrEmpty(input.Key)){xmlRoutingOption.setAttribute("InputKey",input.Key)}if(!System.String.IsNullOrEmpty(input.TypeValue)){xmlRoutingOption.setAttribute("InputTypeValue",input.TypeValue)}xmlQuestion.appendChild(xmlRoutingOption)}}if(oQuestion instanceof Design.ValidationQuestion){var xmlValidationRules=xmlDOM.createElement("ValidationRules");var rules=new Array;rules.push(oQuestion.ValidationRule);rules=this.PurgeClauses(rules);if(rules.length>0){this.CreateValidationRules(xmlDOM,xmlValidationRules,rules)}xmlQuestion.appendChild(xmlValidationRules)}if(oQuestion.HasValidationRules){var xmlValidationRules=xmlDOM.createElement("ValidationRules");for(var validationIndex=0;validationIndex<oQuestion.Validations.length;validationIndex++){var r=oQuestion.Validations[validationIndex];var xmlRule=xmlDOM.createElement("Rule");xmlRule.setAttribute(Intelledox.Common.ConstantValues.XTF_ID,r.Id);xmlRule.setAttribute("RuleType",r.RuleType.toString());xmlRule.setAttribute("ComparisonType",r.ComparisonType.toString());xmlRule.setAttribute("Expression",r.Expression);xmlRule.setAttribute("Message",r.Message);xmlValidationRules.appendChild(xmlRule)}xmlQuestion.appendChild(xmlValidationRules)}if(oQuestion.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Chart){var xmlChartProperties=xmlDOM.createElement("ChartProperties");var chartQuestion=oQuestion;if(chartQuestion.Chart.BackColour!==-1){xmlChartProperties.setAttribute("BackColour",chartQuestion.Chart.BackColour.toString())}if(chartQuestion.Chart.BorderlineColour!==-1){xmlChartProperties.setAttribute("BorderlineColour",chartQuestion.Chart.BorderlineColour.toString())}if(chartQuestion.Chart.BorderlineDashStyle!==Design.ChartBorderlineDashStyle.Solid){xmlChartProperties.setAttribute("BorderlineDashStyle",chartQuestion.Chart.BorderlineDashStyle.toString())}if(chartQuestion.Chart.BorderlineWidth!==1){xmlChartProperties.setAttribute("BorderlineWidth",chartQuestion.Chart.BorderlineWidth.toString())}if(chartQuestion.Chart.ColourPalette!==Design.ChartColourPalette.Pastel){xmlChartProperties.setAttribute("ColourPalette",chartQuestion.Chart.ColourPalette.toString())}if(!System.String.IsNullOrEmpty(chartQuestion.Chart.Title)){xmlChartProperties.setAttribute(Intelledox.Common.ConstantValues.XTF_TITLE,chartQuestion.Chart.Title)}for(var seriesIndex=0;seriesIndex<chartQuestion.Chart.Series.length;seriesIndex++){var series=chartQuestion.Chart.Series[seriesIndex];var xmlSeriesProperties=xmlDOM.createElement("Series");if(series.ChartType!==Design.ChartType.Column){xmlSeriesProperties.setAttribute("ChartType",series.ChartType.toString())}if(!System.String.IsNullOrEmpty(series.Name)){xmlSeriesProperties.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,series.Name)}xmlSeriesProperties.setAttribute("DataQuestionGuid",series.DataQuestionGuid);xmlSeriesProperties.setAttribute("CategoriesAnswer",series.CategoriesAnswer);xmlSeriesProperties.setAttribute("ValueAnswer",series.ValueAnswer);xmlSeriesProperties.setAttribute("BackColour",series.BackColour.toString());xmlSeriesProperties.setAttribute("BorderlineColour",series.BorderlineColour.toString());if(chartQuestion.Chart.ColourPalette!==Design.ChartColourPalette.None){xmlSeriesProperties.setAttribute("ColourPalette",series.ColourPalette.toString())}if(series.BorderlineDashStyle!==Design.ChartBorderlineDashStyle.Solid){xmlSeriesProperties.setAttribute("BorderlineDashStyle",series.BorderlineDashStyle.toString())}if(series.BorderlineWidth!==1){xmlSeriesProperties.setAttribute("BorderlineWidth",series.BorderlineWidth.toString())}if(series.DataPointLabel!==Design.ChartDataPointLabel.None){xmlSeriesProperties.setAttribute("DataPointLabel",series.DataPointLabel.toString())}xmlChartProperties.appendChild(xmlSeriesProperties)}var xmlLegendProperties=xmlDOM.createElement("Legend");if(!chartQuestion.Chart.Legend.IsVisible){xmlLegendProperties.setAttribute("Visibility","False")}xmlLegendProperties.setAttribute("Docking",chartQuestion.Chart.Legend.Docking.toString());xmlLegendProperties.setAttribute("Alignment",chartQuestion.Chart.Legend.Alignment.toString());xmlLegendProperties.setAttribute("BackColour",chartQuestion.Chart.Legend.BackColour.toString());xmlLegendProperties.setAttribute("BorderlineColour",chartQuestion.Chart.Legend.BorderlineColour.toString());if(chartQuestion.Chart.Legend.BorderlineDashStyle!==Design.ChartBorderlineDashStyle.Solid){xmlLegendProperties.setAttribute("BorderlineDashStyle",chartQuestion.Chart.Legend.BorderlineDashStyle.toString())}if(chartQuestion.Chart.Legend.BorderlineWidth!==1){xmlLegendProperties.setAttribute("BorderlineWidth",chartQuestion.Chart.Legend.BorderlineWidth.toString())}xmlChartProperties.appendChild(xmlLegendProperties);var xmlChartAreaProperties=xmlDOM.createElement("ChartArea");if(chartQuestion.Chart.ChartArea.Is3D){xmlChartAreaProperties.setAttribute("Enable3D","True")}if(chartQuestion.Chart.ChartArea.BackColour!==-1){xmlChartAreaProperties.setAttribute("BackColour",chartQuestion.Chart.ChartArea.BackColour.toString())}if(chartQuestion.Chart.ChartArea.BorderlineColour!==-1){xmlChartAreaProperties.setAttribute("BorderlineColour",chartQuestion.Chart.ChartArea.BorderlineColour.toString())}if(chartQuestion.Chart.ChartArea.BorderlineDashStyle!==Design.ChartBorderlineDashStyle.Solid){xmlChartAreaProperties.setAttribute("BorderlineDashStyle",chartQuestion.Chart.ChartArea.BorderlineDashStyle.toString())}if(chartQuestion.Chart.ChartArea.BorderlineWidth!==1){xmlChartAreaProperties.setAttribute("BorderlineWidth",chartQuestion.Chart.ChartArea.BorderlineWidth.toString())}xmlChartProperties.appendChild(xmlChartAreaProperties);var xmlAxisXProperties=xmlDOM.createElement("AxisX");if(chartQuestion.Chart.AxisX.HideTitle){xmlAxisXProperties.setAttribute("HideTitle","True")}if(!System.String.IsNullOrEmpty(chartQuestion.Chart.AxisX.Title)){xmlAxisXProperties.setAttribute(Intelledox.Common.ConstantValues.XTF_TITLE,chartQuestion.Chart.AxisX.Title)}xmlAxisXProperties.setAttribute("Alignment",chartQuestion.Chart.AxisX.Alignment.toString());if(chartQuestion.Chart.AxisX.HideLabels){xmlAxisXProperties.setAttribute("HideLabels","True")}if(chartQuestion.Chart.AxisX.HideFirstAndLastLabels){xmlAxisXProperties.setAttribute("HideFirstAndLastLabels","True")}if(chartQuestion.Chart.AxisX.BorderlineColour!==-1){xmlAxisXProperties.setAttribute("BorderlineColour",chartQuestion.Chart.AxisX.BorderlineColour.toString())}if(chartQuestion.Chart.AxisX.BorderlineDashStyle!==Design.ChartBorderlineDashStyle.Solid){xmlAxisXProperties.setAttribute("BorderlineDashStyle",chartQuestion.Chart.AxisX.BorderlineDashStyle.toString())}if(chartQuestion.Chart.AxisX.BorderlineWidth!==1){xmlAxisXProperties.setAttribute("BorderlineWidth",chartQuestion.Chart.AxisX.BorderlineWidth.toString())}xmlChartProperties.appendChild(xmlAxisXProperties);var xmlAxisYProperties=xmlDOM.createElement("AxisY");if(chartQuestion.Chart.AxisY.HideTitle){xmlAxisYProperties.setAttribute("HideTitle","True")}if(!System.String.IsNullOrEmpty(chartQuestion.Chart.AxisY.Title)){xmlAxisYProperties.setAttribute(Intelledox.Common.ConstantValues.XTF_TITLE,chartQuestion.Chart.AxisY.Title)}xmlAxisYProperties.setAttribute("Alignment",chartQuestion.Chart.AxisY.Alignment.toString());if(chartQuestion.Chart.AxisY.HideLabels){xmlAxisYProperties.setAttribute("HideLabels","True")}if(chartQuestion.Chart.AxisY.HideFirstAndLastLabels){xmlAxisYProperties.setAttribute("HideFirstAndLastLabels","True")}if(chartQuestion.Chart.AxisY.BorderlineColour!==-1){xmlAxisYProperties.setAttribute("BorderlineColour",chartQuestion.Chart.AxisY.BorderlineColour.toString())}if(chartQuestion.Chart.AxisY.BorderlineDashStyle!==Design.ChartBorderlineDashStyle.Solid){xmlAxisYProperties.setAttribute("BorderlineDashStyle",chartQuestion.Chart.AxisY.BorderlineDashStyle.toString())}if(chartQuestion.Chart.AxisY.BorderlineWidth!==1){xmlAxisYProperties.setAttribute("BorderlineWidth",chartQuestion.Chart.AxisY.BorderlineWidth.toString())}xmlChartProperties.appendChild(xmlAxisYProperties);xmlQuestion.appendChild(xmlChartProperties)}if(oQuestion instanceof Design.GeolocationQuestion){xmlQuestion.setAttribute("HighAccuracy",Design.GeneralFunctions.FromBool(oQuestion.HighAccuracy))}for(var answerIndex=0;answerIndex<oQuestion.Answers.length;answerIndex++){var oAnswer=oQuestion.Answers[answerIndex];xmlAnswer=xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_ANSWER);xmlAnswer.setAttribute(Intelledox.Common.ConstantValues.XTF_ID,oAnswer.ID.toString());xmlAnswer.setAttribute(Intelledox.Common.ConstantValues.XTF_GUID,oAnswer.AnswerGuid);xmlAnswer.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,oAnswer.Name);if(!System.String.IsNullOrEmpty(oAnswer.FormatString)){xmlAnswer.setAttribute("FormatString",oAnswer.FormatString)}switch(oQuestion.QuestionTypeID){case Design.QuestionType.QuestionTypeEnum.AddressPrompt:case Design.QuestionType.QuestionTypeEnum.Datasource:case Design.QuestionType.QuestionTypeEnum.Variable:case Design.QuestionType.QuestionTypeEnum.Geolocation:xmlAnswer.setAttribute("FieldName",oAnswer.DataField);break}if(oAnswer instanceof Design.LogicAnswer&&oAnswer.HideValue){xmlAnswer.setAttribute("HideValue","1")}if(!System.String.IsNullOrEmpty(oAnswer.WritebackField)){xmlAnswer.setAttribute("WritebackField",oAnswer.WritebackField)}if(oAnswer instanceof Design.LogicAnswer){if(!System.String.IsNullOrEmpty(oAnswer.TagValue)){xmlAnswer.setAttribute("TagValue",oAnswer.TagValue)}}if(oAnswer.ImageSettings.MaxHeight!==0){xmlAnswer.setAttribute("ImageMaxHeight",oAnswer.ImageSettings.MaxHeight.toString())}if(oAnswer.ImageSettings.MaxWidth!==0){xmlAnswer.setAttribute("ImageMaxWidth",oAnswer.ImageSettings.MaxWidth.toString())}if(oAnswer.ImageSettings.StretchToFit){xmlAnswer.setAttribute("ImageStretchToFit","True")}if(!System.String.IsNullOrEmpty(oAnswer.ImageSettings.AlternativeText)){xmlAnswer.setAttribute("AlternativeText",oAnswer.ImageSettings.AlternativeText)}if(oAnswer.ImageSettings.UnitOfMeasure!==Intelledox.Model.UnitsOfMeasure.Pixels){xmlAnswer.setAttribute("ImageUnitOfMeasure",oAnswer.ImageSettings.UnitOfMeasure.toString())}xmlAnswer.setAttribute(Intelledox.Common.ConstantValues.XTF_SAVETOANSWERFILE,Design.GeneralFunctions.FromBool(oAnswer.SaveToAnswerFile));if(oAnswer.SaveToAnswerFile){if(oAnswer.SaveToAnswerFileBy!==Design.SaveAnswerByEnum.SaveById){xmlAnswer.setAttribute(Intelledox.Common.ConstantValues.XTF_SAVETOANSWERFILEBY,oAnswer.SaveToAnswerFileBy.toString())}if(oAnswer.SaveToAnswerFileBy===Design.SaveAnswerByEnum.SaveByLabel){xmlAnswer.setAttribute(Intelledox.Common.ConstantValues.XTF_ANSWERFILELABEL,oAnswer.SaveToAnswerFileLabel)}}if(oAnswer instanceof Design.VariableAnswer){if(!System.String.IsNullOrEmpty(oAnswer.Formula)){xmlAnswer.setAttribute("Formula",oAnswer.Formula)}}if(oAnswer instanceof Design.DatasourceAnswer){if(!System.String.IsNullOrEmpty(oAnswer.Formula)){xmlAnswer.setAttribute("Formula",oAnswer.Formula)}}if(oQuestion.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.GroupLogic){if(!System.String.IsNullOrEmpty(oAnswer.DisplayText)){xmlAnswer.setAttribute("DisplayText",oAnswer.DisplayText)}if(oQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelect||oQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelectToggleButton){if(oAnswer.IsDefaultSelected){xmlAnswer.setAttribute("DefaultSelected","1")}if(oAnswer.DefaultQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlAnswer.setAttribute("DefaultQuestionReference",oAnswer.DefaultQuestionReference)}if(oAnswer.DefaultAnswerReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlAnswer.setAttribute("DefaultAnswerReference",oAnswer.DefaultAnswerReference)}}}if(oQuestion.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Custom){if(oAnswer.OutputTypeId!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlAnswer.setAttribute("OutputTypeId",oAnswer.OutputTypeId)}}if(oAnswer.HasValidationRules){var xmlValidationRules=xmlDOM.createElement("ValidationRules");for(var answerValidationIndex=0;answerValidationIndex<oAnswer.Validations.length;answerValidationIndex++){var r=oAnswer.Validations[answerValidationIndex];var xmlRule=xmlDOM.createElement("Rule");xmlRule.setAttribute(Intelledox.Common.ConstantValues.XTF_ID,r.Id);xmlRule.setAttribute("RuleType",r.RuleType.toString());xmlRule.setAttribute("ComparisonType",r.ComparisonType.toString());xmlRule.setAttribute("Expression",r.Expression);xmlRule.setAttribute("Message",r.Message);xmlValidationRules.appendChild(xmlRule)}xmlAnswer.appendChild(xmlValidationRules)}if(oAnswer instanceof Design.DatasourceAnswer&&oAnswer.DataConvertType!==Design.DataConvertType.None){xmlAnswer.setAttribute("DataConvertType",oAnswer.DataConvertType.toString());xmlAnswer.setAttribute("DataConvertPattern",oAnswer.DataConvertPattern||"")}for(var answerContentIndex=0;answerContentIndex<oAnswer.ContentItems.length;answerContentIndex++){var contentItm=oAnswer.ContentItems[answerContentIndex];var xmlContentItem=xmlDOM.createElement("ContentItem");xmlContentItem.setAttribute("Id",contentItm.ContentItemGuid);xmlContentItem.setAttribute("InstanceId",contentItm.ContentInstanceId);xmlContentItem.setAttribute("ContentTypeId",contentItm.ContentTypeId.toString());switch(contentItm.ContentTypeId){case Intelledox.Model.ContentType.Image:xmlContentItem.setAttribute("MaxHeight",contentItm.ImageSettings.MaxHeight.toString());xmlContentItem.setAttribute("MaxWidth",contentItm.ImageSettings.MaxWidth.toString());xmlContentItem.setAttribute("UnitOfMeasure",contentItm.ImageSettings.UnitOfMeasure.toString());xmlContentItem.setAttribute("StretchToFit",Design.GeneralFunctions.FromBool(contentItm.ImageSettings.StretchToFit));xmlContentItem.setAttribute("AlternativeText",contentItm.ImageSettings.AlternativeText||"");break;case Intelledox.Model.ContentType.Attachment:xmlContentItem.setAttribute("AttachmentName",contentItm.AttachmentName);break;case Intelledox.Model.ContentType.DocumentFragment:if(contentItm.KeepSourceFormatting){xmlContentItem.setAttribute("KeepSourceFormatting","True")}break}xmlAnswer.appendChild(xmlContentItem)}if(oAnswer.HasPlaceholders){this.AddPlaceholderNode(xmlDOM,xmlAnswer,oAnswer.Placeholders,multiDoc,source)}for(var responseMetadataIndex=0;responseMetadataIndex<oAnswer.ResponseMetadataFields.length;responseMetadataIndex++){this.AddResponseMetadataNode(xmlDOM,xmlAnswer,oAnswer.ResponseMetadataFields[responseMetadataIndex])}this.AddConditionsNode(xmlDOM,xmlAnswer,oAnswer.ActiveConditions);if(oAnswer instanceof Design.AutoLogicAnswer&&oAnswer.Rules.Type!==Intelledox.Model.ClauseType.Basic){var rules=new Array;rules.push(oAnswer.Rules);rules=this.PurgeClauses(rules);if(rules.length>0){xmlActive=xmlDOM.createElement("Rules");this.CreateRules(xmlDOM,xmlActive,rules);xmlAnswer.appendChild(xmlActive)}}xmlQuestion.appendChild(xmlAnswer)}this.AddConditionsNode(xmlDOM,xmlQuestion,oQuestion.ActiveConditions);this.AddConditionsNode(xmlDOM,xmlQuestion,oQuestion.VisibleConditions,"VisibleConditions");this.AddConditionsNode(xmlDOM,xmlQuestion,oQuestion.EditableConditions,"EditableConditions");if(oQuestion.Mandatory===Design.MandatoryType.Conditional&&!isStaticImage){this.AddConditionsNode(xmlDOM,xmlQuestion,oQuestion.MandatoryConditions,"MandatoryConditions")}if(oQuestion.QuestionTypeID===Design.QuestionType.QuestionTypeEnum.Datasource&&oQuestion.Filters!=null){var filters=new Array;filters.push(oQuestion.Filters);filters=this.PurgeClauses(filters);if(filters.length>0){xmlActive=xmlDOM.createElement("Filters");this.CreateFilters(xmlDOM,xmlActive,filters);xmlQuestion.appendChild(xmlActive)}}return xmlQuestion};WizardController.prototype.AddConditionsNode=function(xmlDom,xmlParent,conds,nodeName){nodeName=nodeName||"Conditions";if(conds!=null&&conds.Type!==Intelledox.Model.ClauseType.Basic){var purgedConds=new Array;purgedConds.push(conds);purgedConds=this.PurgeClauses(purgedConds);if(purgedConds.length>0){var xmlConds=xmlDom.createElement(nodeName);this.CreateConditions(xmlDom,xmlConds,purgedConds);xmlParent.appendChild(xmlConds)}}};WizardController.prototype.PurgeClauses=function(clauses){var result=new Array;for(var i=0;i<clauses.length;i++){var c=clauses[i];switch(c.Type){case Intelledox.Model.ClauseType.AllOf:case Intelledox.Model.ClauseType.AnyOf:var purgedClauses=this.PurgeClauses(c.SubClauses);if(purgedClauses.length>0){c.SubClauses=purgedClauses;result.push(c)}break;case Intelledox.Model.ClauseType.Comparison:result.push(c);break}}return result};WizardController.prototype.CreateRepeatPlaceholders=function(xmlDom,xmlParent,placeholders){for(var i=0;i<placeholders.length;i++){var placeholder=placeholders[i];var xmlItem=xmlDom.createElement("RepeatPlaceholder");xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,placeholder.name);if(placeholder.type!==Intelledox.Model.PlaceholderType.Bookmark){xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_TYPEID,placeholder.type.toString())}xmlParent.appendChild(xmlItem)}};WizardController.prototype.CreateConditions=function(xmlDom,xmlParent,conditions){for(var i=0;i<conditions.length;i++){var condition=conditions[i];var xmlCond=null;switch(condition.Type){case Intelledox.Model.ClauseType.AllOf:if(condition.SubClauses.length>0){xmlCond=xmlDom.createElement("And");this.CreateConditions(xmlDom,xmlCond,condition.SubClauses)}break;case Intelledox.Model.ClauseType.AnyOf:if(condition.SubClauses.length>0){xmlCond=xmlDom.createElement("Or");this.CreateConditions(xmlDom,xmlCond,condition.SubClauses)}break;case Intelledox.Model.ClauseType.Comparison:xmlCond=xmlDom.createElement("Cond");if(condition.ParentItemGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlCond.setAttribute("QID",condition.ParentItemGuid)}if(condition.ParentAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlCond.setAttribute("AID",condition.ParentAttributeGuid)}xmlCond.setAttribute("Compare",Design.ClauseComparisonType[condition.ComparisonType]);xmlCond.setAttribute("Value",condition.CompareTo);if(condition.ParentType!==Design.ConditionParentType.Reference){xmlCond.setAttribute("ParentType",Design.ConditionParentType[condition.ParentType])}break}if(xmlCond!=null){xmlParent.appendChild(xmlCond)}}};WizardController.prototype.CreateValidationRules=function(xmlDom,xmlParent,validationRules){for(var i=0;i<validationRules.length;i++){var vRule=validationRules[i];var xmlRule=null;switch(vRule.Type){case Intelledox.Model.ClauseType.AllOf:if(vRule.SubClauses.length>0){xmlRule=xmlDom.createElement("And");this.CreateValidationRules(xmlDom,xmlRule,vRule.SubClauses)}break;case Intelledox.Model.ClauseType.AnyOf:if(vRule.SubClauses.length>0){xmlRule=xmlDom.createElement("Or");this.CreateValidationRules(xmlDom,xmlRule,vRule.SubClauses)}break;case Intelledox.Model.ClauseType.Comparison:xmlRule=xmlDom.createElement("vqRule");xmlRule.setAttribute("RuleType",vRule.RuleType.toString());xmlRule.setAttribute("ComparisonType",vRule.ComparisonType.toString());xmlRule.setAttribute("Expression",vRule.Expression);if(vRule.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlRule.setAttribute("QID",vRule.QuestionGuid);if(vRule.AnswerGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlRule.setAttribute("AID",vRule.AnswerGuid)}}break}if(xmlRule!=null){xmlParent.appendChild(xmlRule)}}};WizardController.prototype.CreateRules=function(xmlDom,xmlParent,rules){for(var i=0;i<rules.length;i++){var rule=rules[i];var xmlRule=null;switch(rule.Type){case Intelledox.Model.ClauseType.AllOf:if(rule.SubClauses.length>0){xmlRule=xmlDom.createElement("And");this.CreateRules(xmlDom,xmlRule,rule.SubClauses)}break;case Intelledox.Model.ClauseType.AnyOf:if(rule.SubClauses.length>0){xmlRule=xmlDom.createElement("Or");this.CreateRules(xmlDom,xmlRule,rule.SubClauses)}break;case Intelledox.Model.ClauseType.Comparison:xmlRule=xmlDom.createElement("alRule");if(rule.ParentItemGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlRule.setAttribute("QID",rule.ParentItemGuid)}if(rule.ParentAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlRule.setAttribute("AID",rule.ParentAttributeGuid)}xmlRule.setAttribute("Compare",Design.ClauseComparisonType[rule.ComparisonType]);xmlRule.setAttribute("Value",rule.CompareTo);xmlRule.setAttribute("ParentType",Design.RuleParentType[rule.ParentType]);if(!System.String.IsNullOrEmpty(rule.Formula)){xmlRule.setAttribute("Formula",rule.Formula)}if(rule.EveryOrOneOf!==Design.RepeaterChoice.NotRepeated){xmlRule.setAttribute("RepChoice",rule.EveryOrOneOf.toString())}break}if(xmlRule!=null){xmlParent.appendChild(xmlRule)}}};WizardController.prototype.CreateFilters=function(xmlDom,xmlParent,filters){for(var i=0;i<filters.length;i++){var filter=filters[i];var xmlFilter=null;switch(filter.Type){case Intelledox.Model.ClauseType.AllOf:if(filter.SubClauses.length>0){xmlFilter=xmlDom.createElement("And");this.CreateFilters(xmlDom,xmlFilter,filter.SubClauses)}break;case Intelledox.Model.ClauseType.AnyOf:if(filter.SubClauses.length>0){xmlFilter=xmlDom.createElement("Or");this.CreateFilters(xmlDom,xmlFilter,filter.SubClauses)}break;case Intelledox.Model.ClauseType.Comparison:xmlFilter=xmlDom.createElement("Filter");if(!System.String.IsNullOrEmpty(filter.FieldName)){xmlFilter.setAttribute("ChildField",filter.FieldName)}xmlFilter.setAttribute("ComparisonType",filter.ComparisonType.toString());if(filter.ParentType!==Design.FilterParentType.Reference){xmlFilter.setAttribute("ParentType",Design.FilterParentType[filter.ParentType])}if(filter.ParentType===Design.FilterParentType.Constant){xmlFilter.setAttribute("ConstantValue",filter.ConstantValue)}else if(filter.ParentType===Design.FilterParentType.Input){xmlFilter.setAttribute("ParentQuestionGuid",filter.ParentItemGuid)}else{if(filter.ParentItemGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlFilter.setAttribute("ParentQuestionGuid",filter.ParentItemGuid);if(filter.ParentAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlFilter.setAttribute("ParentAnswerGuid",filter.ParentAttributeGuid)}else if(!System.String.IsNullOrEmpty(filter.ParentFieldName)){xmlFilter.setAttribute("ParentFieldName",filter.ParentFieldName)}if(filter.IsAggregate){xmlFilter.setAttribute("IsAggregate","1")}}}break}if(xmlFilter!=null){xmlParent.appendChild(xmlFilter)}}};WizardController.prototype.CreateActions=function(xmlDom,xmlParent,actions){for(var i=0;i<actions.length;i++){var a=actions[i];var xElement=xmlDom.createElement("Action");xElement.setAttribute(Intelledox.Common.ConstantValues.XTF_ID,a.ActionGuid);xElement.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,a.Name);xElement.setAttribute(Intelledox.Common.ConstantValues.XTF_TYPEID,a.Type.routingTypeId);if(a.RunActionWhen!==Intelledox.Model.RunActionWhen.OnDocGenSuccess){xElement.setAttribute("RunActionWhen",a.RunActionWhen.toString())}if(a.ShowActionWhen!==Intelledox.Model.RunActionWhen.Always){xElement.setAttribute("ShowActionWhen",a.ShowActionWhen.toString())}if(a.SubmissionStage!==Intelledox.Model.SubmissionStage.Finish){xElement.setAttribute("SubmissionStage",a.SubmissionStage.toString())}if(a.HasRetries){xElement.setAttribute("Retries",a.Retries.toString());xElement.setAttribute("RetryWait",a.RetryWait.toString())}if(a.IsRepeated){xElement.setAttribute("IsRepeated","1");if(a.RepeaterGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xElement.setAttribute("RepeatSource",a.RepeaterGuid);if(a.Children.length>0){this.CreateActions(xmlDom,xElement,a.Children)}}}this.CreateActionInputs(xmlDom,xElement,a.ActionInputs);if(a.HasCustomDocuments){xElement.setAttribute("HasCustomDocuments","1");if(a.SubmissionStage!==Intelledox.Model.SubmissionStage.Submit){for(var docIndex=0;docIndex<a.CustomDocuments.length;docIndex++){var doc=a.CustomDocuments[docIndex];var xmlActionDocument=xmlDom.createElement("Document");xmlActionDocument.setAttribute("DocumentGuid",doc.DocumentGuid);xmlActionDocument.setAttribute("Type",Intelledox.Model.ActionDocumentType[doc.Type]);if(doc.Format!==Intelledox.Model.OutputType.None){xmlActionDocument.setAttribute("Format",doc.Format.toString())}xElement.appendChild(xmlActionDocument)}}}this.AddConditionsNode(xmlDom,xElement,a.Conditions);xmlParent.appendChild(xElement)}};WizardController.prototype.CreateActionInputs=function(xmlDom,parentElement,inputs){for(var inputIndex=0;inputIndex<inputs.length;inputIndex++){var routingOpt=inputs[inputIndex];var xmlRoutingOption=xmlDom.createElement(Intelledox.Common.ConstantValues.XTF_ACTIONINPUT);xmlRoutingOption.setAttribute("ActionInputGuid",routingOpt.RoutingOptionGuid);xmlRoutingOption.setAttribute("ActionAttributeId",routingOpt.ElementTypeId.toString());xmlRoutingOption.setAttribute("ActionAttributeSourceTypeId",routingOpt.SourceType.toString());if(routingOpt.SourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlRoutingOption.setAttribute("ActionAttributeQuestionGuid",routingOpt.SourceGuid)}if(routingOpt.SourceAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlRoutingOption.setAttribute("ActionAttributeAnswerGuid",routingOpt.SourceAttributeGuid)}if(!System.String.IsNullOrEmpty(routingOpt.FieldName)){xmlRoutingOption.setAttribute("ActionAttributeFieldName",routingOpt.FieldName)}if(!System.String.IsNullOrEmpty(routingOpt.FixedValue)){xmlRoutingOption.setAttribute(Intelledox.Common.ConstantValues.XTF_ACTIONATTRIBUTEFIXEDVALUE,routingOpt.FixedValue)}if(!System.String.IsNullOrEmpty(routingOpt.Key)){xmlRoutingOption.setAttribute("ActionAttributeKey",routingOpt.Key)}if(!System.String.IsNullOrEmpty(routingOpt.TypeValue)){xmlRoutingOption.setAttribute("ActionAttributeTypeValue",routingOpt.TypeValue)}parentElement.appendChild(xmlRoutingOption);if(routingOpt.ChildInputs!=null){this.CreateActionInputs(xmlDom,xmlRoutingOption,routingOpt.ChildInputs)}}};WizardController.prototype.CreateXtfLayoutContainer=function(node,xmlDom,multiDoc,xmlPage,source){var xmlLayout=xmlDom.createElement(Intelledox.Common.ConstantValues.XTF_LAYOUT);for(var i=0;i<node.Children.length;i++){xmlLayout.appendChild(this.CreateXtfLayoutNode(node.Children[i],xmlDom,multiDoc,xmlPage,source))}return xmlLayout};WizardController.prototype.CreateXtfLayoutNode=function(node,xmlDom,multiDoc,xmlPage,source){var xmlItem=null;if(node instanceof Design.Question){xmlItem=xmlDom.createElement(Intelledox.Common.ConstantValues.XTF_CONTROL);xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_GUID,node.QuestionGuid);xmlPage.appendChild(this.SerializeQuestion(xmlDom,node,multiDoc,source))}else if(node instanceof Design.Section){xmlItem=xmlDom.createElement(Intelledox.Common.ConstantValues.XTF_SECTION);xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_GUID,node.SectionGuid);if(!System.String.IsNullOrEmpty(node.Title)){xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_TITLE,node.Title)}if(!System.String.IsNullOrEmpty(node.Description)){xmlItem.setAttribute("Description",node.Description)}if(node.CssStyle!==""&&node.CssStyle!==null){xmlItem.setAttribute("CssClass",node.CssStyle)}xmlItem.setAttribute("DisplayImportOptions",Design.GeneralFunctions.FromBool(node.DisplayImportOptions));if(node.IsRepeated){xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_REPEATED,"True");if(!System.String.IsNullOrEmpty(node.MaximumRepeats)){xmlItem.setAttribute("Maximum",node.MaximumRepeats)}if(!System.String.IsNullOrEmpty(node.MinimumRepeats)){xmlItem.setAttribute("Minimum",node.MinimumRepeats)}if(!System.String.IsNullOrEmpty(node.RepeatName)){xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_REPEATNAME,node.RepeatName)}if(!node.AllowSorting){xmlItem.setAttribute("AllowSorting","False")}if(node.CreateMinimumRepeats){xmlItem.setAttribute("CreateMinimum","True")}if(node.RepeatSourceType!==Design.RepeatSourceType.None){xmlItem.setAttribute("RepeatSourceType",node.RepeatSourceType.toString());xmlItem.setAttribute("RepeatSourceGuid",node.RepeatSourceGuid);if(node.RepeatSourceAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlItem.setAttribute("RepeatSourceAttributeGuid",node.RepeatSourceAttributeGuid)}xmlItem.setAttribute("ShowFillDown","False");if(!node.IsEditableDrivenRepeat){xmlItem.setAttribute("IsEditableDrivenRepeat","False")}}else{if(!node.ShowFillDownButton){xmlItem.setAttribute("ShowFillDown","False")}}if(node.RepeatPlaceholders.length>0){this.CreateRepeatPlaceholders(xmlDom,xmlItem,node.RepeatPlaceholders)}}this.AddConditionsNode(xmlDom,xmlItem,node.ActiveConditions);this.AddConditionsNode(xmlDom,xmlItem,node.VisibleConditions,"VisibleConditions");this.AddConditionsNode(xmlDom,xmlItem,node.EditableConditions,"EditableConditions");if(node.IsRepeated){this.AddConditionsNode(xmlDom,xmlItem,node.RepeatConditions,"RepeatConditions")}}else if(node instanceof Design.Column){xmlItem=xmlDom.createElement(Intelledox.Common.ConstantValues.XTF_COLUMN);xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_GUID,node.ColumnGuid);if(!System.String.IsNullOrEmpty(node.Title)){xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_TITLE,node.Title)}if(!System.String.IsNullOrEmpty(node.HelpText)){xmlItem.setAttribute("HelpText",node.HelpText)}if(node.Width>0){xmlItem.setAttribute("WidthType",Design.WidthType[node.WidthType]);xmlItem.setAttribute("Width",node.Width.toString())}if(node.GroupBy){xmlItem.setAttribute("GroupBy","True")}if(node.CssStyle!==""&&node.CssStyle!==null){xmlItem.setAttribute("CssClass",node.CssStyle)}this.AddConditionsNode(xmlDom,xmlItem,node.ActiveConditions);this.AddConditionsNode(xmlDom,xmlItem,node.VisibleConditions,"VisibleConditions");this.AddConditionsNode(xmlDom,xmlItem,node.EditableConditions,"EditableConditions")}else if(node instanceof Design.TabGroup){var tabs=node;xmlItem=xmlDom.createElement(Intelledox.Common.ConstantValues.XTF_TABGROUP);xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_GUID,tabs.TabGroupGuid);if(tabs.DisplayType!==Intelledox.Model.TabGroupDisplayType.Classic){xmlItem.setAttribute("DisplayType",tabs.DisplayType.toString())}if(tabs.CssStyle!==""&&tabs.CssStyle!==null){xmlItem.setAttribute("CssClass",tabs.CssStyle)}this.AddConditionsNode(xmlDom,xmlItem,tabs.ActiveConditions);this.AddConditionsNode(xmlDom,xmlItem,tabs.VisibleConditions,"VisibleConditions");this.AddConditionsNode(xmlDom,xmlItem,tabs.EditableConditions,"EditableConditions")}else if(node instanceof Design.TabPage){xmlItem=xmlDom.createElement(Intelledox.Common.ConstantValues.XTF_TABPAGE);xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_GUID,node.TabPageGuid);if(!System.String.IsNullOrEmpty(node.Title)){xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_TITLE,node.Title)}if(node.CssStyle!==""&&node.CssStyle!==null){xmlItem.setAttribute("CssClass",node.CssStyle)}this.AddConditionsNode(xmlDom,xmlItem,node.ActiveConditions);this.AddConditionsNode(xmlDom,xmlItem,node.VisibleConditions,"VisibleConditions");this.AddConditionsNode(xmlDom,xmlItem,node.EditableConditions,"EditableConditions")}else if(node instanceof Design.FragmentReference){xmlItem=xmlDom.createElement(Intelledox.Common.ConstantValues.XTF_FRAGMENT);xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_PROJECTGUID,node.ProjectGuid);xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,node.Name);xmlItem.setAttribute(Intelledox.Common.ConstantValues.XTF_FRAGMENTGUID,node.FragmentGuid);this.AddConditionsNode(xmlDom,xmlItem,node.ActiveConditions);this.AddConditionsNode(xmlDom,xmlItem,node.VisibleConditions,"VisibleConditions");this.AddConditionsNode(xmlDom,xmlItem,node.EditableConditions,"EditableConditions");this.AddFragmentInputsNode(xmlDom,xmlItem,node.Inputs);this.AddFragmentDocumentsNode(xmlDom,xmlItem,node.Documents,multiDoc);this.AddFragmentOutputsNode(xmlDom,xmlItem,node.Outputs,multiDoc)}if(node instanceof Design.Section||node instanceof Design.TabGroup){var children=node.Children;for(var structureIndex=0;structureIndex<children.length;structureIndex++){xmlItem.appendChild(this.CreateXtfLayoutNode(children[structureIndex],xmlDom,multiDoc,xmlPage,source))}}else if(typeof(node.HasContainerInterface)!=="undefined"){xmlItem.appendChild(this.CreateXtfLayoutContainer(node,xmlDom,multiDoc,xmlPage,source))}return xmlItem};WizardController.prototype.AddFragmentDocumentsNode=function(xmlDom,parent,documents,multiDoc){for(var i=0;i<documents.length;i++){var doc=documents[i];var xmlDocument=xmlDom.createElement("FragmentDocument");xmlDocument.setAttribute("DocumentGuid",doc.DocumentGuid);xmlDocument.setAttribute("FormatType",doc.FormatType.toString());if(doc.IsAttachment&&doc.AttachmentFormat!==Intelledox.Model.OutputType.None){xmlDocument.setAttribute("IsAttachment","1");xmlDocument.setAttribute("Format",doc.AttachmentFormat.toString())}for(var placeIndex=0;placeIndex<doc.Placeholders.length;placeIndex++){this.AddFragmentPlaceholderNode(xmlDom,xmlDocument,doc.Placeholders[placeIndex],multiDoc)}parent.appendChild(xmlDocument)}};WizardController.prototype.AddFragmentInputsNode=function(xmlDom,parent,inputs){for(var i=0;i<inputs.length;i++){var input=inputs[i];var xmlInput=xmlDom.createElement("Input");xmlInput.setAttribute("Id",input.ElementTypeId);xmlInput.setAttribute("InputSourceTypeId",input.SourceType.toString());if(input.SourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlInput.setAttribute("InputQuestionGuid",input.SourceGuid)}if(input.SourceAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlInput.setAttribute("InputAnswerGuid",input.SourceAttributeGuid)}if(!System.String.IsNullOrEmpty(input.FieldName)){xmlInput.setAttribute("InputFieldName",input.FieldName)}if(!System.String.IsNullOrEmpty(input.FixedValue)){xmlInput.setAttribute("InputFixedValue",input.FixedValue)}parent.appendChild(xmlInput)}};WizardController.prototype.AddFragmentOutputsNode=function(xmlDom,parent,outputs,multiDoc){for(var i=0;i<outputs.length;i++){var output=outputs[i];if(output.Placeholders.length>0||output.ResponseMetadataFields.length>0){var xmlOutput=xmlDom.createElement("Output");xmlOutput.setAttribute("Id",output.OutputGuid);for(var placeIndex=0;placeIndex<output.Placeholders.length;placeIndex++){this.AddFragmentPlaceholderNode(xmlDom,xmlOutput,output.Placeholders[placeIndex],multiDoc)}for(var responseMetadataFieldIndex=0;responseMetadataFieldIndex<output.ResponseMetadataFields.length;responseMetadataFieldIndex++){this.AddResponseMetadataNode(xmlDom,xmlOutput,output.ResponseMetadataFields[responseMetadataFieldIndex])}parent.appendChild(xmlOutput)}}};WizardController.prototype.AddPlaceholderNode=function(xmlDOM,parent,placeholders,multiDoc,source){for(var placeholderIndex=0;placeholderIndex<placeholders.length;placeholderIndex++){var placeholder=placeholders[placeholderIndex];var xmlPlaceholder=xmlDOM.createElement("Bookmark");xmlPlaceholder.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,placeholder.Name);if(placeholder.HasCloseGap){xmlPlaceholder.setAttribute("CloseGapBookmark",placeholder.CloseGapPlaceholder.name);if(placeholder.CloseGapPlaceholder.type!==Intelledox.Model.PlaceholderType.Bookmark){xmlPlaceholder.setAttribute("CloseGapType",placeholder.CloseGapPlaceholder.type.toString())}}if(placeholder.External){xmlPlaceholder.setAttribute("External","True")}else if(multiDoc||source.Documents.length===0||placeholder.DocumentGuid!==source.Documents[0].DocumentGuid){xmlPlaceholder.setAttribute("DocumentGuid",placeholder.DocumentGuid)}if(placeholder.ReverseHideValue){xmlPlaceholder.setAttribute("ReverseHideValue","True")}if(placeholder.ContentId!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlPlaceholder.setAttribute("InstanceId",placeholder.ContentId)}if(placeholder.ContentImageScale!==0){xmlPlaceholder.setAttribute("ContentImageSizeScale",placeholder.ContentImageScale.toString())}if(placeholder.PlaceholderType!==Intelledox.Model.PlaceholderType.Bookmark){xmlPlaceholder.setAttribute(Intelledox.Common.ConstantValues.XTF_TYPEID,placeholder.PlaceholderType.toString())}if(!System.String.IsNullOrEmpty(placeholder.XmlNamespace)){xmlPlaceholder.setAttribute("XmlNamespace",placeholder.XmlNamespace)}if(placeholder.Behaviour!==Design.PlaceholderBehaviour.Default){xmlPlaceholder.setAttribute("Behaviour",placeholder.Behaviour.toString())}if(!System.String.IsNullOrEmpty(placeholder.StyleName)){xmlPlaceholder.setAttribute("StyleName",placeholder.StyleName)}parent.appendChild(xmlPlaceholder)}};WizardController.prototype.AddFragmentPlaceholderNode=function(xmlDom,parent,placeholder,multiDoc){var xmlPlaceholder=xmlDom.createElement("Bookmark");xmlPlaceholder.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,placeholder.Name);if(placeholder.HasCloseGap){xmlPlaceholder.setAttribute("CloseGapBookmark",placeholder.CloseGapPlaceholder.name);if(placeholder.CloseGapPlaceholder.type!==Intelledox.Model.PlaceholderType.Bookmark){xmlPlaceholder.setAttribute("CloseGapType",placeholder.CloseGapPlaceholder.type.toString())}}if(placeholder.External){xmlPlaceholder.setAttribute("External",Design.GeneralFunctions.FromBool(placeholder.External))}else if(multiDoc){xmlPlaceholder.setAttribute("DocumentGuid",placeholder.DocumentGuid)}if(placeholder.PlaceholderType!==Intelledox.Model.PlaceholderType.Bookmark){xmlPlaceholder.setAttribute(Intelledox.Common.ConstantValues.XTF_TYPEID,placeholder.PlaceholderType.toString())}parent.appendChild(xmlPlaceholder)};WizardController.prototype.AddResponseMetadataNode=function(xmlDom,parent,responseMetadataField){var xmlResponseMetadataField=xmlDom.createElement(Intelledox.Common.ConstantValues.XTF_RESPONSEMETADATAFIELD);xmlResponseMetadataField.setAttribute(Intelledox.Common.ConstantValues.XTF_GUID,responseMetadataField.ResponseMetadataFieldGuid.toString());parent.appendChild(xmlResponseMetadataField)};WizardController.prototype.CreateStateNode=function(xmlDOM,state){var xmlStateElement=xmlDOM.createElement("State");xmlStateElement.setAttribute(Intelledox.Common.ConstantValues.XTF_ID,state.Id);if(!(state instanceof Intelledox.QAWizard.Design.FinishWorkflowState)){xmlStateElement.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,state.Name)}if(state.TransitionType!==Design.StateTransitionType.Single){xmlStateElement.setAttribute("TransitionType",state.TransitionType.toString())}if(state.AllowCancellation){xmlStateElement.setAttribute("AllowCancellation","True")}if(state.DueType===Intelledox.Model.WorkflowStateDueType.Days){xmlStateElement.setAttribute("DueAfter",state.DueAfter.toString());if(state.WorkingDays){xmlStateElement.setAttribute("WorkingDays","1")}}else if(state.DueType===Intelledox.Model.WorkflowStateDueType.QuestionReference){if(state.DueDateQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlStateElement.setAttribute("DueDateQR",state.DueDateQuestionReference)}if(state.DueDateAnswerReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlStateElement.setAttribute("DueDateAR",state.DueDateAnswerReference)}}if(state.EscalationList!=null){for(var escalationIndex=0;escalationIndex<state.EscalationList.length;escalationIndex++){var escalation=state.EscalationList[escalationIndex];var xmlEscalation=xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_ESCALATION);xmlEscalation.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,escalation.Name);xmlEscalation.setAttribute(Intelledox.Common.ConstantValues.XTF_TYPEID,escalation.Type.routingTypeId);if(escalation.InitialisationType===Intelledox.Model.EscalationInitialisationType.QuestionReference){xmlEscalation.setAttribute("ExpireDateQR",escalation.ExpiryDateQuestionReference);if(escalation.ExpiryDateAnswerReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlEscalation.setAttribute("ExpireDateAR",escalation.ExpiryDateAnswerReference)}}else{xmlEscalation.setAttribute("InitiateType",escalation.InitialisationType.toString());xmlEscalation.setAttribute("ExpireAfter",escalation.ExpireAfter.toString())}if(escalation.WorkingDays){xmlEscalation.setAttribute("WorkingDays","1")}for(var escInputIndex=0;escInputIndex<escalation.EscalationInputs.length;escInputIndex++){var routingOpt=escalation.EscalationInputs[escInputIndex];var xmlEscalationInput=xmlDOM.createElement(Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUT);xmlEscalationInput.setAttribute(Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUTGUID,routingOpt.RoutingOptionGuid);xmlEscalationInput.setAttribute("EscalationInputTypeId",routingOpt.ElementTypeId);xmlEscalationInput.setAttribute("EscalationInputSourceTypeId",routingOpt.SourceType.toString());if(!System.String.IsNullOrEmpty(routingOpt.FixedValue)){xmlEscalationInput.setAttribute(Intelledox.Common.ConstantValues.XTF_ESCALATIONINPUTVALUE,routingOpt.FixedValue)}if(routingOpt.SourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlEscalationInput.setAttribute("EscalationInputQuestionReference",routingOpt.SourceGuid)}if(routingOpt.SourceAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlEscalationInput.setAttribute("EscalationInputAnswerReference",routingOpt.SourceAttributeGuid)}if(!System.String.IsNullOrEmpty(routingOpt.FieldName)){xmlEscalationInput.setAttribute("EscalationInputFieldName",routingOpt.FieldName)}xmlEscalation.appendChild(xmlEscalationInput)}if(escalation.Recurs){var xmlRecurrence=xmlDOM.createElement("Recurrence");xmlRecurrence.setAttribute("Frequency",Intelledox.Model.FrequencyEnum[escalation.Recurrence.Frequency]);xmlRecurrence.setAttribute("Interval",escalation.Recurrence.Interval.toString());if(escalation.Recurrence.ByDay.length>0){xmlRecurrence.setAttribute("ByDay",escalation.Recurrence.ByDay.join())}if(escalation.Recurrence.ByMonthDay.length>0){xmlRecurrence.setAttribute("ByMonthDay",escalation.Recurrence.ByMonthDay.join())}if(escalation.Recurrence.BySetPosition>0){xmlRecurrence.setAttribute("BySetPosition",escalation.Recurrence.BySetPosition.toString())}if(escalation.Recurrence.RepeatCount>0){xmlRecurrence.setAttribute("RepeatOccurences",escalation.Recurrence.RepeatCount.toString())}else if(escalation.Recurrence.RepeatDays>0){xmlRecurrence.setAttribute("RepeatDays",escalation.Recurrence.RepeatDays.toString());if(escalation.Recurrence.WorkingDays){xmlRecurrence.setAttribute("WorkingDays","1")}}else if(escalation.Recurrence.RecurDateQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlRecurrence.setAttribute("RecurDateQR",escalation.Recurrence.RecurDateQuestionReference);if(escalation.Recurrence.RecurDateAnswerReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlRecurrence.setAttribute("RecurDateAR",escalation.Recurrence.RecurDateAnswerReference)}}xmlEscalation.appendChild(xmlRecurrence)}this.AddConditionsNode(xmlDOM,xmlEscalation,escalation.Conditions);xmlStateElement.appendChild(xmlEscalation)}}if(state.Transitions!=null){for(var transitionIndex=0;transitionIndex<state.Transitions.length;transitionIndex++){var trans=state.Transitions[transitionIndex];if(trans.StateId!==Intelledox.Common.ConstantValues.GUID_EMPTY){var xmlTransition=xmlDOM.createElement("Transition");xmlTransition.setAttribute("StateId",trans.StateId);xmlTransition.setAttribute("SendTo",trans.SendTo.toString());if(!System.String.IsNullOrEmpty(trans.Name)){xmlTransition.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,trans.Name)}if(trans.SendToType!==Design.StateTransitionSendToType.Specified){xmlTransition.setAttribute("SendToType",trans.SendToType.toString())}if(trans.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlTransition.setAttribute("TransQuestionReference",trans.QuestionGuid)}if(trans.AnswerGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlTransition.setAttribute("TransAnswerReference",trans.AnswerGuid)}if(trans.SendToUser!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlTransition.setAttribute("SendToUser",trans.SendToUser)}if(trans.SendToGroup!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlTransition.setAttribute("SendToGroup",trans.SendToGroup)}if(!System.String.IsNullOrEmpty(trans.SendToName)){xmlTransition.setAttribute("SendToName",trans.SendToName)}if(trans.SendToRestrictSearch&&trans.SendToRestrictGroup!=null){xmlTransition.setAttribute("SentToRestrictSearch","1");xmlTransition.setAttribute("SendToRestrictGroup",trans.SendToRestrictGroup);if(!System.String.IsNullOrEmpty(trans.SendToRestrictName)){xmlTransition.setAttribute("SendToRestrictName",trans.SendToRestrictName)}}if(trans.AllowReassign){xmlTransition.setAttribute("AllowReassign","1")}if(!trans.SendEmail){xmlTransition.setAttribute("SendEmail","0")}else{xmlTransition.setAttribute("EmailSubject",trans.EmailSubject);xmlTransition.setAttribute("EmailText",trans.EmailText)}if(trans.StartPageGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){xmlTransition.setAttribute(Intelledox.Common.ConstantValues.XTF_STARTPAGE,trans.StartPageGuid);;}if(!trans.ShowNextSteps){xmlTransition.setAttribute("ShowNextSteps","0")}if(!trans.ShowSendTo){xmlTransition.setAttribute("ShowSendTo","0")}if(!trans.ShowComment){xmlTransition.setAttribute("ShowComment","0")}else if(trans.CommentMandatory){xmlTransition.setAttribute("CommentMandatory","1")}if(!System.String.IsNullOrEmpty(trans.DefaultComment)){xmlTransition.setAttribute("DefaultComment",trans.DefaultComment)}if(trans.PageTitle!==Design.Resources.Strings.DefaultFinishTitle){xmlTransition.setAttribute("PageTitle",trans.PageTitle)}if(!System.String.IsNullOrEmpty(trans.HelpText)){xmlTransition.setAttribute("HelpText",trans.HelpText)}if(trans.SubmitButtonText!==Design.Resources.Strings.FormDefaultGenerateButtonText){xmlTransition.setAttribute("SubmitButtonText",trans.SubmitButtonText)}if(trans.SubmittingText!==Design.Resources.Strings.CurrentlySubmittingDefault){xmlTransition.setAttribute("SubmittingText",trans.SubmittingText)}if(trans.ResponsesSubmittedText!==Design.Resources.Strings.WorkflowStepCompleteDefault){xmlTransition.setAttribute("ResponsesSubmittedText",trans.ResponsesSubmittedText)}if(trans.RedirectToHome&&trans.OfflineRedirectMessage!==Design.Resources.Strings.FormQueueMessage){xmlTransition.setAttribute("OfflineRedirectMessage",trans.OfflineRedirectMessage)}if(trans.RedirectToHome){xmlTransition.setAttribute("RedirectToHome","1")}if(trans.RedirectToHome&&!trans.WaitForProject){xmlTransition.setAttribute("WaitForProject","0")}if(trans.PriorityExit){xmlTransition.setAttribute("PriorityExit","1")}if(trans.TemporaryRecipientNameQuestion!==null&&trans.TemporaryRecipientNameQuestion!==Intelledox.Common.ConstantValues.GUID_EMPTY&&trans.SendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.Temporary){xmlTransition.setAttribute("AnonymousRecipientNameQ",trans.TemporaryRecipientNameQuestion)}if(trans.TemporaryRecipientNameAnswer!==null&&trans.TemporaryRecipientNameAnswer!==Intelledox.Common.ConstantValues.GUID_EMPTY&&trans.SendTo===Intelledox.QAWizard.Design.StateTransitionSendTo.Temporary){xmlTransition.setAttribute("AnonymousRecipientNameA",trans.TemporaryRecipientNameAnswer)}if(!System.String.IsNullOrEmpty(trans.DownloadableDocuments)){xmlTransition.setAttribute(Intelledox.Common.ConstantValues.XTF_DOWNLOADABLEDOCUMENTS,trans.DownloadableDocuments)}this.AddConditionsNode(xmlDOM,xmlTransition,trans.Conditions);this.CreateActions(xmlDOM,xmlTransition,trans.Actions);for(var propIndex=0;propIndex<trans.Properties.length;propIndex++){var prop=trans.Properties[propIndex];var xmlProp=xmlDOM.createElement("Property");xmlProp.setAttribute("Id",prop.Id);xmlProp.setAttribute("Value",prop.Value);xmlTransition.appendChild(xmlProp)}xmlStateElement.appendChild(xmlTransition)}}}return xmlStateElement};WizardController.prototype.CreateParallelNode=function(xmlDOM,parallel){var parallelElement=xmlDOM.createElement("Parallel");parallelElement.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,parallel.Name);parallelElement.setAttribute("ParallelSectionGuid",parallel.ParallelSectionGuid);for(var i=0;i<parallel.States.length;i++){parallelElement.appendChild(this.CreateStateNode(xmlDOM,parallel.States[i]))}for(var i=0;i<parallel.ParallelSections.length;i++){parallelElement.appendChild(this.CreateParallelNode(xmlDOM,parallel.ParallelSections[i]))}return parallelElement};WizardController.prototype.CreateProtectedFields=function(xmlDom,xmlParent,protectedFields){for(var i=0;i<protectedFields.length;i++){var nextField=protectedFields[i];var xElement=xmlDom.createElement(Intelledox.Common.ConstantValues.XTF_PROTECTEDFIELD);xElement.setAttribute(Intelledox.Common.ConstantValues.XTF_NAME,nextField.Name);xElement.setAttribute(Intelledox.Common.ConstantValues.XTF_REFERENCE,nextField.Reference);xmlParent.appendChild(xElement)}};WizardController.prototype.CreatePageSummary=function(page){if(page.Summary==null){page.Summary=new Intelledox.QAWizard.Design.Summary.PageSummarySettings}};WizardController.prototype.CreateQuestionSummary=function(question){if(question.Summary==null){question.Summary=new Intelledox.QAWizard.Design.Summary.QuestionSummarySettings}};return WizardController}());Design.WizardController=WizardController})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var TabGroup=(function(){function TabGroup(){this.TabGroupGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.DisplayType=0;this.CssStyle=null;this.TabGroupGuid=Design.GeneralFunctions.NewGuid();this.TabPages=new Array}Object.defineProperty(TabGroup.prototype,"ObjectId",{get:function(){return this.TabGroupGuid},set:function(value){this.TabGroupGuid=value},enumerable:true,configurable:true});TabGroup.prototype.Clone=function(nextId,addQuestionsToPage){if(addQuestionsToPage===void 0){addQuestionsToPage=null}var result=new TabGroup;result.DisplayType=this.DisplayType;result.CssStyle=this.CssStyle;if(this.ActiveConditions!=null){result.ActiveConditions=this.ActiveConditions.Clone()}if(this.VisibleConditions!=null){result.VisibleConditions=this.VisibleConditions.Clone()}if(this.EditableConditions!=null){result.EditableConditions=this.EditableConditions.Clone()}for(var i=0;i<this.TabPages.length;i++){result.TabPages.push(this.TabPages[i].Clone(nextId,addQuestionsToPage))}return result};Object.defineProperty(TabGroup.prototype,"Children",{get:function(){return this.TabPages},enumerable:true,configurable:true});TabGroup.prototype.HasContainerInterface=function(){return true};TabGroup.prototype.HasLayoutInterface=function(){return true};Object.defineProperty(TabGroup.prototype,"ActiveTab",{get:function(){if(this._activeTab==null&&this.TabPages.length>0){this._activeTab=this.TabPages[0]}return this._activeTab},set:function(value){this._activeTab=value},enumerable:true,configurable:true});TabGroup.prototype.HasChild=function(childGuid){if(this.TabGroupGuid===childGuid){return true}else{for(var i=0;i<this.Children.length;i++){if(this.Children[i].HasChild(childGuid)){return true}}return false}};return TabGroup}());Design.TabGroup=TabGroup})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var WorkflowState=(function(){function WorkflowState(){this.Id=Intelledox.Common.ConstantValues.GUID_EMPTY;this.IsFixedState=false;this.AllowCancellation=false;this.DueAfter=0;this.WorkingDays=false;this.DueDateQuestionReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this.DueDateAnswerReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this.TransitionType=Design.StateTransitionType.Single;this.DueType=Intelledox.Model.WorkflowStateDueType.None;this.ParallelSectionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.Transitions=new Array;this.EscalationList=new Array}return WorkflowState}());Design.WorkflowState=WorkflowState})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var FinishWorkflowState=(function(_super){__extends(FinishWorkflowState,_super);function FinishWorkflowState(){var _this=_super.call(this)||this;_this.Id=FinishWorkflowState.FixedId;_this.Name=Design.Resources.Strings.FinishState;_this.IsFixedState=true;return _this}FinishWorkflowState.FixedId=Intelledox.Common.ConstantValues.FINISHED_STATE_GUID;return FinishWorkflowState}(Design.WorkflowState));Design.FinishWorkflowState=FinishWorkflowState})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var StartWorkflowState=(function(_super){__extends(StartWorkflowState,_super);function StartWorkflowState(){var _this=_super.call(this)||this;_this.Id=StartWorkflowState.FixedId;_this.Name=Design.Resources.Strings.StartState;_this.IsFixedState=true;return _this}StartWorkflowState.FixedId=Intelledox.Common.ConstantValues.START_STATE_GUID;return StartWorkflowState}(Design.WorkflowState));Design.StartWorkflowState=StartWorkflowState})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var QAWizard;(function(QAWizard){var Design;(function(Design){var Workflow=(function(){function Workflow(){this.ParallelSections=new Array;this.ParallelSectionGuid=Design.GeneralFunctions.NewGuid()}Object.defineProperty(Workflow.prototype,"HasWorkflow",{get:function(){var start=this.GetStartState();if(start==null){return false}else{return(start.Transitions.length>0)}},enumerable:true,configurable:true});Workflow.prototype.GetStartState=function(){if(this.States==null){return null}else{for(var i=0;i<this.States.length;i++){if(this.States[i]instanceof Design.StartWorkflowState){return this.States[i]}}return null}};Object.defineProperty(Workflow.prototype,"DirectStates",{get:function(){if(this.States==null){return[]}else{var returnStates=Array();returnStates.push.apply(returnStates,this.FullStateList);for(var i=0;i<returnStates.length;i++){if(returnStates[i]instanceof Design.FinishWorkflowState){returnStates.splice(i,1);break}}returnStates.sort(function(a,b){if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0});for(var i=0;i<returnStates.length;i++){if(returnStates[i]instanceof Design.StartWorkflowState){var fixedState=returnStates[i];returnStates.splice(i,1);returnStates.splice(0,0,fixedState)}}return returnStates}},enumerable:true,configurable:true});Object.defineProperty(Workflow.prototype,"AllStatesWithoutFinish",{get:function(){if(this.States==null){return[]}else{var returnStates=Array();returnStates.push.apply(returnStates,this.FullStateList);for(var i=0;i<returnStates.length;i++){if(returnStates[i]instanceof Design.FinishWorkflowState){returnStates.splice(i,1);break}}returnStates.sort(function(a,b){if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0});for(var i=0;i<returnStates.length;i++){if(returnStates[i]instanceof Design.StartWorkflowState){var fixedState=returnStates[i];returnStates.splice(i,1);returnStates.splice(0,0,fixedState)}}return returnStates}},enumerable:true,configurable:true});Workflow.prototype.FullSectionList=function(){var result=new Array;for(var i=0;i<this.ParallelSections.length;i++){var parallel=this.ParallelSections[i];result.push(parallel);var fullList=parallel.FullSectionList();for(var fullIndex=0;fullIndex<fullList.length;fullIndex++){result.push(fullList[fullIndex])}}return result};Object.defineProperty(Workflow.prototype,"FullStateList",{get:function(){var returnStates=new Array;if(this.States!=null){returnStates.push.apply(returnStates,this.States)}for(var i=0;i<this.ParallelSections.length;i++){returnStates.push.apply(returnStates,this.ParallelSections[i].FullStateList)}return returnStates},enumerable:true,configurable:true});Workflow.prototype.HasParallelSectionName=function(sectionName){for(var i=0;i<this.ParallelSections.length;i++){if(this.ParallelSections[i].Name===sectionName){return true}}return false};Workflow.prototype.RemoveState=function(state){if(this.States.indexOf(state)>-1){this.States.splice(this.States.indexOf(state),1);return true}else{for(var i=0;i<this.ParallelSections.length;i++){if(this.ParallelSections[i].RemoveState(state)){return true}}}return false};Workflow.prototype.RemoveParallel=function(parallel){if(this.ParallelSections.indexOf(parallel)>-1){this.ParallelSections.splice(this.ParallelSections.indexOf(parallel),1);return true}else{for(var i=0;i<this.ParallelSections.length;i++){if(this.ParallelSections[i].RemoveParallel(parallel)){return true}}}return false};Workflow.prototype.GetSection=function(parallelSectionGuid){if(parallelSectionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){if(this.ParallelSectionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return this}else{return null}}var fullList=this.FullSectionList();for(var i=0;i<fullList.length;i++){if(fullList[i].ParallelSectionGuid===parallelSectionGuid){return fullList[i]}}return null};Workflow.prototype.ValidTransitions=function(fromState){var result=[];if(fromState.ParallelSectionGuid===this.ParallelSectionGuid){result.push.apply(result,this.States);for(var i=0;i<this.ParallelSections.length;i++){result.push.apply(result,this.ParallelSections[i].States)}}else{for(var i=0;i<this.ParallelSections.length;i++){result=this.ParallelSections[i].ValidTransitions(fromState);if(result.length>0){result.push.apply(result,this.States);return result}}}return result};Workflow.prototype.GetState=function(stateGuid){var fullList=this.FullStateList;for(var i=0;i<fullList.length;i++){if(fullList[i].Id===stateGuid){return fullList[i]}}return null};return Workflow}());Design.Workflow=Workflow})(Design=QAWizard.Design||(QAWizard.Design={}))})(QAWizard=Intelledox.QAWizard||(Intelledox.QAWizard={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var RecentProjects=(function(){function RecentProjects(){}RecentProjects.prototype.getList=function(){var items=localStorage.getItem('recentProjects');if(items==null||items===''){return[]}return JSON.parse(items)};RecentProjects.prototype.addRecent=function(projectGuid,name){var currentList=this.getList(),i=0;for(i=0;i<currentList.length;i++){if(currentList[i].projectGuid===projectGuid){currentList.splice(i,1);break}}currentList.splice(0,0,{name:name,projectGuid:projectGuid});if(currentList.length>=7){currentList.splice(7,1)}this.storeList(currentList)};RecentProjects.prototype.removeRecent=function(projectGuid){var currentList=this.getList(),i=0;for(i=0;i<currentList.length;i++){if(currentList[i].projectGuid===projectGuid){currentList.splice(i,1);break}}this.storeList(currentList)};RecentProjects.prototype.storeList=function(items){localStorage.setItem('recentProjects',JSON.stringify(items))};return RecentProjects}());Design.RecentProjects=RecentProjects;angular.module("Design").service("recentProjects",[RecentProjects]);angular.module("Startup").service("recentProjects",[RecentProjects])})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var System;(function(System){'use strict';var String=(function(){function String(){}String.IsNullOrEmpty=function(s){return(s==null||s==="")};String.IsNullOrWhiteSpace=function(s){return(s==null||s===""||s.trim()==="")};String.StartsWith=function(s,find){if(find===null){throw"Value cannot be null.\r\nParameter name: find";}return s.lastIndexOf(find,0)===0};String.StartsWithIgnoreCase=function(s,find){if(find===null){throw"Value cannot be null.\r\nParameter name: find";}return s.toUpperCase().lastIndexOf(find.toUpperCase(),0)===0};String.EndsWith=function(s,find){if(find===null){throw"Value cannot be null.\r\nParameter name: find";}return s.indexOf(find,s.length-find.length)!==-1};String.Trim=function(s,chars){chars=chars.replace(/[\[\](){}?*+\^$\\.|\-]/g,"\\$&");return s.replace(new RegExp("^["+chars+"]+|["+chars+"]+$","g"),'')};String.Substring=function(s,startIndex,length){if(length<0){throw"Length cannot be less than zero.\r\nParameter name: length";}return s.substring(startIndex,startIndex+length)};String.Remove=function(s,startIndex,count){return s.substring(0,startIndex)+s.substring(startIndex+count)};String.Insert=function(s,startIndex,value){return s.substring(0,startIndex)+value+s.substring(startIndex)};String.Format=function(s){var args=[];for(var _i=1;_i<arguments.length;_i++){args[_i-1]=arguments[_i]}if(arguments.length===2){return s.replace("{0}",arguments[1])}if(arguments.length===3){return s.replace("{0}",arguments[1]).replace("{1}",arguments[2])}for(var i=1;i<arguments.length;i++){s=s.replace("{"+(i-1).toString()+"}",arguments[i])}return s};return String}());System.String=String})(System||(System={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var DataFilterPanelViewModel=(function(){function DataFilterPanelViewModel($filter,editorViewModel){this._wizard=null;this._listManager=null;this._currentQuestion=null;this._isInitializing=false;this._selectedParentType=Intelledox.QAWizard.Design.FilterParentType.Reference;this._selectedField='';this._selectedInput=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedComparisonType=Intelledox.Model.ComparisonType.None;this._constant='';this._isAggregate=false;this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.isConstantVisible=false;this.isInputVisible=true;this.isQuestionVisible=true;this.isAnswerEnabled=false;this.isParentFieldVisible=false;this.isAggregateVisible=false;this.availableFieldWidth=0;this.availableParentTypes=[];this.availableFields=[];this.availableInputs=[];this.availableQuestions=[];this.availableAnswers=[];this.availableParentFields=[];this.availableComparisonTypes=[];var vm=this;this._editorViewModel=editorViewModel;this._filter=$filter;this.clauseDesignerModel=new Design.ClauseDesignerViewModel($filter,editorViewModel);this.clauseDesignerModel.replaceClause=function(node){vm.clauseViewReplaceClause(node)};this.clauseDesignerModel.clauseSelected=function(){if(vm.clauseDesignerModel.clausesTreeView.selectedNode.tag.Type===Intelledox.Model.ClauseType.Comparison){vm.loadFilter(vm.clauseDesignerModel.clausesTreeView.selectedNode.tag)}vm.updateCompareButtons()};this.clauseDesignerModel.clauseDrop=function(dropNode,targetNode){vm.clauseDrop(dropNode,targetNode)}}Object.defineProperty(DataFilterPanelViewModel.prototype,"selectedField",{get:function(){return this._selectedField},set:function(value){this._selectedField=value;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(DataFilterPanelViewModel.prototype,"selectedParentType",{get:function(){return this._selectedParentType},set:function(value){this._selectedParentType=value;if(!this._isInitializing){this.parentTypeChanged()}},enumerable:true,configurable:true});Object.defineProperty(DataFilterPanelViewModel.prototype,"selectedQuestionGuid",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;var vm=this;var isAutoChange=this._isInitializing;this._isInitializing=true;this.availableAnswers=[];this.availableParentFields=[];if(value!=null&&value!==Intelledox.Common.ConstantValues.GUID_EMPTY){var currentParentQuestion=this.findSelectedQuestion(value);if(currentParentQuestion==null){this.isParentFieldVisible=false;this.isAggregate=false;this.isAggregateVisible=false}else if(currentParentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.isParentFieldVisible=true;if(currentParentQuestion.SelectionType===Intelledox.Model.SelectionType.Multiple){this.isAggregateVisible=true}else{this.isAggregate=false;this.isAggregateVisible=false}var fieldSortingFunc=function(a,b){if(a.name>b.name){return 1}if(a.name<b.name){return-1}return 0};this.availableParentFields.push({name:this._filter('translate')('NoneWithBrackets'),value:''});if(currentParentQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){Design.HierarchyHelper.getDataFields(this._wizard,this._listManager,currentParentQuestion,this.availableFieldWidth,true).then(function(fields){fields.sort(fieldSortingFunc);vm.availableParentFields.push.apply(vm.availableParentFields,fields)})}else if(currentParentQuestion.IsQARepeater){var fields=Design.QARepeatHelper.getDataFields(this._filter,this._wizard,currentParentQuestion);fields.sort(fieldSortingFunc);vm.availableParentFields.push.apply(vm.availableParentFields,fields)}else if(currentParentQuestion.DataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var dataSourceGuid=currentParentQuestion.DataSourceGuid;var dataObjectGuid=currentParentQuestion.DataObjectGuid;if(dataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&dataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this._listManager.dataFieldsList(dataObjectGuid,this.availableFieldWidth,true,'').then(function(fields){fields.sort(fieldSortingFunc);vm.availableParentFields.push.apply(vm.availableParentFields,fields)})}}}else{this.isParentFieldVisible=false;this.isAggregate=false;this.isAggregateVisible=false;this.availableAnswers.push(new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));for(var i=0;i<currentParentQuestion.Answers.length;i++){this.availableAnswers.push(currentParentQuestion.Answers[i])}this.availableAnswers.sort(function(a,b){if(a.AnswerGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return-1}if(b.AnswerGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return 1}if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0})}this.isAnswerEnabled=true}this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.selectedParentField='';this._isInitializing=isAutoChange;if(!this._isInitializing){this.updateCompareButtons()}},enumerable:true,configurable:true});Object.defineProperty(DataFilterPanelViewModel.prototype,"selectedAnswerGuid",{get:function(){return this._selectedAnswerGuid},set:function(value){this._selectedAnswerGuid=value;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(DataFilterPanelViewModel.prototype,"selectedParentField",{get:function(){return this._selectedParentField},set:function(value){this._selectedParentField=value;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(DataFilterPanelViewModel.prototype,"selectedComparisonType",{get:function(){return this._selectedComparisonType},set:function(value){this._selectedComparisonType=value;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(DataFilterPanelViewModel.prototype,"selectedInput",{get:function(){return this._selectedInput},set:function(value){this._selectedInput=value;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(DataFilterPanelViewModel.prototype,"constant",{get:function(){return this._constant},set:function(value){this._constant=value;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(DataFilterPanelViewModel.prototype,"isAggregate",{get:function(){return this._isAggregate},set:function(value){this._isAggregate=value},enumerable:true,configurable:true});DataFilterPanelViewModel.prototype.add=function(){var newFilter=new Intelledox.QAWizard.Design.Filter;newFilter.Question=this._currentQuestion;this.updateFilterDetails(newFilter);this._editorViewModel.wizChanged=true;if(this._currentQuestion.Filters==null){this._currentQuestion.Filters=newFilter}else{this._currentQuestion.Filters.Add(newFilter)}this.clauseDesignerModel.setParentClause(this._currentQuestion.Filters);this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(newFilter)};DataFilterPanelViewModel.prototype.update=function(){var updateFilter=this.clauseDesignerModel.clausesTreeView.selectedNode.tag;this.updateFilterDetails(updateFilter);this._editorViewModel.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting()};DataFilterPanelViewModel.prototype.remove=function(){var node=this.clauseDesignerModel.clausesTreeView.selectedNode;var filt=this.clauseDesignerModel.clausesTreeView.selectedNode.tag;if(node.parent==null){this._currentQuestion.Filters=new Intelledox.QAWizard.Design.Filter(Intelledox.Model.ClauseType.Basic)}else{node.parent.tag.SubClauses.splice(node.parent.tag.SubClauses.indexOf(filt),1)}this._editorViewModel.wizChanged=true;this.clauseDesignerModel.setParentClause(this._currentQuestion.Filters);this.clauseDesignerModel.fillClauseViewFromExisting();this.updateCompareButtons()};DataFilterPanelViewModel.prototype.init=function(wizard,currentQuestion,lists){var vm=this;this._wizard=wizard;this._loadedWithDataObjectGuid=currentQuestion.DataObjectGuid;this._loadedWithDataSourceRepeatXPath=currentQuestion.DataSourceRepeatXPath;this._loadedWithDisplayType=currentQuestion.DisplayType;this._currentQuestion=currentQuestion;this._listManager=lists;var isAutoChange=this._isInitializing;this._isInitializing=true;if(this._currentQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var parentQuestion=this._currentQuestion.GetRootDatasourceQuestion(this._wizard);if(parentQuestion==null){this.populateComparisonTypes(Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.Common.ConstantValues.GUID_EMPTY,true)}else{this.populateComparisonTypes(parentQuestion.DataSourceGuid,parentQuestion.DataObjectGuid,true)}}else{this.populateComparisonTypes(this._currentQuestion.DataSourceGuid,this._currentQuestion.DataObjectGuid,false)}this.availableQuestions=[];this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.availableAnswers=[];this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.selectedParentField='';this.constant="";for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pageItem=wizard.Pages[pageIndex];var found=false;for(var questionIndex=0;questionIndex<pageItem.Questions.length;questionIndex++){var questionItem=pageItem.Questions[questionIndex];if(questionItem.QuestionGuid===this._currentQuestion.QuestionGuid){found=true;break}if(this._currentQuestion.IsValidFilterParent(questionItem)){this.availableQuestions.push(questionItem)}}if(found){break}}this.availableQuestions.sort(function(a,b){if(a.Text>b.Text){return 1}if(a.Text<b.Text){return-1}return 0});this.availableQuestions.splice(0,0,new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.availableFields=[];this.availableFields.push({name:this._filter('translate')('NoneWithBrackets'),value:''});if(this._currentQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){Design.HierarchyHelper.getKeyFields(this._wizard,this._listManager,this._currentQuestion,this.availableFieldWidth).then(function(keyFields){vm.availableFields.push.apply(vm.availableFields,keyFields)})}else if(this._currentQuestion.IsQARepeater){var keyFields=Design.QARepeatHelper.getKeyFields(this._filter,this._wizard,this._currentQuestion);vm.availableFields.push.apply(vm.availableFields,keyFields)}else{this._listManager.keyFieldsList(this._currentQuestion.DataObjectGuid,this.availableFieldWidth,"").then(function(keyFields){vm.availableFields.push.apply(vm.availableFields,keyFields)})}if(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPage||this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){this.loadInputs()}this.fillTypeDropdown();this.parentTypeChanged();if(this._currentQuestion.Filters==null){this._currentQuestion.Filters=new Intelledox.QAWizard.Design.Filter(Intelledox.Model.ClauseType.Basic)}this.clauseDesignerModel.init(this._currentQuestion.Filters,this._wizard,this._listManager,this._currentQuestion);this._isInitializing=isAutoChange};DataFilterPanelViewModel.prototype.pickRef=function(){var _this=this;this._editorViewModel.treeView.pickEvent=function(node){_this.onPickRef(node)};this._editorViewModel.treeView.togglePickMode()};DataFilterPanelViewModel.prototype.onPickRef=function(node){if(node.tag instanceof Intelledox.QAWizard.Design.Question){this.selectedQuestionGuid=node.tag.QuestionGuid}else if(node.tag instanceof Intelledox.QAWizard.Design.Answer){this.selectedQuestionGuid=node.parent.tag.QuestionGuid;if(node.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){if(node.tag.DataField!=="[Formula]"&&node.tag.DataField!=="[Aggregate]"){this.selectedParentField=node.tag.DataField}else{this.selectedParentField=''}}else{this.selectedAnswerGuid=node.tag.AnswerGuid}}};DataFilterPanelViewModel.prototype.loadFilter=function(currentFilter){this.selectedField=currentFilter.FieldName;this.selectedComparisonType=currentFilter.ComparisonType;this.selectedParentType=currentFilter.ParentType;if(currentFilter.ParentType===Intelledox.QAWizard.Design.FilterParentType.Constant){this.constant=Design.TranslationHelper.KeywordValueToTranslation(this._filter,currentFilter.ConstantValue);this.isAggregate=false}else if(currentFilter.ParentType===Intelledox.QAWizard.Design.FilterParentType.Input){this.selectedInput=currentFilter.ParentItemGuid;this.isAggregate=false}else{this.isAggregate=currentFilter.IsAggregate;this.selectedQuestionGuid=currentFilter.ParentItemGuid;if(currentFilter.ParentAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.selectedAnswerGuid=currentFilter.ParentAttributeGuid;this.selectedParentField=''}else if(currentFilter.ParentFieldName!==''){this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.selectedParentField=currentFilter.ParentFieldName}}this.parentTypeChanged()};DataFilterPanelViewModel.prototype.populateComparisonTypes=function(dataServiceGuid,dataObjectGuid,isHierarchicalChild){this.availableComparisonTypes=[];if(dataServiceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&dataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var comparisons;if(dataServiceGuid===Intelledox.Common.ConstantValues.QAREPEAT){comparisons=[];comparisons.push(Intelledox.Model.ComparisonType.Equals);comparisons.push(Intelledox.Model.ComparisonType.NotEqualTo);comparisons.push(Intelledox.Model.ComparisonType.GreaterThan);comparisons.push(Intelledox.Model.ComparisonType.GreaterThanOrEquals);comparisons.push(Intelledox.Model.ComparisonType.LessThan);comparisons.push(Intelledox.Model.ComparisonType.LessThanOrEquals);comparisons.push(Intelledox.Model.ComparisonType.Contains);comparisons.push(Intelledox.Model.ComparisonType.NotContain);comparisons.push(Intelledox.Model.ComparisonType.BeginsWith);comparisons.push(Intelledox.Model.ComparisonType.EndsWith);comparisons.push(Intelledox.Model.ComparisonType.ContainedIn);comparisons.push(Intelledox.Model.ComparisonType.NotContainedIn);this.populateComparisonTypesResults(comparisons);this.clauseDesignerModel.supportsNesting=true}else if(isHierarchicalChild){var vm=this;this._listManager.supportedHierarchicalFilterComparisons(dataServiceGuid,dataObjectGuid).then(function(comparisons){vm.populateComparisonTypesResults(comparisons);if(comparisons.length===1&&comparisons[0]===Intelledox.Model.ComparisonType.Equals){vm.clauseDesignerModel.supportsNesting=false}else{vm.clauseDesignerModel.supportsNesting=true}})}else{var vm=this;this._listManager.supportedFilterComparisons(dataServiceGuid,dataObjectGuid).then(function(comparisons){vm.populateComparisonTypesResults(comparisons);if(comparisons.length===1&&comparisons[0]===Intelledox.Model.ComparisonType.Equals){vm.clauseDesignerModel.supportsNesting=false}else{vm.clauseDesignerModel.supportsNesting=true}})}}};DataFilterPanelViewModel.prototype.populateComparisonTypesResults=function(comparisions){if(comparisions.indexOf(Intelledox.Model.ComparisonType.Equals)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('EqualsString'),value:Intelledox.Model.ComparisonType.Equals})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.NotEqualTo)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('NotEqualTo'),value:Intelledox.Model.ComparisonType.NotEqualTo})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.GreaterThan)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThan'),value:Intelledox.Model.ComparisonType.GreaterThan})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.GreaterThanOrEquals)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThanorEquals'),value:Intelledox.Model.ComparisonType.GreaterThanOrEquals})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.LessThan)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('LessThan'),value:Intelledox.Model.ComparisonType.LessThan})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.LessThanOrEquals)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('LessThanorEquals'),value:Intelledox.Model.ComparisonType.LessThanOrEquals})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.Contains)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('Contains'),value:Intelledox.Model.ComparisonType.Contains})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.NotContain)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('DoesntContain'),value:Intelledox.Model.ComparisonType.NotContain})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.BeginsWith)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('BeginsWith'),value:Intelledox.Model.ComparisonType.BeginsWith})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.EndsWith)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('EndsWith'),value:Intelledox.Model.ComparisonType.EndsWith})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.ContainedIn)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('ContainedIn'),value:Intelledox.Model.ComparisonType.ContainedIn})}if(comparisions.indexOf(Intelledox.Model.ComparisonType.NotContainedIn)>-1){this.availableComparisonTypes.push({name:this._filter('translate')('NotContainedIn'),value:Intelledox.Model.ComparisonType.NotContainedIn})}this.selectedComparisonType=this.availableComparisonTypes[0].value};DataFilterPanelViewModel.prototype.fillTypeDropdown=function(){this.availableParentTypes=[];this.availableParentTypes.push({name:this._filter('translate')('ParentQuestion'),value:Intelledox.QAWizard.Design.FilterParentType.Reference});this.availableParentTypes.push({name:this._filter('translate')('ConstantValue'),value:Intelledox.QAWizard.Design.FilterParentType.Constant});if(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPage||this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){this.availableParentTypes.push({name:this._filter('translate')('Input'),value:Intelledox.QAWizard.Design.FilterParentType.Input})}if(this._currentQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.AutoComplete){this.availableParentTypes.push({name:this._filter('translate')('UserEntered'),value:Intelledox.QAWizard.Design.FilterParentType.UserEntered})}};DataFilterPanelViewModel.prototype.loadInputs=function(){this.availableInputs=[];for(var i=0;i<this._wizard.AvailableInputs.length;i++){if(this._wizard.AvailableInputs[i].valueType!==Intelledox.Model.ValueTypes.Repeat){this.availableInputs.push(this._wizard.AvailableInputs[i])}}if(this.availableInputs.length>0){this.selectedInput=this.availableInputs[0].routingElementTypeId}};DataFilterPanelViewModel.prototype.parentTypeChanged=function(){if(this.selectedParentType===Intelledox.QAWizard.Design.FilterParentType.Reference){this.isConstantVisible=false;this.isInputVisible=false;this.isQuestionVisible=true}else if(this.selectedParentType===Intelledox.QAWizard.Design.FilterParentType.Constant){this.isConstantVisible=true;this.isInputVisible=false;this.isQuestionVisible=false}else if(this.selectedParentType===Intelledox.QAWizard.Design.FilterParentType.Input){this.isConstantVisible=false;this.isInputVisible=true;this.isQuestionVisible=false}else if(this.selectedParentType===Intelledox.QAWizard.Design.FilterParentType.UserEntered){this.isConstantVisible=false;this.isInputVisible=false;this.isQuestionVisible=false}this.updateCompareButtons()};DataFilterPanelViewModel.prototype.updateCompareButtons=function(){this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;if(!System.String.IsNullOrEmpty(this._selectedField)){if(this.isQuestionVisible&&this.selectedQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.isAddEnabled=true}else if(this.isConstantVisible){this.isAddEnabled=true}else if(this.isInputVisible&&this.selectedInput!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.isAddEnabled=true}else if(this.selectedParentType===Intelledox.QAWizard.Design.FilterParentType.UserEntered){this.isAddEnabled=true}else{this.isAddEnabled=false}}var node=this.clauseDesignerModel.clausesTreeView.selectedNode;if(node!=null){if(node.tag.Type===Intelledox.Model.ClauseType.Comparison){this.isUpdateEnabled=this.isAddEnabled;this.isRemoveEnabled=true}else{this.isUpdateEnabled=false;this.isRemoveEnabled=false}}else{this.isUpdateEnabled=false;this.isRemoveEnabled=false}};DataFilterPanelViewModel.prototype.findSelectedQuestion=function(questionGuid){for(var i=0;i<this.availableQuestions.length;i++){if(questionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};DataFilterPanelViewModel.prototype.clauseViewReplaceClause=function(copyClause){if(copyClause==null){this._currentQuestion.Filters=new Intelledox.QAWizard.Design.Filter(Intelledox.Model.ClauseType.Basic)}else{if(copyClause instanceof Intelledox.QAWizard.Design.Filter){this._currentQuestion.Filters=copyClause.CloneFilter(this._currentQuestion)}else if(copyClause instanceof Intelledox.QAWizard.Design.Condition){alert(this._filter('translate')('ErrorMsg_CannotCopyConditionToValidatorAndDataFilter'));return}else if(copyClause instanceof Intelledox.QAWizard.Design.ValidationRule){alert(this._filter('translate')('ErrorMsg_CannotCopyValidatorRuleToOtherTabs'));return}else if(copyClause instanceof Intelledox.QAWizard.Design.Rule){alert(this._filter('translate')('ErrorMsg_CannotCopyRuleToValidatorAndDataFilter'));return}}this.clauseDesignerModel.setParentClause(this._currentQuestion.Filters);this.clauseDesignerModel.fillClauseViewFromExisting();this.updateCompareButtons();this._editorViewModel.wizChanged=true};DataFilterPanelViewModel.prototype.updateFilterDetails=function(filt){filt.FieldName=this._selectedField;filt.ComparisonType=this.selectedComparisonType;if(this.selectedParentType===Intelledox.QAWizard.Design.FilterParentType.Reference){filt.ParentType=Intelledox.QAWizard.Design.FilterParentType.Reference;filt.ParentItemGuid=this.selectedQuestionGuid;filt.ConstantValue='';filt.IsAggregate=this.isAggregate;if(this.isParentFieldVisible){filt.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;filt.ParentFieldName=this.selectedParentField}else{filt.ParentAttributeGuid=this.selectedAnswerGuid;filt.ParentFieldName=''}}else if(this.selectedParentType===Intelledox.QAWizard.Design.FilterParentType.Input){filt.ParentType=Intelledox.QAWizard.Design.FilterParentType.Input;filt.ParentItemGuid=this.selectedInput;filt.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;filt.ParentFieldName='';filt.ConstantValue='';filt.IsAggregate=false}else if(this.selectedParentType===Intelledox.QAWizard.Design.FilterParentType.UserEntered){filt.ParentType=Intelledox.QAWizard.Design.FilterParentType.UserEntered;filt.ParentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;filt.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;filt.ParentFieldName='';filt.ConstantValue='';filt.IsAggregate=false}else{filt.ParentType=Intelledox.QAWizard.Design.FilterParentType.Constant;filt.ParentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;filt.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;filt.ParentFieldName='';filt.IsAggregate=false;filt.ConstantValue=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.constant)}};DataFilterPanelViewModel.prototype.activate=function(){if(this._currentQuestion.DataObjectGuid!==this._loadedWithDataObjectGuid||this._currentQuestion.DataSourceRepeatXPath!==this._loadedWithDataSourceRepeatXPath||this._currentQuestion.DisplayType!==this._loadedWithDisplayType){this.init(this._wizard,this._currentQuestion,this._listManager)}};DataFilterPanelViewModel.prototype.clauseDrop=function(dragNode,targetNode){if(dragNode.treeView===this.clauseDesignerModel.clausesTreeView){if(dragNode!==targetNode&&!dragNode.isDecendantOf(targetNode)){var hitFilter=targetNode.tag;dragNode.parent.tag.SubClauses.splice(dragNode.parent.tag.SubClauses.indexOf(dragNode.tag),1);if(hitFilter.Type===Intelledox.Model.ClauseType.Comparison){hitFilter=targetNode.parent.tag}hitFilter.Add(dragNode.tag);this._editorViewModel.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(hitFilter)}}else{var childObject=this._currentQuestion;var newFilt=null;var parent=null;if(dragNode.tag instanceof Intelledox.QAWizard.Design.Question){if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){alert(this._filter('translate')('ErrorMsg_InvalidParentDatasource'))}else{parent=dragNode.tag;newFilt=new Intelledox.QAWizard.Design.Filter;newFilt.ParentType=Intelledox.QAWizard.Design.FilterParentType.Reference;newFilt.ParentItemGuid=dragNode.tag.QuestionGuid;newFilt.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;newFilt.ParentFieldName=''}}else if(dragNode.tag instanceof Intelledox.QAWizard.Design.Answer){parent=dragNode.parent.tag;newFilt=new Intelledox.QAWizard.Design.Filter;newFilt.ParentType=Intelledox.QAWizard.Design.FilterParentType.Reference;newFilt.ParentItemGuid=dragNode.parent.tag.QuestionGuid;if(dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){newFilt.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;newFilt.ParentFieldName=dragNode.tag.DataField}else{newFilt.ParentAttributeGuid=dragNode.tag.AnswerGuid;newFilt.ParentFieldName=''}newFilt.ParentFieldName=''}else if(dragNode.tag instanceof Intelledox.QAWizard.Design.AvailableInput){parent=dragNode.tag;newFilt=new Intelledox.QAWizard.Design.Filter;newFilt.ParentType=Intelledox.QAWizard.Design.FilterParentType.Input;newFilt.ParentItemGuid=dragNode.tag.routingElementTypeId;newFilt.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;newFilt.ParentFieldName=''}if(newFilt!=null){if(System.String.IsNullOrEmpty(this._selectedField)){alert(this._filter('translate')('ErrorMsg_MissingFilterFieldSelection'))}else if((parent instanceof Intelledox.QAWizard.Design.Question&&this.availableQuestions.indexOf(parent)>-1)||(parent instanceof Intelledox.QAWizard.Design.AvailableInput)){newFilt.Question=this._currentQuestion;newFilt.FieldName=this._selectedField;newFilt.ComparisonType=this.selectedComparisonType;newFilt.ConstantValue='';newFilt.IsAggregate=false;if(targetNode==null){if(this._currentQuestion.Filters==null){this._currentQuestion.Filters=newFilt}else{newFilt=this._currentQuestion.Filters.Add(newFilt)}}else{if(targetNode.tag.Type===Intelledox.Model.ClauseType.AllOf||targetNode.tag.Type===Intelledox.Model.ClauseType.AnyOf){targetNode.tag.SubClauses.push(newFilt)}else if(targetNode.parent!=null){targetNode.parent.tag.SubClauses.push(newFilt)}else{newFilt=this._currentQuestion.Filters.Add(newFilt)}}this._editorViewModel.wizChanged=true;this.clauseDesignerModel.setParentClause(this._currentQuestion.Filters);this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(newFilt)}else{alert(this._filter('translate')('ErrorMsg_InvalidParent'))}}}};return DataFilterPanelViewModel}());Design.DataFilterPanelViewModel=DataFilterPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var CustomPropertiesViewModel=(function(_super){__extends(CustomPropertiesViewModel,_super);function CustomPropertiesViewModel(editorViewModel,question,wizard,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this.inputsPanelModel=null;_this.isInputsPanelVisible=false;var vm=_this;_this.inputsPanelModel=new Design.InputsPanelViewModel($filter,editorViewModel,question,wizard,lists);lists.customQuestionInputTypes(question.CustomQuestionTypeId).then(function(types){if(types.length>0){vm.isInputsPanelVisible=true}});return _this}return CustomPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.CustomPropertiesViewModel=CustomPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var BarcodeAnswerPropertiesViewModel=(function(_super){__extends(BarcodeAnswerPropertiesViewModel,_super);function BarcodeAnswerPropertiesViewModel(editorViewModel,question,answer,$filter,lists){var _this=_super.call(this,editorViewModel,question,answer,$filter,lists)||this;answer.ImageSettings.StretchToFit=true;_this.imageProperties=new Design.ImagePropertiesViewModel($filter,editorViewModel,answer.ImageSettings);_this.imageProperties.isAlternativeTextVisible=true;_this.imageProperties.isStretchToFitEnabled=false;return _this}return BarcodeAnswerPropertiesViewModel}(Design.AnswerPropertiesViewModel));Design.BarcodeAnswerPropertiesViewModel=BarcodeAnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var CustomAnswerPropertiesViewModel=(function(_super){__extends(CustomAnswerPropertiesViewModel,_super);function CustomAnswerPropertiesViewModel(editorViewModel,question,answer,$filter,lists){var _this=_super.call(this,editorViewModel,question,answer,$filter,lists)||this;_this.isImagePropertiesVisible=false;_this.availableOutputs=[];_this._filterLocal=$filter;_this._editor=editorViewModel;_this._listManager=lists;_this._customAnswer=answer;_this.imageProperties=new Design.ImagePropertiesViewModel($filter,editorViewModel,answer.ImageSettings);_this.imageProperties.isAlternativeTextVisible=true;_this.loadOutputs();return _this}Object.defineProperty(CustomAnswerPropertiesViewModel.prototype,"customField",{get:function(){return this._customField},set:function(value){this._customField=value;this._customAnswer.OutputTypeId=value;this._editor.wizChanged=true;this.isImagePropertiesVisible=false;for(var i=0;i<this.availableOutputs.length;i++){if(this.availableOutputs[i].value===value&&this.availableOutputs[i].isImage){this.isImagePropertiesVisible=true}}},enumerable:true,configurable:true});CustomAnswerPropertiesViewModel.prototype.loadOutputs=function(){var vm=this;this.availableOutputs=[];this.availableOutputs.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY,isImage:false});this._listManager.customQuestionOutputTypes(this._customAnswer.Question.CustomQuestionTypeId).then(function(customTypes){for(var i=0;i<customTypes.length;i++){vm.availableOutputs.push({name:customTypes[i].description,value:customTypes[i].routingElementTypeId,isImage:(customTypes[i].outputType===Intelledox.Model.CustomQuestionOutputType.Image)});if(vm._customAnswer.OutputTypeId===customTypes[i].routingElementTypeId&&customTypes[i].outputType===Intelledox.Model.CustomQuestionOutputType.Image){vm.isImagePropertiesVisible=true}}vm._customField=vm._customAnswer.OutputTypeId})};return CustomAnswerPropertiesViewModel}(Design.AnswerPropertiesViewModel));Design.CustomAnswerPropertiesViewModel=CustomAnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var InkPropertiesViewModel=(function(_super){__extends(InkPropertiesViewModel,_super);function InkPropertiesViewModel(editorViewModel,question,wizard,$filter,$uibModal,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this.BackgroundSourceOptions=[{name:'StaticImage',value:Intelledox.Model.BackgroundSource.StaticImage},{name:'QuestionReference',value:Intelledox.Model.BackgroundSource.QuestionReference}];_this.questionReferenceModel=null;_this.backgroundImage=Intelledox.Common.ConstantValues.DATA_URI_BLANK;_this.isStaticImageField=false;_this.isResizeBackgroundVisible=false;_this.isImagePropertiesVisible=false;_this._editor=editorViewModel;_this._ink=question;_this._filterLocal=$filter;_this._modal=$uibModal;_this._wizard=wizard;_this._inkquestion=question;_this.imageProperties=new Design.ImagePropertiesViewModel($filter,editorViewModel,_this._ink.ImageSettings);if(!System.String.IsNullOrEmpty(_this._ink.BackgroundImage)){_this.backgroundImage=Intelledox.Common.ConstantValues.DATA_URI_PREFIX+_this._ink.BackgroundImage}_this.loadColours();_this.displayControls($filter,editorViewModel,wizard,question);_this.questionReferenceModel=new Design.QuestionReferenceViewModel($filter,editorViewModel,wizard,question);return _this}Object.defineProperty(InkPropertiesViewModel.prototype,"backgroundSource",{get:function(){return this._ink.BackgroundSource},set:function(value){this._ink.BackgroundSource=value;this._editor.wizChanged=true;this.displayControls(this._filterLocal,this._editor,this._wizard,this._inkquestion)},enumerable:true,configurable:true});Object.defineProperty(InkPropertiesViewModel.prototype,"allowZoom",{get:function(){return this._ink.AllowZoom},set:function(value){this._ink.AllowZoom=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(InkPropertiesViewModel.prototype,"thumbnailMaxWidth",{get:function(){if(this._ink.ThumbnailMaxWidth===0){return''}return this._ink.ThumbnailMaxWidth.toString()},set:function(value){this._ink.ThumbnailMaxWidth=parseFloat(value);if(isNaN(this._ink.ThumbnailMaxWidth)){this._ink.ThumbnailMaxWidth=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(InkPropertiesViewModel.prototype,"thumbnailMaxHeight",{get:function(){if(this._ink.ThumbnailMaxHeight===0){return''}return this._ink.ThumbnailMaxHeight.toString()},set:function(value){this._ink.ThumbnailMaxHeight=parseFloat(value);if(isNaN(this._ink.ThumbnailMaxHeight)){this._ink.ThumbnailMaxHeight=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(InkPropertiesViewModel.prototype,"includeBackground",{get:function(){return this._ink.IncludeBackground},set:function(value){this._ink.IncludeBackground=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(InkPropertiesViewModel.prototype,"allowBackgroundUpload",{get:function(){return this._ink.AllowBackgroundUpload},set:function(value){this._ink.AllowBackgroundUpload=value;this._editor.wizChanged=true;this.isResizeBackgroundVisible=value;this.resizeBackground=value},enumerable:true,configurable:true});Object.defineProperty(InkPropertiesViewModel.prototype,"resizeBackground",{get:function(){return this._ink.ResizeBackgroundImage},set:function(value){this._ink.ResizeBackgroundImage=value;this._editor.wizChanged=true;this.isImagePropertiesVisible=value},enumerable:true,configurable:true});Object.defineProperty(InkPropertiesViewModel.prototype,"allowInkColourChoice",{get:function(){return this._ink.AllowInkColourChoice},set:function(value){this._ink.AllowInkColourChoice=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(InkPropertiesViewModel.prototype,"inkColour",{get:function(){return this._ink.InkColour},set:function(value){this._ink.InkColour=value;this._editor.wizChanged=true},enumerable:true,configurable:true});InkPropertiesViewModel.prototype.openImage=function(){var vm=this;var modalInstance=this._modal.open({templateUrl:'Views/Modal/imageUpload.html?v=106882799234227327',controller:['$scope','$modalInstance','$http',Design.OpenImageModalCtrl],backdrop:'static'});modalInstance.result.then(function(base64Image){vm.backgroundImage=Intelledox.Common.ConstantValues.DATA_URI_PREFIX+base64Image;vm._ink.BackgroundImage=base64Image;vm._editor.wizChanged=true})};InkPropertiesViewModel.prototype.loadColours=function(){this.availableInkColours=Intelledox.Common.Functions.ColourList(this._filterLocal,false)};InkPropertiesViewModel.prototype.displayControls=function($filter,editorViewModel,wizard,question){var staticImageFields=false;staticImageFields=(this._ink.BackgroundSource===Intelledox.Model.BackgroundSource.StaticImage);this.isStaticImageField=staticImageFields;this.isResizeBackgroundVisible=!staticImageFields||this._ink.AllowBackgroundUpload;this.isImagePropertiesVisible=this.isResizeBackgroundVisible&&this._ink.ResizeBackgroundImage};return InkPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.InkPropertiesViewModel=InkPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ImagePropertiesViewModel=(function(){function ImagePropertiesViewModel($filter,editorViewModel,imageSettings){this.defaultAlternativeText='';this.isAlternativeTextVisible=false;this.isStretchToFitEnabled=true;this._filter=$filter;this._editorViewModel=editorViewModel;this._imageSettings=imageSettings;this.loadUnitsOfMeasure($filter)}Object.defineProperty(ImagePropertiesViewModel.prototype,"maxHeight",{get:function(){if(this._imageSettings.MaxHeight===0){return''}return this._imageSettings.MaxHeight.toString()},set:function(value){this._imageSettings.MaxHeight=parseFloat(value);if(isNaN(this._imageSettings.MaxHeight)){this._imageSettings.MaxHeight=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ImagePropertiesViewModel.prototype,"maxWidth",{get:function(){if(this._imageSettings.MaxWidth===0){return''}return this._imageSettings.MaxWidth.toString()},set:function(value){this._imageSettings.MaxWidth=parseFloat(value);if(isNaN(this._imageSettings.MaxWidth)){this._imageSettings.MaxWidth=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ImagePropertiesViewModel.prototype,"units",{get:function(){return this._imageSettings.UnitOfMeasure},set:function(value){this._imageSettings.UnitOfMeasure=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ImagePropertiesViewModel.prototype,"alternativeText",{get:function(){if(System.String.IsNullOrEmpty(this._imageSettings.AlternativeText)){return Design.TranslationHelper.KeywordValueToTranslation(this._filter,this.defaultAlternativeText)}else{return Design.TranslationHelper.KeywordValueToTranslation(this._filter,this._imageSettings.AlternativeText)}},set:function(value){if(value===this.defaultAlternativeText){this._imageSettings.AlternativeText=''}else{this._imageSettings.AlternativeText=value}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ImagePropertiesViewModel.prototype,"stretchToFit",{get:function(){return this._imageSettings.StretchToFit},set:function(value){this._imageSettings.StretchToFit=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});ImagePropertiesViewModel.prototype.pickAlternativeTextRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.alternativeText=Design.HelperFunctions.onPickRef(_this._filter,_this.alternativeText,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};ImagePropertiesViewModel.prototype.loadUnitsOfMeasure=function($filter){this.availableUnits=[];this.availableUnits.push({name:$filter('translate')('Inches'),value:Intelledox.Model.UnitsOfMeasure.Inches});this.availableUnits.push({name:$filter('translate')('Centimeters'),value:Intelledox.Model.UnitsOfMeasure.Centimeters});this.availableUnits.push({name:$filter('translate')('Millimeters'),value:Intelledox.Model.UnitsOfMeasure.Millimeters});this.availableUnits.push({name:$filter('translate')('Points'),value:Intelledox.Model.UnitsOfMeasure.Points});this.availableUnits.push({name:$filter('translate')('Picas'),value:Intelledox.Model.UnitsOfMeasure.Picas});this.availableUnits.push({name:$filter('translate')('Pixels'),value:Intelledox.Model.UnitsOfMeasure.Pixels})};return ImagePropertiesViewModel}());Design.ImagePropertiesViewModel=ImagePropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var FragmentDocumentPropertiesViewModel=(function(){function FragmentDocumentPropertiesViewModel($filter,editorViewModel,doc){this._doc=null;this.isAttachmentEnabled=true;this.isFormatVisible=false;this.availableFormats=[];this._editorViewModel=editorViewModel;this._filter=$filter;this._doc=doc;this.loadFormats();if(doc.HasPlaceholders){this.isAttachmentEnabled=false;doc.IsAttachment=false}else{this.isAttachmentEnabled=true;this.isFormatVisible=doc.IsAttachment}}Object.defineProperty(FragmentDocumentPropertiesViewModel.prototype,"isAttachment",{get:function(){return this._doc.IsAttachment},set:function(value){if(this._doc.HasPlaceholders&&value){this._doc.IsAttachment=false;this.isAttachmentEnabled=false}else{this._doc.IsAttachment=value;this._editorViewModel.wizChanged=true}this.isFormatVisible=this._doc.IsAttachment},enumerable:true,configurable:true});Object.defineProperty(FragmentDocumentPropertiesViewModel.prototype,"selectedFormat",{get:function(){return this._doc.AttachmentFormat},set:function(value){this._doc.AttachmentFormat=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});FragmentDocumentPropertiesViewModel.prototype.loadFormats=function(){this.availableFormats=[];this.availableFormats.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Model.OutputType.None});if(this._doc.FormatType===Intelledox.Model.TemplateFormatType.WordBinary||this._doc.FormatType===Intelledox.Model.TemplateFormatType.WordDocm||this._doc.FormatType===Intelledox.Model.TemplateFormatType.WordDocx){this.getDocumentOutputTypes()}else if(this._doc.FormatType===Intelledox.Model.TemplateFormatType.PowerPointPptx){this.getPresentationOutputTypes()}else if(this._doc.FormatType===Intelledox.Model.TemplateFormatType.ExcelXlsx){this.getNamedRangeOutputTypes()}else if(this._doc.FormatType===Intelledox.Model.TemplateFormatType.Pdf){this.availableFormats.pop();this.getPDFOutputTypes()}else if(this._doc.FormatType===Intelledox.Model.TemplateFormatType.Xsd){this.availableFormats.pop();this.getXMLOutputTypes()}else if(this._doc.FormatType===Intelledox.Model.TemplateFormatType.Txt){this.availableFormats.pop();this.getTextOutputTypes()}else if(this._doc.FormatType===Intelledox.Model.TemplateFormatType.Html){this.availableFormats.pop();this.getHtmlOutputTypes()}else if(this._doc.FormatType===Intelledox.Model.TemplateFormatType.Csv){this.availableFormats.pop();this.getCsvOutputTypes()}else if(this._doc.FormatType===Intelledox.Model.TemplateFormatType.Json){this.availableFormats.pop();this.getJsonOutputTypes()}};FragmentDocumentPropertiesViewModel.prototype.getDocumentOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('WordDocxDesc'),value:Intelledox.Model.OutputType.Docx});this.availableFormats.push({name:this._filter('translate')('WordDocx2010Desc'),value:Intelledox.Model.OutputType.Docx2010});this.availableFormats.push({name:this._filter('translate')('PDFDesc'),value:Intelledox.Model.OutputType.Pdf});this.availableFormats.push({name:this._filter('translate')('PDFADesc'),value:Intelledox.Model.OutputType.PdfA});this.availableFormats.push({name:this._filter('translate')('WordBinaryDesc'),value:Intelledox.Model.OutputType.Doc});this.availableFormats.push({name:this._filter('translate')('RtfDesc'),value:Intelledox.Model.OutputType.Rtf});this.availableFormats.push({name:this._filter('translate')('OdtDesc'),value:Intelledox.Model.OutputType.Odt});this.availableFormats.push({name:this._filter('translate')('XpsDesc'),value:Intelledox.Model.OutputType.Xps});this.availableFormats.push({name:this._filter('translate')('MhtDesc'),value:Intelledox.Model.OutputType.Mht});this.availableFormats.push({name:this._filter('translate')('PsDesc'),value:Intelledox.Model.OutputType.Ps})};FragmentDocumentPropertiesViewModel.prototype.getPresentationOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('PowerPointPptxDesc'),value:Intelledox.Model.OutputType.Pptx});this.availableFormats.push({name:this._filter('translate')('PDFDesc'),value:Intelledox.Model.OutputType.PresPdf});this.availableFormats.push({name:this._filter('translate')('PDFADesc'),value:Intelledox.Model.OutputType.PresPdfA});this.availableFormats.push({name:this._filter('translate')('OdpDesc'),value:Intelledox.Model.OutputType.Odp});this.availableFormats.push({name:this._filter('translate')('XpsDesc'),value:Intelledox.Model.OutputType.PresXps})};FragmentDocumentPropertiesViewModel.prototype.getNamedRangeOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('XlsxDesc'),value:Intelledox.Model.OutputType.Xlsx});this.availableFormats.push({name:this._filter('translate')('XlsDesc'),value:Intelledox.Model.OutputType.Xls});this.availableFormats.push({name:this._filter('translate')('XpsDesc'),value:Intelledox.Model.OutputType.SpreadXps});this.availableFormats.push({name:this._filter('translate')('OdsDesc'),value:Intelledox.Model.OutputType.Ods});this.availableFormats.push({name:this._filter('translate')('PDFDesc'),value:Intelledox.Model.OutputType.SpreadPdf});this.availableFormats.push({name:this._filter('translate')('PDFADesc'),value:Intelledox.Model.OutputType.SpreadPdfA})};FragmentDocumentPropertiesViewModel.prototype.getPDFOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('PDFDesc'),value:Intelledox.Model.OutputType.Pdf})};FragmentDocumentPropertiesViewModel.prototype.getXMLOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('XMLDesc'),value:Intelledox.Model.OutputType.Xml})};FragmentDocumentPropertiesViewModel.prototype.getTextOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('TxtDesc'),value:Intelledox.Model.OutputType.Txt})};FragmentDocumentPropertiesViewModel.prototype.getHtmlOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('HtmlDesc'),value:Intelledox.Model.OutputType.Html})};FragmentDocumentPropertiesViewModel.prototype.getCsvOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('CsvDesc'),value:Intelledox.Model.OutputType.Csv})};FragmentDocumentPropertiesViewModel.prototype.getJsonOutputTypes=function(){this.availableFormats.push({name:this._filter('translate')('JsonDesc'),value:Intelledox.Model.OutputType.Json})};return FragmentDocumentPropertiesViewModel}());Design.FragmentDocumentPropertiesViewModel=FragmentDocumentPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ContentItemPropertiesViewModel=(function(){function ContentItemPropertiesViewModel($filter,editorViewModel,contentItem,lists){this._contentItem=null;this._listManager=null;this.imageProperties=null;this.isAttachmentNameVisible=false;this.isSourceFormattingVisible=false;this.contentName='';this._editorViewModel=editorViewModel;this._filter=$filter;this._contentItem=contentItem;this._listManager=lists;var vm=this;switch(contentItem.ContentTypeId){case Intelledox.Model.ContentType.Image:this.imageProperties=new Design.ImagePropertiesViewModel($filter,editorViewModel,contentItem.ImageSettings);this.imageProperties.isAlternativeTextVisible=true;break;case Intelledox.Model.ContentType.Attachment:this.isAttachmentNameVisible=true;break;case Intelledox.Model.ContentType.DocumentFragment:this.isSourceFormattingVisible=true;break}lists.getContentItems().then(function(contentItems){var found=false;for(var i=0;i<contentItems.length;i++){if(contentItems[i].contentItemGuid===contentItem.ContentItemGuid){found=true;vm.contentName=contentItems[i].name;if(vm.imageProperties!=null&&!System.String.IsNullOrEmpty(contentItems[i].description)){vm.imageProperties.defaultAlternativeText=contentItems[i].description}break}}if(!found){vm.contentName=vm._filter('translate')('InvalidContentItem')}})}Object.defineProperty(ContentItemPropertiesViewModel.prototype,"attachmentName",{get:function(){return Design.TranslationHelper.TranslationToKeywordValue(this._filter,this._contentItem.AttachmentName)},set:function(value){this._contentItem.AttachmentName=Design.TranslationHelper.TranslationToKeywordValue(this._filter,value);this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ContentItemPropertiesViewModel.prototype,"keepSourceFormatting",{get:function(){return this._contentItem.KeepSourceFormatting},set:function(value){this._contentItem.KeepSourceFormatting=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});ContentItemPropertiesViewModel.prototype.validateAttachmentName=function(){if(System.String.IsNullOrEmpty(this._contentItem.AttachmentName)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('Attachment'),this._filter('translate')('Name')))}};return ContentItemPropertiesViewModel}());Design.ContentItemPropertiesViewModel=ContentItemPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var FragmentOutputPropertiesViewModel=(function(){function FragmentOutputPropertiesViewModel($filter,editorViewModel,availableOutput,wizard,lists){this._isInitializing=false;this._availableOutput=null;this._wizard=null;this._listManager=null;this._selectedType=Intelledox.Model.RoutingSourceType.AnswerValue;this._selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedAnswerGuidOrField=Intelledox.Common.ConstantValues.GUID_EMPTY;this.questionTitle='';this.answerTitle='';this.availableFieldWidth=0;this.isQuestionVisible=false;this.isRepeatSourcesVisible=false;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.availableTypes=[];this.availableQuestions=[];this.availableAnswers=[];this.availableRepeatSources=[];this.availableFragments=[];this.availableFragmentOutputs=[];this._editorViewModel=editorViewModel;this._filter=$filter;this._availableOutput=availableOutput;this._wizard=wizard;this._listManager=lists;this._isInitializing=true;this.loadSourceTypes();this.selectedType=availableOutput.SourceType;switch(availableOutput.SourceType){case Intelledox.Model.RoutingSourceType.AnswerValue:this.selectedQuestionGuid=availableOutput.SourceGuid;this.selectedAnswerGuidOrField=availableOutput.SourceAttributeGuid;break;case Intelledox.Model.RoutingSourceType.DataQuestion:this.selectedQuestionGuid=availableOutput.SourceGuid;this.selectedAnswerGuidOrField=availableOutput.FieldName;break;case Intelledox.Model.RoutingSourceType.Repeat:this.repeatSourceGuid=availableOutput.SourceGuid;this.selectedAnswerGuidOrField='';this.selectedFragmentOutput=availableOutput.SourceAttributeGuid;break;case Intelledox.Model.RoutingSourceType.FragmentOutput:this.selectedFragment=availableOutput.SourceGuid;this.selectedAnswerGuidOrField='';this.selectedFragmentOutput=availableOutput.SourceAttributeGuid;break}this._isInitializing=false}Object.defineProperty(FragmentOutputPropertiesViewModel.prototype,"outputName",{get:function(){return this._availableOutput.Name},set:function(value){this._availableOutput.Name=value;this._editorViewModel.treeView.selectedNode.text=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(FragmentOutputPropertiesViewModel.prototype,"selectedType",{get:function(){return this._selectedType},set:function(value){this._selectedType=value;switch(value){case Intelledox.Model.RoutingSourceType.AnswerValue:this.questionTitle=this._filter('translate')('Question');this.answerTitle=this._filter('translate')('Answer');this.isQuestionVisible=true;this.isRepeatSourcesVisible=false;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.loadQuestions(false);break;case Intelledox.Model.RoutingSourceType.DataQuestion:this.questionTitle=this._filter('translate')('DataQuestion');this.answerTitle=this._filter('translate')('Field');this.isQuestionVisible=true;this.isRepeatSourcesVisible=false;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.loadQuestions(true);break;case Intelledox.Model.RoutingSourceType.Repeat:this.isQuestionVisible=false;this.isRepeatSourcesVisible=true;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.loadRepeatSources();break;case Intelledox.Model.RoutingSourceType.FragmentOutput:this.isQuestionVisible=false;this.isRepeatSourcesVisible=false;this.isFragmentVisible=true;this.isFragmentOutputVisible=true;this.loadFragments()}if(!this._isInitializing){this._availableOutput.SourceType=value;this._editorViewModel.wizChanged=true}},enumerable:true,configurable:true});Object.defineProperty(FragmentOutputPropertiesViewModel.prototype,"selectedQuestionGuid",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;if(this.selectedType===Intelledox.Model.RoutingSourceType.AnswerValue){this.loadAnswers()}else if(this.selectedType===Intelledox.Model.RoutingSourceType.DataQuestion){this.loadFields()}if(!this._isInitializing){this._availableOutput.SourceGuid=value;this._editorViewModel.wizChanged=true}},enumerable:true,configurable:true});Object.defineProperty(FragmentOutputPropertiesViewModel.prototype,"selectedAnswerGuidOrField",{get:function(){return this._selectedAnswerGuidOrField},set:function(value){this._selectedAnswerGuidOrField=value;if(!this._isInitializing){if(value===Intelledox.Common.ConstantValues.GUID_EMPTY){this._availableOutput.FieldName='';this._availableOutput.SourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}else{if(this.selectedType===Intelledox.Model.RoutingSourceType.DataQuestion){this._availableOutput.FieldName=value}else{this._availableOutput.SourceAttributeGuid=value}}this._editorViewModel.wizChanged=true}},enumerable:true,configurable:true});Object.defineProperty(FragmentOutputPropertiesViewModel.prototype,"repeatSourceGuid",{get:function(){return this._availableOutput.SourceGuid},set:function(value){if(!this._isInitializing){this._availableOutput.SourceGuid=value;this._availableOutput.SourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._availableOutput.FieldName='';this._editorViewModel.wizChanged=true}this.isFragmentOutputVisible=false;if(value!==Intelledox.Common.ConstantValues.GUID_EMPTY){var repeatReference=this._editorViewModel.wizard.FindLayoutNode(this.repeatSourceGuid);if(repeatReference!=null&&typeof repeatReference.HasFragmentInterface!=="undefined"){this.isFragmentOutputVisible=true;this.availableFragmentOutputs=[];this._listManager.populateFragmentRepeatedOutputs(repeatReference.ProjectGuid,this.availableFragmentOutputs)}}},enumerable:true,configurable:true});Object.defineProperty(FragmentOutputPropertiesViewModel.prototype,"selectedFragment",{get:function(){return this._availableOutput.SourceGuid},set:function(value){if(!this._isInitializing){this._availableOutput.SourceGuid=value;this._availableOutput.SourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._availableOutput.FieldName=''}var isAutoChange=this._isInitializing;var projectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(value!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var i=0;i<this.availableFragments.length;i++){if(this.availableFragments[i].ObjectId===value){projectGuid=this.availableFragments[i].ProjectGuid;break}}}this._isInitializing=true;this.availableFragmentOutputs=[];this._listManager.populateFragmentOutputs(projectGuid,this.availableFragmentOutputs);if(!this._isInitializing){this.selectedFragmentOutput=Intelledox.Common.ConstantValues.GUID_EMPTY}this._isInitializing=isAutoChange},enumerable:true,configurable:true});Object.defineProperty(FragmentOutputPropertiesViewModel.prototype,"selectedFragmentOutput",{get:function(){return this._availableOutput.SourceAttributeGuid},set:function(value){if(!this._isInitializing){this._availableOutput.SourceAttributeGuid=value;this._editorViewModel.wizChanged=true}},enumerable:true,configurable:true});FragmentOutputPropertiesViewModel.prototype.validateName=function(){if(System.String.IsNullOrEmpty(this._availableOutput.Name)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('OutputName'),''))}else if(this._availableOutput.Name.indexOf('|')>-1||this._availableOutput.Name.indexOf('.')>-1){alert(this._filter('translate')('InvalidOutputName'))}else{for(var i=0;i<this._wizard.AvailableOutputs.length;i++){var output=this._wizard.AvailableOutputs[i];if(this._availableOutput.RoutingOptionGuid===output.RoutingOptionGuid){continue}else if(Intelledox.Common.Functions.EqualsIgnoreCase(output.Name,this._availableOutput.Name)){alert(this._filter('translate')('NotUniqueAvailableOutputName'))}}}};FragmentOutputPropertiesViewModel.prototype.loadSourceTypes=function(){this.availableTypes=[];this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.AnswerValue),value:Intelledox.Model.RoutingSourceType.AnswerValue});this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.DataQuestion),value:Intelledox.Model.RoutingSourceType.DataQuestion});this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.Repeat),value:Intelledox.Model.RoutingSourceType.Repeat});this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.FragmentOutput),value:Intelledox.Model.RoutingSourceType.FragmentOutput});this.selectedType=Intelledox.Model.RoutingSourceType.AnswerValue};FragmentOutputPropertiesViewModel.prototype.sourceTypeString=function(sourceType){switch(sourceType){case Intelledox.Model.RoutingSourceType.AnswerValue:return this._filter('translate')('AnswerValue');case Intelledox.Model.RoutingSourceType.DataQuestion:return this._filter('translate')('DataQuestion');case Intelledox.Model.RoutingSourceType.Repeat:return this._filter('translate')('Repeat');case Intelledox.Model.RoutingSourceType.FragmentOutput:return this._filter('translate')('FragmentOutput');default:return"("+this._filter('translate')('UndefinedSource')+")"}};FragmentOutputPropertiesViewModel.prototype.loadQuestions=function(dataOnly){this.availableQuestions=[];this.availableAnswers=[];this.availableQuestions.push(new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.availableAnswers.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY});for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){for(var questionIndex=0;questionIndex<this._wizard.Pages[pageIndex].Questions.length;questionIndex++){var qn=this._wizard.Pages[pageIndex].Questions[questionIndex];if(qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric||qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RichText||qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation||qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AutoLogic||qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom||qn.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt){if(!dataOnly||qn.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.availableQuestions.push(qn)}}}}this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY};FragmentOutputPropertiesViewModel.prototype.loadAnswers=function(){this.availableAnswers=[];this.availableAnswers.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY});if(this.selectedQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var i=0;i<this.availableQuestions.length;i++){if(this.availableQuestions[i].QuestionGuid===this.selectedQuestionGuid){var question=this.availableQuestions[i];for(var answerIndex=0;answerIndex<question.Answers.length;answerIndex++){this.availableAnswers.push({name:question.Answers[answerIndex].Name,value:question.Answers[answerIndex].AnswerGuid})}break}}}this.selectedAnswerGuidOrField=Intelledox.Common.ConstantValues.GUID_EMPTY};FragmentOutputPropertiesViewModel.prototype.loadFields=function(){var vm=this;this.availableAnswers=[];this.availableAnswers.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY});if(this.selectedQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var i=0;i<this.availableQuestions.length;i++){if(this.availableQuestions[i].QuestionGuid===this.selectedQuestionGuid){var question=this.availableQuestions[i];if(question.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){Design.HierarchyHelper.getDataFields(this._wizard,this._listManager,question,this.availableFieldWidth,false).then(function(fieldItems){vm.availableAnswers.push.apply(vm.availableAnswers,fieldItems)})}else if(question.IsQARepeater){this.availableAnswers.push.apply(vm.availableAnswers,Design.QARepeatHelper.getDataFields(this._filter,this._wizard,question))}else if(question.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this._listManager.dataFieldsList(question.DataObjectGuid,this.availableFieldWidth,true,"").then(function(fieldItems){vm.availableAnswers.push.apply(vm.availableAnswers,fieldItems)})}break}}}this.selectedAnswerGuidOrField=''};FragmentOutputPropertiesViewModel.prototype.pickRef=function(){var _this=this;this._editorViewModel.treeView.pickEvent=function(node){_this.onPickRef(node)};this._editorViewModel.treeView.togglePickMode()};FragmentOutputPropertiesViewModel.prototype.onPickRef=function(node){if(node.tag instanceof Intelledox.QAWizard.Design.Question){this.setReferenceQuestion(node.tag)}else if(node.tag instanceof Intelledox.QAWizard.Design.Answer){this.setReferenceQuestionAnswer(node.parent.tag,node.tag)}else if(node.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){this.setReferenceOutput(node.tag)}else if(node.tag instanceof Intelledox.QAWizard.Design.FragmentPage||node.tag instanceof Intelledox.QAWizard.Design.FragmentReference){this.setReferenceFragment(node.tag)}};FragmentOutputPropertiesViewModel.prototype.setReferenceQuestion=function(refQuestion){if(this.selectedType!==Intelledox.Model.RoutingSourceType.AnswerValue&&this.selectedType!==Intelledox.Model.RoutingSourceType.DataQuestion){this.selectedType=Intelledox.Model.RoutingSourceType.AnswerValue}this.selectedQuestionGuid=refQuestion.QuestionGuid};FragmentOutputPropertiesViewModel.prototype.setReferenceQuestionAnswer=function(refQuestion,refAnswer){if(this.selectedType!==Intelledox.Model.RoutingSourceType.AnswerValue&&this.selectedType!==Intelledox.Model.RoutingSourceType.DataQuestion){this.selectedType=Intelledox.Model.RoutingSourceType.AnswerValue}this.selectedQuestionGuid=refQuestion.QuestionGuid;if(this.selectedType===Intelledox.Model.RoutingSourceType.DataQuestion){if(refAnswer instanceof Intelledox.QAWizard.Design.DatasourceAnswer){this.selectedAnswerGuidOrField=refAnswer.DataField}else{this.selectedAnswerGuidOrField=''}}else{this.selectedAnswerGuidOrField=refAnswer.AnswerGuid}};FragmentOutputPropertiesViewModel.prototype.setReferenceOutput=function(refOutput){this.selectedType=Intelledox.Model.RoutingSourceType.FragmentOutput;this.selectedFragment=refOutput.Parent.ObjectId;this.selectedFragmentOutput=refOutput.OutputGuid};FragmentOutputPropertiesViewModel.prototype.setReferenceFragment=function(refFragment){this.selectedType=Intelledox.Model.RoutingSourceType.FragmentOutput;this.selectedFragment=refFragment.ObjectId};FragmentOutputPropertiesViewModel.prototype.loadRepeatSources=function(){this.availableRepeatSources=[];this._listManager.populateRepeatSources(this._editorViewModel.wizard,false,null,this.availableRepeatSources)};FragmentOutputPropertiesViewModel.prototype.loadFragments=function(){this.availableFragments=[];this._listManager.populateInstanceFragments(this._wizard,this.availableFragments);if(this.availableFragments.length>0){this.selectedFragment=this.availableFragments[0].ObjectId}else{this.selectedFragment=Intelledox.Common.ConstantValues.GUID_EMPTY}};return FragmentOutputPropertiesViewModel}());Design.FragmentOutputPropertiesViewModel=FragmentOutputPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var AvailableInputPropertiesViewModel=(function(){function AvailableInputPropertiesViewModel($filter,editorViewModel,availableInput,wiz){this._filter=$filter;this._editor=editorViewModel;this._availableInput=availableInput;this._wizard=wiz}Object.defineProperty(AvailableInputPropertiesViewModel.prototype,"inputName",{get:function(){return this._availableInput.description},set:function(value){this._availableInput.description=value;this._editor.wizChanged=true;this._editor.treeView.selectedNode.text=value},enumerable:true,configurable:true});Object.defineProperty(AvailableInputPropertiesViewModel.prototype,"defaultValue",{get:function(){return this._availableInput.DefaultValue},set:function(value){this._availableInput.DefaultValue=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AvailableInputPropertiesViewModel.prototype,"isRepeated",{get:function(){return this._availableInput.valueType===Intelledox.Model.ValueTypes.Repeat},set:function(value){this._availableInput.valueType=(value?Intelledox.Model.ValueTypes.Repeat:Intelledox.Model.ValueTypes.Any);this._editor.wizChanged=true},enumerable:true,configurable:true});AvailableInputPropertiesViewModel.prototype.validateName=function(){if(System.String.IsNullOrEmpty(this._availableInput.description)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('InputName'),''))}else{for(var i=0;i<this._wizard.AvailableInputs.length;i++){var input=this._wizard.AvailableInputs[i];if(this._availableInput.routingElementTypeId===input.routingElementTypeId){continue}else if(Intelledox.Common.Functions.EqualsIgnoreCase(input.description,this._availableInput.description)){alert(this._filter('translate')('NotUniqueAvailableInputName'))}}}};return AvailableInputPropertiesViewModel}());Design.AvailableInputPropertiesViewModel=AvailableInputPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var FragmentPropertiesViewModel=(function(){function FragmentPropertiesViewModel(editorViewModel,fragment,wiz,$filter,lists){this.inputsPanelModel=null;this.projectName='';var vm=this;this.inputsPanelModel=new Design.InputsPanelViewModel($filter,editorViewModel,fragment,wiz,lists);this._editor=editorViewModel;this._filter=$filter;this._fragment=fragment;this._wizard=wiz;lists.projectFragment(fragment.ProjectGuid).then(function(projectFragment){if(projectFragment==null){vm.projectName=this._filter('translate')('ProjectNotFound')}else{vm.projectName=projectFragment.Name}})}Object.defineProperty(FragmentPropertiesViewModel.prototype,"fragmentName",{get:function(){return this._fragment.Name},set:function(value){this._fragment.Name=value;this._editor.wizChanged=true;this._editor.treeView.selectedNode.text=value},enumerable:true,configurable:true});FragmentPropertiesViewModel.prototype.validateName=function(){if(System.String.IsNullOrEmpty(this._fragment.Name)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('FragmentName'),''))}else if(!this._wizard.IsUniqueFragmentName(this._fragment.Name,this._fragment.ObjectId)){alert(this._filter('translate')('NotUniqueFragmentName'))}};return FragmentPropertiesViewModel}());Design.FragmentPropertiesViewModel=FragmentPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ClauseDesignerViewModel=(function(){function ClauseDesignerViewModel($filter,editorViewModel){this._wizard=null;this._listManager=null;this._parentClause=null;this._currentNode=null;this.isCopyEnabled=false;this.isPasteEnabled=false;this.isRemoveEnabled=false;this.isConvertEnabled=false;this.supportsNesting=true;this.pasteText='';var vm=this;this._filter=$filter;this._editorViewModel=editorViewModel;this.clausesTreeView=new Design.TreeView;this.clausesTreeView.canExpandCollapse=false;this.clausesTreeView.afterSelect=function afterSelect(){vm.clauseSelected();vm.updateToolbarButtons()};this.clausesTreeView.dropEvent=function drop(dragItem,targetNode){vm.clauseDrop(dragItem,targetNode)};this.clausesTreeView.deleteEvent=function deleteItem(node){if(vm.isRemoveEnabled){vm.deleteClause()}}}ClauseDesignerViewModel.prototype.init=function(parent,wiz,lists,currentNode){this._wizard=wiz;this._listManager=lists;this._currentNode=currentNode;this._lookupService=new Design.WizardExternalLookupService(lists);this.clausesTreeView.selectedNode=null;this._parentClause=parent;this.fillClauseView(parent)};ClauseDesignerViewModel.prototype.copy=function(){Design.InfinitiClipboard.clauseCopy=this._parentClause.Clone();this.isPasteEnabled=true};ClauseDesignerViewModel.prototype.paste=function(){if(Design.InfinitiClipboard.clauseCopy.ContainsItem(this._currentNode)){alert(this._filter('translate')('ErrorMsg_ItemCantReferenceItself'));return}if(this.replaceClause!=null){this.replaceClause(Design.InfinitiClipboard.clauseCopy)}};ClauseDesignerViewModel.prototype.moveUp=function(){var clauses=this._parentClause;var selectedClause=null;var group=null;if(this.clausesTreeView.selectedNode==null){return}else{selectedClause=this.clausesTreeView.selectedNode.tag}var results={clause:null,foundCompareNode:false};this.findClauseGroupAbove(selectedClause,clauses.SubClauses,results);group=results.clause;if(group==null&&clauses!==selectedClause){group=clauses}if(group!=null){this.clausesTreeView.selectedNode.parent.tag.SubClauses.splice(this.clausesTreeView.selectedNode.parent.tag.SubClauses.indexOf(selectedClause),1);group.SubClauses.splice(0,0,selectedClause);this._editorViewModel.wizChanged=true}this.fillClauseView(clauses)};ClauseDesignerViewModel.prototype.moveDown=function(){var clauses=this._parentClause;var selectedClause=null;var group=null;if(this.clausesTreeView.selectedNode==null){return}else{selectedClause=this.clausesTreeView.selectedNode.tag}var results={clause:null,foundCompareNode:false};this.findClauseGroupBelow(selectedClause,clauses.SubClauses,results);group=results.clause;if(group==null&&clauses!==selectedClause){group=clauses}if(group!=null){this.clausesTreeView.selectedNode.parent.tag.SubClauses.splice(this.clausesTreeView.selectedNode.parent.tag.SubClauses.indexOf(selectedClause),1);group.SubClauses.splice(0,0,selectedClause);this._editorViewModel.wizChanged=true}this.fillClauseView(clauses)};ClauseDesignerViewModel.prototype.addAnd=function(){var clauses=this._parentClause;if(clauses!=null){if(clauses instanceof Intelledox.QAWizard.Design.Condition){clauses.Add(new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.AllOf))}else if(clauses instanceof Intelledox.QAWizard.Design.Rule){clauses.Add(new Intelledox.QAWizard.Design.Rule(Intelledox.Model.ClauseType.AllOf))}else if(clauses instanceof Intelledox.QAWizard.Design.Filter){clauses.Add(new Intelledox.QAWizard.Design.Filter(Intelledox.Model.ClauseType.AllOf))}else if(this._parentClause instanceof Intelledox.QAWizard.Design.ValidationRule){clauses.Add(new Intelledox.QAWizard.Design.ValidationRule(Intelledox.Model.ClauseType.AllOf))}this.fillClauseView(clauses)}};ClauseDesignerViewModel.prototype.addOr=function(){var clauses=this._parentClause;if(clauses!=null){if(clauses instanceof Intelledox.QAWizard.Design.Condition){clauses.Add(new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.AnyOf))}else if(clauses instanceof Intelledox.QAWizard.Design.Rule){clauses.Add(new Intelledox.QAWizard.Design.Rule(Intelledox.Model.ClauseType.AnyOf))}else if(clauses instanceof Intelledox.QAWizard.Design.Filter){clauses.Add(new Intelledox.QAWizard.Design.Filter(Intelledox.Model.ClauseType.AnyOf))}else if(this._parentClause instanceof Intelledox.QAWizard.Design.ValidationRule){clauses.Add(new Intelledox.QAWizard.Design.ValidationRule(Intelledox.Model.ClauseType.AnyOf))}this.fillClauseView(clauses)}};ClauseDesignerViewModel.prototype.convert=function(){var selectedClause;if(this.clausesTreeView.selectedNode==null){return}else{selectedClause=this.clausesTreeView.selectedNode.tag}if(selectedClause.Type===Intelledox.Model.ClauseType.AllOf){selectedClause.Type=Intelledox.Model.ClauseType.AnyOf}else if(selectedClause.Type===Intelledox.Model.ClauseType.AnyOf){selectedClause.Type=Intelledox.Model.ClauseType.AllOf}this._editorViewModel.wizChanged=true;this.fillClauseViewFromExisting()};ClauseDesignerViewModel.prototype.deleteClause=function(){if(this.clausesTreeView.selectedNode!=null){if(this.clausesTreeView.selectedNode.parent==null){if(this._parentClause instanceof Intelledox.QAWizard.Design.Condition){this.replaceClause(new Intelledox.QAWizard.Design.Condition)}else if(this._parentClause instanceof Intelledox.QAWizard.Design.Rule){this.replaceClause(new Intelledox.QAWizard.Design.Rule)}else if(this._parentClause instanceof Intelledox.QAWizard.Design.Filter){this.replaceClause(null)}else if(this._parentClause instanceof Intelledox.QAWizard.Design.ValidationRule){this.replaceClause(new Intelledox.QAWizard.Design.ValidationRule)}}else{this.clausesTreeView.selectedNode.parent.tag.SubClauses.splice(this.clausesTreeView.selectedNode.parent.tag.SubClauses.indexOf(this.clausesTreeView.selectedNode.tag),1);this.replaceClause(this._parentClause)}}};ClauseDesignerViewModel.prototype.selectClauseNode=function(c){var clauseNode=this.clausesTreeView.findNodeByTag(null,c);this.clausesTreeView.selectedNode=clauseNode};ClauseDesignerViewModel.prototype.setParentClause=function(parent){this._parentClause=parent};ClauseDesignerViewModel.prototype.fillClauseViewFromExisting=function(){this.fillClauseView(this._parentClause)};ClauseDesignerViewModel.prototype.fillClauseView=function(clauses){var selectedNode=null;if(this.clausesTreeView.selectedNode!=null){selectedNode=this.clausesTreeView.selectedNode.tag}this.clausesTreeView.clear();if(clauses!=null&&clauses.Type!==Intelledox.Model.ClauseType.Basic){this.clausesTreeView.addChild(this.createClauseNode(clauses))}if(selectedNode!=null){this.selectClauseNode(selectedNode)}this.updateToolbarButtons()};ClauseDesignerViewModel.prototype.createClauseNode=function(clause){var newNode=new Design.TreeNode("",null);newNode.treeView=this.clausesTreeView;switch(clause.Type){case Intelledox.Model.ClauseType.AllOf:newNode=new Design.TreeNode(this._filter('translate')('AllOf'),clause);newNode.treeView=this.clausesTreeView;for(var i=0;i<clause.SubClauses.length;i++){newNode.addChild(this.createClauseNode(clause.SubClauses[i]))}break;case Intelledox.Model.ClauseType.AnyOf:newNode=new Design.TreeNode(this._filter('translate')('AnyOf'),clause);newNode.treeView=this.clausesTreeView;for(var i=0;i<clause.SubClauses.length;i++){newNode.addChild(this.createClauseNode(clause.SubClauses[i]))}break;case Intelledox.Model.ClauseType.Comparison:newNode=new Design.TreeNode('',clause);newNode.text=Design.TranslationHelper.KeywordValueToTranslation(this._filter,this.getDescription(newNode,clause));newNode.treeView=this.clausesTreeView}return newNode};ClauseDesignerViewModel.prototype.getDescription=function(currentNode,clause){if(clause instanceof Intelledox.QAWizard.Design.Condition){return this.conditionDescription(currentNode,clause)}else if(clause instanceof Intelledox.QAWizard.Design.Rule){return this.ruleDescription(currentNode,clause)}else if(clause instanceof Intelledox.QAWizard.Design.Filter){return this.filterDescription(currentNode,clause)}else if(clause instanceof Intelledox.QAWizard.Design.ValidationRule){return this.validationRuleDescription(clause)}return this._filter('translate')('InvalidClause')};ClauseDesignerViewModel.prototype.updateToolbarButtons=function(){this.isCopyEnabled=(this.clausesTreeView.nodes.length>0);this.isPasteEnabled=(Design.InfinitiClipboard.clauseCopy!=null);this.isRemoveEnabled=(this.clausesTreeView.selectedNode!=null);if(this.clausesTreeView.selectedNode!=null&&this.clausesTreeView.selectedNode.tag!=null&&(this.clausesTreeView.selectedNode.tag.Type===Intelledox.Model.ClauseType.AllOf||this.clausesTreeView.selectedNode.tag.Type===Intelledox.Model.ClauseType.AnyOf)){this.isConvertEnabled=true}else{this.isConvertEnabled=false}if(this._parentClause==null||this._parentClause.Type===Intelledox.Model.ClauseType.Basic){this.pasteText=this._filter('translate')('PasteConditions')}else{this.pasteText=this._filter('translate')('ReplaceConditions')}};ClauseDesignerViewModel.prototype.conditionDescription=function(currentNode,cond){var result;var vm=this;if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.State){var state=null;result=this._filter('translate')('State');switch(cond.ComparisonType){case Intelledox.QAWizard.Design.ClauseComparisonType.Equals:result+=" = ";break;case Intelledox.QAWizard.Design.ClauseComparisonType.IsNotEqual:result+=" <> ";break}var fullStates=this._wizard.Workflow.FullStateList;for(var i=0;i<fullStates.length;i++){if(fullStates[i].Id===cond.CompareTo){state=fullStates[i]}}if(state==null){return this._filter('translate')('StateNotFound')}else{result+=state.Name}return result}else{if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Action){var a=this._wizard.FindAction(cond.ParentItemGuid,true).action;if(a==null){result=this._filter('translate')('ParentActionNotFound')}else{result=a.Name+" - "}if(cond.ParentAttributeGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){result+=this._filter('translate')('ResultSquareBrackets')}else{result+=String.fromCharCode(133);this._listManager.actionOutput(cond.ParentAttributeGuid).then(function(output){var name;if(output==null){name=vm._filter('translate')('ParentActionOutputNotFound')}else{name=output.name}currentNode.text=currentNode.text.replace(String.fromCharCode(133),name)})}}else if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Input){var input=null;for(var i=0;i<this._wizard.AvailableInputs.length;i++){var fi=this._wizard.AvailableInputs[i];if(fi.routingElementTypeId===cond.ParentItemGuid){input=fi;break}}if(input==null){return this._filter('translate')('ParentInputNotFound')}else{result=input.description}}else if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.FragmentOutput){var fragment=this._wizard.FindLayoutNode(cond.ParentItemGuid);if(fragment==null){return this._filter('translate')('ParentFragmentNotFound')}result=String.fromCharCode(133);this._listManager.projectFragment(fragment.ProjectGuid).then(function(fragment){for(var i=0;i<fragment.AvailableOutputs.length;i++){if(fragment.AvailableOutputs[i].RoutingOptionGuid===cond.ParentAttributeGuid){currentNode.text=currentNode.text.replace(String.fromCharCode(133),fragment.Name+"."+fragment.AvailableOutputs[i].Name);return}}currentNode.text=currentNode.text.replace(String.fromCharCode(133),this._filter('translate')('ParentOutputNotFound'))})}else if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.ProjectProperty){var prop=null;for(var i=0;i<this._wizard.Properties.length;i++){if(this._wizard.Properties[i].Id===cond.ParentItemGuid){prop=this._wizard.Properties[i];break}}if(prop==null){return this._filter('translate')('ParentProjectPropertyNotFound')}result=prop.Name}else{var question=this._wizard.FindQuestion(cond.ParentItemGuid);var ans=null;if(question==null){return this._filter('translate')('ParentQuestionNotFound')}else{if(cond.ParentAttributeGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){result=question.TranslatedText}else{ans=question.FindAnswer(cond.ParentAttributeGuid);if(ans==null){return this._filter('translate')('ParentAnswerNotFound')}else{result=ans.Name}}}}switch(cond.ComparisonType){case Intelledox.QAWizard.Design.ClauseComparisonType.Is:result+=" "+this._filter('translate')('IsString')+" "+this.translate(cond.CompareTo);break;case Intelledox.QAWizard.Design.ClauseComparisonType.IsNot:result+=" "+this._filter('translate')('IsNotString')+" "+this.translate(cond.CompareTo);break;case Intelledox.QAWizard.Design.ClauseComparisonType.Equals:result+=" = \""+cond.CompareTo+"\"";break;case Intelledox.QAWizard.Design.ClauseComparisonType.IsNotEqual:result+=" <> \""+cond.CompareTo+"\"";break;case Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThan:result+=" > "+cond.CompareTo;break;case Intelledox.QAWizard.Design.ClauseComparisonType.LessThan:result+=" < "+cond.CompareTo;break;case Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThanOrEquals:result+=" >= "+cond.CompareTo;break;case Intelledox.QAWizard.Design.ClauseComparisonType.LessThanOrEquals:result+=" <= "+cond.CompareTo;break;case Intelledox.QAWizard.Design.ClauseComparisonType.Contains:result+=" "+this._filter('translate')('Contains')+" "+cond.CompareTo;break}}return result};ClauseDesignerViewModel.prototype.ruleDescription=function(currentNode,rule){var result="";var question=this._wizard.FindQuestion(rule.ParentItemGuid);var ans=null;if(rule.ParentType===Intelledox.QAWizard.Design.RuleParentType.Reference){if(question==null){return this._filter('translate')('ParentQuestionNotFound')}else{switch(rule.EveryOrOneOf){case Intelledox.QAWizard.Design.RepeaterChoice.AtLeastOne:result=this._filter('translate')('AtLeastOne')+" ";break;case Intelledox.QAWizard.Design.RepeaterChoice.Every:result=this._filter('translate')('Every')+" ";break}if(rule.ParentAttributeGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){result+=question.TranslatedText}else{ans=question.FindAnswer(rule.ParentAttributeGuid);if(ans==null){return this._filter('translate')('ParentAnswerNotFound')}else{result+=ans.Name}}}}else if(rule.ParentType===Intelledox.QAWizard.Design.RuleParentType.Input){var input=null;for(var i=0;i<this._wizard.AvailableInputs.length;i++){var fi=this._wizard.AvailableInputs[i];if(fi.routingElementTypeId===rule.ParentItemGuid){input=fi;break}}if(input==null){return this._filter('translate')('ParentInputNotFound')}else{result=input.description}}else if(rule.ParentType===Intelledox.QAWizard.Design.RuleParentType.FragmentOutput){var fragment=this._wizard.FindLayoutNode(rule.ParentItemGuid);if(fragment==null){return this._filter('translate')('ParentFragmentNotFound')}result=String.fromCharCode(133);this._listManager.projectFragment(fragment.ProjectGuid).then(function(fragment){for(var i=0;i<fragment.AvailableOutputs.length;i++){if(fragment.AvailableOutputs[i].RoutingOptionGuid===rule.ParentAttributeGuid){currentNode.text=currentNode.text.replace(String.fromCharCode(133),fragment.Name+"."+fragment.AvailableOutputs[i].Name);return}}currentNode.text=currentNode.text.replace(String.fromCharCode(133),this._filter('translate')('ParentOutputNotFound'))})}else if(rule.ParentType===Intelledox.QAWizard.Design.RuleParentType.Formula||rule.ParentType===Intelledox.QAWizard.Design.RuleParentType.Aggregate){result=rule.Formula.replace(/\n/g,"");if(result.length>0&&result.charAt(0)==='='){result=result.substring(1)}if(result.length>60){result=result.substring(0,60)+"..."}}else if(rule.ParentType===Intelledox.QAWizard.Design.RuleParentType.ProjectProperty){var prop=null;for(var i=0;i<this._wizard.Properties.length;i++){if(this._wizard.Properties[i].Id===rule.ParentItemGuid){prop=this._wizard.Properties[i];break}}if(prop==null){return this._filter('translate')('ParentProjectPropertyNotFound')}result=prop.Name}switch(rule.ComparisonType){case Intelledox.QAWizard.Design.ClauseComparisonType.Is:result+=" "+this._filter('translate')('IsString')+" "+this.translate(rule.CompareTo);break;case Intelledox.QAWizard.Design.ClauseComparisonType.IsNot:result+=" "+this._filter('translate')('IsNotString')+" "+this.translate(rule.CompareTo);break;case Intelledox.QAWizard.Design.ClauseComparisonType.Equals:result+=" = \""+rule.CompareTo+"\"";break;case Intelledox.QAWizard.Design.ClauseComparisonType.IsNotEqual:result+=" <> \""+rule.CompareTo+"\"";break;case Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThan:result+=" > "+rule.CompareTo;break;case Intelledox.QAWizard.Design.ClauseComparisonType.LessThan:result+=" < "+rule.CompareTo;break;case Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThanOrEquals:result+=" >= "+rule.CompareTo;break;case Intelledox.QAWizard.Design.ClauseComparisonType.LessThanOrEquals:result+=" <= "+rule.CompareTo;break;case Intelledox.QAWizard.Design.ClauseComparisonType.Contains:result+=" "+this._filter('translate')('Contains')+" "+rule.CompareTo;break}return result};ClauseDesignerViewModel.prototype.filterDescription=function(currentNode,filter){var result=String.fromCharCode(133);switch(filter.ComparisonType){case Intelledox.Model.ComparisonType.Equals:result+=" = ";break;case Intelledox.Model.ComparisonType.NotEqualTo:result+=" <> ";break;case Intelledox.Model.ComparisonType.GreaterThan:result+=" > ";break;case Intelledox.Model.ComparisonType.LessThan:result+=" < ";break;case Intelledox.Model.ComparisonType.GreaterThanOrEquals:result+=" >= ";break;case Intelledox.Model.ComparisonType.LessThanOrEquals:result+=" <= ";break;case Intelledox.Model.ComparisonType.BeginsWith:result+=" "+this._filter('translate')('BeginWith')+" ";break;case Intelledox.Model.ComparisonType.Contains:result+=" "+this._filter('translate')('Contain')+" ";break;case Intelledox.Model.ComparisonType.EndsWith:result+=" "+this._filter('translate')('EndWith')+" ";break;case Intelledox.Model.ComparisonType.NotContain:result+=" "+this._filter('translate')('NotContain')+" ";break;case Intelledox.Model.ComparisonType.ContainedIn:result+=" "+this._filter('translate')('ContainedIn')+" ";break;case Intelledox.Model.ComparisonType.NotContainedIn:result+=" "+this._filter('translate')('NotContainedIn')+" ";break}if(filter.ParentType===Intelledox.QAWizard.Design.FilterParentType.Constant){result+="\""+filter.ConstantValue+"\""}else if(filter.ParentType===Intelledox.QAWizard.Design.FilterParentType.Input){var input=null;for(var i=0;i<this._wizard.AvailableInputs.length;i++){if(this._wizard.AvailableInputs[i].routingElementTypeId===filter.ParentItemGuid){input=this._wizard.AvailableInputs[i];break}}if(input==null){return this._filter('translate')('ParentInputNotFound')}else{result+=input.description}}else if(filter.ParentType===Intelledox.QAWizard.Design.FilterParentType.UserEntered){if(filter.Question.DisplayType!==Intelledox.Model.QuestionDisplayType.AutoComplete){return this._filter('translate')('FilterTypeNotFound')}else{result+=this._filter('translate')('UserEnteredWithBrackets')}}else{var question=this._wizard.FindQuestion(filter.ParentItemGuid);var ans=null;if(question==null){return this._filter('translate')('ParentQuestionNotFound')}else{result+=question.TranslatedText;if(filter.ParentAttributeGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){if(!System.String.IsNullOrEmpty(filter.ParentFieldName)&&question instanceof Intelledox.QAWizard.Design.DatasourceQuestion){result+=" - "+String.fromCharCode(149);this._lookupService.fieldNameToDisplayName(question.DataObjectGuid,filter.ParentFieldName).then(function(name){currentNode.text=currentNode.text.replace(String.fromCharCode(149),name)})}}else{ans=question.FindAnswer(filter.ParentAttributeGuid);if(ans==null){return this._filter('translate')('ParentAnswerNotFound')}else{result+=" - "+this.translate(ans.Name)}}}}this._lookupService.keyFieldToDisplayName(filter.Question.DataObjectGuid,filter.FieldName).then(function(name){currentNode.text=currentNode.text.replace(String.fromCharCode(133),name)});return result};ClauseDesignerViewModel.prototype.validationRuleDescription=function(validationRule){var result="";switch(validationRule.RuleType){case Intelledox.Model.ValidationRuleType.Compare:result=this._filter('translate')('Compare');break;case Intelledox.Model.ValidationRuleType.FieldLength:result=this._filter('translate')('FieldLength');break;case Intelledox.Model.ValidationRuleType.RegularExpression:result=this._filter('translate')('RegularExpression');break;case Intelledox.Model.ValidationRuleType.Mandatory:result=this._filter('translate')('Mandatory');break}var q=this._wizard.FindQuestion(validationRule.QuestionGuid);if(validationRule.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&q!=null){if(q!=null){result+=" "+q.Text;var a=q.FindAnswer(validationRule.AnswerGuid);if(validationRule.AnswerGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&a!=null){result+=" - "+q.FindAnswer(validationRule.AnswerGuid).Name}else{if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt){result+=" "+this._filter('translate')('ErrorMsg_AnswerNotFound')}}}}else{result+=" "+this._filter('translate')('ErrorMsg_QuestionNotFound')}switch(validationRule.ComparisonType){case Intelledox.Model.ComparisonType.BeginsWith:result+=" "+this._filter('translate')('BeginsWith');break;case Intelledox.Model.ComparisonType.Contains:result+=" "+this._filter('translate')('Contains');break;case Intelledox.Model.ComparisonType.EndsWith:result+=" "+this._filter('translate')('EndsWith');break;case Intelledox.Model.ComparisonType.Equals:result+=" "+this._filter('translate')('EqualsString');break;case Intelledox.Model.ComparisonType.GreaterThan:result+=" "+this._filter('translate')('GreaterThan');break;case Intelledox.Model.ComparisonType.GreaterThanOrEquals:result+=" "+this._filter('translate')('GreaterThanorEqualTo');break;case Intelledox.Model.ComparisonType.LessThan:result+=" "+this._filter('translate')('LessThan');break;case Intelledox.Model.ComparisonType.LessThanOrEquals:result+=" "+this._filter('translate')('LessThanorEqualTo');break;case Intelledox.Model.ComparisonType.NotContain:result+=" "+this._filter('translate')('NotContain');break;case Intelledox.Model.ComparisonType.NotEqualTo:result+=" "+this._filter('translate')('NotEqualTo');break}if(System.String.IsNullOrEmpty(validationRule.Expression)){result+=" "+"\"\""}else{result+=" "+validationRule.Expression}return result};ClauseDesignerViewModel.prototype.translate=function(stringToTranslate){switch(stringToTranslate){case"[RowCount]":return"["+this._filter('translate')('RowCount')+"]";case"[RowNumber]":return"["+this._filter('translate')('RowNumber')+"]";case"[RowId]":return"["+this._filter('translate')('RowId')+"]";case"Selected":return this._filter('translate')('Selected').toLowerCase();case"True":return this._filter('translate')('TrueOption').toLowerCase();case"False":return this._filter('translate')('FalseOption').toLowerCase();case"Success":return this._filter('translate')('Success').toLowerCase();case"Fail":return this._filter('translate')('Fail').toLowerCase();case"NotRun":return this._filter('translate')('NotRun').toLowerCase();default:return stringToTranslate}};ClauseDesignerViewModel.prototype.findClauseGroupAbove=function(compareNode,clauses,results){for(var i=clauses.length-1;i>=0;i--){if(clauses[i]===compareNode){results.foundCompareNode=true}else{this.findClauseGroupAbove(compareNode,clauses[i].SubClauses,results);if(results.clause!=null){return}if(results.foundCompareNode&&clauses[i].SubClauses.indexOf(compareNode)===-1){if(clauses[i].Type===Intelledox.Model.ClauseType.AllOf||clauses[i].Type===Intelledox.Model.ClauseType.AnyOf){results.clause=clauses[i];return}}}}return null};ClauseDesignerViewModel.prototype.findClauseGroupBelow=function(compareNode,clauses,results){for(var i=0;i<clauses.length;i++){if(clauses[i]===compareNode){results.foundCompareNode=true}else{if(results.foundCompareNode){if(clauses[i].Type===Intelledox.Model.ClauseType.AllOf||clauses[i].Type===Intelledox.Model.ClauseType.AnyOf){results.clause=clauses[i];return}}this.findClauseGroupBelow(compareNode,clauses[i].SubClauses,results);if(results.clause!=null){return}}}return null};return ClauseDesignerViewModel}());Design.ClauseDesignerViewModel=ClauseDesignerViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var AnswerFilePropertiesViewModel=(function(_super){__extends(AnswerFilePropertiesViewModel,_super);function AnswerFilePropertiesViewModel(editorViewModel,$filter,$scope,$uibModal,wizard){var _this=_super.call(this)||this;_this.GenerateButtonLocations=[{name:'Both',value:Intelledox.QAWizard.Design.GenerateButtonLocation.Both},{name:'BottomMiddle',value:Intelledox.QAWizard.Design.GenerateButtonLocation.BottomMiddle_Default},{name:'TopRight',value:Intelledox.QAWizard.Design.GenerateButtonLocation.TopRight}];_this._editorViewModel=editorViewModel;_this._filter=$filter;_this._scope=$scope;_this._modal=$uibModal;_this._wizard=wizard;return _this}Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"FinishTitle",{get:function(){return this._editorViewModel.wizard.FinishTitle},set:function(value){this._editorViewModel.wizard.FinishTitle=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"Visible",{get:function(){return this._editorViewModel.wizard.FinishPageVisible},set:function(value){this._editorViewModel.wizard.FinishPageVisible=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"SubmitButtonText",{get:function(){return this._editorViewModel.wizard.GenerateButtonText},set:function(value){this._editorViewModel.wizard.GenerateButtonText=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"GenerateButtonLocation",{get:function(){return this._editorViewModel.wizard.GenerateButtonLocation},set:function(value){this._editorViewModel.wizard.GenerateButtonLocation=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"InvalidProjectText",{get:function(){return this._editorViewModel.wizard.InvalidProjectText},set:function(value){this._editorViewModel.wizard.InvalidProjectText=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"SubmittingText",{get:function(){return this._editorViewModel.wizard.GeneratingText},set:function(value){this._editorViewModel.wizard.GeneratingText=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"AllowDocumentDownload",{get:function(){return this._editorViewModel.wizard.AllowDocumentDownload},set:function(value){this._editorViewModel.wizard.AllowDocumentDownload=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"RestrictDownloadableDocs",{get:function(){return(this._restrictDownloadableDocuments)||!(this._editorViewModel.wizard.DownloadableDocuments==="ALL")},set:function(value){this._restrictDownloadableDocuments=value;if(!value){this._editorViewModel.wizard.DownloadableDocuments="ALL";this._editorViewModel.wizChanged=true}},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"RedirectToHome",{get:function(){return this._editorViewModel.wizard.RedirectToHome},set:function(value){this._editorViewModel.wizard.RedirectToHome=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"WaitForProject",{get:function(){return this._editorViewModel.wizard.WaitForProject},set:function(value){this._editorViewModel.wizard.WaitForProject=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"OnlineRedirectMessage",{get:function(){return this._editorViewModel.wizard.OnlineRedirectMessage},set:function(value){this._editorViewModel.wizard.OnlineRedirectMessage=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"OfflineRedirectMessage",{get:function(){return this._editorViewModel.wizard.OfflineRedirectMessage},set:function(value){this._editorViewModel.wizard.OfflineRedirectMessage=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"ShowRedirectOptions",{get:function(){return this._editorViewModel.wizard.RedirectToHome},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"FinishPageTitle",{get:function(){return this._editorViewModel.wizard.DownloadPageTitle},set:function(value){this._editorViewModel.wizard.DownloadPageTitle=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(AnswerFilePropertiesViewModel.prototype,"documentsText",{get:function(){return this.displayDocumentsText()},enumerable:true,configurable:true});AnswerFilePropertiesViewModel.prototype.validateOnlineRedirectMessage=function(id){var allowRedirect=this._editorViewModel.wizard.RedirectToHome;if(allowRedirect&&System.String.IsNullOrEmpty(this._editorViewModel.wizard.OnlineRedirectMessage)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('OnlineRedirectMessage'),''));this.OnlineRedirectMessage=this._editorViewModel.wizard.DefaultOnlineRedirectMessage;this._scope.setFocus(id)}};AnswerFilePropertiesViewModel.prototype.validateOfflineRedirectMessage=function(id){var allowRedirect=this._editorViewModel.wizard.RedirectToHome;if(allowRedirect&&System.String.IsNullOrEmpty(this._editorViewModel.wizard.OfflineRedirectMessage)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('OfflineRedirectMessage'),''));this.OfflineRedirectMessage=this._editorViewModel.wizard.DefaultOfflineRedirectMessage;this._scope.setFocus(id)}};AnswerFilePropertiesViewModel.prototype.selectFinishPgDocuments=function(){var vm=this;vm.availableDocuments=[];var modalConfirm=this._modal.open({templateUrl:'Views/Modal/manageDocuments.html?v=106882799234227327',controller:['$scope','$modalInstance','$filter','editor','wizard','allDocuments','selectedDocuments',Design.SelectDocumentsModalCtrl],backdrop:'static',resolve:{editor:function(){return vm._editorViewModel},wizard:function(){return vm._wizard},allDocuments:function(){return vm._editorViewModel.findDownloadableDocuments(vm.availableDocuments)},selectedDocuments:function(){return vm._editorViewModel.wizard.DownloadableDocuments}}});modalConfirm.result.then(function(newList){vm._editorViewModel.wizard.DownloadableDocuments=newList;vm._editorViewModel.wizChanged=true})};AnswerFilePropertiesViewModel.prototype.displayDocumentsText=function(){var docCount=0;if(!System.String.IsNullOrEmpty(this._editorViewModel.wizard.DownloadableDocuments)){if(this._editorViewModel.wizard.DownloadableDocuments==="ALL"){return System.String.Format(this._filter('translate')('NoOfDocsSelected'),this._filter('translate')('All'))}else{docCount=this._editorViewModel.wizard.DownloadableDocuments.split(',').length}}return System.String.Format(this._filter('translate')('NoOfDocsSelected'),docCount)};return AnswerFilePropertiesViewModel}(Design.PropertiesViewModel));Design.AnswerFilePropertiesViewModel=AnswerFilePropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var NumericPropertiesViewModel=(function(_super){__extends(NumericPropertiesViewModel,_super);function NumericPropertiesViewModel(editorViewModel,question,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._editor=editorViewModel;_this._numeric=question;if(_this._numeric.Width<1){_this._numeric.Width=0}if(_this._numeric.Increment<1){_this._numeric.Increment=1}return _this}Object.defineProperty(NumericPropertiesViewModel.prototype,"minimum",{get:function(){if(Design.HelperFunctions.isNegativeZero(this._numeric.MinimumValue)){return"-"}return this._numeric.MinimumValue.toString()},set:function(value){if(value==="-"){this._numeric.MinimumValue=-0}else{this._numeric.MinimumValue=parseInt(value,10);if(isNaN(this._numeric.MinimumValue)){this._numeric.MinimumValue=0}}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(NumericPropertiesViewModel.prototype,"maximum",{get:function(){return this._numeric.MaximumValue.toString()},set:function(value){this._numeric.MaximumValue=parseInt(value,10);if(isNaN(this._numeric.MaximumValue)){this._numeric.MaximumValue=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(NumericPropertiesViewModel.prototype,"increment",{get:function(){if(this._numeric.Increment==undefined){return""}return this._numeric.Increment.toString()},set:function(value){if(value!=""){this._numeric.Increment=parseInt(value,10);if(isNaN(this._numeric.Increment)){this._numeric.Increment=1}}else{this._numeric.Increment=undefined}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(NumericPropertiesViewModel.prototype,"width",{get:function(){return this._numeric.Width.toString()},set:function(value){this._numeric.Width=parseInt(value,10);if(isNaN(this._numeric.Width)){this._numeric.Width=0}this._editor.wizChanged=true},enumerable:true,configurable:true});return NumericPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.NumericPropertiesViewModel=NumericPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var GeolocationPropertiesViewModel=(function(_super){__extends(GeolocationPropertiesViewModel,_super);function GeolocationPropertiesViewModel(editorViewModel,question,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._editor=editorViewModel;_this._geolocation=question;return _this}Object.defineProperty(GeolocationPropertiesViewModel.prototype,"highAccuracy",{get:function(){return this._geolocation.HighAccuracy},set:function(value){if(this._geolocation.HighAccuracy!==value){this._geolocation.HighAccuracy=value;this._editor.wizChanged=true}},enumerable:true,configurable:true});return GeolocationPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.GeolocationPropertiesViewModel=GeolocationPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ActionPropertiesViewModel=(function(){function ActionPropertiesViewModel(editorViewModel,action,wizard,$filter,lists,scope,isWorkflowPage){this._isInitializing=false;this._isWorkflowPage=false;this._isRetryVisible=false;this._actionUsesDocuments=true;this.inputsPanelModel=null;this.isRunActionVisible=false;this.isShowActionVisible=false;this.isRepeatSourceVisible=false;var vm=this;this.inputsPanelModel=new Design.InputsPanelViewModel($filter,editorViewModel,action,wizard,lists);this._editor=editorViewModel;this._scope=scope;this._filter=$filter;this._action=action;this._wizard=wizard;this._isWorkflowPage=isWorkflowPage;this._isInitializing=true;this._isRetryVisible=this._action.HasRetries;this.propertiesTitle=System.String.Format(this._filter('translate')('ActionPropertiesTitle'),'');lists.getActionName(action.Type.routingTypeId).then(function(name){vm.propertiesTitle=System.String.Format(vm._filter('translate')('ActionPropertiesTitle'),name)});if(action.IsRepeated){this.loadRepeatSources();this.isRepeatSourceVisible=true}else{this.availableRepeatSources=[]}this.loadActionWhen();this.loadSubmissionStages();lists.actionTypes().then(function(actionTypes){var supportsRun=false;var supportsUI=false;for(var i=0;i<actionTypes.length;i++){if(actionTypes[i].routingTypeId===action.Type.routingTypeId){supportsRun=actionTypes[i].supportsRun;supportsUI=actionTypes[i].supportsUI;vm._actionUsesDocuments=(actionTypes[i].usesDocuments!==Intelledox.Model.DocumentUsage.Never);break}}vm.isRunActionVisible=supportsRun;vm.isShowActionVisible=supportsUI;vm._editor.hasActionDocuments=vm._editor.hasActionDocuments&&vm._actionUsesDocuments});this._isInitializing=false}Object.defineProperty(ActionPropertiesViewModel.prototype,"isRetryVisible",{get:function(){return this._isRetryVisible},set:function(value){this._isRetryVisible=value;if(value===false){this._action.Retries=0;this._action.RetryWait=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ActionPropertiesViewModel.prototype,"retries",{get:function(){return this._action.Retries},set:function(value){this._action.Retries=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ActionPropertiesViewModel.prototype,"retryWait",{get:function(){return this._action.RetryWait},set:function(value){this._action.RetryWait=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ActionPropertiesViewModel.prototype,"name",{get:function(){return Design.TranslationHelper.KeywordValueToTranslation(this._filter,this._action.Name)},set:function(value){this._action.Name=Design.TranslationHelper.TranslationToKeywordValue(this._filter,value);this._editor.wizChanged=true;if(this._editor.treeView.selectedNode!=null){this._editor.treeView.selectedNode.text=value}this._scope.$emit('workflowChanged')},enumerable:true,configurable:true});Object.defineProperty(ActionPropertiesViewModel.prototype,"selectedRunActionWhen",{get:function(){return this._action.RunActionWhen},set:function(value){this._action.RunActionWhen=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ActionPropertiesViewModel.prototype,"selectedShowActionWhen",{get:function(){return this._action.ShowActionWhen},set:function(value){this._action.ShowActionWhen=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ActionPropertiesViewModel.prototype,"selectedSubmissionStage",{get:function(){return this._action.SubmissionStage},set:function(value){this._action.SubmissionStage=value;this._editor.wizChanged=true;this._editor.hasActionDocuments=(value!==Intelledox.Model.SubmissionStage.Submit&&this._actionUsesDocuments)},enumerable:true,configurable:true});Object.defineProperty(ActionPropertiesViewModel.prototype,"isRepeated",{get:function(){return this._action.IsRepeated},set:function(value){this._action.IsRepeated=value;this._editor.wizChanged=true;if(value&&this.availableRepeatSources.length===0){this.loadRepeatSources()}this.isRepeatSourceVisible=value},enumerable:true,configurable:true});Object.defineProperty(ActionPropertiesViewModel.prototype,"repeatSource",{get:function(){return this._action.RepeaterGuid},set:function(value){this._action.RepeaterGuid=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ActionPropertiesViewModel.prototype,"isSubmissionStageVisible",{get:function(){return this.isRunActionVisible},enumerable:true,configurable:true});ActionPropertiesViewModel.prototype.validateName=function(){if(System.String.IsNullOrEmpty(this._action.Name)){alert(System.String.Format(this._filter('translate')('ErrorMsg_MustProvideValidNameFormat'),this._filter('translate')('ActionName'),''))}};ActionPropertiesViewModel.prototype.loadRepeatSources=function(){var results={sectionsSoFar:0};this.availableRepeatSources=[];this.availableRepeatSources.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY});for(var i=0;i<this._wizard.Pages.length;i++){var p=this._wizard.Pages[i];if(p.IsRepeated){this.availableRepeatSources.push({name:Design.TranslationHelper.KeywordValueToTranslation(this._filter,p.Name),value:p.ObjectId})}this.loadRepeatSourcesRecursive(p.Children,Design.TranslationHelper.KeywordValueToTranslation(this._filter,p.Name)+": ",results)}};ActionPropertiesViewModel.prototype.loadRepeatSourcesRecursive=function(layout,sectionNamePrefix,results){for(var i=0;i<layout.length;i++){var l=layout[i];if(l instanceof Intelledox.QAWizard.Design.Section){results.sectionsSoFar+=1;var s=l;var sectionName;if(!System.String.IsNullOrEmpty(s.Title)){sectionName=sectionNamePrefix+Design.TranslationHelper.KeywordValueToTranslation(this._filter,s.Title)}else{sectionName=sectionNamePrefix+System.String.Format(this._filter('translate')('SectionNumber'),results.sectionsSoFar.toString())}if(l.IsRepeated){this.availableRepeatSources.push({name:Design.TranslationHelper.KeywordValueToTranslation(this._filter,sectionName),value:s.ObjectId})}this.loadRepeatSourcesRecursive(l.Children,Design.TranslationHelper.KeywordValueToTranslation(this._filter,sectionName)+" - ",{sectionsSoFar:0})}else if(typeof l.HasContainerInterface!=="undefined"){this.loadRepeatSourcesRecursive(l.Children,sectionNamePrefix,results)}else if(l instanceof Intelledox.QAWizard.Design.DatasourceQuestion){if(l.SelectionType===Intelledox.Model.SelectionType.Multiple){this.availableRepeatSources.push({name:sectionNamePrefix+l.Text,value:l.ObjectId})}}}};ActionPropertiesViewModel.prototype.loadActionWhen=function(){this.availableActionWhens=[];this.availableActionWhens.push({name:this._filter('translate')('Always'),value:Intelledox.Model.RunActionWhen.Always});this.availableActionWhens.push({name:this._filter('translate')('Never'),value:Intelledox.Model.RunActionWhen.Never});this.availableActionWhens.push({name:this._filter('translate')('OnDocGenFail'),value:Intelledox.Model.RunActionWhen.OnDocGenFail});this.availableActionWhens.push({name:this._filter('translate')('OnDocGenSuccess'),value:Intelledox.Model.RunActionWhen.OnDocGenSuccess})};ActionPropertiesViewModel.prototype.loadSubmissionStages=function(){var i=1;this.availableSubmissionStages=[];this.availableSubmissionStages.push({name:i.toString()+". "+this._filter('translate')('Submit'),value:Intelledox.Model.SubmissionStage.Submit});i++;this.availableSubmissionStages.push({name:i.toString()+". "+this._filter('translate')('DocumentGeneration'),value:Intelledox.Model.SubmissionStage.DocumentGeneration});i++;if(this._isWorkflowPage){this.availableSubmissionStages.push({name:i.toString()+". "+this._filter('translate')('WorkflowAssignment'),value:Intelledox.Model.SubmissionStage.WorkflowAssignment});i++}this.availableSubmissionStages.push({name:i.toString()+". "+this._filter('translate')('Finish'),value:Intelledox.Model.SubmissionStage.Finish})};return ActionPropertiesViewModel}());Design.ActionPropertiesViewModel=ActionPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var InputsPanelViewModel=(function(){function InputsPanelViewModel($filter,editorViewModel,parent,wiz,lists){var _this=this;this._isInitializing=false;this._parent=null;this._wizard=null;this._listManager=null;this._selectedAvailableInput=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedType=Intelledox.Model.RoutingSourceType.FixedValue;this._selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedAnswerGuidOrField=Intelledox.Common.ConstantValues.GUID_EMPTY;this._typeValue='';this._canTypeBoolBeVisible=false;this._canTypeValuesBeVisible=false;this._allDocuments=null;this._key='';this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.isTypeVisible=false;this.isQuestionVisible=false;this.isTextVisible=false;this.isKeyVisible=false;this.isTypeBoolVisible=false;this.isTypeValuesVisible=false;this.isRepeatSourcesVisible=false;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.isCurrentProjectAvailableInputsVisible=false;this.frameTitle='';this.questionTitle='';this.answerTitle='';this.textValue='';this.availableFieldWidth=0;this.availableInputs=[];this.availableTypes=[];this.availableQuestions=[];this.availableAnswers=[];this.availableValues=[];this.availableRepeatSources=[];this.availableFragments=[];this.availableFragmentOutputs=[];this.availableCurrentProjectInputs=[];this._q=lists.qservice;this._editorViewModel=editorViewModel;this._filter=$filter;this._parent=parent;this._wizard=wiz;this._listManager=lists;this.inputsTreeview=new Design.TreeView;this.inputsTreeview.selectionEvent=function(node){return _this.nodeSelected(node)};this._isInitializing=true;if(parent instanceof Intelledox.QAWizard.Design.Escalation){this.frameTitle=this._filter('translate')('EscalationInputs')}else if(parent instanceof Intelledox.QAWizard.Design.Action){this.frameTitle=this._filter('translate')('ActionInput')}else if(parent instanceof Intelledox.QAWizard.Design.CustomQuestion){this.frameTitle=this._filter('translate')('CustomQuestionInputs')}else if(typeof parent.HasFragmentInterface!=="undefined"){this.frameTitle=this._filter('translate')('FragmentInputs')}this.textValue='';this.key='';this.typeValue='';this.loadAvailableInputs();this.loadSourceTypes(null);this.selectedType=Intelledox.Model.RoutingSourceType.FixedValue;this.checkAddUpdate();this._isInitializing=false}Object.defineProperty(InputsPanelViewModel.prototype,"key",{get:function(){return this._key},set:function(value){this._key=value;this.checkAddUpdate()},enumerable:true,configurable:true});Object.defineProperty(InputsPanelViewModel.prototype,"selectedAvailableInput",{get:function(){return this._selectedAvailableInput},set:function(value){this._selectedAvailableInput=value;var selectedItem=this.getSelectedAvailableInput();if(selectedItem!=null){this.isKeyVisible=selectedItem.isKeyValue;this._canTypeBoolBeVisible=(selectedItem.valueType===Intelledox.Model.ValueTypes.Boolean);this._canTypeValuesBeVisible=(selectedItem.valueType===Intelledox.Model.ValueTypes.Enum||selectedItem.valueType===Intelledox.Model.ValueTypes.Document);if(selectedItem.valueType===Intelledox.Model.ValueTypes.Enum){this.loadEnums(selectedItem)}else if(selectedItem.valueType===Intelledox.Model.ValueTypes.Document){this.loadDocuments()}this.loadSourceTypes(selectedItem);if(selectedItem.valueType===Intelledox.Model.ValueTypes.Boolean||selectedItem.valueType===Intelledox.Model.ValueTypes.Enum||selectedItem.valueType===Intelledox.Model.ValueTypes.Document){this.selectedType=Intelledox.Model.RoutingSourceType.TypeValue}else if(selectedItem.valueType===Intelledox.Model.ValueTypes.Repeat){this.selectedType=Intelledox.Model.RoutingSourceType.Repeat}else if(this.selectedType===Intelledox.Model.RoutingSourceType.TypeValue||this.selectedType===Intelledox.Model.RoutingSourceType.Repeat||this.selectedType===Intelledox.Model.RoutingSourceType.InputValue){this.selectedType=Intelledox.Model.RoutingSourceType.FixedValue}}this.checkAddUpdate()},enumerable:true,configurable:true});Object.defineProperty(InputsPanelViewModel.prototype,"selectedType",{get:function(){return this._selectedType},set:function(value){this._selectedType=value;switch(value){case Intelledox.Model.RoutingSourceType.AnswerValue:this.questionTitle=this._filter('translate')('Question');this.answerTitle=this._filter('translate')('Answer');this.isQuestionVisible=true;this.isTypeBoolVisible=false;this.isTypeValuesVisible=false;this.isRepeatSourcesVisible=false;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.isCurrentProjectAvailableInputsVisible=false;this.loadQuestions(false);break;case Intelledox.Model.RoutingSourceType.DataQuestion:this.questionTitle=this._filter('translate')('DataQuestion');this.answerTitle=this._filter('translate')('Field');this.isQuestionVisible=true;this.isTypeBoolVisible=false;this.isTypeValuesVisible=false;this.isRepeatSourcesVisible=false;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.isCurrentProjectAvailableInputsVisible=false;this.loadQuestions(true);break;case Intelledox.Model.RoutingSourceType.FixedValue:this.isQuestionVisible=false;this.isTypeBoolVisible=false;this.isTypeValuesVisible=false;this.isRepeatSourcesVisible=false;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.isCurrentProjectAvailableInputsVisible=false;break;case Intelledox.Model.RoutingSourceType.TypeValue:this.isQuestionVisible=false;this.isTypeBoolVisible=this._canTypeBoolBeVisible;this.isTypeValuesVisible=this._canTypeValuesBeVisible;this.isRepeatSourcesVisible=false;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.isCurrentProjectAvailableInputsVisible=false;break;case Intelledox.Model.RoutingSourceType.Repeat:this.questionTitle=this._filter('translate')('Repeat');this.isQuestionVisible=false;this.isTypeBoolVisible=false;this.isTypeValuesVisible=false;this.isRepeatSourcesVisible=true;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.isCurrentProjectAvailableInputsVisible=false;this.loadRepeatSources();break;case Intelledox.Model.RoutingSourceType.InputValue:this.questionTitle=this._filter('translate')('Input');this.isQuestionVisible=false;this.isTypeBoolVisible=false;this.isTypeValuesVisible=false;this.isRepeatSourcesVisible=false;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.isCurrentProjectAvailableInputsVisible=true;this.loadCurrentProjectAvailableInputs();break;case Intelledox.Model.RoutingSourceType.FragmentOutput:this.isQuestionVisible=false;this.isTypeBoolVisible=false;this.isTypeValuesVisible=false;this.isRepeatSourcesVisible=false;this.isFragmentVisible=true;this.isFragmentOutputVisible=true;this.isCurrentProjectAvailableInputsVisible=false;this.loadFragments()}this.checkAddUpdate()},enumerable:true,configurable:true});Object.defineProperty(InputsPanelViewModel.prototype,"selectedQuestionGuid",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;if(this.selectedType===Intelledox.Model.RoutingSourceType.AnswerValue){this.loadAnswers()}else if(this.selectedType===Intelledox.Model.RoutingSourceType.DataQuestion){this.loadFields()}this.checkAddUpdate()},enumerable:true,configurable:true});Object.defineProperty(InputsPanelViewModel.prototype,"selectedAnswerGuidOrField",{get:function(){return this._selectedAnswerGuidOrField},set:function(value){this._selectedAnswerGuidOrField=value;this.checkAddUpdate()},enumerable:true,configurable:true});Object.defineProperty(InputsPanelViewModel.prototype,"selectedInputRepeat",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;this.isFragmentOutputVisible=false;var repeatReference=this._editorViewModel.wizard.FindLayoutNode(this.selectedInputRepeat);if(repeatReference!=null&&typeof repeatReference.HasFragmentInterface!=="undefined"){this.isFragmentOutputVisible=true;this.availableFragmentOutputs=[];this._listManager.populateFragmentRepeatedOutputs(repeatReference.ProjectGuid,this.availableFragmentOutputs)}this.checkAddUpdate()},enumerable:true,configurable:true});Object.defineProperty(InputsPanelViewModel.prototype,"selectedFragment",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;var projectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(value!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var i=0;i<this.availableFragments.length;i++){if(this.availableFragments[i].ObjectId===value){projectGuid=this.availableFragments[i].ProjectGuid;break}}}this.availableFragmentOutputs=[];this._listManager.populateFragmentOutputs(projectGuid,this.availableFragmentOutputs);this.checkAddUpdate()},enumerable:true,configurable:true});Object.defineProperty(InputsPanelViewModel.prototype,"selectedFragmentOutput",{get:function(){return this._selectedAnswerGuidOrField},set:function(value){this._selectedAnswerGuidOrField=value;this.checkAddUpdate()},enumerable:true,configurable:true});Object.defineProperty(InputsPanelViewModel.prototype,"selectedCurrentProjectAvailableInput",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;this.checkAddUpdate()},enumerable:true,configurable:true});Object.defineProperty(InputsPanelViewModel.prototype,"typeValue",{get:function(){return this._typeValue},set:function(value){this._typeValue=value;this.checkAddUpdate()},enumerable:true,configurable:true});Object.defineProperty(InputsPanelViewModel.prototype,"typeValueBool",{get:function(){return Intelledox.Common.Functions.EqualsIgnoreCase(this.typeValue,"true")},set:function(value){this.typeValue=value.toString()},enumerable:true,configurable:true});InputsPanelViewModel.prototype.add=function(){var newInputType=this.getSelectedAvailableInput();var inputs=this.inputs();if(newInputType.parentRoutingElementTypeId!==Intelledox.Common.ConstantValues.GUID_EMPTY){var existing=this.getSelectedExistingInput();var parentInput=null;var newInputTypeParent=this.availableInputs.filter(function(input){return input.value.routingElementTypeId===newInputType.parentRoutingElementTypeId})[0].value;if(existing!=null&&existing.ElementTypeId===newInputType.parentRoutingElementTypeId){parentInput=existing}if(parentInput==null){var parentNode=null;if(newInputType.elementLimit>0){var parentNodes=this.inputsTreeview.findTreeNodes(function(parentNode){return parentNode.tag.ElementTypeId===newInputType.parentRoutingElementTypeId});for(var i=0;i<parentNodes.length;i++){var routingOption=parentNodes[i].tag;if(routingOption.ChildInputs===null){parentNode=parentNodes[i];break}var hasVacancy=true;for(var j=0;j<routingOption.ChildInputs.length;j++){if(routingOption.ChildInputs[j].ElementTypeId===newInputType.routingElementTypeId){hasVacancy=false;break}}if(hasVacancy){parentNode=parentNodes[i];break}}if(parentNode===null&&parentNodes.length>0){alert(System.String.Format(this._filter('translate')('ErrorMsg_ExceededAttributeLimit'),newInputType.description,this.parentName()));return}}else{parentNode=this.inputsTreeview.firstOrDefault(function(parentNode){return parentNode.tag.ElementTypeId===newInputType.parentRoutingElementTypeId})}if(parentNode!=null){parentInput=parentNode.tag}if(parentInput==null&&newInputTypeParent.valueType==Intelledox.Model.ValueTypes.None){parentInput=new Intelledox.Model.RoutingOption;var parentInputElementType=new Intelledox.Model.RoutingElementType;parentInputElementType.routingElementTypeId=newInputTypeParent.routingElementTypeId;parentInputElementType.elementLimit=newInputTypeParent.elementLimit;parentInputElementType.description=newInputTypeParent.description;parentInput=this.addNewInputType(parentInputElementType,inputs,"")}}if(parentInput==null){alert(this._filter('translate')('ParentInputNotFound'));return}else{if(parentInput.ChildInputs==null){parentInput.ChildInputs=[]}inputs=parentInput.ChildInputs}}this.addNewInputType(newInputType,inputs,this.textValue);this.loadInputs();this._editorViewModel.wizChanged=true};InputsPanelViewModel.prototype.addNewInputType=function(newInputType,inputs,value){if(typeof this._parent.HasFragmentInterface!=="undefined"||newInputType.elementLimit>0){var thisInputCount=0;for(var i=0;i<inputs.length;i++){var input=inputs[i];if(input.ElementTypeId===newInputType.routingElementTypeId){thisInputCount+=1}}if(typeof this._parent.HasFragmentInterface!=="undefined"){if(thisInputCount>=1){alert(this._filter('translate')('ErrorMsg_InputAlreadyDefined'));return}}else if(thisInputCount>=newInputType.elementLimit){alert(System.String.Format(this._filter('translate')('ErrorMsg_ExceededAttributeLimit'),newInputType.description,this.parentName()));return}}var newInput=null;if(this._parent instanceof Intelledox.QAWizard.Design.Escalation){newInput=new Intelledox.QAWizard.Design.EscalationInput}else if(this._parent instanceof Intelledox.QAWizard.Design.Action){newInput=new Intelledox.QAWizard.Design.ActionInput}else{newInput=new Intelledox.Model.RoutingOption}newInput.RoutingOptionGuid=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();newInput.ElementTypeId=newInputType.routingElementTypeId;newInput.SourceType=this.selectedType;newInput.TemplateGuid=this._wizard.ProjectGuid;if(this.isKeyVisible){newInput.Key=this.key}if(newInput.SourceType===Intelledox.Model.RoutingSourceType.FixedValue){newInput.FixedValue=this.translationToText(value)}else if(newInput.SourceType===Intelledox.Model.RoutingSourceType.DataQuestion){newInput.SourceGuid=this.selectedQuestionGuid;newInput.FieldName=this.selectedAnswerGuidOrField}else if(newInput.SourceType===Intelledox.Model.RoutingSourceType.TypeValue){if(this.isTypeBoolVisible&&System.String.IsNullOrEmpty(this.typeValue)){newInput.TypeValue="false"}else{newInput.TypeValue=this.typeValue}}else if(newInput.SourceType===Intelledox.Model.RoutingSourceType.Repeat){newInput.SourceGuid=this.selectedInputRepeat;newInput.SourceAttributeGuid=this.selectedFragmentOutput}else if(newInput.SourceType===Intelledox.Model.RoutingSourceType.InputValue){newInput.SourceGuid=this.selectedCurrentProjectAvailableInput}else if(newInput.SourceType===Intelledox.Model.RoutingSourceType.FragmentOutput){newInput.SourceGuid=this.selectedFragment;newInput.SourceAttributeGuid=this.selectedFragmentOutput}else{newInput.SourceGuid=this.selectedQuestionGuid;newInput.SourceAttributeGuid=this.selectedAnswerGuidOrField}var lastSiblingInput=-1;for(var i=0;i<inputs.length;i++){if(inputs[i].ElementTypeId===newInput.ElementTypeId){lastSiblingInput=i}}if(lastSiblingInput>-1){inputs.splice(lastSiblingInput+1,0,newInput)}else{inputs.push(newInput)}return newInput};InputsPanelViewModel.prototype.update=function(){var existingInput=this.getSelectedExistingInput();if(existingInput!=null){if(existingInput.ElementTypeId!==this.selectedAvailableInput){var newInputType=this.getSelectedAvailableInput();var validElementType=true;if(this.inputsTreeview.selectedNode.parent==null){validElementType=(newInputType.parentRoutingElementTypeId===Intelledox.Common.ConstantValues.GUID_EMPTY)}else{var parentInput=this.inputsTreeview.selectedNode.parent.tag;validElementType=(newInputType.parentRoutingElementTypeId===parentInput.ElementTypeId)}if(!validElementType){alert(this._filter('translate')('ErrorMsg_InvalidParent'));return}existingInput.ElementTypeId=this.selectedAvailableInput}existingInput.SourceType=this.selectedType;existingInput.Key=this.isKeyVisible?this.key:"";switch(existingInput.SourceType){case Intelledox.Model.RoutingSourceType.AnswerValue:existingInput.SourceGuid=this.selectedQuestionGuid;existingInput.SourceAttributeGuid=this.selectedAnswerGuidOrField;existingInput.FieldName="";existingInput.FixedValue="";existingInput.TypeValue="";break;case Intelledox.Model.RoutingSourceType.DataQuestion:existingInput.SourceGuid=this.selectedQuestionGuid;existingInput.SourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;existingInput.FieldName=this.selectedAnswerGuidOrField;existingInput.FixedValue="";existingInput.TypeValue="";break;case Intelledox.Model.RoutingSourceType.FixedValue:existingInput.SourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;existingInput.SourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;existingInput.FieldName="";existingInput.FixedValue=this.translationToText(this.textValue);existingInput.TypeValue="";break;case Intelledox.Model.RoutingSourceType.TypeValue:existingInput.SourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;existingInput.SourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;existingInput.FieldName="";existingInput.FixedValue="";existingInput.TypeValue=this.typeValue;break;case Intelledox.Model.RoutingSourceType.Repeat:existingInput.SourceGuid=this.selectedInputRepeat;existingInput.SourceAttributeGuid=this.selectedFragmentOutput;existingInput.FieldName="";existingInput.FixedValue="";existingInput.TypeValue="";break;case Intelledox.Model.RoutingSourceType.InputValue:existingInput.SourceGuid=this.selectedCurrentProjectAvailableInput;existingInput.SourceAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;existingInput.FieldName="";existingInput.FixedValue="";existingInput.TypeValue="";break;case Intelledox.Model.RoutingSourceType.FragmentOutput:existingInput.SourceGuid=this.selectedFragment;existingInput.SourceAttributeGuid=this.selectedFragmentOutput;existingInput.FieldName="";existingInput.FixedValue="";existingInput.TypeValue="";break}this.loadInputs();this._editorViewModel.wizChanged=true}};InputsPanelViewModel.prototype.remove=function(){var existingInput=this.getSelectedExistingInput();if(existingInput!=null){var userResponse=false;if(this._parent instanceof Intelledox.QAWizard.Design.Escalation){userResponse=confirm(this._filter('translate')('RemoveTheSelectedEscalationInput'))}else if(this._parent instanceof Intelledox.QAWizard.Design.Action){userResponse=confirm(this._filter('translate')('RemoveTheSelectedActionInput'))}else if(this._parent instanceof Intelledox.QAWizard.Design.CustomQuestion||typeof this._parent.HasFragmentInterface!=="undefined"){userResponse=confirm(this._filter('translate')('RemoveTheSelectedInput'))}if(userResponse){this.removeInput(existingInput,this.inputs());this.loadInputs();this.checkAddUpdate();this._editorViewModel.wizChanged=true}}};InputsPanelViewModel.prototype.removeInput=function(existingInput,inputs){for(var i=0;i<inputs.length;i++){if(inputs[i]===existingInput){inputs.splice(i,1);return}if(inputs[i].ChildInputs!=null&&inputs[i].ChildInputs.length>0){this.removeInput(existingInput,inputs[i].ChildInputs)}}};InputsPanelViewModel.prototype.pickTextValueRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.textValue=Design.HelperFunctions.onPickRef(_this._filter,_this.textValue,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};InputsPanelViewModel.prototype.inputs=function(){if(this._parent instanceof Intelledox.QAWizard.Design.Escalation){return this._parent.EscalationInputs}else if(this._parent instanceof Intelledox.QAWizard.Design.Action){return this._parent.ActionInputs}else if(this._parent instanceof Intelledox.QAWizard.Design.CustomQuestion){return this._parent.Inputs}else if(typeof this._parent.HasFragmentInterface!=="undefined"){return this._parent.Inputs}return[]};InputsPanelViewModel.prototype.inputTypes=function(){if(this._parent instanceof Intelledox.QAWizard.Design.Escalation){return this._listManager.routingElementTypes(this._parent.Type.routingTypeId)}else if(this._parent instanceof Intelledox.QAWizard.Design.Action){return this._listManager.routingElementTypes(this._parent.Type.routingTypeId)}else if(this._parent instanceof Intelledox.QAWizard.Design.CustomQuestion){return this._listManager.customQuestionInputTypes(this._parent.CustomQuestionTypeId)}else if(typeof this._parent.HasFragmentInterface!=="undefined"){return this._listManager.projectFragment(this._parent.ProjectGuid).then(function(fragment){return fragment.AvailableInputs})}};InputsPanelViewModel.prototype.loadInputs=function(){var _this=this;this.inputsTreeview.clear();this.loadInputsRecursive(this.inputs(),function(childNode){return _this.inputsTreeview.addChild(childNode)});this.checkAddUpdate()};InputsPanelViewModel.prototype.loadInputsRecursive=function(inputs,nodeAddFunc){var existingNode=null;var routingOpt=null;var previousInputType=Intelledox.Common.ConstantValues.GUID_EMPTY;for(var i=0;i<inputs.length;i++){routingOpt=inputs[i];existingNode=new Design.TreeNode("",routingOpt);existingNode.key=routingOpt.RoutingOptionGuid;var newInputType=new Intelledox.Model.RoutingElementType;var availableInputsArray=this.availableInputs.filter(function(input){return input.value.routingElementTypeId===routingOpt.ElementTypeId});if(availableInputsArray.length>0){newInputType=availableInputsArray[0].value}nodeAddFunc(existingNode);existingNode.expand();if(newInputType.valueType!=Intelledox.Model.ValueTypes.None){existingNode.text=": ";if(!System.String.IsNullOrEmpty(routingOpt.Key)){existingNode.text=routingOpt.Key+'='}switch(routingOpt.SourceType){case Intelledox.Model.RoutingSourceType.AnswerValue:var qn=this._wizard.FindQuestion(routingOpt.SourceGuid);var an=null;if(qn!=null){existingNode.text+=qn.TranslatedText;if(routingOpt.SourceAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){an=qn.FindAnswer(routingOpt.SourceAttributeGuid);if(an!==null){existingNode.text+=" - "+an.Name}else{existingNode.text+=" - "+"{"+this._filter('translate')('InvalidAnswer')+"}"}}}else{existingNode.text+="{"+this._filter('translate')('InvalidQuestion')+"} - "+"{"+this._filter('translate')('InvalidAnswer')+"}"}break;case Intelledox.Model.RoutingSourceType.DataQuestion:var qn=this._wizard.FindQuestion(routingOpt.SourceGuid);if(qn!=null){existingNode.text+=qn.TranslatedText}else{existingNode.text+="{"+this._filter('translate')('InvalidQuestion')+"}"}existingNode.text+=" - "+this._listManager.dataFieldToTranslation(routingOpt.FieldName);break;case Intelledox.Model.RoutingSourceType.FixedValue:existingNode.text+="\""+this.textToTranslation(routingOpt.FixedValue)+"\"";break;case Intelledox.Model.RoutingSourceType.TypeValue:existingNode.text+=this.textToTranslation(routingOpt.TypeValue);break;case Intelledox.Model.RoutingSourceType.Repeat:var rp=this._wizard.FindRepeater(routingOpt.SourceGuid);if(rp!=null){if(rp instanceof Intelledox.QAWizard.Design.DatasourceQuestion){existingNode.text+=rp.TranslatedText}else if(rp instanceof Intelledox.QAWizard.Design.Section){if(this.availableRepeatSources.length===0){this.loadRepeatSources()}for(var sectionIndex=0;sectionIndex<this.availableRepeatSources.length;sectionIndex++){if(this.availableRepeatSources[sectionIndex].tag===rp){existingNode.text+=this.availableRepeatSources[sectionIndex].name;break}}}else if(rp instanceof Intelledox.QAWizard.Design.FragmentPage){existingNode.text+=rp.Name}else if(rp instanceof Intelledox.QAWizard.Design.FragmentReference){existingNode.text+=rp.Name}else if(rp instanceof Intelledox.QAWizard.Design.Page){existingNode.text+=rp.Name}}else{var found=false;for(var inputIndex=0;inputIndex<this._editorViewModel.wizard.AvailableInputs.length;inputIndex++){var input=this._editorViewModel.wizard.AvailableInputs[inputIndex];if(input.routingElementTypeId===routingOpt.SourceGuid){existingNode.text+=input.description;found=true;break}}}break;case Intelledox.Model.RoutingSourceType.InputValue:for(var inputIndex=0;inputIndex<this._editorViewModel.wizard.AvailableInputs.length;inputIndex++){var input=this._editorViewModel.wizard.AvailableInputs[inputIndex];if(input.routingElementTypeId===routingOpt.SourceGuid){existingNode.text+=input.description;found=true;break}}if(!found){existingNode.text+="{"+this._filter('translate')('InputNotFound')+"}"}break;case Intelledox.Model.RoutingSourceType.FragmentOutput:var rp=this._wizard.FindRepeater(routingOpt.SourceGuid);if(rp!=null){if(rp instanceof Intelledox.QAWizard.Design.FragmentPage){existingNode.text+=rp.Name}else if(rp instanceof Intelledox.QAWizard.Design.FragmentReference){existingNode.text+=rp.Name}}else{existingNode.text+="{"+this._filter('translate')('ParentFragmentNotFound')+"}"}}}if(routingOpt.ElementTypeId!==previousInputType){(function(opt,node,vm){vm.inputTypes().then(function(elementTypes){var elementType=null;for(var typeIndex=0;typeIndex<elementTypes.length;typeIndex++){if(elementTypes[typeIndex].routingElementTypeId===opt.ElementTypeId){elementType=elementTypes[typeIndex];break}}if(elementType==null){node.text=vm._filter('translate')('InputNotFound')+node.text}else{node.text=elementType.description+node.text;if(elementType.valueType===Intelledox.Model.ValueTypes.Document){vm.getAllDocuments().then(function(allDocuments){for(var docIndex=0;docIndex<allDocuments.length;docIndex++){if(allDocuments[docIndex].value===opt.TypeValue){node.text=node.text.replace(opt.TypeValue,allDocuments[docIndex].name);break}}})}}})})(routingOpt,existingNode,this)}if(routingOpt.ChildInputs!=null&&routingOpt.ChildInputs.length>0){previousInputType=Intelledox.Common.ConstantValues.GUID_EMPTY;this.loadInputsRecursive(routingOpt.ChildInputs,function(childNode){return existingNode.addChild(childNode)})}else{previousInputType=routingOpt.ElementTypeId}}};InputsPanelViewModel.prototype.textToTranslation=function(text){var result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(text,".Result]","."+this._filter('translate')('Result')+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,".Result|","."+this._filter('translate')('Result')+"|");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+Intelledox.Common.ConstantValues.PROJECTLINK+"]","["+this._filter('translate')('ProjectLink')+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+Intelledox.Common.ConstantValues.STATENAME+"]","["+this._filter('translate')('StateName')+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+Intelledox.Common.ConstantValues.COMMENTS+"]","["+this._filter('translate')('Comments')+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+Intelledox.Common.ConstantValues.PROJECTNAME+"]","["+this._filter('translate')('ProjectName')+"]");return Design.TranslationHelper.KeywordValueToTranslation(this._filter,result)};InputsPanelViewModel.prototype.translationToText=function(translation){var result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(translation,"."+this._filter('translate')('Result')+"]",".Result]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"."+this._filter('translate')('Result')+"|",".Result|");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+this._filter('translate')('ProjectLink')+"]","["+Intelledox.Common.ConstantValues.PROJECTLINK+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+this._filter('translate')('ProjectName')+"]","["+Intelledox.Common.ConstantValues.PROJECTNAME+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+this._filter('translate')('Comments')+"]","["+Intelledox.Common.ConstantValues.COMMENTS+"]");result=Intelledox.QAWizard.Design.GeneralFunctions.ReplaceIgnoreCase(result,"["+this._filter('translate')('StateName')+"]","["+Intelledox.Common.ConstantValues.STATENAME+"]");return Design.TranslationHelper.TranslationToKeywordValue(this._filter,result)};InputsPanelViewModel.prototype.loadSourceTypes=function(selectedItem){this.availableTypes=[];if(selectedItem==null||selectedItem.valueType!==Intelledox.Model.ValueTypes.Repeat){this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.DataQuestion),value:Intelledox.Model.RoutingSourceType.DataQuestion});this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.AnswerValue),value:Intelledox.Model.RoutingSourceType.AnswerValue});this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.FixedValue),value:Intelledox.Model.RoutingSourceType.FixedValue});if(this._canTypeBoolBeVisible||this._canTypeValuesBeVisible){this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.TypeValue),value:Intelledox.Model.RoutingSourceType.TypeValue})}if(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPage||this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.InputValue),value:Intelledox.Model.RoutingSourceType.InputValue})}this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.FragmentOutput),value:Intelledox.Model.RoutingSourceType.FragmentOutput})}else{this.availableTypes.push({name:this.sourceTypeString(Intelledox.Model.RoutingSourceType.Repeat),value:Intelledox.Model.RoutingSourceType.Repeat})}};InputsPanelViewModel.prototype.sourceTypeString=function(sourceType){switch(sourceType){case Intelledox.Model.RoutingSourceType.AnswerValue:return this._filter('translate')('AnswerValue');case Intelledox.Model.RoutingSourceType.DataQuestion:return this._filter('translate')('DataQuestion');case Intelledox.Model.RoutingSourceType.FixedValue:return this._filter('translate')('TextValue');case Intelledox.Model.RoutingSourceType.TypeValue:return this._filter('translate')('Value');case Intelledox.Model.RoutingSourceType.Repeat:return this._filter('translate')('Repeat');case Intelledox.Model.RoutingSourceType.InputValue:return this._filter('translate')('Input');case Intelledox.Model.RoutingSourceType.FragmentOutput:return this._filter('translate')('FragmentOutput');default:return"("+this._filter('translate')('UndefinedSource')+")"}};InputsPanelViewModel.prototype.loadAvailableInputs=function(){var vm=this;this.availableInputs=[];this.inputTypes().then(function(currentElements){vm.loadAvailableInputsRecursive(Intelledox.Common.ConstantValues.GUID_EMPTY,currentElements,'');vm.loadInputs()})};InputsPanelViewModel.prototype.loadAvailableInputsRecursive=function(parentId,availableInputs,level){for(var i=0;i<availableInputs.length;i++){var element=availableInputs[i];if(element.parentRoutingElementTypeId===parentId){this.availableInputs.push({name:level+this._listManager.nameToTranslation(element.description),value:element});this.loadAvailableInputsRecursive(element.routingElementTypeId,availableInputs,'\u2003'+level)}}};InputsPanelViewModel.prototype.loadEnums=function(selectedItem){this.availableValues=[];var enumValues=selectedItem.enumValues.split('|');for(var i=0;i<enumValues.length;i++){this.availableValues.push({name:this._filter('translate')(enumValues[i]),value:enumValues[i]})}};InputsPanelViewModel.prototype.loadDocuments=function(){var vm=this;this.availableValues=[];if(this._parent instanceof Intelledox.QAWizard.Design.Action){var action=this._parent;this.getAllDocuments().then(function(allTemplates){if(action.HasCustomDocuments){for(var i=0;i<action.CustomDocuments.length;i++){var customDocument=action.CustomDocuments[i];for(var docIndex=0;docIndex=allTemplates.length;docIndex++){if(allTemplates[docIndex].value===customDocument.DocumentGuid){vm.availableValues.push({name:allTemplates[docIndex].name,value:allTemplates[docIndex].value});break}}}}else{for(var i=0;i<allTemplates.length;i++){vm.availableValues.push({name:allTemplates[i].name,value:allTemplates[i].value})}}})}};InputsPanelViewModel.prototype.checkAddUpdate=function(){var _this=this;var addState=false;var updateState=false;var removeState=false;this.isTypeVisible=true;this.isTextVisible=true;if(this.getSelectedExistingInput()!=null){removeState=true}if(this.selectedAvailableInput!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(this.isKeyVisible&&System.String.IsNullOrWhiteSpace(this.key)){addState=false}else if(this.selectedType===Intelledox.Model.RoutingSourceType.AnswerValue||this.selectedType===Intelledox.Model.RoutingSourceType.DataQuestion){if(this.selectedQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var question=null;for(var i=0;i<this.availableQuestions.length;i++){if(this.selectedQuestionGuid===this.availableQuestions[i].QuestionGuid){question=this.availableQuestions[i]}}if(question!=null&&(question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||(this.selectedAnswerGuidOrField!==Intelledox.Common.ConstantValues.GUID_EMPTY&&this.selectedAnswerGuidOrField!==''))){addState=true}}this.isTextVisible=false}else if(this.selectedType===Intelledox.Model.RoutingSourceType.FixedValue){addState=true}else if(this.selectedType===Intelledox.Model.RoutingSourceType.TypeValue){if(this.isTypeBoolVisible){addState=true}else if(this.isTypeValuesVisible){addState=!System.String.IsNullOrEmpty(this.typeValue)}this.isTextVisible=false}else if(this.selectedType===Intelledox.Model.RoutingSourceType.Repeat){if(this.selectedInputRepeat!==Intelledox.Common.ConstantValues.GUID_EMPTY||this._parent instanceof Intelledox.QAWizard.Design.Action){addState=true}this.isTextVisible=false}else if(this.selectedType===Intelledox.Model.RoutingSourceType.InputValue){if(this.selectedCurrentProjectAvailableInput!==Intelledox.Common.ConstantValues.GUID_EMPTY){addState=true}this.isTextVisible=false}else if(this.selectedType===Intelledox.Model.RoutingSourceType.FragmentOutput){if(this.selectedFragment!==Intelledox.Common.ConstantValues.GUID_EMPTY&&this.selectedFragmentOutput!==Intelledox.Common.ConstantValues.GUID_EMPTY){addState=true}this.isTextVisible=false}var selectedAvailableInputType=this.availableInputs.filter(function(input){return input.value.routingElementTypeId===_this.selectedAvailableInput})[0].value;if(selectedAvailableInputType.valueType==Intelledox.Model.ValueTypes.None){this._selectedType=Intelledox.Model.RoutingSourceType.FixedValue;this.isTypeVisible=false;this.isTextVisible=false;this.isQuestionVisible=false;this.isFragmentVisible=false;this.isFragmentOutputVisible=false;this.isRepeatSourcesVisible=false;this.isCurrentProjectAvailableInputsVisible=false}}if(removeState&&addState){updateState=true}this.isAddEnabled=addState;this.isUpdateEnabled=updateState;this.isRemoveEnabled=removeState};InputsPanelViewModel.prototype.nodeSelected=function(node){var attr=node.tag;this.inputsTreeview.selectedNode=node;this.selectedAvailableInput=attr.ElementTypeId;this.selectedType=attr.SourceType;this.key=attr.Key;this.textValue='';this.typeValue='';switch(attr.SourceType){case Intelledox.Model.RoutingSourceType.AnswerValue:this.selectedQuestionGuid=attr.SourceGuid;this.selectedAnswerGuidOrField=attr.SourceAttributeGuid;break;case Intelledox.Model.RoutingSourceType.DataQuestion:this.selectedQuestionGuid=attr.SourceGuid;this.selectedAnswerGuidOrField=attr.FieldName;break;case Intelledox.Model.RoutingSourceType.FixedValue:this.textValue=this.textToTranslation(attr.FixedValue);break;case Intelledox.Model.RoutingSourceType.TypeValue:this.typeValue=attr.TypeValue;break;case Intelledox.Model.RoutingSourceType.Repeat:this.selectedInputRepeat=attr.SourceGuid;this.selectedFragmentOutput=attr.SourceAttributeGuid;break;case Intelledox.Model.RoutingSourceType.InputValue:this.selectedCurrentProjectAvailableInput=attr.SourceGuid;break;case Intelledox.Model.RoutingSourceType.FragmentOutput:this.selectedFragment=attr.SourceGuid;this.selectedFragmentOutput=attr.SourceAttributeGuid;break}this.checkAddUpdate()};InputsPanelViewModel.prototype.getSelectedExistingInput=function(){var selectedNode=this.inputsTreeview.selectedNode;if(selectedNode!=null){return selectedNode.tag}return null};InputsPanelViewModel.prototype.loadQuestions=function(dataOnly){this.availableQuestions=[];this.availableAnswers=[];var parentPage=null;if(this._parent instanceof Intelledox.QAWizard.Design.CustomQuestion){parentPage=this._parent.Page}else if(this._parent instanceof Intelledox.QAWizard.Design.FragmentPage){parentPage=this._parent}else if(this._parent instanceof Intelledox.QAWizard.Design.FragmentReference){parentPage=this._wizard.FindPageOfLayout(this._parent)}this.availableQuestions.push(new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.availableAnswers.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY});for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){for(var questionIndex=0;questionIndex<this._wizard.Pages[pageIndex].Questions.length;questionIndex++){var qn=this._wizard.Pages[pageIndex].Questions[questionIndex];if(this._parent instanceof Intelledox.QAWizard.Design.CustomQuestion||typeof this._parent.HasFragmentInterface!=="undefined"){if(qn===this._parent){break}else if(parentPage===qn.Page){if(!Design.ValidationWizard.isValidSamePageConditionParentQuestion(qn)){continue}}else if(!Design.ValidationWizard.isValidConditionParentQuestionType(qn.QuestionTypeID)){continue}}if(!dataOnly||qn.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.availableQuestions.push(qn)}}}this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY};InputsPanelViewModel.prototype.loadAnswers=function(){this.availableAnswers=[];this.availableAnswers.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY});if(this.selectedQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var i=0;i<this.availableQuestions.length;i++){if(this.availableQuestions[i].QuestionGuid===this.selectedQuestionGuid){var question=this.availableQuestions[i];for(var answerIndex=0;answerIndex<question.Answers.length;answerIndex++){this.availableAnswers.push({name:question.Answers[answerIndex].Name,value:question.Answers[answerIndex].AnswerGuid})}break}}}this.selectedAnswerGuidOrField=Intelledox.Common.ConstantValues.GUID_EMPTY};InputsPanelViewModel.prototype.loadFields=function(){var vm=this;this.availableAnswers=[];this.availableAnswers.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY});if(this.selectedQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var i=0;i<this.availableQuestions.length;i++){if(this.availableQuestions[i].QuestionGuid===this.selectedQuestionGuid){var question=this.availableQuestions[i];if(question.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){Design.HierarchyHelper.getDataFields(this._wizard,this._listManager,question,this.availableFieldWidth,false).then(function(fieldItems){vm.availableAnswers.push.apply(vm.availableAnswers,fieldItems)})}else if(question.IsQARepeater){this.availableAnswers.push.apply(vm.availableAnswers,Design.QARepeatHelper.getDataFields(this._filter,this._wizard,question))}else if(question.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this._listManager.dataFieldsList(question.DataObjectGuid,this.availableFieldWidth,true,"").then(function(fieldItems){vm.availableAnswers.push.apply(vm.availableAnswers,fieldItems)})}break}}}this.selectedAnswerGuidOrField=''};InputsPanelViewModel.prototype.loadFragments=function(){this.availableFragments=[];this._listManager.populateInstanceFragments(this._wizard,this.availableFragments);this.selectedFragment=Intelledox.Common.ConstantValues.GUID_EMPTY};InputsPanelViewModel.prototype.selectRow=function(selectedSubItem){var inputNodes=this.inputsTreeview.findNodeByKey(null,selectedSubItem,true);if(inputNodes.length>0){this.nodeSelected(inputNodes[0])}};InputsPanelViewModel.prototype.getSelectedAvailableInput=function(){for(var i=0;i<this.availableInputs.length;i++){if(this.availableInputs[i].value.routingElementTypeId===this.selectedAvailableInput){return this.availableInputs[i].value}}return null};InputsPanelViewModel.prototype.getAllDocuments=function(){if(this._allDocuments==null){this._allDocuments=Design.ActionDocumentPanelViewModel.getAllAvailableDocuments(this._q,this._filter,this._wizard,false,this._parent,this._listManager)}return this._allDocuments};InputsPanelViewModel.prototype.moveUp=function(){var selectedNode=this.inputsTreeview.selectedNode;if(selectedNode!=null){var prevNode=selectedNode.prevNode;if(prevNode!=null){var index;selectedNode.remove();if(prevNode.parent===null){index=this.inputsTreeview.nodes.indexOf(prevNode);this.inputsTreeview.insertChild(index,selectedNode);this.inputs().splice(index+1,1);this.inputs().splice(index,0,selectedNode.tag)}else{index=prevNode.parent.nodes.indexOf(prevNode);prevNode.parent.insertChild(index,selectedNode);var inputs=prevNode.parent.tag.ChildInputs;inputs.splice(index+1,1);inputs.splice(index,0,selectedNode.tag)}this._editorViewModel.wizChanged=true}}};InputsPanelViewModel.prototype.moveDown=function(){var selectedNode=this.inputsTreeview.selectedNode;if(selectedNode!=null){var nextNode=selectedNode.nextNode;if(nextNode!=null){var index;selectedNode.remove();if(nextNode.parent===null){index=this.inputsTreeview.nodes.indexOf(nextNode)+1;this.inputsTreeview.insertChild(index,selectedNode);this.inputs().splice(index-1,1);this.inputs().splice(index,0,selectedNode.tag)}else{index=nextNode.parent.nodes.indexOf(nextNode)+1;nextNode.parent.insertChild(index,selectedNode);var inputs=nextNode.parent.tag.ChildInputs;inputs.splice(index-1,1);inputs.splice(index,0,selectedNode.tag)}this._editorViewModel.wizChanged=true}}};InputsPanelViewModel.prototype.parentName=function(){if(this._parent instanceof Intelledox.QAWizard.Design.Escalation){return this._filter('translate')('Escalation')}else if(this._parent instanceof Intelledox.QAWizard.Design.Action){return this._filter('translate')('Action')}else if(this._parent instanceof Intelledox.QAWizard.Design.CustomQuestion){return this._filter('translate')('Question')}else if(this._parent instanceof Intelledox.Model.RoutingElementType){return this._filter('translate')('Input')}else if(typeof this._parent.HasFragmentInterface!=="undefined"){return this._filter('translate')('Fragment')}else{return this._filter('translate')('Item')}};InputsPanelViewModel.prototype.loadRepeatSources=function(){this.availableRepeatSources=[];this._listManager.populateRepeatSources(this._editorViewModel.wizard,true,this._parent,this.availableRepeatSources)};InputsPanelViewModel.prototype.loadCurrentProjectAvailableInputs=function(){this.availableCurrentProjectInputs=[];this.availableCurrentProjectInputs.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY,tag:null});for(var i=0;i<this._editorViewModel.wizard.AvailableInputs.length;i++){var input=this._editorViewModel.wizard.AvailableInputs[i];if(input.valueType!==Intelledox.Model.ValueTypes.Repeat){this.availableCurrentProjectInputs.push({name:input.description,value:input.routingElementTypeId,tag:input})}}};return InputsPanelViewModel}());Design.InputsPanelViewModel=InputsPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var DatasourcePropertiesViewModel=(function(_super){__extends(DatasourcePropertiesViewModel,_super);function DatasourcePropertiesViewModel(editorViewModel,question,wizard,$filter,$uibModal,lists,isNewQuestion,qNode){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._hasLoadedDataSources=false;_this._hasLoadedDataObjects=false;_this._hasLoadedFields=false;_this._isNewQuestion=false;_this.availableFieldWidth=0;_this.isDisplayTypeVisible=false;_this.isTextboxWidthVisible=false;_this.isResultsPerPageVisible=false;_this.isDataObjectEnabled=false;_this.isDisplayFieldVisible=false;_this.isAnswerDisplayFieldVisible=false;_this.isDisplayFieldEnabled=false;_this.isValueFieldEnabled=false;_this.isGroupingFieldVisible=false;_this.isAllowDataUploadVisible=false;_this.isDefaultVisible=false;_this.defaultTitle='';_this.repeatPlaceholderText='';_this.qNode=null;_this.NOT_REPEATED="not repeated";_this._filterLocal=$filter;_this._modal=$uibModal;_this._editor=editorViewModel;_this._listManager=lists;_this._currentQuestion=question;_this._wizard=wizard;_this._repeatPlaceholders=(_this._currentQuestion.RepeatPlaceholders!=null&&_this._currentQuestion.RepeatPlaceholders.length>0);_this._isNewQuestion=isNewQuestion;_this.qNode=qNode;if(_this._repeatPlaceholders){_this.displayRepeatPlaceholderText()}_this.loadDefaultTypes();_this.loadDataSources();_this.loadDataObjects();_this.loadDataFields();if(_this._currentQuestion.Visibility){_this.isDisplayTypeVisible=true}_this.availableDisplayTypes=[];_this.loadSelectionTypes();_this.LoadDisplayTypes(_this._currentQuestion.SelectionType);_this.setDefaultTitle(_this._currentQuestion.DefaultType);_this.checkDisplayField();_this.checkValueField();_this.checkGroupingField();_this.checkWidth();_this.checkResultsPerPage();_this.showProvidedData();return _this}DatasourcePropertiesViewModel.prototype.hasSelectedDataSource=function(){return this._hasLoadedDataSources&&this.dataSource!==Intelledox.Common.ConstantValues.GUID_EMPTY};DatasourcePropertiesViewModel.prototype.hasSelectedDataObject=function(){return this._hasLoadedDataSources&&this.dataObject!==Intelledox.Common.ConstantValues.GUID_EMPTY};Object.defineProperty(DatasourcePropertiesViewModel.prototype,"isDataGrid",{get:function(){return this._currentQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.DataGrid},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"hasLoadedDataSources",{get:function(){return this._hasLoadedDataSources},set:function(value){this._hasLoadedDataSources=value;if(this._isNewQuestion&&!this.hasSelectedDataSource()){this._isNewQuestion=false;var vm=this;var modalInstance=this._modal.open({templateUrl:'Views/Modal/datasourceWizard.html?v=106882799234227327',controller:['$scope','$modalInstance','vm',Design.DataSourceModalCtrl],backdrop:'static',resolve:{vm:function(){return vm}}});modalInstance.result.then(function(result){if(result.addAnswers&&vm.availableDisplayFields.length>0){for(var i=0;i<vm.availableDisplayFields.length;i++){if(vm.availableDisplayFields[i].value!=null&&vm.availableDisplayFields[i].value!="[Answer]"){var aNode=vm._editor.createNewAnswer(vm._wizard,vm.qNode,false);aNode.tag.Name=vm.availableDisplayFields[i].name;aNode.tag.DataField=vm.availableDisplayFields[i].name;aNode.text=vm.availableDisplayFields[i].name}}}else if(!vm.qNode.hasChildren){vm._editor.createNewAnswer(vm._wizard,vm.qNode,false)}})}},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"defaultType",{get:function(){return this._currentQuestion.DefaultType},set:function(value){this._currentQuestion.DefaultType=value;this.setDefaultTitle(value);this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"defaultValue",{get:function(){return this._currentQuestion.DefaultValue},set:function(value){if(value===''){this._currentQuestion.DefaultValue=''}else if(Intelledox.Common.Functions.EqualsIgnoreCase(value,'None')||value==='0'){this._currentQuestion.DefaultValue='None'}else if(this._currentQuestion.DefaultType===Intelledox.Model.DefaultValueType.Index){var intValue=parseInt(value,10);if(isNaN(intValue)){intValue=0}this._currentQuestion.DefaultValue=intValue.toString()}else if(this._currentQuestion.DefaultType===Intelledox.Model.DefaultValueType.Value){this._currentQuestion.DefaultValue=value}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"displayType",{get:function(){return this._currentQuestion.DisplayType},set:function(value){this._currentQuestion.DisplayType=value;this._editor.wizChanged=true;if((value===Intelledox.Model.QuestionDisplayType.List&&this._currentQuestion.SelectionType===Intelledox.Model.SelectionType.Multiple)||value===Intelledox.Model.QuestionDisplayType.DataGrid){this.loadDataFields()}if(value===Intelledox.Model.QuestionDisplayType.Popup||value===Intelledox.Model.QuestionDisplayType.Search||value===Intelledox.Model.QuestionDisplayType.DataGrid){this._editor.hasDisplayFields=true}else{this._currentQuestion.HasCustomDisplayFields=false;this._editor.hasDisplayFields=false}if(value!==Intelledox.Model.QuestionDisplayType.DataGrid){this.liveRefresh=false}this.checkWidth();this.checkDisplayField();this.checkGroupingField()},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"canRepeat",{get:function(){if(this._currentQuestion.SelectionType===Intelledox.Model.SelectionType.Multiple){return this.hasDocument()}return false},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"selectionType",{get:function(){return this._currentQuestion.SelectionType},set:function(value){this._currentQuestion.SelectionType=value;if(value===Intelledox.Model.SelectionType.Single||value===Intelledox.Model.SelectionType.None){this.LoadDisplayTypes(value);this.clearRepeatPlaceholders();if(this.dataObject!=null&&this.dataObject===Intelledox.Common.ConstantValues.GUID_EMPTY){if(this._currentQuestion.DisplayType!==Intelledox.Model.QuestionDisplayType.List){this.loadDataFields()}}this.clearRepeatPlaceholders();this.repeatPlaceholderText=''}else{this.LoadDisplayTypes(Intelledox.Model.SelectionType.Multiple)}var dt=this.availableDisplayTypes[0].value;for(var i=0;i<this.availableDisplayTypes.length;i++){if(this.availableDisplayTypes[i].value===this.displayType){dt=this.availableDisplayTypes[i].value;break}}if(dt!==this.displayType){this.displayType=dt}this._editor.wizChanged=true;this.checkDisplayField();this.checkValueField();this.checkWidth()},enumerable:true,configurable:true});DatasourcePropertiesViewModel.prototype.LoadDisplayTypes=function(selectionType){this.availableDisplayTypes=[];if(selectionType===Intelledox.Model.SelectionType.None){this.availableDisplayTypes.push({name:this._filterLocal('translate')('DataGrid'),value:Intelledox.Model.QuestionDisplayType.DataGrid})}else{if(selectionType===Intelledox.Model.SelectionType.Single){this.availableDisplayTypes.push({name:this._filterLocal('translate')('AutoComplete'),value:Intelledox.Model.QuestionDisplayType.AutoComplete});this.availableDisplayTypes.push({name:this._filterLocal('translate')('DropDownList'),value:Intelledox.Model.QuestionDisplayType.List})}else{this.availableDisplayTypes.push({name:this._filterLocal('translate')('DropDownList'),value:Intelledox.Model.QuestionDisplayType.MultiSelectDropdown});this.availableDisplayTypes.push({name:this._filterLocal('translate')('ListBox'),value:Intelledox.Model.QuestionDisplayType.List})}this.availableDisplayTypes.push({name:this._filterLocal('translate')('DataGrid'),value:Intelledox.Model.QuestionDisplayType.DataGrid});this.availableDisplayTypes.push({name:this._filterLocal('translate')('Popup'),value:Intelledox.Model.QuestionDisplayType.Popup});this.availableDisplayTypes.push({name:this._filterLocal('translate')('Search'),value:Intelledox.Model.QuestionDisplayType.Search})}};Object.defineProperty(DatasourcePropertiesViewModel.prototype,"dataSource",{get:function(){if(!this.hasLoadedDataSources){return undefined}if(this._currentQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){return this._currentQuestion.DataSourceHierarchyGuid}return this._currentQuestion.DataSourceGuid},set:function(value){if(value!==Intelledox.Common.ConstantValues.GUID_EMPTY&&(this._currentQuestion.DataSourceGuid===value||this._currentQuestion.DataSourceHierarchyGuid===value)){return}var updateQuestionText=this.questionTextMatchesDS();this.isDataObjectEnabled=false;if(value!==Intelledox.Common.ConstantValues.GUID_EMPTY){var selectedDataSourceItem=this.getSelectedDataSourceItem(value);if(selectedDataSourceItem.tag instanceof Infiniti.Model.Apis.DataService){var oDataSource=selectedDataSourceItem.tag;this._currentQuestion.DataSourceHierarchyGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._currentQuestion.DataSourceRepeatXPath=null;this._currentQuestion.DataSourceGuid=oDataSource.dataServiceGuid}else if(selectedDataSourceItem.tag instanceof Intelledox.QAWizard.Design.DatasourceQuestion){var dataQuestion=selectedDataSourceItem.tag;this._currentQuestion.DataSourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._currentQuestion.DataSourceHierarchyGuid=dataQuestion.QuestionGuid;this._currentQuestion.DataSourceRepeatXPath=null}else if(selectedDataSourceItem.tag==null){this._currentQuestion.DataSourceHierarchyGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._currentQuestion.DataSourceRepeatXPath=null;this._currentQuestion.DataSourceGuid=Intelledox.Common.ConstantValues.QAREPEAT}this.loadDataObjects();this.showProvidedData();this.isDataObjectEnabled=true;this.dataObject=Intelledox.Common.ConstantValues.GUID_EMPTY;this._editor.wizChanged=true}else{if(this._currentQuestion.DataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this._currentQuestion.DataSourceGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._currentQuestion.DataObjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._currentQuestion.DataObjectTypeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._currentQuestion.DataSourceHierarchyGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._currentQuestion.DataSourceRepeatXPath=null;this._editor.wizChanged=true}this.dataObject=Intelledox.Common.ConstantValues.GUID_EMPTY}if(updateQuestionText){this.Text=this.generateQuestionText()}this.hasSelectedDataSource()},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"dataObject",{get:function(){if(!this._hasLoadedDataObjects){return undefined}if(this._currentQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(this._currentQuestion.DataSourceRepeatXPath==null){return Intelledox.Common.ConstantValues.GUID_EMPTY}return this._currentQuestion.DataSourceRepeatXPath}return this._currentQuestion.DataObjectGuid},set:function(value){this._editor.wizChanged=true;if(value===Intelledox.Common.ConstantValues.GUID_EMPTY){this._currentQuestion.DataObjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._currentQuestion.DataObjectTypeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._currentQuestion.DataSourceRepeatXPath=null;this.availableDisplayFields=[];this.availableUniqueFields=[];this.availableGroupingFields=[];this.availableAnswerFields=[];this.availableDisplayFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:null});this.availableUniqueFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:null});this.availableGroupingFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:null});this.availableAnswerFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:null})}else{var updateQuestionText=this.questionTextMatchesDS();var selectedDataSource=this.getSelectedDataSourceItem(this.dataSource);if(selectedDataSource.tag instanceof Intelledox.QAWizard.Design.DatasourceQuestion){this._currentQuestion.DataObjectGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._currentQuestion.DataSourceRepeatXPath=value}else{var dataObjType=Intelledox.Common.ConstantValues.GUID_EMPTY;for(var i=0;i<this.availableDataObjects.length;i++){var dataObj=this.availableDataObjects[i];if(dataObj.value===value){dataObjType=dataObj.type;break}}this._currentQuestion.DataObjectTypeGuid=dataObjType;this._currentQuestion.DataObjectGuid=value;this._currentQuestion.DataSourceRepeatXPath=null}this.loadDataFields();if(updateQuestionText){this.Text=this.generateQuestionText()}}this.displayField=null;this.valueField=null;this.groupingField=null;this.checkDisplayField();this.checkValueField();this.checkGroupingField()},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"displayField",{get:function(){if(!this._hasLoadedFields){return undefined}return this._currentQuestion.DisplayField},set:function(value){this._currentQuestion.DisplayField=value;this._editor.wizChanged=true;this.checkAnswerDisplayField()},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"answerDisplayField",{get:function(){if(!this._hasLoadedFields){return undefined}return this._currentQuestion.AnswerDisplayField},set:function(value){this._currentQuestion.AnswerDisplayField=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"valueField",{get:function(){if(!this._hasLoadedFields){return undefined}return this._currentQuestion.ValueField},set:function(value){this._currentQuestion.ValueField=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"groupingField",{get:function(){if(!this._hasLoadedFields){return undefined}return this._currentQuestion.GroupingField},set:function(value){this._currentQuestion.GroupingField=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"textboxWidth",{get:function(){if(this._currentQuestion.TextBoxWidth<1){return''}return this._currentQuestion.TextBoxWidth.toString()},set:function(value){this._currentQuestion.TextBoxWidth=parseInt(value,10);if(isNaN(this._currentQuestion.TextBoxWidth)){this._currentQuestion.TextBoxWidth=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"noResultsMessage",{get:function(){return this._currentQuestion.NoResultsMessage},set:function(value){this._currentQuestion.NoResultsMessage=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"resultsPerPage",{get:function(){if(this._currentQuestion.ResultsPerPage<1){return''}return this._currentQuestion.ResultsPerPage.toString()},set:function(value){this._currentQuestion.ResultsPerPage=parseInt(value,10);if(isNaN(this._currentQuestion.ResultsPerPage)||this._currentQuestion.ResultsPerPage<1){this._currentQuestion.ResultsPerPage=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"searchAll",{get:function(){return this._currentQuestion.SearchAll},set:function(value){this._currentQuestion.SearchAll=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"visible",{get:function(){return this._currentQuestion.Visibility},set:function(value){this._currentQuestion.Visibility=value;this._editor.wizChanged=true;if(this._currentQuestion.Visibility){this.isDisplayTypeVisible=true}else{this._currentQuestion.DisplayType=Intelledox.Model.QuestionDisplayType.List;this._currentQuestion.LiveRefresh=false;this.isDisplayTypeVisible=false}this.showProvidedData();this.checkDisplayField();this.checkGroupingField()},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"allowDataUpload",{get:function(){return this._currentQuestion.AllowUserUpload},set:function(value){this._currentQuestion.AllowUserUpload=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"repeatContent",{get:function(){if(this._repeatPlaceholders){return"1"}return"0"},set:function(value){this._repeatPlaceholders=(value==="1");if(value!=="1"){this.clearRepeatPlaceholders()}},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"Watermark",{get:function(){return this._currentQuestion.Watermark},set:function(value){this._currentQuestion.Watermark=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"showWatermark",{get:function(){return this._currentQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.AutoComplete},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"showNoResultsMessage",{get:function(){return this._currentQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.AutoComplete},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"hasUserEnteredFilters",{get:function(){return this._currentQuestion.HasUserEnteredFilters()},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"showLiveRefresh",{get:function(){return this._currentQuestion.Visibility&&this._currentQuestion.DisplayType===Intelledox.Model.QuestionDisplayType.DataGrid},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"liveRefresh",{get:function(){return this._currentQuestion.LiveRefresh},set:function(value){this._currentQuestion.LiveRefresh=value;if(value){this._currentQuestion.RefreshPeriod=60}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DatasourcePropertiesViewModel.prototype,"refreshPeriod",{get:function(){if(this._currentQuestion.RefreshPeriod<1){return''}return this._currentQuestion.RefreshPeriod.toString()},set:function(value){this._currentQuestion.RefreshPeriod=parseInt(value,10);if(isNaN(this._currentQuestion.RefreshPeriod)){this._currentQuestion.RefreshPeriod=0}this._editor.wizChanged=true},enumerable:true,configurable:true});DatasourcePropertiesViewModel.prototype.pickWatermarkRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editor.treeView.pickEvent=function(node){_this.Watermark=Design.HelperFunctions.onPickRef(_this._filterLocal,_this.Watermark,node,insertPoint)};this._editor.treeView.togglePickMode()};DatasourcePropertiesViewModel.prototype.selectRepeatPlaceholder=function(){var vm=this;var originalList=[];if(this._currentQuestion.RepeatPlaceholders!=null){for(var i=0;i<this._currentQuestion.RepeatPlaceholders.length;i++){var newItem=new Design.PlaceholderListItem(this._currentQuestion.RepeatPlaceholders[i],Intelledox.Common.ConstantValues.GUID_EMPTY);originalList.push(newItem)}}var modalConfirm=this._modal.open({templateUrl:'Views/Modal/managePlaceholders.html?v=106882799234227327',controller:['$scope','$modalInstance','$filter','editor','singleSelect','placeholders','usedPlaceholders','unusedPlaceholders','additionalListItem','placeholderPurpose',Design.SelectPlaceholdersModalCtrl],backdrop:'static',resolve:{editor:function(){return vm._editor},singleSelect:function(){return false},placeholders:function(){return vm._currentQuestion.RepeatPlaceholders},usedPlaceholders:function(){return vm._editor.flyoutPlaceholders.usedPlaceholders},unusedPlaceholders:function(){return vm._editor.flyoutPlaceholders.unusedPlaceholders},additionalListItem:function(){return null},placeholderPurpose:function(){return Intelledox.Model.PlaceholderPurpose.Repeat}}});modalConfirm.result.then(function(newList){vm._editor.flyoutPlaceholders.colourPlaceholdersFromList(originalList,false);vm._editor.flyoutPlaceholders.colourPlaceholdersFromList(newList,true);vm._currentQuestion.RepeatPlaceholders=[];for(var i=0;i<newList.length;i++){vm._currentQuestion.RepeatPlaceholders.push(newList[i].reference)}vm.displayRepeatPlaceholderText();vm._editor.wizChanged=true})};DatasourcePropertiesViewModel.prototype.loadDefaultTypes=function(){this.availableDefaultTypes=[];this.availableDefaultTypes.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:Intelledox.Model.DefaultValueType.None});this.availableDefaultTypes.push({name:this._filterLocal('translate')('DefaultIndex'),value:Intelledox.Model.DefaultValueType.Index});this.availableDefaultTypes.push({name:this._filterLocal('translate')('DefaultValue'),value:Intelledox.Model.DefaultValueType.Value})};DatasourcePropertiesViewModel.prototype.setDefaultTitle=function(value){if(value===Intelledox.Model.DefaultValueType.None){this.defaultTitle='';this.isDefaultVisible=false;this._currentQuestion.DefaultValue=''}else if(value===Intelledox.Model.DefaultValueType.Index){this.defaultTitle=this._filterLocal('translate')('DefaultIndex');this.isDefaultVisible=true}else if(value===Intelledox.Model.DefaultValueType.Value){this.defaultTitle=this._filterLocal('translate')('DefaultValue');this.isDefaultVisible=true}};DatasourcePropertiesViewModel.prototype.loadDataSources=function(){var vm=this;this.availableDataSources=[];var found=false;var noneService=new Infiniti.Model.Apis.DataService;this.availableDataSources.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY,tag:noneService});for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var p=this._wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<p.Questions.length;questionIndex++){var q=p.Questions[questionIndex];if(q===this._currentQuestion){found=true;break}else if(q instanceof Intelledox.QAWizard.Design.DatasourceQuestion){if(q.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.availableDataSources.push({name:'('+this._filterLocal('translate')('Question')+')'+q.TranslatedText,value:q.QuestionGuid,tag:q})}else if(q.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){(function(currentQuestion){vm._listManager.dataFields(currentQuestion.DataObjectGuid,false,'').then(function(fields){for(var fieldIndex=0;fieldIndex<fields.length;fieldIndex++){if(fields[fieldIndex].isRepeated){vm.availableDataSources.push({name:'('+vm._filterLocal('translate')('Question')+')'+currentQuestion.TranslatedText,value:currentQuestion.QuestionGuid,tag:currentQuestion});break}}})})(q)}}}if(found){break}}this._listManager.dataSources().then(function(dataSources){for(var i=0;i<dataSources.length;i++){vm.availableDataSources.push({name:dataSources[i].name,value:dataSources[i].dataServiceGuid,tag:dataSources[i]})}}).then(function(){vm.availableDataSources.push({name:vm._filterLocal('translate')('PagesAndSections'),value:Intelledox.Common.ConstantValues.QAREPEAT,tag:null});vm.hasLoadedDataSources=true})};DatasourcePropertiesViewModel.prototype.loadDataObjects=function(){var vm=this;this.availableDataObjects=[];this.availableDataObjects.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:Intelledox.Common.ConstantValues.GUID_EMPTY,type:Intelledox.Common.ConstantValues.GUID_EMPTY});if(this._currentQuestion.DataSourceGuid===Intelledox.Common.ConstantValues.GUID_EMPTY&&this._currentQuestion.DataSourceHierarchyGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){this._hasLoadedDataObjects=true;return}if(this._currentQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var parentQuestion=this._wizard.FindQuestion(this._currentQuestion.DataSourceHierarchyGuid);var parentDataQuestion=parentQuestion.GetRootDatasourceQuestion(this._wizard);if(parentDataQuestion!=null){var path;if(parentQuestion.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){path=""}else{path=parentQuestion.DataSourceRepeatXPath}if(path==null){path=""}this._listManager.dataFields(parentDataQuestion.DataObjectGuid,false,path).then(function(displayFields){var fields=new Array;for(var i=0;i<displayFields.length;i++){if(displayFields[i].isRepeated){fields.push(displayFields[i])}}vm.availableDataObjects.push.apply(vm.availableDataObjects,vm._listManager.dataFieldsListFromExisting(fields,vm.availableFieldWidth));vm._hasLoadedDataObjects=true})}}else if(this._currentQuestion.IsQARepeater){var results={sectionsSoFar:0};var repeatParents={};var foundObjectRepeatParents="";for(var i=0;i<this._wizard.Pages.length;i++){var p=this._wizard.Pages[i];var repeatGuids="";if(p.IsRepeated){repeatGuids=p.PageGuid.toString()}foundObjectRepeatParents=this.loadRepeatSourcesRecursive(p.Children,this._currentQuestion,Design.TranslationHelper.KeywordValueToTranslation(this._filterLocal,p.Name)+": ",results,repeatParents,repeatGuids);if(foundObjectRepeatParents!=""){break}if(p.IsRepeated){this.availableDataObjects.push({name:Design.TranslationHelper.KeywordValueToTranslation(this._filterLocal,p.Name),value:p.ObjectId,type:Intelledox.Common.ConstantValues.GUID_EMPTY});repeatParents[p.PageGuid.toString()]=""}}if(foundObjectRepeatParents!=this.NOT_REPEATED){for(var i=this.availableDataObjects.length-1;i>=1;i--){var dataObject=this.availableDataObjects[i];var dataObjectParentSections=repeatParents[dataObject.value.toString()].split('|');for(var j=0;j<dataObjectParentSections.length;j++){if(!System.String.IsNullOrEmpty(dataObjectParentSections[j])&&(foundObjectRepeatParents.indexOf(dataObjectParentSections[j])==-1)){this.availableDataObjects.splice(i,1)}}}}this._hasLoadedDataObjects=true}else{this._listManager.dataObjects(this._currentQuestion.DataSourceGuid).then(function(dataObjects){for(var i=0;i<dataObjects.length;i++){vm.availableDataObjects.push({name:dataObjects[i].displayName,value:dataObjects[i].dataObjectGuid,type:dataObjects[i].objectType})}vm._hasLoadedDataObjects=true})}};DatasourcePropertiesViewModel.prototype.loadRepeatSourcesRecursive=function(layout,stopObject,sectionNamePrefix,results,sectionRepeatParents,currentRepeats){for(var i=0;i<layout.length;i++){var l=layout[i];if(l===stopObject){if(currentRepeats==""){return this.NOT_REPEATED}else{return currentRepeats}}else if(l instanceof Intelledox.QAWizard.Design.Section){results.sectionsSoFar+=1;var s=l;var sectionName;if(!System.String.IsNullOrEmpty(s.Title)){sectionName=sectionNamePrefix+Design.TranslationHelper.KeywordValueToTranslation(this._filterLocal,s.Title)}else{sectionName=sectionNamePrefix+System.String.Format(this._filterLocal('translate')('SectionNumber'),results.sectionsSoFar.toString())}var myRepeats=currentRepeats;if(s.IsRepeated){this.availableDataObjects.push({name:Design.TranslationHelper.KeywordValueToTranslation(this._filterLocal,sectionName),value:s.ObjectId,type:Intelledox.Common.ConstantValues.GUID_EMPTY});sectionRepeatParents[s.SectionGuid.toString()]=currentRepeats;myRepeats+="|"+s.SectionGuid.toString()}var foundObjectRepeatParents=this.loadRepeatSourcesRecursive(l.Children,stopObject,Design.TranslationHelper.KeywordValueToTranslation(this._filterLocal,sectionName)+" - ",results,sectionRepeatParents,myRepeats);if(foundObjectRepeatParents!=""){return foundObjectRepeatParents}}else if(typeof(l.HasContainerInterface)!=="undefined"){var foundObjectRepeatParents=this.loadRepeatSourcesRecursive(l.Children,stopObject,sectionNamePrefix,results,sectionRepeatParents,currentRepeats);if(foundObjectRepeatParents!=""){return foundObjectRepeatParents}}}return""};DatasourcePropertiesViewModel.prototype.loadAnswerDataFields=function(){var vm=this;this.availableAnswerFields=[];this.availableAnswerFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:null});var foundCurrentAnswerField=false;var answerFieldSet=!System.String.IsNullOrEmpty(vm._currentQuestion.AnswerDisplayField);if((this._currentQuestion.DataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&this._currentQuestion.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY)||(this._currentQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY)){for(var i=0;i<vm._currentQuestion.Answers.length;i++){vm.availableAnswerFields.push({name:vm._currentQuestion.Answers[i].Name,value:vm._currentQuestion.Answers[i].AnswerGuid});if(answerFieldSet&&vm._currentQuestion.Answers[i].AnswerGuid.toString()===vm._currentQuestion.AnswerDisplayField){foundCurrentAnswerField=true}}if(!foundCurrentAnswerField){vm._currentQuestion.AnswerDisplayField=""}}};DatasourcePropertiesViewModel.prototype.loadDataFields=function(){var vm=this;this.availableDisplayFields=[];this.availableUniqueFields=[];this.availableGroupingFields=[];this.availableDisplayFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:null});this.availableUniqueFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:null});this.availableGroupingFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:null});this.availableDisplayFields.push({name:this._filterLocal('translate')('AnswerWithBrackets'),value:"[Answer]"});if(this._currentQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){Design.HierarchyHelper.getDataFields(this._wizard,this._listManager,this._currentQuestion,this.availableFieldWidth,false).then(function(dataFields){vm.availableDisplayFields.push.apply(vm.availableDisplayFields,dataFields);vm.availableUniqueFields.push.apply(vm.availableUniqueFields,dataFields);vm.availableGroupingFields.push.apply(vm.availableGroupingFields,dataFields);vm._hasLoadedFields=true})}else if(this._currentQuestion.IsQARepeater){this.availableDisplayFields.push.apply(this.availableDisplayFields,Design.QARepeatHelper.getDataFields(this._filterLocal,this._wizard,this._currentQuestion));this.availableUniqueFields.push.apply(this.availableUniqueFields,Design.QARepeatHelper.getDataFields(this._filterLocal,this._wizard,this._currentQuestion));this.availableGroupingFields.push.apply(this.availableGroupingFields,Design.QARepeatHelper.getDataFields(this._filterLocal,this._wizard,this._currentQuestion));this._hasLoadedFields=true}else if(this._currentQuestion.DataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&this._currentQuestion.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this._listManager.dataFieldsList(this._currentQuestion.DataObjectGuid,this.availableFieldWidth,false,'').then(function(dataFields){vm.availableDisplayFields.push.apply(vm.availableDisplayFields,dataFields);vm.availableUniqueFields.push.apply(vm.availableUniqueFields,dataFields);vm.availableGroupingFields.push.apply(vm.availableGroupingFields,dataFields);vm._hasLoadedFields=true})}else{this._hasLoadedFields=true}this.loadAnswerDataFields()};DatasourcePropertiesViewModel.prototype.loadSelectionTypes=function(){this.availableSelectionTypes=[];this.availableSelectionTypes.push({name:this._filterLocal('translate')('SingleRow'),value:Intelledox.Model.SelectionType.Single});this.availableSelectionTypes.push({name:this._filterLocal('translate')('MultipleRows'),value:Intelledox.Model.SelectionType.Multiple});if(this.getControlDisplayType()===Intelledox.Model.QuestionDisplayType.DataGrid){this.availableSelectionTypes.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:Intelledox.Model.SelectionType.None})}};DatasourcePropertiesViewModel.prototype.showProvidedData=function(){var vm=this;if(!this._currentQuestion.Visibility||this._currentQuestion.DataSourceGuid===Intelledox.Common.ConstantValues.GUID_EMPTY||this._currentQuestion.IsQARepeater){this.isAllowDataUploadVisible=false;this._currentQuestion.AllowUserUpload=false}else{var ctx={dataProviders:null};this._listManager.dataProviders().then(function(dataProviders){ctx.dataProviders=dataProviders;return vm._listManager.dataSources()}).then(function(dataServices){var selectedDatasource=null;for(var i=0;i<dataServices.length;i++){if(dataServices[i].dataServiceGuid===vm._currentQuestion.DataSourceGuid){selectedDatasource=dataServices[i];break}}if(selectedDatasource!=null){for(var i=0;i<ctx.dataProviders.length;i++){if(ctx.dataProviders[i].providerName===selectedDatasource.providerName){if(ctx.dataProviders[i].supportsProvidedData){vm.isAllowDataUploadVisible=true;return}break}}}vm.isAllowDataUploadVisible=false;vm._currentQuestion.AllowUserUpload=false})}};DatasourcePropertiesViewModel.prototype.getSelectedDataSourceItem=function(guidToFind){for(var i=0;i<this.availableDataSources.length;i++){if(this.availableDataSources[i].value===guidToFind){return this.availableDataSources[i]}}return null};DatasourcePropertiesViewModel.prototype.getSelectedDataObjectItem=function(guidToFind){for(var i=0;i<this.availableDataObjects.length;i++){if(this.availableDataObjects[i].value===guidToFind){return this.availableDataObjects[i]}}return null};DatasourcePropertiesViewModel.prototype.clearRepeatPlaceholders=function(){this._editor.flyoutPlaceholders.colourPlaceholders(this._currentQuestion.RepeatPlaceholders,false);this._currentQuestion.RepeatPlaceholders=[];this.repeatPlaceholderText=""};DatasourcePropertiesViewModel.prototype.getControlDisplayType=function(){if(!this.isDisplayTypeVisible){return Intelledox.Model.QuestionDisplayType.MultiChoice}else{return this.displayType}};DatasourcePropertiesViewModel.prototype.checkDisplayField=function(){var displayType=this.getControlDisplayType();var isVisible=this._currentQuestion.Visibility&&(displayType===Intelledox.Model.QuestionDisplayType.List||displayType===Intelledox.Model.QuestionDisplayType.MultiSelectDropdown||displayType===Intelledox.Model.QuestionDisplayType.AutoComplete||(displayType===Intelledox.Model.QuestionDisplayType.Popup&&this.selectionType===Intelledox.Model.SelectionType.Single));this.isDisplayFieldVisible=isVisible;this.checkAnswerDisplayField();if(this.dataObject==null||this.dataObject===Intelledox.Common.ConstantValues.GUID_EMPTY){this.isDisplayFieldEnabled=false}else{this.isDisplayFieldEnabled=true}};DatasourcePropertiesViewModel.prototype.checkAnswerDisplayField=function(){var isVisible=this._currentQuestion.DisplayField==="[Answer]";this.isAnswerDisplayFieldVisible=isVisible};DatasourcePropertiesViewModel.prototype.checkValueField=function(){if(this.dataObject==null||this.dataObject===Intelledox.Common.ConstantValues.GUID_EMPTY){this.isValueFieldEnabled=false}else{this.isValueFieldEnabled=true}};DatasourcePropertiesViewModel.prototype.checkGroupingField=function(){if(this.getControlDisplayType()!==Intelledox.Model.QuestionDisplayType.DataGrid||!this._currentQuestion.Visibility){this.isGroupingFieldVisible=false}else{this.isGroupingFieldVisible=true}};DatasourcePropertiesViewModel.prototype.checkWidth=function(){var isVisible=this._currentQuestion.Visibility&&this.selectionType===Intelledox.Model.SelectionType.Single&&this.displayType===Intelledox.Model.QuestionDisplayType.AutoComplete;this.isTextboxWidthVisible=isVisible};DatasourcePropertiesViewModel.prototype.checkResultsPerPage=function(){var isVisible=this._currentQuestion.Visibility&&this.displayType===Intelledox.Model.QuestionDisplayType.DataGrid;this.isResultsPerPageVisible=isVisible};DatasourcePropertiesViewModel.prototype.displayRepeatPlaceholderText=function(){this.repeatPlaceholderText="";if(this._currentQuestion.RepeatPlaceholders!=null){for(var i=0;i<this._currentQuestion.RepeatPlaceholders.length;i++){this.repeatPlaceholderText+=this._currentQuestion.RepeatPlaceholders[i].name;if(i+1!==this._currentQuestion.RepeatPlaceholders.length){this.repeatPlaceholderText+=", "}}}};DatasourcePropertiesViewModel.prototype.questionTextMatchesDS=function(){var dataSourceText=this.generateQuestionText();return(!System.String.IsNullOrEmpty(dataSourceText)&&System.String.StartsWith(this._currentQuestion.Text,System.String.Format(this._filterLocal('translate')('NewObjectFormat'),this._filterLocal('translate')('Question'),"")))||dataSourceText===this._currentQuestion.Text};DatasourcePropertiesViewModel.prototype.generateQuestionText=function(){var result="";var selectedDatasource=this.getSelectedDataSourceItem(this.dataSource);if(selectedDatasource!=null&&selectedDatasource.value!==Intelledox.Common.ConstantValues.GUID_EMPTY){result=selectedDatasource.name}if(!System.String.IsNullOrEmpty(result)){var selectedDataObject=this.getSelectedDataObjectItem(this.dataObject);if(selectedDataObject!=null&&selectedDataObject.value!==Intelledox.Common.ConstantValues.GUID_EMPTY){result=result+" - "+selectedDataObject.name}}return result};DatasourcePropertiesViewModel.prototype.hasDocument=function(){return(this._editor.wizard.Documents.length>0)};return DatasourcePropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.DatasourcePropertiesViewModel=DatasourcePropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var BarcodePropertiesViewModel=(function(_super){__extends(BarcodePropertiesViewModel,_super);function BarcodePropertiesViewModel(editorViewModel,question,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this.isDisplayTypeVisible=false;_this.isRowsColumnsVisible=false;_this._editor=editorViewModel;_this._barcode=question;_this._filterLocal=$filter;_this.loadLists();_this.checkDisplayType();_this.checkRowsColumns();return _this}Object.defineProperty(BarcodePropertiesViewModel.prototype,"barcodeType",{get:function(){return this._barcode.BarcodeType},set:function(value){this._barcode.BarcodeType=value;this._editor.wizChanged=true;this.checkDisplayType();this.checkRowsColumns()},enumerable:true,configurable:true});Object.defineProperty(BarcodePropertiesViewModel.prototype,"displayType",{get:function(){return this._barcode.BarcodeSubType},set:function(value){this._barcode.BarcodeSubType=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(BarcodePropertiesViewModel.prototype,"location",{get:function(){return this._barcode.BarcodeCodeLocation},set:function(value){this._barcode.BarcodeCodeLocation=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(BarcodePropertiesViewModel.prototype,"columns",{get:function(){if(this._barcode.Columns===0){return''}return this._barcode.Columns.toString()},set:function(value){this._barcode.Columns=parseInt(value,10);if(isNaN(this._barcode.Columns)){this._barcode.Columns=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(BarcodePropertiesViewModel.prototype,"rows",{get:function(){if(this._barcode.Rows===0){return''}return this._barcode.Rows.toString()},set:function(value){this._barcode.Rows=parseInt(value,10);if(isNaN(this._barcode.Rows)){this._barcode.Rows=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(BarcodePropertiesViewModel.prototype,"rotation",{get:function(){if(Design.HelperFunctions.isNegativeZero(this._barcode.Rotation)){return"-"}return this._barcode.Rotation.toString()},set:function(value){if(value==="-"){this._barcode.Rotation=-0}else{this._barcode.Rotation=parseInt(value,10);if(isNaN(this._barcode.Rotation)){this._barcode.Rotation=0}}this._editor.wizChanged=true},enumerable:true,configurable:true});BarcodePropertiesViewModel.prototype.loadLists=function(){this.availableBarcodeTypes=[];this.availableBarcodeTypes.push({name:'',value:Intelledox.QAWizard.Design.BarcodeType.None});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('AustraliaPost'),value:Intelledox.QAWizard.Design.BarcodeType.AustraliaPost});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Aztec'),value:Intelledox.QAWizard.Design.BarcodeType.Aztec});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Codabar'),value:Intelledox.QAWizard.Design.BarcodeType.Codabar});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Code11'),value:Intelledox.QAWizard.Design.BarcodeType.Code11});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Code128'),value:Intelledox.QAWizard.Design.BarcodeType.Code128});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Code39Extended'),value:Intelledox.QAWizard.Design.BarcodeType.Code39Extended});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Code39Standard'),value:Intelledox.QAWizard.Design.BarcodeType.Code39Standard});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Code93Extended'),value:Intelledox.QAWizard.Design.BarcodeType.Code93Extended});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Code93Standard'),value:Intelledox.QAWizard.Design.BarcodeType.Code93Standard});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('DataMatrix'),value:Intelledox.QAWizard.Design.BarcodeType.DataMatrix});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('DeutschePostIdentcode'),value:Intelledox.QAWizard.Design.BarcodeType.DeutschePostIdentcode});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('EAN8'),value:Intelledox.QAWizard.Design.BarcodeType.EAN8});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('EAN14'),value:Intelledox.QAWizard.Design.BarcodeType.EAN14});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('EAN13'),value:Intelledox.QAWizard.Design.BarcodeType.EAN13});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('IATA2of5'),value:Intelledox.QAWizard.Design.BarcodeType.IATA2of5});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Interleaved2of5'),value:Intelledox.QAWizard.Design.BarcodeType.Interleaved2of5});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('ItalianPost25'),value:Intelledox.QAWizard.Design.BarcodeType.ItalianPost25});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('ITF6'),value:Intelledox.QAWizard.Design.BarcodeType.ITF6});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('ITF14'),value:Intelledox.QAWizard.Design.BarcodeType.ITF14});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Leitcode'),value:Intelledox.QAWizard.Design.BarcodeType.DeutschePostLeitcode});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('MacroPDF417'),value:Intelledox.QAWizard.Design.BarcodeType.MacroPdf417});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Matrix2of5'),value:Intelledox.QAWizard.Design.BarcodeType.Matrix2of5});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('MSI'),value:Intelledox.QAWizard.Design.BarcodeType.MSI});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('OneCode'),value:Intelledox.QAWizard.Design.BarcodeType.OneCode});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('OPC'),value:Intelledox.QAWizard.Design.BarcodeType.OPC});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('PDF417'),value:Intelledox.QAWizard.Design.BarcodeType.Pdf417});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Planet'),value:Intelledox.QAWizard.Design.BarcodeType.Planet});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('POSTNET'),value:Intelledox.QAWizard.Design.BarcodeType.Postnet});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('PZN'),value:Intelledox.QAWizard.Design.BarcodeType.PZN});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('QR'),value:Intelledox.QAWizard.Design.BarcodeType.QR});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('RM4SCC'),value:Intelledox.QAWizard.Design.BarcodeType.RM4SCC});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('SSCC18'),value:Intelledox.QAWizard.Design.BarcodeType.SSCC18});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('Standard2of5'),value:Intelledox.QAWizard.Design.BarcodeType.Standard2of5});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('UPCA'),value:Intelledox.QAWizard.Design.BarcodeType.UPCA});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('UPCE'),value:Intelledox.QAWizard.Design.BarcodeType.UPCE});this.availableBarcodeTypes.push({name:this._filterLocal('translate')('VIN'),value:Intelledox.QAWizard.Design.BarcodeType.VIN});this.availableDisplayTypes=[];this.availableDisplayTypes.push({name:'',value:Intelledox.QAWizard.Design.AustraliaPostBarcodeType.None});this.availableDisplayTypes.push({name:this._filterLocal('translate')('CustomerBarCode2'),value:Intelledox.QAWizard.Design.AustraliaPostBarcodeType.Customer2});this.availableDisplayTypes.push({name:this._filterLocal('translate')('CustomerBarCode3'),value:Intelledox.QAWizard.Design.AustraliaPostBarcodeType.Customer3});this.availableDisplayTypes.push({name:this._filterLocal('translate')('Redirection'),value:Intelledox.QAWizard.Design.AustraliaPostBarcodeType.Redirection});this.availableDisplayTypes.push({name:this._filterLocal('translate')('ReplyPaid'),value:Intelledox.QAWizard.Design.AustraliaPostBarcodeType.ReplyPaid});this.availableDisplayTypes.push({name:this._filterLocal('translate')('Routing'),value:Intelledox.QAWizard.Design.AustraliaPostBarcodeType.Routing});this.availableDisplayTypes.push({name:this._filterLocal('translate')('Standard'),value:Intelledox.QAWizard.Design.AustraliaPostBarcodeType.Standard});this.availableLocations=[];this.availableLocations.push({name:this._filterLocal('translate')('Above'),value:Intelledox.QAWizard.Design.BarcodeCodeLocation.Above});this.availableLocations.push({name:this._filterLocal('translate')('Below'),value:Intelledox.QAWizard.Design.BarcodeCodeLocation.Below});this.availableLocations.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:Intelledox.QAWizard.Design.BarcodeCodeLocation.None})};BarcodePropertiesViewModel.prototype.checkDisplayType=function(){this.isDisplayTypeVisible=(this._barcode.BarcodeType===Intelledox.QAWizard.Design.BarcodeType.AustraliaPost)};BarcodePropertiesViewModel.prototype.checkRowsColumns=function(){this.isRowsColumnsVisible=(this._barcode.BarcodeType===Intelledox.QAWizard.Design.BarcodeType.Pdf417)};return BarcodePropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.BarcodePropertiesViewModel=BarcodePropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ValidatorPropertiesViewModel=(function(_super){__extends(ValidatorPropertiesViewModel,_super);function ValidatorPropertiesViewModel(editorViewModel,question,currentPage,wizard,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._isInitializing=false;_this._selectedValidationType=Intelledox.Model.ValidationRuleType.Compare;_this._selectedComparison=Intelledox.Model.ComparisonType.None;_this._expression='';_this._selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this._selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;_this.isAddEnabled=false;_this.isUpdateEnabled=false;_this.isRemoveEnabled=false;_this.isComparisonTypeEnabled=true;_this.isExpressionEnabled=true;_this.isAnswerVisible=true;_this.availableComparisons=[];_this.availableQuestions=[];_this.availableAnswers=[];var vm=_this;_this._editor=editorViewModel;_this._localFilter=$filter;_this._isInitializing=true;_this.clauseDesignerModel=new Design.ClauseDesignerViewModel($filter,editorViewModel);_this.clauseDesignerModel.replaceClause=function(copyClause){if(copyClause!=null){if(copyClause instanceof Intelledox.QAWizard.Design.ValidationRule){vm._validator.ValidationRule=copyClause}else if(copyClause instanceof Intelledox.QAWizard.Design.Condition){alert(vm._localFilter('translate')('ErrorMsg_CannotCopyConditionToValidatorAndDataFilter'));return}else if(copyClause instanceof Intelledox.QAWizard.Design.Filter){alert(vm._localFilter('translate')('ErrorMsg_CannotCopyDataFilterRuleToOtherTabs'));return}else if(copyClause instanceof Intelledox.QAWizard.Design.Rule){alert(vm._localFilter('translate')('ErrorMsg_CannotCopyRuleToValidatorAndDataFilter'));return}}vm.clauseDesignerModel.setParentClause(vm._validator.ValidationRule);vm.clauseDesignerModel.fillClauseViewFromExisting();vm.initValidationRules();editorViewModel.wizChanged=true};_this.clauseDesignerModel.clauseSelected=function(){if(vm.clauseDesignerModel.clausesTreeView.selectedNode.tag instanceof Intelledox.QAWizard.Design.ValidationRule){var validationRule=vm.clauseDesignerModel.clausesTreeView.selectedNode.tag;if(validationRule.Type===Intelledox.Model.ClauseType.Comparison){vm.loadValidationRule(validationRule)}}vm.checkValidationAddUpdateRemove()};_this.clauseDesignerModel.clauseDrop=function(dropNode,targetNode){vm.clauseDrop(dropNode,targetNode)};_this._validator=question;_this._currentPage=currentPage;_this._wizard=wizard;_this.loadQuestions();_this.loadAnswers();_this.enableDisableQuestionReferenceAnswer();_this.clauseDesignerModel.clausesTreeView.selectedNode=null;_this.initValidationRules();_this.populateValidationComparisonTypes();_this.clauseDesignerModel.init(_this._validator.ValidationRule,wizard,lists,_this._validator);_this._isInitializing=false;return _this}Object.defineProperty(ValidatorPropertiesViewModel.prototype,"selectedValidationType",{get:function(){return this._selectedValidationType},set:function(value){this._selectedValidationType=value;if(!this._isInitializing){this.populateValidationComparisonTypes();this.checkValidationAddUpdateRemove()}},enumerable:true,configurable:true});Object.defineProperty(ValidatorPropertiesViewModel.prototype,"selectedComparison",{get:function(){return this._selectedComparison},set:function(value){this._selectedComparison=value;if(!this._isInitializing){this.checkValidationAddUpdateRemove()}},enumerable:true,configurable:true});Object.defineProperty(ValidatorPropertiesViewModel.prototype,"expression",{get:function(){return this._expression},set:function(value){this._expression=value;if(!this._isInitializing){this.checkValidationAddUpdateRemove()}},enumerable:true,configurable:true});Object.defineProperty(ValidatorPropertiesViewModel.prototype,"selectedQuestionGuid",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;this.loadAnswers();this.enableDisableQuestionReferenceAnswer();this.checkValidationAddUpdateRemove()},enumerable:true,configurable:true});Object.defineProperty(ValidatorPropertiesViewModel.prototype,"selectedAnswerGuid",{get:function(){return this._selectedAnswerGuid},set:function(value){this._selectedAnswerGuid=value;this.checkValidationAddUpdateRemove()},enumerable:true,configurable:true});ValidatorPropertiesViewModel.prototype.add=function(){if(!this._isInitializing){if(this.validateValidationRule()){var newRule=new Intelledox.QAWizard.Design.ValidationRule;newRule.RuleType=this.selectedValidationType;newRule.ComparisonType=this.selectedComparison;newRule.Expression=Design.TranslationHelper.TranslationToKeywordValue(this._localFilter,this.expression);newRule.Type=Intelledox.Model.ClauseType.Comparison;newRule.QuestionGuid=this.selectedQuestionGuid;newRule.AnswerGuid=this.selectedAnswerGuid;this._editor.wizChanged=true;this._validator.ValidationRule.Add(newRule);this.clauseDesignerModel.setParentClause(this._validator.ValidationRule);this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(newRule)}}};ValidatorPropertiesViewModel.prototype.update=function(){var editRule;if(!this._isInitializing){if(this.validateValidationRule()){editRule=this.clauseDesignerModel.clausesTreeView.selectedNode.tag;editRule.RuleType=this.selectedValidationType;editRule.ComparisonType=this.selectedComparison;editRule.Expression=Design.TranslationHelper.TranslationToKeywordValue(this._localFilter,this.expression);editRule.QuestionGuid=this.selectedQuestionGuid;editRule.AnswerGuid=this.selectedAnswerGuid;this._editor.wizChanged=true;this.initValidationRules();this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(editRule)}}};ValidatorPropertiesViewModel.prototype.remove=function(){if(!this._isInitializing){var node=this.clauseDesignerModel.clausesTreeView.selectedNode;if(node.parent==null){this._validator.ValidationRule=new Intelledox.QAWizard.Design.ValidationRule;this.clauseDesignerModel.setParentClause(this._validator.ValidationRule)}else{var r=this.clauseDesignerModel.clausesTreeView.selectedNode.tag;node.parent.tag.SubClauses.splice(node.parent.tag.SubClauses.indexOf(r),1)}this._editor.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting();this.checkValidationAddUpdateRemove()}};ValidatorPropertiesViewModel.prototype.pickRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editor.treeView.pickEvent=function(node){_this.expression=Design.HelperFunctions.onPickRef(_this._localFilter,_this.expression,node,insertPoint)};this._editor.treeView.togglePickMode()};ValidatorPropertiesViewModel.prototype.initValidationRules=function(){var autochange=this._isInitializing;this._isInitializing=true;this.populateValidationRuleTypes();this.selectedValidationType=this.availableValidationTypes[0].value;this.populateValidationComparisonTypes();this.selectedComparison=this.availableComparisons[0].value;this.expression="";this.checkValidationAddUpdateRemove();if(this.availableQuestions.length>0){this.selectedQuestionGuid=this.availableQuestions[0].QuestionGuid}this._isInitializing=autochange};ValidatorPropertiesViewModel.prototype.populateValidationRuleTypes=function(){this.availableValidationTypes=[];this.availableValidationTypes.push({name:this._localFilter('translate')('Compare'),value:Intelledox.Model.ValidationRuleType.Compare});this.availableValidationTypes.push({name:this._localFilter('translate')('FieldLength'),value:Intelledox.Model.ValidationRuleType.FieldLength});this.availableValidationTypes.push({name:this._localFilter('translate')('RegularExpression'),value:Intelledox.Model.ValidationRuleType.RegularExpression})};ValidatorPropertiesViewModel.prototype.populateValidationComparisonTypes=function(){var ruleType=this.selectedValidationType;this.availableComparisons=[];this.isComparisonTypeEnabled=true;this.isExpressionEnabled=true;switch(ruleType){case Intelledox.Model.ValidationRuleType.Compare:this.availableComparisons.push({name:this._localFilter('translate')('GreaterThan'),value:Intelledox.Model.ComparisonType.GreaterThan});this.availableComparisons.push({name:this._localFilter('translate')('GreaterThanorEquals'),value:Intelledox.Model.ComparisonType.GreaterThanOrEquals});this.availableComparisons.push({name:this._localFilter('translate')('LessThan'),value:Intelledox.Model.ComparisonType.LessThan});this.availableComparisons.push({name:this._localFilter('translate')('LessThanorEquals'),value:Intelledox.Model.ComparisonType.LessThanOrEquals});this.availableComparisons.push({name:this._localFilter('translate')('EqualsString'),value:Intelledox.Model.ComparisonType.Equals});this.availableComparisons.push({name:this._localFilter('translate')('NotEqualTo'),value:Intelledox.Model.ComparisonType.NotEqualTo});this.availableComparisons.push({name:this._localFilter('translate')('BeginsWith'),value:Intelledox.Model.ComparisonType.BeginsWith});this.availableComparisons.push({name:this._localFilter('translate')('EndsWith'),value:Intelledox.Model.ComparisonType.EndsWith});this.availableComparisons.push({name:this._localFilter('translate')('Contains'),value:Intelledox.Model.ComparisonType.Contains});this.availableComparisons.push({name:this._localFilter('translate')('DoesntContain'),value:Intelledox.Model.ComparisonType.NotContain});break;case Intelledox.Model.ValidationRuleType.FieldLength:this.availableComparisons.push({name:this._localFilter('translate')('Minimum'),value:Intelledox.Model.ComparisonType.GreaterThanOrEquals});this.availableComparisons.push({name:this._localFilter('translate')('Maximum'),value:Intelledox.Model.ComparisonType.LessThanOrEquals});break;case Intelledox.Model.ValidationRuleType.RegularExpression:this.availableComparisons.push({name:this._localFilter('translate')('Match'),value:Intelledox.Model.ComparisonType.None});break;case Intelledox.Model.ValidationRuleType.Mandatory:this.availableComparisons.push({name:this._localFilter('translate')('NoneWithBrackets'),value:Intelledox.Model.ComparisonType.None});this.isComparisonTypeEnabled=false;this.expression="";this.isExpressionEnabled=false;break}this.selectedComparison=this.availableComparisons[0].value};ValidatorPropertiesViewModel.prototype.loadValidationRule=function(rule){this.isComparisonTypeEnabled=true;this.isExpressionEnabled=true;var autoChange=false;if(rule==null){return}autoChange=this._isInitializing;this._isInitializing=true;this.selectedValidationType=rule.RuleType;this.populateValidationComparisonTypes();this.selectedComparison=rule.ComparisonType;if(rule.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.selectedQuestionGuid=rule.QuestionGuid;this.selectedAnswerGuid=rule.AnswerGuid}this.expression=Design.TranslationHelper.KeywordValueToTranslation(this._localFilter,rule.Expression);this._isInitializing=autoChange};ValidatorPropertiesViewModel.prototype.checkValidationAddUpdateRemove=function(){this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;if(this.clauseDesignerModel.clausesTreeView.selectedNode!=null){if(this.clauseDesignerModel.clausesTreeView.selectedNode.tag instanceof Intelledox.QAWizard.Design.ValidationRule){this.isRemoveEnabled=true}}if(!this.isAnswerVisible||this.selectedAnswerGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.isAddEnabled=true}if(this.clauseDesignerModel.clausesTreeView.selectedNode!=null){if(this.clauseDesignerModel.clausesTreeView.selectedNode.tag instanceof Intelledox.QAWizard.Design.ValidationRule&&this.clauseDesignerModel.clausesTreeView.selectedNode.tag.Type===Intelledox.Model.ClauseType.Comparison){this.isUpdateEnabled=true}}};ValidatorPropertiesViewModel.prototype.validateValidationRule=function(){var msg="";switch(this.selectedValidationType){case Intelledox.Model.ValidationRuleType.FieldLength:if(isNaN(this.expression)){msg=this._localFilter('translate')('ErrorMsg_Validation_FieldLenNumeric')}break;case Intelledox.Model.ValidationRuleType.RegularExpression:if(this.expression!==this.expression.trim()){alert(this._localFilter('translate')('ErrorMsg_WhiteSpaceInRegularExpression'))}break}if(msg!==""){alert(msg);return false}else{return true}};ValidatorPropertiesViewModel.prototype.loadQuestions=function(){this.availableQuestions=[];this.availableAnswers=[];for(var i=0;i<this._wizard.Pages.length;i++){var pageItem=this._wizard.Pages[i];if((!pageItem.IsRepeated)||pageItem===this._currentPage){this.addLayoutQuestionsToDropdown(pageItem.Children,this._validator.QuestionGuid)}}};ValidatorPropertiesViewModel.prototype.addLayoutQuestionsToDropdown=function(layout,validatorQuestionGuid){for(var i=0;i<layout.length;i++){var n=layout[i];if(n instanceof Intelledox.QAWizard.Design.Question){var q=n;if((q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic&&(q.DisplayType===Intelledox.Model.QuestionDisplayType.MultiChoice||q.DisplayType===Intelledox.Model.QuestionDisplayType.MultiChoiceToggleButton||q.DisplayType===Intelledox.Model.QuestionDisplayType.Dropdown))||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&(q.SelectionType===Intelledox.Model.SelectionType.Single))||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom){this.availableQuestions.push(q)}}else if(typeof n.HasContainerInterface!=="undefined"){if(!(n instanceof Intelledox.QAWizard.Design.Section&&n.IsRepeated)){this.addLayoutQuestionsToDropdown(n.Children,validatorQuestionGuid)}else if(this.containsLayoutNode(n.Children,validatorQuestionGuid)){this.addLayoutQuestionsToDropdown(n.Children,validatorQuestionGuid)}}}};ValidatorPropertiesViewModel.prototype.containsLayoutNode=function(layout,nodeGuid){for(var i=0;i<layout.length;i++){var l=layout[i];if(l!=null){if(l.ObjectId===nodeGuid){return true}if(typeof l.HasContainerInterface!=="undefined"){if(this.containsLayoutNode(l.Children,nodeGuid)){return true}}}}return false};ValidatorPropertiesViewModel.prototype.loadAnswers=function(){this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.availableAnswers=[];var question=this.findSelectedQuestion(this.selectedQuestionGuid);if(question!=null){for(var i=0;i<question.Answers.length;i++){this.availableAnswers.push(question.Answers[i])}}};ValidatorPropertiesViewModel.prototype.findSelectedQuestion=function(questionGuid){for(var i=0;i<this.availableQuestions.length;i++){if(questionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};ValidatorPropertiesViewModel.prototype.isAnswerRequired=function(questionType){if(questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||questionType===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label){return false}else{return true}};ValidatorPropertiesViewModel.prototype.enableDisableQuestionReferenceAnswer=function(){var q=this.findSelectedQuestion(this.selectedQuestionGuid);if(q!=null&&q.QuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(this.isAnswerRequired(q.QuestionTypeID)){this.isAnswerVisible=true}else{this.isAnswerVisible=false}}else{this.isAnswerVisible=false}};ValidatorPropertiesViewModel.prototype.clauseDrop=function(dragNode,targetNode){if(dragNode.treeView===this.clauseDesignerModel.clausesTreeView){if(dragNode===targetNode||dragNode.isDecendantOf(targetNode)){alert(this._localFilter('translate')('ErrorMsg_MoveRuleToBeItsOwnChild'))}else{var hitRule=targetNode.tag;dragNode.parent.tag.SubClauses.splice(dragNode.parent.tag.SubClauses.indexOf(dragNode.tag),1);if(hitRule.Type===Intelledox.Model.ClauseType.Comparison){hitRule=targetNode.parent.tag}hitRule.Add(dragNode.tag);this._editor.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(hitRule)}}else{var newRule=null;if(dragNode.tag instanceof Intelledox.QAWizard.Design.Question){if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){alert(this._localFilter('translate')('ErrorMsg_InvalidParentDatasource'));return}else if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt){alert(this._localFilter('translate')('ErrorMsg_InvalidParentAddress'));return}else if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable){alert(this._localFilter('translate')('ErrorMsg_InvalidParentVariable'));return}else if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic){newRule=new Intelledox.QAWizard.Design.ValidationRule(Intelledox.Model.ClauseType.Comparison);newRule.ComparisonType=Intelledox.Model.ComparisonType.Equals;newRule.QuestionGuid=dragNode.tag.QuestionGuid}else if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom){alert(this._localFilter('translate')('ErrorMsg_InvalidParentQuestion'));return}}else if(dragNode.tag instanceof Intelledox.QAWizard.Design.Answer){if(dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt||dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom){newRule=new Intelledox.QAWizard.Design.ValidationRule(Intelledox.Model.ClauseType.Comparison);newRule.ComparisonType=Intelledox.Model.ComparisonType.Equals;newRule.QuestionGuid=dragNode.parent.tag.QuestionGuid;newRule.AnswerGuid=dragNode.tag.AnswerGuid}else if(dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label){newRule=new Intelledox.QAWizard.Design.ValidationRule(Intelledox.Model.ClauseType.Comparison);newRule.ComparisonType=Intelledox.Model.ComparisonType.Equals;newRule.QuestionGuid=dragNode.parent.tag.QuestionGuid}}if(newRule!=null){if(targetNode==null){newRule=this._validator.ValidationRule.Add(newRule)}else if(targetNode.tag instanceof Intelledox.QAWizard.Design.ValidationRule){var hitRule=targetNode.tag;hitRule.Add(newRule)}}else{alert(this._localFilter('translate')('ErrorMsg_InvalidParent'))}this._editor.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(newRule)}};return ValidatorPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.ValidatorPropertiesViewModel=ValidatorPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ValidationPanelViewModel=(function(){function ValidationPanelViewModel($filter,editorViewModel){this._isInitializing=false;this._currentObject=null;this._selectedValidationType=Intelledox.Model.ValidationRuleType.Compare;this._selectedComparison=Intelledox.Model.ComparisonType.None;this._expression='';this._message='';this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.isComparisonTypeEnabled=true;this.isExpressionEnabled=true;this.existingValidations=[];this.availableValidationTypes=[];this.availableComparisons=[];this._editorViewModel=editorViewModel;this._filter=$filter}Object.defineProperty(ValidationPanelViewModel.prototype,"selectedValidationType",{get:function(){return this._selectedValidationType},set:function(value){this._selectedValidationType=value;if(!this._isInitializing){this.populateValidationComparisonTypes();this.checkValidationAddUpdateRemove()}},enumerable:true,configurable:true});Object.defineProperty(ValidationPanelViewModel.prototype,"selectedComparison",{get:function(){return this._selectedComparison},set:function(value){this._selectedComparison=value;if(!this._isInitializing){this.checkValidationAddUpdateRemove()}},enumerable:true,configurable:true});Object.defineProperty(ValidationPanelViewModel.prototype,"expression",{get:function(){return this._expression},set:function(value){this._expression=value;if(!this._isInitializing){this.checkValidationAddUpdateRemove()}},enumerable:true,configurable:true});Object.defineProperty(ValidationPanelViewModel.prototype,"message",{get:function(){return this._message},set:function(value){this._message=value;this.checkValidationAddUpdateRemove()},enumerable:true,configurable:true});ValidationPanelViewModel.prototype.add=function(){var newRule=new Intelledox.QAWizard.Design.ValidationRule;if(!this._isInitializing){if(this.validateValidationRule()){newRule=new Intelledox.QAWizard.Design.ValidationRule;newRule.Id=Intelledox.QAWizard.Design.GeneralFunctions.NewGuid();newRule.RuleType=this.selectedValidationType;newRule.ComparisonType=this.selectedComparison;newRule.Expression=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.expression);newRule.Message=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.message);this.currentValidationRules().push(newRule);this._editorViewModel.wizChanged=true;this.initValidationRules();this.selectExistingValidation(newRule)}}};ValidationPanelViewModel.prototype.update=function(){var editRule=null;if(!this._isInitializing){try{if(this.validateValidationRule()){editRule=this.getSelectedExistingValidation();editRule.RuleType=this.selectedValidationType;editRule.ComparisonType=this.selectedComparison;editRule.Expression=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.expression);editRule.Message=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.message);this._editorViewModel.wizChanged=true;this.initValidationRules();this.selectExistingValidation(editRule)}}catch(ex){alert(this._filter('translate')('ErrorMsg_ErrorUpdatingValidationRule'))}}};ValidationPanelViewModel.prototype.remove=function(){if(!this._isInitializing){this.currentValidationRules().splice(this.currentValidationRules().indexOf(this.getSelectedExistingValidation()),1);this._editorViewModel.wizChanged=true;this.initValidationRules()}};ValidationPanelViewModel.prototype.init=function(currentObject){var isAutoChange=this._isInitializing;this._currentObject=currentObject;this._isInitializing=true;this.initValidationRules();this.populateValidationComparisonTypes();this._isInitializing=isAutoChange};ValidationPanelViewModel.prototype.pickRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.expression=Design.HelperFunctions.onPickRef(_this._filter,_this.expression,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};ValidationPanelViewModel.prototype.initValidationRules=function(){var autochange=this._isInitializing;this._isInitializing=true;this.populateValidationRuleTypes();this.selectedValidationType=this.availableValidationTypes[0].value;this.populateValidationComparisonTypes();this.selectedComparison=this.availableComparisons[0].value;this.expression='';this.message='';this.existingValidations=[];for(var i=0;i<this.currentValidationRules().length;i++){var r=this.currentValidationRules()[i];this.existingValidations.push({tag:r,name:this.getValidationRuleTypeName(r.RuleType),comparison:Design.HelperFunctions.comparisonTypeIdToText(this._filter,r.ComparisonType,r.RuleType),expression:Design.TranslationHelper.KeywordValueToTranslation(this._filter,r.Expression),selected:false})}this.checkValidationAddUpdateRemove();this._isInitializing=autochange};ValidationPanelViewModel.prototype.populateValidationRuleTypes=function(){this.availableValidationTypes=[];this.availableValidationTypes.push({name:this._filter('translate')('Compare'),value:Intelledox.Model.ValidationRuleType.Compare});this.availableValidationTypes.push({name:this._filter('translate')('FieldLength'),value:Intelledox.Model.ValidationRuleType.FieldLength});this.availableValidationTypes.push({name:this._filter('translate')('RegularExpression'),value:Intelledox.Model.ValidationRuleType.RegularExpression});if(this._currentObject instanceof Intelledox.QAWizard.Design.Answer){if(this._currentObject.Question.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.availableValidationTypes.push({name:this._filter('translate')('Mandatory'),value:Intelledox.Model.ValidationRuleType.Mandatory})}}};ValidationPanelViewModel.prototype.populateValidationComparisonTypes=function(){this.availableComparisons=[];this.isComparisonTypeEnabled=true;this.isExpressionEnabled=true;switch(this.selectedValidationType){case Intelledox.Model.ValidationRuleType.Compare:this.availableComparisons.push({name:this._filter('translate')('GreaterThan'),value:Intelledox.Model.ComparisonType.GreaterThan});this.availableComparisons.push({name:this._filter('translate')('GreaterThanorEquals'),value:Intelledox.Model.ComparisonType.GreaterThanOrEquals});this.availableComparisons.push({name:this._filter('translate')('LessThan'),value:Intelledox.Model.ComparisonType.LessThan});this.availableComparisons.push({name:this._filter('translate')('LessThanorEquals'),value:Intelledox.Model.ComparisonType.LessThanOrEquals});this.availableComparisons.push({name:this._filter('translate')('EqualsString'),value:Intelledox.Model.ComparisonType.Equals});this.availableComparisons.push({name:this._filter('translate')('NotEqualTo'),value:Intelledox.Model.ComparisonType.NotEqualTo});this.availableComparisons.push({name:this._filter('translate')('BeginsWith'),value:Intelledox.Model.ComparisonType.BeginsWith});this.availableComparisons.push({name:this._filter('translate')('EndsWith'),value:Intelledox.Model.ComparisonType.EndsWith});this.availableComparisons.push({name:this._filter('translate')('Contains'),value:Intelledox.Model.ComparisonType.Contains});this.availableComparisons.push({name:this._filter('translate')('DoesntContain'),value:Intelledox.Model.ComparisonType.NotContain});break;case Intelledox.Model.ValidationRuleType.FieldLength:this.availableComparisons.push({name:this._filter('translate')('Minimum'),value:Intelledox.Model.ComparisonType.GreaterThanOrEquals});this.availableComparisons.push({name:this._filter('translate')('Maximum'),value:Intelledox.Model.ComparisonType.LessThanOrEquals});break;case Intelledox.Model.ValidationRuleType.RegularExpression:this.availableComparisons.push({name:this._filter('translate')('Match'),value:Intelledox.Model.ComparisonType.None});break;case Intelledox.Model.ValidationRuleType.Mandatory:this.availableComparisons.push({name:this._filter('translate')('NoneWithBrackets'),value:Intelledox.Model.ComparisonType.None});this.isComparisonTypeEnabled=false;this.expression="";this.isExpressionEnabled=false;break}this.selectedComparison=this.availableComparisons[0].value};ValidationPanelViewModel.prototype.populateCurrentValidationRule=function(){var autoChange=false;try{autoChange=this._isInitializing;this._isInitializing=true;var selectedItem=this.getSelectedExistingValidation();if(selectedItem==null){return}this.selectedValidationType=selectedItem.RuleType;this.populateValidationComparisonTypes();this.selectedComparison=selectedItem.ComparisonType;this.expression=Design.TranslationHelper.KeywordValueToTranslation(this._filter,selectedItem.Expression);this.message=Design.TranslationHelper.KeywordValueToTranslation(this._filter,selectedItem.Message)}catch(ex){alert(this._filter('translate')('ErrorMsg_ErrorReadingValidationRule'))}finally{this._isInitializing=autoChange}};ValidationPanelViewModel.prototype.checkValidationAddUpdateRemove=function(){this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;var continueCheck=false;if(this.expression!==""){continueCheck=true;if(this.selectedValidationType===Intelledox.Model.ValidationRuleType.RegularExpression){if(this.message.trim()===""){continueCheck=false}}}if(this.selectedValidationType===Intelledox.Model.ValidationRuleType.Mandatory){continueCheck=true}if(continueCheck){this.isAddEnabled=true;if(this.getSelectedExistingValidation()!=null){this.isUpdateEnabled=true}}if(this.getSelectedExistingValidation()!=null){this.isRemoveEnabled=true}};ValidationPanelViewModel.prototype.validateValidationRule=function(){var msg="";try{switch(this.selectedValidationType){case Intelledox.Model.ValidationRuleType.FieldLength:if(isNaN(this.expression)){msg=this._filter('translate')('ErrorMsg_Validation_FieldLenNumeric')}break;case Intelledox.Model.ValidationRuleType.RegularExpression:if(this.expression!==this.expression.trim()){alert(this._filter('translate')('ErrorMsg_WhiteSpaceInRegularExpression'))}break}}catch(ex){msg=this._filter('translate')('ErrorMsg_Validation_RuleCantEvaluate')}if(msg!==""){alert(msg);return false}else{return true}};ValidationPanelViewModel.prototype.getValidationRuleTypeName=function(ruleType){switch(ruleType){case Intelledox.Model.ValidationRuleType.Compare:return this._filter('translate')('Compare');case Intelledox.Model.ValidationRuleType.FieldLength:return this._filter('translate')('FieldLength');case Intelledox.Model.ValidationRuleType.RegularExpression:return this._filter('translate')('RegularExpression');case Intelledox.Model.ValidationRuleType.Mandatory:return this._filter('translate')('Mandatory');default:return this._filter('translate')('NoneWithBrackets')}};ValidationPanelViewModel.prototype.currentValidationRules=function(){if(this._currentObject instanceof Intelledox.QAWizard.Design.Question){return this._currentObject.Validations}else if(this._currentObject instanceof Intelledox.QAWizard.Design.Answer){return this._currentObject.Validations}return null};ValidationPanelViewModel.prototype.selectExistingValidation=function(rule){for(var i=0;i<this.existingValidations.length;i++){if(this.existingValidations[i].tag===rule){this.existingValidations[i].selected=true;this.populateCurrentValidationRule();this.checkValidationAddUpdateRemove()}else{this.existingValidations[i].selected=false}}};ValidationPanelViewModel.prototype.getSelectedExistingValidation=function(){for(var i=0;i<this.existingValidations.length;i++){if(this.existingValidations[i].selected){return this.existingValidations[i].tag}}return null};return ValidationPanelViewModel}());Design.ValidationPanelViewModel=ValidationPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ConditionPanelViewModel=(function(){function ConditionPanelViewModel($filter,editorViewModel){this._wizard=null;this._listManager=null;this._currentConditions=null;this._currentPage=null;this._currentNode=null;this._conditionTypeChange=false;this._actionTransition=null;this._instructions="";this._isInitializing=false;this._selectedConditionType=Intelledox.QAWizard.Design.ConditionType.Active;this._selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.Reference;this._selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedAction=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedActionOutput=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedComparisonType=Intelledox.QAWizard.Design.ClauseComparisonType.None;this._selectedInput=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedFragment=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedFragmentOutput=Intelledox.Common.ConstantValues.GUID_EMPTY;this._selectedProjectProperty=Intelledox.Common.ConstantValues.GUID_EMPTY;this.isAddEnabled=false;this.isUpdateEnabled=false;this.isRemoveEnabled=false;this.isComparisonTypeEnabled=true;this.isActionVisible=true;this.isActionOutputEnabled=false;this.isInputVisible=true;this.isStateVisible=false;this.isQuestionVisible=true;this.isAnswerVisible=true;this.isAnswerEnabled=false;this.isFragmentVisible=true;this.isProjectPropertyVisible=true;this.isCompareToListVisible=false;this.isCompareToTextVisible=false;this.isCompareToListEnabled=true;this.isCompareToTextEnabled=true;this.availableConditionTypes=[];this.availableParentTypes=[];this.availableStates=[];this.availableInputs=[];this.availableFragments=[];this.availableFragmentOutputs=[];this.availableQuestions=[];this.availableAnswers=[];this.availableActions=[];this.availableActionOutputs=[];this.availableComparisonTypes=[];this.availableCompareTos=[];this.selectedStateGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.compareTo="";var vm=this;this._editorViewModel=editorViewModel;this._filter=$filter;this.clauseDesignerModel=new Design.ClauseDesignerViewModel($filter,editorViewModel);this.clauseDesignerModel.replaceClause=function(node){vm.clauseViewReplaceClause(node)};this.clauseDesignerModel.clauseSelected=function(){if(vm.clauseDesignerModel.clausesTreeView.selectedNode.tag.Type===Intelledox.Model.ClauseType.Comparison){vm.loadCondition(vm.clauseDesignerModel.clausesTreeView.selectedNode.tag)}vm.updateCompareButtons()};this.clauseDesignerModel.clauseDrop=function(dropNode,targetNode){vm.clauseDrop(dropNode,targetNode)}}Object.defineProperty(ConditionPanelViewModel.prototype,"availableProjectProperties",{get:function(){return this._wizard.Properties},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"hasAnyConditions",{get:function(){if(this.availableConditionTypes==null){return false}for(var i=0;i<this.availableConditionTypes.length;i++){if(this.availableConditionTypes[i].hasType){return true}}return false},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedConditionTypeText",{get:function(){return this._selectedConditionType.toString()},set:function(value){this.selectedConditionType=parseInt(value,10)},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedConditionType",{get:function(){return this._selectedConditionType},set:function(value){this._selectedConditionType=value;if(this._isInitializing){return}this._conditionTypeChange=true;this.init(this._wizard,this._currentPage,this._currentNode,this._listManager);this._conditionTypeChange=false},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedParentType",{get:function(){return this._selectedParentType},set:function(value){this._selectedParentType=value;var isAutoChange=this._isInitializing;this._isInitializing=true;this.isQuestionVisible=false;this.isAnswerVisible=false;this.isCompareToTextVisible=false;this.isStateVisible=false;this.isActionVisible=false;this.isInputVisible=false;this.isFragmentVisible=false;this.isProjectPropertyVisible=false;if(this.isReference()){this.isQuestionVisible=true;this.isAnswerVisible=true;this.compareTo="";this.enableComparisonTypeDropDownWithParent()}else if(this.isState()){this.selectedQuestionGuid=this.availableQuestions[0].QuestionGuid;this.selectedAnswerGuid=this.availableAnswers[0].AnswerGuid;this.isStateVisible=true;this.enableComparisonTypeDropDown()}else if(this.isInput()){this.selectedQuestionGuid=this.availableQuestions[0].QuestionGuid;this.selectedAnswerGuid=this.availableAnswers[0].AnswerGuid;this.isInputVisible=true;this.enableComparisonTypeDropDown()}else if(this.isFragmentOutput()){this.isFragmentVisible=true;this.enableComparisonTypeDropDown()}else if(this.isProjectProperty()){this.isProjectPropertyVisible=true;this.enableComparisonTypeDropDown()}else{this.isActionVisible=true;this.compareTo="";this.enableComparisonTypeDropDown()}this._isInitializing=isAutoChange;this.updateCompareButtons();this._isInitializing=isAutoChange},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedQuestionGuid",{get:function(){return this._selectedQuestionGuid},set:function(value){this._selectedQuestionGuid=value;var isAutoChange=this._isInitializing;this._isInitializing=true;this.availableAnswers=[];if(value!=null&&value!==Intelledox.Common.ConstantValues.GUID_EMPTY){var currentQuestion=this.findSelectedQuestion(value);if(currentQuestion==null){this.compareTo=""}else if(currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric){for(var i=0;i<currentQuestion.Answers.length;i++){this.availableAnswers.push(currentQuestion.Answers[i])}this.isAnswerEnabled=true;this.compareTo=""}else{this.isAnswerEnabled=false}}else{this.compareTo=""}this.availableAnswers.sort(function(a,b){if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0});this.availableAnswers.splice(0,0,new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(!this.isAnswerEnabled){this.enableComparisonTypeDropDownWithParent()}this._isInitializing=isAutoChange;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedAnswerGuid",{get:function(){return this._selectedAnswerGuid},set:function(value){this._selectedAnswerGuid=value;if(value==null||value===Intelledox.Common.ConstantValues.GUID_EMPTY){this.isComparisonTypeEnabled=false;this.availableComparisonTypes=[];this.selectedComparisonType=Intelledox.QAWizard.Design.ClauseComparisonType.None;this.updateCompareToBox()}else{this.enableComparisonTypeDropDownWithParent()}},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedAction",{get:function(){return this._selectedAction},set:function(value){var vm=this;this._selectedAction=value;var isAutoChange=this._isInitializing;this._isInitializing=true;this.availableActionOutputs=[];var resultOutput=new Intelledox.Model.ActionOutput;resultOutput.id=Intelledox.Common.ConstantValues.GUID_EMPTY;resultOutput.name=this._filter('translate')('ResultSquareBrackets');this.availableActionOutputs.push(resultOutput);this.compareTo="";this.selectedActionOutput=resultOutput.id;if(this.selectedAction!==Intelledox.Common.ConstantValues.GUID_EMPTY){var currentAction;for(var i=0;i<this.availableActions.length;i++){if(this.availableActions[i].ActionGuid===value){currentAction=this.availableActions[i];break}}this._listManager.actionOutputs(currentAction.Type.routingTypeId).then(function(outputs){for(var i=0;i<outputs.length;i++){vm.availableActionOutputs.push(outputs[i])}vm.isActionOutputEnabled=true;vm.availableActionOutputs.sort(function(a,b){if(a.id===Intelledox.Common.ConstantValues.GUID_EMPTY){return-1}if(b.id===Intelledox.Common.ConstantValues.GUID_EMPTY){return 1}if(a.name>b.name){return 1}if(a.name<b.name){return-1}return 0})})}else{this.isActionOutputEnabled=false}this.enableComparisonTypeDropDown();this._isInitializing=isAutoChange;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedActionOutput",{get:function(){return this._selectedActionOutput},set:function(value){this._selectedActionOutput=value;this.enableComparisonTypeDropDown()},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedComparisonType",{get:function(){return this._selectedComparisonType},set:function(value){this._selectedComparisonType=value;this.updateCompareToBox()},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedInput",{get:function(){return this._selectedInput},set:function(value){this._selectedInput=value;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedProjectProperty",{get:function(){return this._selectedProjectProperty},set:function(value){this._selectedProjectProperty=value;this.updateCompareButtons()},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedFragment",{get:function(){return this._selectedFragment},set:function(value){this._selectedFragment=value;var vm=this;var isAutoChange=this._isInitializing;this._isInitializing=true;this.availableFragmentOutputs=[];var noneOutput=new Intelledox.QAWizard.Design.AvailableOutput;noneOutput.RoutingOptionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;noneOutput.Name=this._filter('translate')('NoneWithBrackets');this.availableFragmentOutputs.push(noneOutput);this.selectedFragmentOutput=Intelledox.Common.ConstantValues.GUID_EMPTY;if(value!==Intelledox.Common.ConstantValues.GUID_EMPTY){var currentFragment=null;for(var i=0;i<this.availableFragments.length;i++){if(this.availableFragments[i].ObjectId===value){currentFragment=this.availableFragments[i];break}}if(currentFragment!=null){this._listManager.projectFragment(currentFragment.ProjectGuid).then(function(fragment){for(var i=0;i<fragment.AvailableOutputs.length;i++){if(fragment.AvailableOutputs[i].SourceType!==Intelledox.Model.RoutingSourceType.Repeat){vm.availableFragmentOutputs.push(fragment.AvailableOutputs[i])}}vm.availableFragmentOutputs.sort(function(a,b){if(a.RoutingOptionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return-1}if(b.RoutingOptionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return 1}if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0})})}}this._isInitializing=isAutoChange;this.updateCompareButtons();this._isInitializing=isAutoChange},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"selectedFragmentOutput",{get:function(){return this._selectedFragmentOutput},set:function(value){this._selectedFragmentOutput=value;if(value===Intelledox.Common.ConstantValues.GUID_EMPTY){this.isComparisonTypeEnabled=false;this.availableComparisonTypes=[];this.selectedComparisonType=null;this.updateCompareToBox()}else{this.enableComparisonTypeDropDown()}},enumerable:true,configurable:true});Object.defineProperty(ConditionPanelViewModel.prototype,"instructions",{get:function(){return this._instructions},enumerable:true,configurable:true});ConditionPanelViewModel.prototype.add=function(){var newCond=new Intelledox.QAWizard.Design.Condition;this.updateConditionDetails(newCond);this._editorViewModel.wizChanged=true;this._currentConditions.Add(newCond);this.clauseDesignerModel.setParentClause(this._currentConditions);this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(newCond);this.checkMandatory();this.updateConditionTypeDropdownDetails()};ConditionPanelViewModel.prototype.update=function(){var cond=this.clauseDesignerModel.clausesTreeView.selectedNode.tag;this.updateConditionDetails(cond);this._editorViewModel.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting()};ConditionPanelViewModel.prototype.remove=function(){var node=this.clauseDesignerModel.clausesTreeView.selectedNode;var cond=this.clauseDesignerModel.clausesTreeView.selectedNode.tag;if(node.parent==null){if(this._currentNode instanceof Intelledox.QAWizard.Design.Question){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.EditableConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Mandatory){this._currentNode.MandatoryConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.MandatoryConditions}else{this._currentNode.ActiveConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.TabGroup){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.EditableConditions}else{this._currentNode.ActiveConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.TabPage){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.EditableConditions}else{this._currentNode.ActiveConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Section){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Repeat){this._currentNode.RepeatConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.RepeatConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.EditableConditions}else{this._currentNode.ActiveConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Column){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.EditableConditions}else{this._currentNode.ActiveConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.FinishPage){this._wizard.FinishPageConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._wizard.FinishPageConditions}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Page){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Repeat){this._currentNode.RepeatConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.RepeatConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.EditableConditions}else{this._currentNode.ActiveConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.FragmentReference){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.EditableConditions}else{this._currentNode.ActiveConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Answer){this._currentNode.ActiveConditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.ActiveConditions}else if(this._currentNode instanceof Intelledox.QAWizard.Design.DocumentTemplate){this._currentNode.Conditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.Conditions}else if(this._currentNode instanceof Intelledox.QAWizard.Design.StateTransition){this._currentNode.Conditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.Conditions}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Escalation){this._currentNode.Conditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.Conditions}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Action){this._currentNode.Conditions=new Intelledox.QAWizard.Design.Condition;this._currentConditions=this._currentNode.Conditions}}else{node.parent.tag.SubClauses.splice(node.parent.tag.SubClauses.indexOf(cond),1)}this._editorViewModel.wizChanged=true;this.clauseDesignerModel.setParentClause(this._currentConditions);this.clauseDesignerModel.fillClauseViewFromExisting();this.updateCompareButtons();this.checkMandatory();this.updateConditionTypeDropdownDetails()};ConditionPanelViewModel.prototype.init=function(wizard,currentPage,currentNode,lists){var vm=this;var isAutoChange=this._isInitializing;var conditionType=0;this._wizard=wizard;this._currentPage=currentPage;this._currentNode=currentNode;this._listManager=lists;this._actionTransition=null;this._isInitializing=true;this.fillStateDropdown();if(!this._conditionTypeChange){this.fillConditionTypeDropdown()}this.availableQuestions=[];this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.availableAnswers=[];this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.isComparisonTypeEnabled=false;this.compareTo="";this.availableActions=[];var noneAction=new Intelledox.QAWizard.Design.Action;noneAction.Name=this._filter('translate')('NoneWithBrackets');noneAction.ActionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.availableActions.push(noneAction);this.selectedAction=noneAction.ActionGuid;this.isActionVisible=false;this.isQuestionVisible=true;this.isAnswerVisible=true;conditionType=this.selectedConditionType;this.fillParentTypeDropdown();if(currentNode instanceof Intelledox.QAWizard.Design.Question||currentNode instanceof Intelledox.QAWizard.Design.Answer||currentNode instanceof Intelledox.QAWizard.Design.TabGroup||currentNode instanceof Intelledox.QAWizard.Design.TabPage||currentNode instanceof Intelledox.QAWizard.Design.Section||currentNode instanceof Intelledox.QAWizard.Design.Column||currentNode instanceof Intelledox.QAWizard.Design.FragmentReference){var selectedPage=currentPage;var selectedObjectId=Intelledox.Common.ConstantValues.GUID_EMPTY;if(typeof currentNode['ObjectId']!=='undefined'){selectedObjectId=currentNode.ObjectId}if(currentNode instanceof Intelledox.QAWizard.Design.Question){var currentQuestion=currentNode;if(conditionType===Intelledox.QAWizard.Design.ConditionType.Visible){if(currentQuestion.VisibleConditions==null){currentQuestion.VisibleConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentQuestion.VisibleConditions}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Editable){if(currentQuestion.EditableConditions==null){currentQuestion.EditableConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentQuestion.EditableConditions}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Mandatory){if(currentQuestion.MandatoryConditions==null){currentQuestion.MandatoryConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentQuestion.MandatoryConditions}else{if(currentQuestion.ActiveConditions==null){currentQuestion.ActiveConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentQuestion.ActiveConditions}}else if(currentNode instanceof Intelledox.QAWizard.Design.TabGroup){var currentTabGroup=currentNode;if(conditionType===Intelledox.QAWizard.Design.ConditionType.Visible){if(currentTabGroup.VisibleConditions==null){currentTabGroup.VisibleConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentTabGroup.VisibleConditions}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Editable){if(currentTabGroup.EditableConditions==null){currentTabGroup.EditableConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentTabGroup.EditableConditions}else{if(currentTabGroup.ActiveConditions==null){currentTabGroup.ActiveConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentTabGroup.ActiveConditions}}else if(currentNode instanceof Intelledox.QAWizard.Design.TabPage){var currentTabPage=currentNode;if(conditionType===Intelledox.QAWizard.Design.ConditionType.Visible){if(currentTabPage.VisibleConditions==null){currentTabPage.VisibleConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentTabPage.VisibleConditions}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Editable){if(currentTabPage.EditableConditions==null){currentTabPage.EditableConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentTabPage.EditableConditions}else{if(currentTabPage.ActiveConditions==null){currentTabPage.ActiveConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentTabPage.ActiveConditions}}else if(currentNode instanceof Intelledox.QAWizard.Design.Section){var currentSection=currentNode;if(conditionType===Intelledox.QAWizard.Design.ConditionType.Visible){if(currentSection.VisibleConditions==null){currentSection.VisibleConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentSection.VisibleConditions}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Editable){if(currentSection.EditableConditions==null){currentSection.EditableConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentSection.EditableConditions}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Repeat){if(currentSection.RepeatConditions==null){currentSection.RepeatConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentSection.RepeatConditions;this._instructions=this._filter('translate')('ConditionRepeatInstructions')}else{if(currentSection.ActiveConditions==null){currentSection.ActiveConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentSection.ActiveConditions}}else if(currentNode instanceof Intelledox.QAWizard.Design.Column){var currentColumn=currentNode;if(conditionType===Intelledox.QAWizard.Design.ConditionType.Visible){if(currentColumn.VisibleConditions==null){currentColumn.VisibleConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentColumn.VisibleConditions}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Editable){if(currentColumn.EditableConditions==null){currentColumn.EditableConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentColumn.EditableConditions}else{if(currentColumn.ActiveConditions==null){currentColumn.ActiveConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentColumn.ActiveConditions}}else if(currentNode instanceof Intelledox.QAWizard.Design.FragmentReference){var currentFrag=currentNode;if(conditionType===Intelledox.QAWizard.Design.ConditionType.Visible){if(currentFrag.VisibleConditions==null){currentFrag.VisibleConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentFrag.VisibleConditions}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Editable){if(currentFrag.EditableConditions==null){currentFrag.EditableConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentFrag.EditableConditions}else{if(currentFrag.ActiveConditions==null){currentFrag.ActiveConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentFrag.ActiveConditions}}else{var currentAnswer=currentNode;selectedObjectId=currentAnswer.Question.QuestionGuid;if(currentAnswer.ActiveConditions==null){currentAnswer.ActiveConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=currentAnswer.ActiveConditions}if(conditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._instructions=this._filter('translate')('ConditionVisibleInstructions')}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._instructions=this._filter('translate')('ConditionEditableInstructions')}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Repeat){this._instructions=this._filter('translate')('ConditionRepeatInstructions')}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Mandatory){this._instructions=this._filter('translate')('ConditionMandatoryInstructions')}else{this._instructions=this.conditionActiveInstructions()}for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pageItem=wizard.Pages[pageIndex];if(!pageItem.IsRepeated||pageItem===selectedPage){this.addLayoutQuestionsToDropdown(pageItem.Children,selectedObjectId,pageItem===selectedPage,false);if(pageItem===selectedPage){break}}}}else if(currentNode instanceof Intelledox.QAWizard.Design.FinishPage){for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pageItem=wizard.Pages[pageIndex];if(!pageItem.IsRepeated){this.addLayoutQuestionsToDropdown(pageItem.Children,Intelledox.Common.ConstantValues.GUID_EMPTY,false,false)}}this._currentConditions=this._wizard.FinishPageConditions;this._instructions=this.conditionActiveInstructions()}else if(currentNode instanceof Intelledox.QAWizard.Design.Page){var selectedPage=currentPage;for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pageItem=wizard.Pages[pageIndex];if(pageItem===selectedPage){break}if(!pageItem.IsRepeated){this.addLayoutQuestionsToDropdown(pageItem.Children,Intelledox.Common.ConstantValues.GUID_EMPTY,false,false)}}if(conditionType===Intelledox.QAWizard.Design.ConditionType.Visible){if(selectedPage.VisibleConditions==null){selectedPage.VisibleConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=selectedPage.VisibleConditions;this._instructions=this._filter('translate')('ConditionVisibleInstructions')}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Editable){if(selectedPage.EditableConditions==null){selectedPage.EditableConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=selectedPage.EditableConditions;this._instructions=this._filter('translate')('ConditionEditableInstructions')}else if(conditionType===Intelledox.QAWizard.Design.ConditionType.Repeat){if(selectedPage.RepeatConditions==null){selectedPage.RepeatConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=selectedPage.RepeatConditions;this._instructions=this._filter('translate')('ConditionRepeatInstructions')}else{if(selectedPage.ActiveConditions==null){selectedPage.ActiveConditions=new Intelledox.QAWizard.Design.Condition}this._currentConditions=selectedPage.ActiveConditions;this._instructions=this.conditionActiveInstructions()}}else if(currentNode instanceof Intelledox.QAWizard.Design.DocumentTemplate){for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pageItem=wizard.Pages[pageIndex];if(!pageItem.IsRepeated){this.addLayoutQuestionsToDropdown(pageItem.Children,Intelledox.Common.ConstantValues.GUID_EMPTY,false,false)}}this._currentConditions=currentNode.Conditions;this._instructions=this.conditionActiveInstructions()}else if(currentNode instanceof Intelledox.QAWizard.Design.StateTransition){for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pageItem=wizard.Pages[pageIndex];if(!pageItem.IsRepeated){this.addLayoutQuestionsToDropdown(pageItem.Children,Intelledox.Common.ConstantValues.GUID_EMPTY,false,false)}}this._currentConditions=currentNode.Conditions;this._instructions=this.conditionActiveInstructions()}else if(currentNode instanceof Intelledox.QAWizard.Design.Escalation){for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pageItem=wizard.Pages[pageIndex];if(!pageItem.IsRepeated){this.addLayoutQuestionsToDropdown(pageItem.Children,Intelledox.Common.ConstantValues.GUID_EMPTY,false,false)}}this._currentConditions=currentNode.Conditions;this._instructions=this.conditionActiveInstructions()}else if(currentNode instanceof Intelledox.QAWizard.Design.Action){var currentAction=currentNode;for(var pageIndex=0;pageIndex<wizard.Pages.length;pageIndex++){var pageItem=wizard.Pages[pageIndex];if(!pageItem.IsRepeated){this.addLayoutQuestionsToDropdown(pageItem.Children,currentAction.RepeaterGuid,false,true)}else if(pageItem.ObjectId===currentAction.RepeaterGuid||this.containsLayoutNode(pageItem.Children,currentAction.RepeaterGuid)){this.addLayoutQuestionsToDropdown(pageItem.Children,currentAction.RepeaterGuid,false,true)}}var searchAction=this._wizard.FindAction(currentNode.ActionGuid,false);if(searchAction!=null){this._actionTransition=searchAction.stateTransition;var actionList;if(this._actionTransition==null){actionList=this._wizard.Actions}else{actionList=this._actionTransition.Actions}this._listManager.actionTypes().then(function(types){for(var actionIndex=0;actionIndex<actionList.length;actionIndex++){var a=actionList[actionIndex];if(a.ActionGuid===currentNode.ActionGuid){break}else{for(var availableIndex=0;availableIndex<types.length;availableIndex++){if(types[availableIndex].routingTypeId===a.Type.routingTypeId&&types[availableIndex].supportsRun&&Design.ValidationWizard.isValidParentAction(a,currentNode,wizard)){vm.availableActions.push(a)}}}}vm.availableActions.sort(function(a,b){if(a.ActionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return-1}if(b.ActionGuid===Intelledox.Common.ConstantValues.GUID_EMPTY){return 1}if(a.Name>b.Name){return 1}if(a.Name<b.Name){return-1}return 0})})}this._currentConditions=currentAction.Conditions;this._instructions=this.conditionActiveInstructions()}if(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPage||this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){this.loadInputs()}this.loadFragments();this.availableQuestions.sort(function(a,b){if(a.Text>b.Text){return 1}if(a.Text<b.Text){return-1}return 0});this.availableQuestions.splice(0,0,new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filter('translate')('NoneWithBrackets')));this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this.selectedAction=Intelledox.Common.ConstantValues.GUID_EMPTY;this.clauseDesignerModel.init(this._currentConditions,this._wizard,lists,currentNode);this.updateCompareButtons();this._isInitializing=isAutoChange};ConditionPanelViewModel.prototype.pickRef=function(){var _this=this;this._editorViewModel.treeView.pickEvent=function(node){_this.onPickRef(node)};this._editorViewModel.treeView.togglePickMode()};ConditionPanelViewModel.prototype.onPickRef=function(node){if(node.tag instanceof Intelledox.QAWizard.Design.Question){this.setReferenceQuestion(node.tag)}else if(node.tag instanceof Intelledox.QAWizard.Design.AvailableInput){this.setReferenceInput(node.tag)}else if(node.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){this.setReferenceOutput(node.tag)}else if(node.tag instanceof Intelledox.QAWizard.Design.FragmentPage||node.tag instanceof Intelledox.QAWizard.Design.FragmentReference){this.setReferenceFragment(node.tag)}else if(node.tag instanceof Intelledox.QAWizard.Design.Answer){if(node.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||node.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||node.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.setReferenceQuestionAnswer(node.parent.tag,node.tag)}else{this.setReferenceQuestion(node.parent.tag)}}};ConditionPanelViewModel.prototype.loadCondition=function(cond){if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Reference){this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.Reference;for(var i=0;i<this.availableQuestions.length;i++){var parentQ=this.availableQuestions[i];if(parentQ.QuestionGuid===cond.ParentItemGuid){this.selectedQuestionGuid=parentQ.QuestionGuid;break}}if(cond.ParentAttributeGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){for(var i=0;i<this.availableAnswers.length;i++){var parentA=this.availableAnswers[i];if(parentA.AnswerGuid===cond.ParentAttributeGuid){this.selectedAnswerGuid=parentA.AnswerGuid;break}}}}else if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.State){if(this.availableParentTypes.length>=2){this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.State}}else if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Input){this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.Input;this.selectedInput=cond.ParentItemGuid}else if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.FragmentOutput){this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.FragmentOutput;this.selectedFragment=cond.ParentItemGuid;this.selectedFragmentOutput=cond.ParentAttributeGuid}else if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.ProjectProperty){this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.ProjectProperty;this.selectedProjectProperty=cond.ParentItemGuid}else{this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.Action;this.selectedAction=cond.ParentItemGuid;this.selectedActionOutput=cond.ParentAttributeGuid}this.selectedComparisonType=cond.ComparisonType;if(cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Reference||cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Action||cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.Input||cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.FragmentOutput||cond.ParentType===Intelledox.QAWizard.Design.ConditionParentType.ProjectProperty){if(this.isCompareToTextVisible){this.compareTo=Design.TranslationHelper.KeywordValueToTranslation(this._filter,cond.CompareTo)}else{this.selectedCompareTo=cond.CompareTo}}else{this.selectedStateGuid=cond.CompareTo}};ConditionPanelViewModel.prototype.enableComparisonTypeDropDownWithParent=function(){var questionTypeId=Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.None;this.availableComparisonTypes=[];this.selectedComparisonType=Intelledox.QAWizard.Design.ClauseComparisonType.None;if(this.selectedQuestionGuid!=null&&this.selectedQuestionGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){var selectedQuestion=this.findSelectedQuestion(this.selectedQuestionGuid);if(selectedQuestion!=null){questionTypeId=selectedQuestion.QuestionTypeID}}if(questionTypeId===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.None){this.isComparisonTypeEnabled=false}else{if(questionTypeId!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic&&questionTypeId!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic&&questionTypeId!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button){this.availableComparisonTypes.push({name:this._filter('translate')('EqualsString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Equals});this.availableComparisonTypes.push({name:this._filter('translate')('NotEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.IsNotEqual});this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThan'),value:Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThan});this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThanorEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThanOrEquals});this.availableComparisonTypes.push({name:this._filter('translate')('LessThan'),value:Intelledox.QAWizard.Design.ClauseComparisonType.LessThan});this.availableComparisonTypes.push({name:this._filter('translate')('LessThanorEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.LessThanOrEquals});this.availableComparisonTypes.push({name:this._filter('translate')('Contains'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Contains})}this.availableComparisonTypes.push({name:this._filter('translate')('IsString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Is});this.availableComparisonTypes.push({name:this._filter('translate')('IsNotString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.IsNot});this.isComparisonTypeEnabled=true;this.selectedComparisonType=this.availableComparisonTypes[0].value}this.updateCompareToBox()};ConditionPanelViewModel.prototype.enableComparisonTypeDropDown=function(){this.availableComparisonTypes=[];this.selectedComparisonType=Intelledox.QAWizard.Design.ClauseComparisonType.None;if(this.isState()){this.availableComparisonTypes.push({name:this._filter('translate')('EqualsString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Equals});this.availableComparisonTypes.push({name:this._filter('translate')('NotEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.IsNotEqual});this.isComparisonTypeEnabled=true;this.selectedComparisonType=this.availableComparisonTypes[0].value}else if(this.isInput()||this.isFragmentOutput()||this.isProjectProperty()){this.availableComparisonTypes.push({name:this._filter('translate')('EqualsString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Equals});this.availableComparisonTypes.push({name:this._filter('translate')('NotEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.IsNotEqual});this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThan'),value:Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThan});this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThanorEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThanOrEquals});this.availableComparisonTypes.push({name:this._filter('translate')('LessThan'),value:Intelledox.QAWizard.Design.ClauseComparisonType.LessThan});this.availableComparisonTypes.push({name:this._filter('translate')('LessThanorEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.LessThanOrEquals});this.availableComparisonTypes.push({name:this._filter('translate')('Contains'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Contains});if(this.isInput()||this.isProjectProperty()){this.isComparisonTypeEnabled=true}else{this.isComparisonTypeEnabled=(this.selectedFragmentOutput!==Intelledox.Common.ConstantValues.GUID_EMPTY)}this.selectedComparisonType=this.availableComparisonTypes[0].value}else{if(this.selectedAction===Intelledox.Common.ConstantValues.GUID_EMPTY){this.isComparisonTypeEnabled=false}else if(this.selectedActionOutput===Intelledox.Common.ConstantValues.GUID_EMPTY){this.availableComparisonTypes.push({name:this._filter('translate')('IsString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Is});this.availableComparisonTypes.push({name:this._filter('translate')('IsNotString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.IsNot});this.isComparisonTypeEnabled=true;this.selectedComparisonType=this.availableComparisonTypes[0].value}else{this.availableComparisonTypes.push({name:this._filter('translate')('EqualsString'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Equals});this.availableComparisonTypes.push({name:this._filter('translate')('NotEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.IsNotEqual});this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThan'),value:Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThan});this.availableComparisonTypes.push({name:this._filter('translate')('GreaterThanorEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.GreaterThanOrEquals});this.availableComparisonTypes.push({name:this._filter('translate')('LessThan'),value:Intelledox.QAWizard.Design.ClauseComparisonType.LessThan});this.availableComparisonTypes.push({name:this._filter('translate')('LessThanorEqualTo'),value:Intelledox.QAWizard.Design.ClauseComparisonType.LessThanOrEquals});this.availableComparisonTypes.push({name:this._filter('translate')('Contains'),value:Intelledox.QAWizard.Design.ClauseComparisonType.Contains});this.isComparisonTypeEnabled=true;this.selectedComparisonType=this.availableComparisonTypes[0].value}}this.updateCompareToBox()};ConditionPanelViewModel.prototype.updateCompareToBox=function(){if(!this.isState()){this.isCompareToTextVisible=true;this.isCompareToListVisible=false;if(this.isComparisonTypeEnabled===false){this.isCompareToListEnabled=false;this.isCompareToTextEnabled=false}else{if(this.selectedComparisonType===Intelledox.QAWizard.Design.ClauseComparisonType.Is||this.selectedComparisonType===Intelledox.QAWizard.Design.ClauseComparisonType.IsNot){this.isCompareToListVisible=true;this.isCompareToTextVisible=false;this.isCompareToListEnabled=true;this.availableCompareTos=[];if(this.isReference()){var currentQuestion=this.findSelectedQuestion(this.selectedQuestionGuid);if(currentQuestion!=null&&(currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button)){this.availableCompareTos.push({name:this._filter('translate')('Selected'),value:"Selected"});this.selectedCompareTo=this.availableCompareTos[0].value}else{this.availableCompareTos.push({name:this._filter('translate')('TrueOption'),value:"True"});this.availableCompareTos.push({name:this._filter('translate')('FalseOption'),value:"False"});this.selectedCompareTo=this.availableCompareTos[0].value}}else{this.availableCompareTos.push({name:this._filter('translate')('Success'),value:"Success"});this.availableCompareTos.push({name:this._filter('translate')('Fail'),value:"Fail"});this.availableCompareTos.push({name:this._filter('translate')('NotRun'),value:"NotRun"});this.selectedCompareTo=this.availableCompareTos[0].value}}else{this.isCompareToListVisible=false;this.isCompareToTextVisible=true;this.isCompareToTextEnabled=true}}}this.updateCompareButtons()};ConditionPanelViewModel.prototype.addLayoutQuestionsToDropdown=function(layout,stopGuid,samePage,isActionCondition){var foundStopGuid=false;for(var i=0;i<layout.length;i++){var n=layout[i];if(n.ObjectId===stopGuid){if(!isActionCondition){return true}else if(n instanceof Intelledox.QAWizard.Design.DatasourceQuestion){continue}}if(n instanceof Intelledox.QAWizard.Design.Question){var q=n;if(samePage){if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric||(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button&&q.ButtonType===Intelledox.Model.ButtonType.Toggle)||(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&(q.DisplayType===Intelledox.Model.QuestionDisplayType.List||q.DisplayType===Intelledox.Model.QuestionDisplayType.AutoComplete))){this.availableQuestions.push(q)}}else if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Numeric||(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button&&q.ButtonType===Intelledox.Model.ButtonType.Toggle)||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.availableQuestions.push(q)}if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RunActionButton){var aq=q;for(var j=0;j<aq.Actions.length;j++){this.availableActions.push(aq.Actions[j])}}}else if(typeof n.HasContainerInterface!=="undefined"){if(!(n instanceof Intelledox.QAWizard.Design.Section&&n.IsRepeated)){foundStopGuid=this.addLayoutQuestionsToDropdown(n.Children,stopGuid,samePage,isActionCondition)}else if(n.ObjectId===stopGuid||this.containsLayoutNode(n.Children,stopGuid)){foundStopGuid=this.addLayoutQuestionsToDropdown(n.Children,stopGuid,true,isActionCondition)}}if(foundStopGuid&&!isActionCondition){return true}}return foundStopGuid};ConditionPanelViewModel.prototype.containsLayoutNode=function(layout,nodeGuid){for(var i=0;i<layout.length;i++){var l=layout[i];if(l!=null){if(l.ObjectId===nodeGuid){return true}if(typeof l.HasContainerInterface!=="undefined"){if(this.containsLayoutNode(l.Children,nodeGuid)){return true}}}}return false};ConditionPanelViewModel.prototype.conditionActiveInstructions=function(){if(this._currentNode instanceof Intelledox.QAWizard.Design.Action){return this._filter('translate')('ActionConditionActiveInstructions')}else if(this._currentNode instanceof Intelledox.QAWizard.Design.DocumentTemplate){return this._filter('translate')('DocumentConditionActiveInstructions')}else if(this._currentNode instanceof Intelledox.QAWizard.Design.StateTransition){return this._filter('translate')('TransitionConditionActiveInstructions')}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Escalation){return this._filter('translate')('EscalationConditionsActiveInstructions')}else if(this._currentNode instanceof Intelledox.QAWizard.Design.FinishPage){return this._filter('translate')('FinishPageConditionActiveInstructions')}else{return this._filter('translate')('ConditionActiveInstructions')}};ConditionPanelViewModel.prototype.fillParentTypeDropdown=function(){this.availableParentTypes=[];this.availableParentTypes.push({name:this._filter('translate')('AnswerValue'),value:Intelledox.QAWizard.Design.ConditionParentType.Reference});if(this._wizard.Workflow.HasWorkflow&&(!(this._currentNode instanceof Intelledox.QAWizard.Design.StateTransition))&&this._actionTransition==null&&(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible||this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable||this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Repeat||this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Mandatory)){this.availableParentTypes.push({name:this._filter('translate')('State'),value:Intelledox.QAWizard.Design.ConditionParentType.State})}if(this._currentNode instanceof Intelledox.QAWizard.Design.Action||this._editorViewModel.isRunActionButtonAvailable){this.availableParentTypes.push({name:this._filter('translate')('ActionOutput'),value:Intelledox.QAWizard.Design.ConditionParentType.Action})}if(this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPage||this._wizard.TypeId===Intelledox.Model.ProjectType.FragmentPortion){this.availableParentTypes.push({name:this._filter('translate')('Input'),value:Intelledox.QAWizard.Design.ConditionParentType.Input})}this.availableParentTypes.push({name:this._filter('translate')('FragmentOutput'),value:Intelledox.QAWizard.Design.ConditionParentType.FragmentOutput});if(this._wizard.Properties.length>0){this.availableParentTypes.push({name:this._filter('translate')('ProjectProperty'),value:Intelledox.QAWizard.Design.ConditionParentType.ProjectProperty})}this.selectedParentType=this.availableParentTypes[0].value};ConditionPanelViewModel.prototype.fillConditionTypeDropdown=function(){var previousType=this.selectedConditionType;this._conditionTypeChange=true;this.availableConditionTypes=[];this.availableConditionTypes.push({name:'',value:0,hasType:false});if((this._currentNode instanceof Intelledox.QAWizard.Design.Page&&!(this._currentNode instanceof Intelledox.QAWizard.Design.FinishPage))||this._currentNode instanceof Intelledox.QAWizard.Design.TabGroup||this._currentNode instanceof Intelledox.QAWizard.Design.TabPage||this._currentNode instanceof Intelledox.QAWizard.Design.Section||this._currentNode instanceof Intelledox.QAWizard.Design.Column||this._currentNode instanceof Intelledox.QAWizard.Design.FragmentReference||(this._currentNode instanceof Intelledox.QAWizard.Design.Question&&this._currentNode.IsDisplayQuestionType&&this._currentNode.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Validator&&this._currentNode.QuestionTypeID!==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Summary)){this.availableConditionTypes.push({name:'',value:Intelledox.QAWizard.Design.ConditionType.Visible,hasType:false});if(!(this._currentNode instanceof Intelledox.QAWizard.Design.LabelQuestion)){this.availableConditionTypes.push({name:'',value:Intelledox.QAWizard.Design.ConditionType.Editable,hasType:false})}}if(this._currentNode instanceof Intelledox.QAWizard.Design.Question){if(this._currentNode.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Custom||this._currentNode.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Geolocation||this._currentNode.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||this._currentNode.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Ink||this._currentNode.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.RichText||this._currentNode.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||(this._currentNode.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.ContentLibrary&&this._currentNode.Visibility)||(this._currentNode.QuestionTypeID==Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&this._currentNode.Visibility)){this.availableConditionTypes.push({name:'',value:Intelledox.QAWizard.Design.ConditionType.Mandatory,hasType:false})}}if(this._currentNode instanceof Intelledox.QAWizard.Design.Page&&this._currentNode.IsRepeated){this.availableConditionTypes.push({name:'',value:Intelledox.QAWizard.Design.ConditionType.Repeat,hasType:false})}if(this._currentNode instanceof Intelledox.QAWizard.Design.Section&&this._currentNode.IsRepeated){this.availableConditionTypes.push({name:'',value:Intelledox.QAWizard.Design.ConditionType.Repeat,hasType:false})}var found=false;for(var i=0;i<this.availableConditionTypes.length;i++){if(previousType===this.availableConditionTypes[i].value){this.selectedConditionType=previousType;found=true;break}}if(!found){this.selectedConditionType=this.availableConditionTypes[0].value}this._conditionTypeChange=false;this.updateConditionTypeDropdownDetails()};ConditionPanelViewModel.prototype.updateConditionTypeDropdownDetails=function(){var hasActive=typeof this._currentNode.ActiveConditions!=="undefined"&&this._currentNode.ActiveConditions!=null&&this._currentNode.ActiveConditions.Type!==Intelledox.Model.ClauseType.Basic;var hasVisible=typeof this._currentNode.VisibleConditions!=="undefined"&&this._currentNode.VisibleConditions!=null&&this._currentNode.VisibleConditions.Type!==Intelledox.Model.ClauseType.Basic;var hasEditable=typeof this._currentNode.EditableConditions!=="undefined"&&this._currentNode.EditableConditions!=null&&this._currentNode.EditableConditions.Type!==Intelledox.Model.ClauseType.Basic;var hasMandatory=typeof this._currentNode.MandatoryConditions!=="undefined"&&this._currentNode.MandatoryConditions!=null&&this._currentNode.MandatoryConditions.Type!==Intelledox.Model.ClauseType.Basic;var hasRepeat=typeof this._currentNode.RepeatConditions!=="undefined"&&this._currentNode.RepeatConditions!=null&&this._currentNode.RepeatConditions.Type!==Intelledox.Model.ClauseType.Basic;for(var i=0;i<this.availableConditionTypes.length;i++){var currentConditionType=this.availableConditionTypes[i];switch(currentConditionType.value){case Intelledox.QAWizard.Design.ConditionType.Active:currentConditionType.name=this._filter('translate')('Active')+(hasActive?' \u2713':'');currentConditionType.hasType=hasActive;break;case Intelledox.QAWizard.Design.ConditionType.Editable:currentConditionType.name=this._filter('translate')('Editable')+(hasEditable?' \u2713':'');currentConditionType.hasType=hasEditable;break;case Intelledox.QAWizard.Design.ConditionType.Visible:currentConditionType.name=this._filter('translate')('Visible')+(hasVisible?' \u2713':'');currentConditionType.hasType=hasVisible;break;case Intelledox.QAWizard.Design.ConditionType.Mandatory:currentConditionType.name=this._filter('translate')('Mandatory')+(hasMandatory?' \u2713':'');currentConditionType.hasType=hasMandatory;break;case Intelledox.QAWizard.Design.ConditionType.Repeat:if(this._currentNode instanceof Intelledox.QAWizard.Design.Page){currentConditionType.name=this._filter('translate')('RepeatPageConditionType')+(hasRepeat?' \u2713':'')}if(this._currentNode instanceof Intelledox.QAWizard.Design.Section){currentConditionType.name=this._filter('translate')('RepeatSectionConditionType')+(hasRepeat?' \u2713':'')}currentConditionType.hasType=hasRepeat;break}}};ConditionPanelViewModel.prototype.fillStateDropdown=function(){if(this._wizard!=null){this.availableStates=this._wizard.Workflow.AllStatesWithoutFinish;if(this.availableStates.length>0){this.selectedStateGuid=this.availableStates[0].Id}}};ConditionPanelViewModel.prototype.loadInputs=function(){this.availableInputs=[];for(var i=0;i<this._wizard.AvailableInputs.length;i++){if(this._wizard.AvailableInputs[i].valueType!==Intelledox.Model.ValueTypes.Repeat){this.availableInputs.push(this._wizard.AvailableInputs[i])}}if(this.availableInputs.length>0){this.selectedInput=this.availableInputs[0].routingElementTypeId}};ConditionPanelViewModel.prototype.loadFragments=function(){this.availableFragments=[];this.selectedFragment=Intelledox.Common.ConstantValues.GUID_EMPTY;for(var pageIndex=0;pageIndex<this._wizard.Pages.length;pageIndex++){var p=this._wizard.Pages[pageIndex];if(p instanceof Intelledox.QAWizard.Design.FragmentPage){this.availableFragments.push(p)}else{for(var i=0;i<p.Children.length;i++){this.loadFragmentsRecursive(p.Children[i])}}}if(this.availableFragments.length>0){this.selectedFragment=this.availableFragments[0].ObjectId}};ConditionPanelViewModel.prototype.loadFragmentsRecursive=function(node){if(node instanceof Intelledox.QAWizard.Design.FragmentReference){this.availableFragments.push(node)}else if(typeof node.HasContainerInterface!=="undefined"){for(var i=0;i<node.Children.length;i++){this.loadFragmentsRecursive(node.Children[i])}}};ConditionPanelViewModel.prototype.isReference=function(){return this.selectedParentType===Intelledox.QAWizard.Design.ConditionParentType.Reference};ConditionPanelViewModel.prototype.isState=function(){return this.selectedParentType===Intelledox.QAWizard.Design.ConditionParentType.State};ConditionPanelViewModel.prototype.isInput=function(){return this.selectedParentType===Intelledox.QAWizard.Design.ConditionParentType.Input};ConditionPanelViewModel.prototype.isFragmentOutput=function(){return this.selectedParentType===Intelledox.QAWizard.Design.ConditionParentType.FragmentOutput};ConditionPanelViewModel.prototype.isProjectProperty=function(){return this.selectedParentType===Intelledox.QAWizard.Design.ConditionParentType.ProjectProperty};ConditionPanelViewModel.prototype.updateCompareButtons=function(){if(this.isCompareToListVisible&&this.isCompareToListEnabled){this.isAddEnabled=true}else if(this.isCompareToTextVisible&&this.isCompareToTextEnabled){this.isAddEnabled=true}else if(this.isStateVisible&&this.selectedStateGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.isAddEnabled=true}else if(this.isInputVisible&&this.selectedInput!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.isAddEnabled=true}else{this.isAddEnabled=false}var node=this.clauseDesignerModel.clausesTreeView.selectedNode;if(node!=null){if(node.tag.Type===Intelledox.Model.ClauseType.Comparison){this.isUpdateEnabled=this.isAddEnabled;this.isRemoveEnabled=true}else{this.isUpdateEnabled=false;this.isRemoveEnabled=false}}else{this.isUpdateEnabled=false;this.isRemoveEnabled=false}};ConditionPanelViewModel.prototype.findSelectedQuestion=function(questionGuid){for(var i=0;i<this.availableQuestions.length;i++){if(questionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};ConditionPanelViewModel.prototype.clauseViewReplaceClause=function(copyClause){var newCondition=null;if(copyClause instanceof Intelledox.QAWizard.Design.Condition){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Active&&copyClause.HasStateComparison()){alert(this._filter('translate')('ErrorMsg_CanOnlyCopyStateConditionToVisibleEditableConditions'));return}newCondition=copyClause.Clone()}else if(copyClause instanceof Intelledox.QAWizard.Design.Rule){var newRule=copyClause;if(newRule.Type===Intelledox.Model.ClauseType.AllOf||newRule.Type===Intelledox.Model.ClauseType.AnyOf||newRule.ParentType===Intelledox.QAWizard.Design.RuleParentType.Reference){newCondition=new Intelledox.QAWizard.Design.Condition(newRule.Type,newRule.ParentItemGuid,newRule.ParentAttributeGuid,newRule.ComparisonType,newRule.CompareTo,Intelledox.QAWizard.Design.ConditionParentType.Reference);if(!this.addSubClauses(newRule,newCondition)){alert(this._filter('translate')('ErrorMsg_CanOnlyCopyReferenceRuleToCondition'));return}}else{alert(this._filter('translate')('ErrorMsg_CanOnlyCopyReferenceRuleToCondition'));return}}else if(copyClause instanceof Intelledox.QAWizard.Design.ValidationRule){alert(this._filter('translate')('ErrorMsg_CannotCopyValidatorRuleToOtherTabs'));return}else if(copyClause instanceof Intelledox.QAWizard.Design.Filter){alert(this._filter('translate')('ErrorMsg_CannotCopyDataFilterRuleToOtherTabs'));return}else{alert(this._filter('translate')('ErrorMsg_PasteError'));return}if(this._currentNode instanceof Intelledox.QAWizard.Design.Question){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=newCondition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=newCondition;this._currentConditions=this._currentNode.EditableConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Mandatory){this._currentNode.MandatoryConditions=newCondition;this._currentConditions=this._currentNode.MandatoryConditions}else{this._currentNode.ActiveConditions=newCondition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.TabGroup){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=newCondition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=newCondition;this._currentConditions=this._currentNode.EditableConditions}else{this._currentNode.ActiveConditions=newCondition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.TabPage){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=newCondition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=newCondition;this._currentConditions=this._currentNode.EditableConditions}else{this._currentNode.ActiveConditions=newCondition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Section){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=newCondition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=newCondition;this._currentConditions=this._currentNode.EditableConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Repeat){this._currentNode.RepeatConditions=newCondition;this._currentConditions=this._currentNode.RepeatConditions}else{this._currentNode.ActiveConditions=newCondition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Column){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=newCondition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=newCondition;this._currentConditions=this._currentNode.EditableConditions}else{this._currentNode.ActiveConditions=newCondition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.FinishPage){this._wizard.FinishPageConditions=newCondition;this._currentConditions=this._wizard.FinishPageConditions}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Page){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=newCondition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=newCondition;this._currentConditions=this._currentNode.EditableConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Repeat){this._currentNode.RepeatConditions=newCondition;this._currentConditions=this._currentNode.RepeatConditions}else{this._currentNode.ActiveConditions=newCondition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.FragmentReference){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Visible){this._currentNode.VisibleConditions=newCondition;this._currentConditions=this._currentNode.VisibleConditions}else if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Editable){this._currentNode.EditableConditions=newCondition;this._currentConditions=this._currentNode.EditableConditions}else{this._currentNode.ActiveConditions=newCondition;this._currentConditions=this._currentNode.ActiveConditions}}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Answer){this._currentNode.ActiveConditions=newCondition;this._currentConditions=this._currentNode.ActiveConditions}else if(this._currentNode instanceof Intelledox.QAWizard.Design.DocumentTemplate){this._currentNode.Conditions=newCondition;this._currentConditions=this._currentNode.Conditions}else if(this._currentNode instanceof Intelledox.QAWizard.Design.StateTransition){this._currentNode.Conditions=newCondition;this._currentConditions=this._currentNode.Conditions}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Escalation){this._currentNode.Conditions=newCondition;this._currentConditions=this._currentNode.Conditions}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Action){this._currentNode.Conditions=newCondition;this._currentConditions=this._currentNode.Conditions}this.clauseDesignerModel.setParentClause(this._currentConditions);this.clauseDesignerModel.fillClauseViewFromExisting();this.updateCompareButtons();this._editorViewModel.wizChanged=true;this.checkMandatory();this.updateConditionTypeDropdownDetails()};ConditionPanelViewModel.prototype.addSubClauses=function(clause,parentCondition){for(var i=0;i<clause.SubClauses.length;i++){var subClause=clause.SubClauses[i];var newSubClause=subClause;var newCondition=null;if(newSubClause.Type===Intelledox.Model.ClauseType.AllOf||newSubClause.Type===Intelledox.Model.ClauseType.AnyOf||newSubClause.ParentType===Intelledox.QAWizard.Design.RuleParentType.Reference){newCondition=new Intelledox.QAWizard.Design.Condition(newSubClause.Type,newSubClause.ParentItemGuid,newSubClause.ParentAttributeGuid,newSubClause.ComparisonType,newSubClause.CompareTo,Intelledox.QAWizard.Design.ConditionParentType.Reference);parentCondition.SubClauses.push(newCondition)}else{return false}if(!this.addSubClauses(newSubClause,newCondition)){return false}}return true};ConditionPanelViewModel.prototype.updateConditionDetails=function(cond){cond.ParentItemGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;cond.ParentAttributeGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;if(this.isReference()){if(this.selectedAnswerGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){cond.ParentAttributeGuid=this.selectedAnswerGuid}cond.ParentItemGuid=this.selectedQuestionGuid;if(this.isCompareToTextVisible){cond.CompareTo=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.compareTo)}else{cond.CompareTo=this.selectedCompareTo}}else if(this.isState()){if(this.selectedStateGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){cond.CompareTo=this.selectedStateGuid}else{cond.CompareTo=Intelledox.Common.ConstantValues.GUID_EMPTY}}else if(this.isInput()){cond.ParentItemGuid=this.selectedInput;if(this.isCompareToTextVisible){cond.CompareTo=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.compareTo)}else{cond.CompareTo=this.selectedCompareTo}}else if(this.isFragmentOutput()){cond.ParentItemGuid=this.selectedFragment;if(this.selectedFragmentOutput!=null){cond.ParentAttributeGuid=this.selectedFragmentOutput}if(this.isCompareToTextVisible){cond.CompareTo=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.compareTo)}else{cond.CompareTo=this.selectedCompareTo}}else if(this.isProjectProperty()){cond.ParentItemGuid=this.selectedProjectProperty;if(this.isCompareToTextVisible){cond.CompareTo=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.compareTo)}else{cond.CompareTo=this.selectedCompareTo}}else{if(this.selectedAction!==Intelledox.Common.ConstantValues.GUID_EMPTY){cond.ParentItemGuid=this.selectedAction}cond.ParentAttributeGuid=this.selectedActionOutput;if(this.isCompareToTextVisible){cond.CompareTo=Design.TranslationHelper.TranslationToKeywordValue(this._filter,this.compareTo)}else{cond.CompareTo=this.selectedCompareTo}}cond.ComparisonType=this.selectedComparisonType;cond.Type=Intelledox.Model.ClauseType.Comparison;cond.ParentType=this.selectedParentType};ConditionPanelViewModel.prototype.checkMandatory=function(){if(this.selectedConditionType===Intelledox.QAWizard.Design.ConditionType.Mandatory){if(this._currentConditions==null||this._currentConditions.Type===Intelledox.Model.ClauseType.Basic){this._currentNode.Mandatory=Intelledox.QAWizard.Design.MandatoryType.No}else{this._currentNode.Mandatory=Intelledox.QAWizard.Design.MandatoryType.Conditional}}};ConditionPanelViewModel.prototype.clauseDrop=function(dragNode,targetNode){if(dragNode.treeView===this.clauseDesignerModel.clausesTreeView){if(dragNode===targetNode||dragNode.isDecendantOf(targetNode)){alert(this._filter('translate')('ErrorMsg_MoveConditionToBeItsOwnChild'))}else{var hitCondition=targetNode.tag;dragNode.parent.tag.SubClauses.splice(dragNode.parent.tag.SubClauses.indexOf(dragNode.tag),1);if(hitCondition.Type===Intelledox.Model.ClauseType.Comparison){hitCondition=targetNode.parent.tag}hitCondition.Add(dragNode.tag);this._editorViewModel.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(hitCondition)}}else{var childObject=null;var newCond=null;var parent=null;if(this._currentNode instanceof Intelledox.QAWizard.Design.Page||this._currentNode instanceof Intelledox.QAWizard.Design.FinishPage){childObject=this._currentPage}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Question||this._currentNode instanceof Intelledox.QAWizard.Design.TabGroup||this._currentNode instanceof Intelledox.QAWizard.Design.TabPage||this._currentNode instanceof Intelledox.QAWizard.Design.Section||this._currentNode instanceof Intelledox.QAWizard.Design.Column||this._currentNode instanceof Intelledox.QAWizard.Design.DocumentTemplate||this._currentNode instanceof Intelledox.QAWizard.Design.StateTransition||this._currentNode instanceof Intelledox.QAWizard.Design.Escalation||this._currentNode instanceof Intelledox.QAWizard.Design.Action||this._currentNode instanceof Intelledox.QAWizard.Design.FragmentReference){childObject=this._currentNode}else if(this._currentNode instanceof Intelledox.QAWizard.Design.Answer){childObject=this._currentNode.Question}if(dragNode.tag instanceof Intelledox.QAWizard.Design.Question){if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic){alert(this._filter('translate')('ErrorMsg_InvalidParentGroupLogic'))}else if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){alert(this._filter('translate')('ErrorMsg_InvalidParentDatasource'))}else if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.AddressPrompt){alert(this._filter('translate')('ErrorMsg_InvalidParentAddress'))}else if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable){alert(this._filter('translate')('ErrorMsg_InvalidParentVariable'))}else if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label)){parent=dragNode.tag;newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Equals,"",Intelledox.QAWizard.Design.ConditionParentType.Reference)}else if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic){parent=dragNode.tag;newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Is,"True",Intelledox.QAWizard.Design.ConditionParentType.Reference)}else if(dragNode.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button){parent=dragNode.tag;newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Is,"Selected",Intelledox.QAWizard.Design.ConditionParentType.Reference)}else{alert(this._filter('translate')('ErrorMsg_InvalidParentQuestion'))}}else if(dragNode.tag instanceof Intelledox.QAWizard.Design.Answer){parent=dragNode.parent.tag;if(dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Button){newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Is,"Selected",Intelledox.QAWizard.Design.ConditionParentType.Reference)}else if(dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic){newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.QuestionGuid,dragNode.tag.AnswerGuid,Intelledox.QAWizard.Design.ClauseComparisonType.Is,"Selected",Intelledox.QAWizard.Design.ConditionParentType.Reference)}else if(dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||(dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Label)){newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Equals,"",Intelledox.QAWizard.Design.ConditionParentType.Reference)}else if(dragNode.parent.tag.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.SimpleLogic){newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.QuestionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Is,"True",Intelledox.QAWizard.Design.ConditionParentType.Reference)}else{newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.QuestionGuid,dragNode.tag.AnswerGuid,Intelledox.QAWizard.Design.ClauseComparisonType.Equals,"",Intelledox.QAWizard.Design.ConditionParentType.Reference)}}else if(dragNode.tag instanceof Intelledox.QAWizard.Design.Action){parent=dragNode.tag;newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.ActionGuid,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Is,"Success",Intelledox.QAWizard.Design.ConditionParentType.Action)}else if(dragNode.tag instanceof Intelledox.QAWizard.Design.AvailableInput){parent=dragNode.tag;newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.routingElementTypeId,Intelledox.Common.ConstantValues.GUID_EMPTY,Intelledox.QAWizard.Design.ClauseComparisonType.Equals,"",Intelledox.QAWizard.Design.ConditionParentType.Input)}else if(dragNode.tag instanceof Intelledox.QAWizard.Design.FragmentOutput){parent=dragNode.tag;newCond=new Intelledox.QAWizard.Design.Condition(Intelledox.Model.ClauseType.Comparison,parent.Parent.FragmentGuid,parent.OutputGuid,Intelledox.QAWizard.Design.ClauseComparisonType.Equals,"",Intelledox.QAWizard.Design.ConditionParentType.FragmentOutput)}if(newCond!=null){if(((parent instanceof Intelledox.QAWizard.Design.Question&&this.availableQuestions.indexOf(parent)>-1)||(parent instanceof Intelledox.QAWizard.Design.Action&&this.availableActions.indexOf(parent)>-1))||(parent instanceof Intelledox.QAWizard.Design.AvailableInput)||(parent instanceof Intelledox.QAWizard.Design.FragmentOutput)){if(targetNode==null){newCond=this._currentConditions.Add(newCond);this.checkMandatory()}else{if(targetNode.tag.Type===Intelledox.Model.ClauseType.AllOf||targetNode.tag.Type===Intelledox.Model.ClauseType.AnyOf){targetNode.tag.SubClauses.push(newCond)}else if(targetNode.parent!=null){targetNode.parent.tag.SubClauses.push(newCond)}else{newCond=this._currentConditions.Add(newCond)}}this._editorViewModel.wizChanged=true;this.clauseDesignerModel.fillClauseViewFromExisting();this.clauseDesignerModel.selectClauseNode(newCond);this.updateConditionTypeDropdownDetails()}else{alert(this._filter('translate')('ErrorMsg_InvalidParent'))}}}};ConditionPanelViewModel.prototype.setReferenceQuestion=function(refQuestion){this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.Reference;this.selectedQuestionGuid=refQuestion.QuestionGuid};ConditionPanelViewModel.prototype.setReferenceQuestionAnswer=function(refQuestion,refAnswer){this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.Reference;this.selectedQuestionGuid=refQuestion.QuestionGuid;this.selectedAnswerGuid=refAnswer.AnswerGuid};ConditionPanelViewModel.prototype.setReferenceInput=function(refInput){this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.Input;this.selectedInput=refInput.routingElementTypeId};ConditionPanelViewModel.prototype.setReferenceOutput=function(refOutput){this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.FragmentOutput;this.selectedFragment=refOutput.Parent.ObjectId;this.selectedFragmentOutput=refOutput.OutputGuid};ConditionPanelViewModel.prototype.setReferenceFragment=function(refFragment){this.selectedParentType=Intelledox.QAWizard.Design.ConditionParentType.FragmentOutput;this.selectedFragment=refFragment.ObjectId};return ConditionPanelViewModel}());Design.ConditionPanelViewModel=ConditionPanelViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var UIViewModel=(function(){function UIViewModel(settings){var vm=this;this._settings=settings;this._showTreeView=settings.isTreeViewVisible;this._showPreview=settings.isPreviewVisible;this._leftPanelSize=settings.leftPanelSize;this._rightPanelSize=settings.rightPanelSize;this._toolboxSelection=settings.toolboxSelection;this._tempShowTreeView=false;var $body=angular.element(document.body);var $rootScope=$body.injector().get('$rootScope');$rootScope.$on('showTempTreeView',function(){vm._tempShowTreeView=true});$rootScope.$on('hideTempTreeView',function(){vm._tempShowTreeView=false})}Object.defineProperty(UIViewModel.prototype,"showTreeView",{get:function(){return this._showTreeView},set:function(value){this._showTreeView=value;this._settings.isTreeViewVisible=value},enumerable:true,configurable:true});Object.defineProperty(UIViewModel.prototype,"tempShowTreeView",{get:function(){return this._tempShowTreeView},set:function(value){this._tempShowTreeView=value},enumerable:true,configurable:true});Object.defineProperty(UIViewModel.prototype,"showPreview",{get:function(){return this._showPreview},set:function(value){this._showPreview=value;this._settings.isPreviewVisible=value},enumerable:true,configurable:true});Object.defineProperty(UIViewModel.prototype,"leftPanelSize",{get:function(){return this._leftPanelSize},set:function(value){this._leftPanelSize=value;this._settings.leftPanelSize=value},enumerable:true,configurable:true});Object.defineProperty(UIViewModel.prototype,"rightPanelSize",{get:function(){return this._rightPanelSize},set:function(value){this._rightPanelSize=value;this._settings.rightPanelSize=value},enumerable:true,configurable:true});Object.defineProperty(UIViewModel.prototype,"toolboxSelection",{get:function(){return this._toolboxSelection},set:function(value){this._toolboxSelection=value;this._settings.toolboxSelection=value},enumerable:true,configurable:true});return UIViewModel}());Design.UIViewModel=UIViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var GeolocationAnswerPropertiesViewModel=(function(_super){__extends(GeolocationAnswerPropertiesViewModel,_super);function GeolocationAnswerPropertiesViewModel(editorViewModel,question,answer,$filter,lists){var _this=_super.call(this,editorViewModel,question,answer,$filter,lists)||this;_this.availableFields=[];_this._filterLocal=$filter;_this._editor=editorViewModel;_this._geolocationAnswer=answer;if(System.String.IsNullOrEmpty(_this._geolocationAnswer.DataField)){_this._geolocationAnswer.DataField="latitude,longitude"}_this.loadFields();return _this}Object.defineProperty(GeolocationAnswerPropertiesViewModel.prototype,"field",{get:function(){return this._geolocationAnswer.DataField},set:function(value){this._geolocationAnswer.DataField=value;this._editor.wizChanged=true},enumerable:true,configurable:true});GeolocationAnswerPropertiesViewModel.prototype.loadFields=function(){this.availableFields.push({name:this._filterLocal('translate')('LatitudeLongitude'),value:"latitude,longitude"});this.availableFields.push({name:this._filterLocal('translate')('Latitude'),value:"latitude"});this.availableFields.push({name:this._filterLocal('translate')('Longitude'),value:"longitude"})};return GeolocationAnswerPropertiesViewModel}(Design.AnswerPropertiesViewModel));Design.GeolocationAnswerPropertiesViewModel=GeolocationAnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var DataSourceAnswerPropertiesViewModel=(function(_super){__extends(DataSourceAnswerPropertiesViewModel,_super);function DataSourceAnswerPropertiesViewModel(editorViewModel,wizard,question,answer,$filter,lists){var _this=_super.call(this,editorViewModel,question,answer,$filter,lists)||this;_this.isImagePropertiesVisible=false;_this.isConvertVisible=false;_this.isConvertPatternVisible=false;_this.isFormulaVisible=false;_this.availableFieldWidth=0;_this.availableFields=[];_this._filterLocal=$filter;_this._editor=editorViewModel;_this._wizard=wizard;_this._listManager=lists;_this._dataQuestion=question;_this._dataAnswer=answer;_this.imageProperties=new Design.ImagePropertiesViewModel($filter,editorViewModel,answer.ImageSettings);_this.imageProperties.isAlternativeTextVisible=true;_this.loadConvertDataTypes();if(_this._dataAnswer.DataConvertType===Intelledox.QAWizard.Design.DataConvertType.Image){_this.isImagePropertiesVisible=true}if(_this._dataAnswer.DataField==="[Formula]"||_this._dataAnswer.DataField==="[Aggregate]"){_this.isFormulaVisible=true}_this.loadFields();_this.showDataConvertOptions();return _this}Object.defineProperty(DataSourceAnswerPropertiesViewModel.prototype,"dataField",{get:function(){return this._dataField},set:function(value){if(this.compareAnswerNameAndField(this._dataAnswer.Name,this._dataAnswer.DataField,value,true)){this._dataAnswer.Name=this.stripAnswerField(value);this.updateTreeName(this._dataAnswer.Name)}this._dataField=value;this._dataAnswer.DataField=value;this._editor.wizChanged=true;this.isFormulaVisible=(value==="[Formula]"||value==="[Aggregate]");this.showDataConvertOptions()},enumerable:true,configurable:true});Object.defineProperty(DataSourceAnswerPropertiesViewModel.prototype,"convertType",{get:function(){return this._dataAnswer.DataConvertType},set:function(value){this._dataAnswer.DataConvertType=value;this._editor.wizChanged=true;this.isImagePropertiesVisible=(value===Intelledox.QAWizard.Design.DataConvertType.Image);this.showDataConvertOptions()},enumerable:true,configurable:true});Object.defineProperty(DataSourceAnswerPropertiesViewModel.prototype,"convertPattern",{get:function(){return this._dataAnswer.DataConvertPattern},set:function(value){this._dataAnswer.DataConvertPattern=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(DataSourceAnswerPropertiesViewModel.prototype,"formula",{get:function(){return this._dataAnswer.Formula},set:function(value){this._dataAnswer.Formula=value;this._editor.wizChanged=true},enumerable:true,configurable:true});DataSourceAnswerPropertiesViewModel.prototype.loadFields=function(){var vm=this;if(this._dataQuestion.DataSourceHierarchyGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.availableFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:''});this.availableFields.push({name:'['+this._filterLocal('translate')('Formula')+']',value:'[Formula]'});if(this._dataQuestion.SelectionType===Intelledox.Model.SelectionType.Multiple){this.availableFields.push({name:'['+this._filterLocal('translate')('Aggregate')+']',value:'[Aggregate]'})}Design.HierarchyHelper.getDataFields(this._wizard,this._listManager,this._dataQuestion,this.availableFieldWidth,true).then(function(fieldItems){vm.availableFields.push.apply(vm.availableFields,fieldItems);vm._dataField=vm._dataAnswer.DataField;vm.showDataConvertOptions()})}else if(this._dataQuestion.IsQARepeater){this.availableFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:''});this.availableFields.push({name:'['+this._filterLocal('translate')('Formula')+']',value:'[Formula]'});if(this._dataQuestion.SelectionType===Intelledox.Model.SelectionType.Multiple){this.availableFields.push({name:'['+this._filterLocal('translate')('Aggregate')+']',value:'[Aggregate]'})}this.availableFields.push.apply(vm.availableFields,Design.QARepeatHelper.getDataFields(this._filterLocal,this._wizard,this._dataQuestion));vm._dataField=vm._dataAnswer.DataField;vm.showDataConvertOptions()}else if(this._dataQuestion.DataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(this._dataQuestion.DataSourceGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY&&this._dataQuestion.DataObjectGuid!==Intelledox.Common.ConstantValues.GUID_EMPTY){this.availableFields.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:''});this.availableFields.push({name:'['+this._filterLocal('translate')('Formula')+']',value:'[Formula]'});if(this._dataQuestion.SelectionType===Intelledox.Model.SelectionType.Multiple){this.availableFields.push({name:'['+this._filterLocal('translate')('Aggregate')+']',value:'[Aggregate]'})}this._listManager.dataFieldsList(this._dataQuestion.DataObjectGuid,this.availableFieldWidth,true,"").then(function(fieldItems){vm.availableFields.push.apply(vm.availableFields,fieldItems);vm._dataField=vm._dataAnswer.DataField;vm.showDataConvertOptions()})}}};DataSourceAnswerPropertiesViewModel.prototype.loadConvertDataTypes=function(){this.availableConverts=[];this.availableConverts.push({name:this._filterLocal('translate')('NoneWithBrackets'),value:Intelledox.QAWizard.Design.DataConvertType.None});this.availableConverts.push({name:this._filterLocal('translate')('DateString'),value:Intelledox.QAWizard.Design.DataConvertType.Date});this.availableConverts.push({name:this._filterLocal('translate')('Number'),value:Intelledox.QAWizard.Design.DataConvertType.Number});this.availableConverts.push({name:this._filterLocal('translate')('Image'),value:Intelledox.QAWizard.Design.DataConvertType.Image});this.availableConverts.push({name:this._filterLocal('translate')('Text'),value:Intelledox.QAWizard.Design.DataConvertType.Text});this.availableConverts.push({name:this._filterLocal('translate')('HtmlRichText'),value:Intelledox.QAWizard.Design.DataConvertType.Html})};DataSourceAnswerPropertiesViewModel.prototype.showDataConvertOptions=function(){if(System.String.IsNullOrEmpty(this._dataAnswer.DataField)||Intelledox.Common.Functions.EqualsIgnoreCase(this._dataAnswer.DataField,"[formula]")||Intelledox.Common.Functions.EqualsIgnoreCase(this._dataAnswer.DataField,"[aggregate]")){this.isConvertVisible=false}else{this.isConvertVisible=true;if(this._dataAnswer.DataConvertType===Intelledox.QAWizard.Design.DataConvertType.Date){this.isConvertPatternVisible=true}else{this.isConvertPatternVisible=false;this._dataAnswer.DataConvertPattern=''}}};DataSourceAnswerPropertiesViewModel.prototype.compareAnswerNameAndField=function(answerName,answerField,newAnswerField,exactMatch){if(answerField==null)answerField="";if((this._dataQuestion.DataSourceHierarchyGuid===Intelledox.Common.ConstantValues.GUID_EMPTY&&this._dataQuestion.DataSourceGuid===Intelledox.Common.ConstantValues.GUID_EMPTY)||this._listManager.isCalculatedDataField(newAnswerField)){return false}answerField=this.stripAnswerField(answerField);if(System.String.StartsWith(answerName,System.String.Format(this._filterLocal('translate')('NewObjectFormat'),this._filterLocal('translate')('Answer'),""))){answerName=""}if(System.String.IsNullOrEmpty(answerName)){return true}else if(exactMatch){return Intelledox.Common.Functions.EqualsIgnoreCase(answerField,answerName)}else{return System.String.StartsWithIgnoreCase(answerField,answerName)}};DataSourceAnswerPropertiesViewModel.prototype.stripAnswerField=function(field){field=field.replace("[","");field=field.replace("]","");field=field.replace("_"," ");if(field.indexOf("\\")>-1){field=this.stripXMLPath(field)}return field};DataSourceAnswerPropertiesViewModel.prototype.stripXMLPath=function(xmlValue){var xmlValues=xmlValue.split("\\");return xmlValues[xmlValues.length-1]};return DataSourceAnswerPropertiesViewModel}(Design.AnswerPropertiesViewModel));Design.DataSourceAnswerPropertiesViewModel=DataSourceAnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var VariableAnswerPropertiesViewModel=(function(_super){__extends(VariableAnswerPropertiesViewModel,_super);function VariableAnswerPropertiesViewModel(editorViewModel,question,answer,$filter,designApi,lists){var _this=_super.call(this,editorViewModel,question,answer,$filter,lists)||this;_this._hasLoadedVariables=false;_this.isImagePropertiesVisible=false;_this.availableVariables=[];_this._filterLocal=$filter;_this._editor=editorViewModel;_this._variableAnswer=answer;_this.imageProperties=new Design.ImagePropertiesViewModel($filter,editorViewModel,answer.ImageSettings);_this.imageProperties.isAlternativeTextVisible=true;designApi.getVariables().then(function(data){return _this.loadVariables(data)});return _this}Object.defineProperty(VariableAnswerPropertiesViewModel.prototype,"variable",{get:function(){if(!this._hasLoadedVariables){return undefined}return this._variableAnswer.DataField},set:function(value){this._variableAnswer.DataField=value;this._editor.wizChanged=true;if(value!=='[Formula]'){this._variableAnswer.Formula=''}this.checkImageProperties()},enumerable:true,configurable:true});Object.defineProperty(VariableAnswerPropertiesViewModel.prototype,"formula",{get:function(){return Design.TranslationHelper.TranslationToKeywordValue(this._filterLocal,this._variableAnswer.Formula)},set:function(value){this._variableAnswer.Formula=Design.TranslationHelper.TranslationToKeywordValue(this._filterLocal,value);this._editor.wizChanged=true},enumerable:true,configurable:true});VariableAnswerPropertiesViewModel.prototype.loadVariables=function(data){this.availableVariables.push({name:this.variableToTranslation('[Formula]'),value:new Intelledox.Model.Variable('[Formula]',0)});for(var i=0;i<data.length;i++){var item=data[i];this.availableVariables.push({name:this.variableToTranslation(item.name),value:item})}this._hasLoadedVariables=true;this.checkImageProperties()};VariableAnswerPropertiesViewModel.prototype.checkImageProperties=function(){for(var i=0;i<this.availableVariables.length;i++){if(this._variableAnswer.DataField===this.availableVariables[i].name){this.isImagePropertiesVisible=(this.availableVariables[i].value.typeId===Intelledox.Model.ValidationType.Image);return}}};VariableAnswerPropertiesViewModel.prototype.variableToTranslation=function(variable){switch(variable){case"User ID":return this._filterLocal('translate')('UserId');case"User Name":return this._filterLocal('translate')('UserName');case"User Prefix":return this._filterLocal('translate')('UserPrefix');case"User First Name":return this._filterLocal('translate')('UserFirstName');case"User Last Name":return this._filterLocal('translate')('UserLastName');case"User Full Name":return this._filterLocal('translate')('UserFullName');case"User Salutation":return this._filterLocal('translate')('UserSalutation');case"User Title":return this._filterLocal('translate')('UserTitle');case"User Organisation":return this._filterLocal('translate')('UserOrganisation');case"User Phone Number":return this._filterLocal('translate')('UserPhoneNumber');case"User Fax Number":return this._filterLocal('translate')('UserFaxNumber');case"User Email Address":return this._filterLocal('translate')('UserEmailAddress');case"User Street Address 1":return this._filterLocal('translate')('UserStreetAddress1');case"User Street Address 2":return this._filterLocal('translate')('UserStreetAddress2');case"User Street Suburb":return this._filterLocal('translate')('UserStreetSuburb');case"User Street State":return this._filterLocal('translate')('UserStreetState');case"User Street Postcode":return this._filterLocal('translate')('UserStreetPostcode');case"User Street Country":return this._filterLocal('translate')('UserStreetCountry');case"User Postal Address 1":return this._filterLocal('translate')('UserPostalAddress1');case"User Postal Address 2":return this._filterLocal('translate')('UserPostalAddress2');case"User Postal Suburb":return this._filterLocal('translate')('UserPostalSuburb');case"User Postal State":return this._filterLocal('translate')('UserPostalState');case"User Postal Postcode":return this._filterLocal('translate')('UserPostalPostcode');case"User Postal Country":return this._filterLocal('translate')('UserPostalCountry');case"User Group ID":return this._filterLocal('translate')('UserGroupId');case"User Group Organisation":return this._filterLocal('translate')('UserGroupOrganisation');case"User Group Phone Number":return this._filterLocal('translate')('UserGroupPhoneNumber');case"User Group Fax Number":return this._filterLocal('translate')('UserGroupFaxNumber');case"User Group Email Address":return this._filterLocal('translate')('UserGroupEmailAddress');case"User Group Street Address 1":return this._filterLocal('translate')('UserGroupStreetAddress1');case"User Group Street Address 2":return this._filterLocal('translate')('UserGroupStreetAddress2');case"User Group Street Suburb":return this._filterLocal('translate')('UserGroupStreetSuburb');case"User Group Street State":return this._filterLocal('translate')('UserGroupStreetState');case"User Group Street Postcode":return this._filterLocal('translate')('UserGroupStreetPostcode');case"User Group Street Country":return this._filterLocal('translate')('UserGroupStreetCountry');case"User Group Postal Address 1":return this._filterLocal('translate')('UserGroupPostalAddress1');case"User Group Postal Address 2":return this._filterLocal('translate')('UserGroupPostalAddress2');case"User Group Postal Suburb":return this._filterLocal('translate')('UserGroupPostalSuburb');case"User Group Postal State":return this._filterLocal('translate')('UserGroupPostalState');case"User Group Postal Postcode":return this._filterLocal('translate')('UserGroupPostalPostcode');case"User Group Postal Country":return this._filterLocal('translate')('UserGroupPostalCountry');case"User Language":return this._filterLocal('translate')('UserLanguage');case"User Language-Culture":return this._filterLocal('translate')('UserLanguageCulture');case"System Date":return this._filterLocal('translate')('SystemDate');case"System Time":return this._filterLocal('translate')('SystemTime');case"UTC Date":return this._filterLocal('translate')('UtcDateString');case"UTC Time":return this._filterLocal('translate')('UtcTimeString');case"Date":return this._filterLocal('translate')('DateString');case"Time":return this._filterLocal('translate')('TimeString');case"Creator ID":return this._filterLocal('translate')('CreatorId');case"Creator Name":return this._filterLocal('translate')('CreatorName');case"Creator Prefix":return this._filterLocal('translate')('CreatorPrefix');case"Creator First Name":return this._filterLocal('translate')('CreatorFirstName');case"Creator Last Name":return this._filterLocal('translate')('CreatorLastName');case"Creator Full Name":return this._filterLocal('translate')('CreatorFullName');case"Creator Salutation":return this._filterLocal('translate')('CreatorSalutation');case"Creator Title":return this._filterLocal('translate')('CreatorTitle');case"Creator Organisation":return this._filterLocal('translate')('CreatorOrganisation');case"Creator Phone Number":return this._filterLocal('translate')('CreatorPhoneNumber');case"Creator Fax Number":return this._filterLocal('translate')('CreatorFaxNumber');case"Creator Email Address":return this._filterLocal('translate')('CreatorEmailAddress');case"Creator Street Address 1":return this._filterLocal('translate')('CreatorStreetAddress1');case"Creator Street Address 2":return this._filterLocal('translate')('CreatorStreetAddress2');case"Creator Street Suburb":return this._filterLocal('translate')('CreatorStreetSuburb');case"Creator Street State":return this._filterLocal('translate')('CreatorStreetState');case"Creator Street Postcode":return this._filterLocal('translate')('CreatorStreetPostcode');case"Creator Street Country":return this._filterLocal('translate')('CreatorStreetCountry');case"Creator Postal Address 1":return this._filterLocal('translate')('CreatorPostalAddress1');case"Creator Postal Address 2":return this._filterLocal('translate')('CreatorPostalAddress2');case"Creator Postal Suburb":return this._filterLocal('translate')('CreatorPostalSuburb');case"Creator Postal State":return this._filterLocal('translate')('CreatorPostalState');case"Creator Postal Postcode":return this._filterLocal('translate')('CreatorPostalPostcode');case"Creator Postal Country":return this._filterLocal('translate')('CreatorPostalCountry');case"Row Count":return this._filterLocal('translate')('RowCount');case"Row Number":return this._filterLocal('translate')('RowNumber');case"Run ID":return this._filterLocal('translate')('RunId');case"State Name":return this._filterLocal('translate')('StateName');case Intelledox.Common.ConstantValues.VARIABLE_CONNECTED:return this._filterLocal('translate')('ConnectedTrueFalse');case"[Formula]":return"["+this._filterLocal('translate')('Formula')+"]";default:return variable}};return VariableAnswerPropertiesViewModel}(Design.AnswerPropertiesViewModel));Design.VariableAnswerPropertiesViewModel=VariableAnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var GroupLogicAnswerPropertiesViewModel=(function(_super){__extends(GroupLogicAnswerPropertiesViewModel,_super);function GroupLogicAnswerPropertiesViewModel(editorViewModel,question,answer,$filter,lists){var _this=_super.call(this,editorViewModel,question,answer,$filter,lists)||this;_this._isDefaultQuestionReference=false;_this.availableQuestions=[];_this.availableAnswers=[];_this.isAnswerVisible=false;_this._editor=editorViewModel;_this._filterLocal=$filter;_this._logicAnswer=answer;_this._logicQuestion=question;if(_this.isMulti){_this._isDefaultQuestionReference=_this._logicAnswer.DefaultQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY}else{_this._isDefaultQuestionReference=_this._logicAnswer.Question.DefaultQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY}if(_this._isDefaultQuestionReference){_this.fillDefaultQuestionDropdown()}return _this}Object.defineProperty(GroupLogicAnswerPropertiesViewModel.prototype,"isMulti",{get:function(){return(this._logicAnswer.Question.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelect||this._logicAnswer.Question.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelectToggleButton)},enumerable:true,configurable:true});Object.defineProperty(GroupLogicAnswerPropertiesViewModel.prototype,"isDropdown",{get:function(){return this._logicAnswer.Question.DisplayType===Intelledox.Model.QuestionDisplayType.Dropdown},enumerable:true,configurable:true});Object.defineProperty(GroupLogicAnswerPropertiesViewModel.prototype,"Name",{get:function(){return this._logicAnswer.Name},set:function(value){this._logicAnswer.Name=value;this._editor.wizChanged=true;this.updateTreeName(value);if(System.String.IsNullOrEmpty(this._logicAnswer.DisplayText)){this._logicAnswer.DisplayText=value}},enumerable:true,configurable:true});Object.defineProperty(GroupLogicAnswerPropertiesViewModel.prototype,"DisplayText",{get:function(){return this._logicAnswer.DisplayText},set:function(value){this._logicAnswer.DisplayText=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GroupLogicAnswerPropertiesViewModel.prototype,"TagValue",{get:function(){return this._logicAnswer.TagValue},set:function(value){this._logicAnswer.TagValue=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GroupLogicAnswerPropertiesViewModel.prototype,"IsSelected",{get:function(){if(this.isMulti){if(this._logicAnswer.DefaultQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){return false}else{return this._logicAnswer.IsDefaultSelected}}else{if(this._logicAnswer.Question.DefaultQuestionReference!==Intelledox.Common.ConstantValues.GUID_EMPTY){return false}else if(this._logicAnswer.Question.DefaultValue!==Intelledox.Common.ConstantValues.GUID_EMPTY){if(this._logicAnswer.Question.DefaultValue===this._logicAnswer.AnswerGuid){return true}}}return false},set:function(value){if(this.isMulti){this._logicAnswer.DefaultQuestionReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this._logicAnswer.IsDefaultSelected=value}else{this._logicAnswer.Question.DefaultQuestionReference=Intelledox.Common.ConstantValues.GUID_EMPTY;this._logicAnswer.Question.DefaultValue=value?this._logicAnswer.AnswerGuid:''}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GroupLogicAnswerPropertiesViewModel.prototype,"IsDefaultQuestionReference",{get:function(){return this._isDefaultQuestionReference},set:function(value){this._isDefaultQuestionReference=value;if(this.isMulti){this._logicAnswer.IsDefaultSelected=false}if(value&&this.availableQuestions.length===0){this.fillDefaultQuestionDropdown()}if(!value){this.selectedQuestionGuid=Intelledox.Common.ConstantValues.GUID_EMPTY}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GroupLogicAnswerPropertiesViewModel.prototype,"selectedQuestionGuid",{get:function(){if(this.isMulti){return this._logicAnswer.DefaultQuestionReference}else{return this._logicAnswer.Question.DefaultQuestionReference}},set:function(value){if(this.isMulti){this._logicAnswer.DefaultQuestionReference=value}else{this._logicAnswer.Question.DefaultQuestionReference=value}this.availableAnswers=[];if(value!=null&&value!==Intelledox.Common.ConstantValues.GUID_EMPTY){var currentQuestion=this.findSelectedQuestion(value);if(currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable||currentQuestion.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource){this.fillDefaultAnswerDropdown(currentQuestion);this.isAnswerVisible=true}else{this.isAnswerVisible=false}}else{this.isAnswerVisible=false}this.selectedAnswerGuid=Intelledox.Common.ConstantValues.GUID_EMPTY;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GroupLogicAnswerPropertiesViewModel.prototype,"selectedAnswerGuid",{get:function(){if(this.isMulti){return this._logicAnswer.DefaultAnswerReference}else{return this._logicAnswer.Question.DefaultValue}},set:function(value){if(this.isMulti){this._logicAnswer.DefaultAnswerReference=value}else{this._logicAnswer.Question.DefaultValue=value}this._editor.wizChanged=true},enumerable:true,configurable:true});GroupLogicAnswerPropertiesViewModel.prototype.fillDefaultQuestionDropdown=function(){this.availableQuestions=[];this.availableQuestions.push(new Intelledox.QAWizard.Design.Question(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filterLocal('translate')('NoneWithBrackets')));for(var pageIndex=0;pageIndex<this._editor.wizard.Pages.length;pageIndex++){var p=this._editor.wizard.Pages[pageIndex];for(var questionIndex=0;questionIndex<p.Questions.length;questionIndex++){var q=p.Questions[questionIndex];if(q===this._logicQuestion){break}if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.UserPrompt||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable){if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.GroupLogic&&(q.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelect||q.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelectToggleButton)){}else if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource&&q.SelectionType===Intelledox.Model.SelectionType.Multiple){}else{this.availableQuestions.push(q);if((this.isMulti&&q.QuestionGuid===this._logicAnswer.DefaultQuestionReference)||(!this.isMulti&&this._logicQuestion.DefaultQuestionReference===q.QuestionGuid)){if(q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Datasource||q.QuestionTypeID===Intelledox.QAWizard.Design.QuestionType.QuestionTypeEnum.Variable){this.isAnswerVisible=true;this.fillDefaultAnswerDropdown(q)}}}}}if(p.PageGuid===this._logicQuestion.Page.PageGuid){break}}};GroupLogicAnswerPropertiesViewModel.prototype.fillDefaultAnswerDropdown=function(q){this.availableAnswers=[];this.availableAnswers.push(new Intelledox.QAWizard.Design.Answer(Intelledox.Common.ConstantValues.GUID_EMPTY,this._filterLocal('translate')('NoneWithBrackets')));for(var answerIndex=0;answerIndex<q.Answers.length;answerIndex++){this.availableAnswers.push(q.Answers[answerIndex])}};GroupLogicAnswerPropertiesViewModel.prototype.findSelectedQuestion=function(questionGuid){for(var i=0;i<this.availableQuestions.length;i++){if(questionGuid===this.availableQuestions[i].QuestionGuid){return this.availableQuestions[i]}}return null};return GroupLogicAnswerPropertiesViewModel}(Design.AnswerPropertiesViewModel));Design.GroupLogicAnswerPropertiesViewModel=GroupLogicAnswerPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var ColumnPropertiesViewModel=(function(_super){__extends(ColumnPropertiesViewModel,_super);function ColumnPropertiesViewModel(editorViewModel,section,column,$filter,lists){var _this=_super.call(this)||this;_this._editorViewModel=editorViewModel;_this._section=section;_this._column=column;_this.styleModel=new Design.StylePropertiesViewModel(editorViewModel,column,$filter,lists);return _this}Object.defineProperty(ColumnPropertiesViewModel.prototype,"title",{get:function(){return this._column.Title},set:function(value){this._column.Title=value;this._editorViewModel.wizChanged=true;this._editorViewModel.treeView.selectedNode.text=value},enumerable:true,configurable:true});Object.defineProperty(ColumnPropertiesViewModel.prototype,"helpText",{get:function(){return this._column.HelpText},set:function(value){this._column.HelpText=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ColumnPropertiesViewModel.prototype,"width",{get:function(){if(this._column.Width===0){return''}return this._column.Width.toString()},set:function(value){this._column.Width=parseInt(value,10);if(isNaN(this._column.Width)){this._column.Width=0}this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ColumnPropertiesViewModel.prototype,"showWidth",{get:function(){return(this._section.Columns.length>1)},enumerable:true,configurable:true});Object.defineProperty(ColumnPropertiesViewModel.prototype,"widthType",{get:function(){return this._column.WidthType.toString()},set:function(value){this._column.WidthType=parseInt(value,10);this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(ColumnPropertiesViewModel.prototype,"isRepeated",{get:function(){return this._section.IsRepeated},enumerable:true,configurable:true});Object.defineProperty(ColumnPropertiesViewModel.prototype,"groupBy",{get:function(){return this._column.GroupBy},set:function(value){this._column.GroupBy=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});return ColumnPropertiesViewModel}(Design.PropertiesViewModel));Design.ColumnPropertiesViewModel=ColumnPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var RichTextPropertiesViewModel=(function(_super){__extends(RichTextPropertiesViewModel,_super);function RichTextPropertiesViewModel(editorViewModel,question,wizard,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._editor=editorViewModel;_this._richText=question;_this._wizard=wizard;return _this}Object.defineProperty(RichTextPropertiesViewModel.prototype,"TextRows",{get:function(){if(this._richText.TextRows===0){return''}return this._richText.TextRows.toString()},set:function(value){this._richText.TextRows=parseInt(value,10);if(isNaN(this._richText.TextRows)){this._richText.TextRows=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RichTextPropertiesViewModel.prototype,"HasBullets",{get:function(){return this._richText.ShowBullets},set:function(value){this._richText.ShowBullets=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RichTextPropertiesViewModel.prototype,"HasCopyAndPaste",{get:function(){return this._richText.ShowCopyAndPaste},set:function(value){this._richText.ShowCopyAndPaste=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RichTextPropertiesViewModel.prototype,"HasHyperlink",{get:function(){return this._richText.ShowHyperlink},set:function(value){this._richText.ShowHyperlink=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RichTextPropertiesViewModel.prototype,"HasSpellCheck",{get:function(){return this._richText.ShowSpellCheck},set:function(value){this._richText.ShowSpellCheck=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RichTextPropertiesViewModel.prototype,"HasStyles",{get:function(){return this._richText.ShowStyles},set:function(value){this._richText.ShowStyles=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RichTextPropertiesViewModel.prototype,"HasTables",{get:function(){return this._richText.ShowTables},set:function(value){this._richText.ShowTables=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RichTextPropertiesViewModel.prototype,"HasProtectedFields",{get:function(){return this._richText.ShowProtectedFields},set:function(value){this._richText.ShowProtectedFields=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(RichTextPropertiesViewModel.prototype,"ShowStyles",{get:function(){return this._wizard.Documents.length>0},enumerable:true,configurable:true});return RichTextPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.RichTextPropertiesViewModel=RichTextPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var GroupLogicPropertiesViewModel=(function(_super){__extends(GroupLogicPropertiesViewModel,_super);function GroupLogicPropertiesViewModel(editorViewModel,question,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this.DisplayTypes=[];_this.SelectionTypes=[{name:'SingleAnswer',value:Intelledox.Model.SelectionType.Single},{name:'MultipleAnswers',value:Intelledox.Model.SelectionType.Multiple}];_this.DisplayDirections=[{name:'Vertical',value:Intelledox.Model.DisplayDirection.Vertical},{name:'Horizontal',value:Intelledox.Model.DisplayDirection.Horizontal},{name:'TwoColumn',value:Intelledox.Model.DisplayDirection.Column2},{name:'ThreeColumn',value:Intelledox.Model.DisplayDirection.Column3},{name:'FourColumn',value:Intelledox.Model.DisplayDirection.Column4}];_this._filterLocal=$filter;_this._editor=editorViewModel;_this._groupLogic=question;_this.LoadDisplayTypes();return _this}Object.defineProperty(GroupLogicPropertiesViewModel.prototype,"SelectionType",{get:function(){if(this._groupLogic.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelect||this._groupLogic.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelectToggleButton){return Intelledox.Model.SelectionType.Multiple}return Intelledox.Model.SelectionType.Single},set:function(value){if(value===Intelledox.Model.SelectionType.Single){this._groupLogic.DisplayType=Intelledox.Model.QuestionDisplayType.MultiChoice}else{this._groupLogic.DisplayType=Intelledox.Model.QuestionDisplayType.MultiSelect}this.LoadDisplayTypes();this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GroupLogicPropertiesViewModel.prototype,"DisplayType",{get:function(){return this._groupLogic.DisplayType},set:function(value){this._groupLogic.DisplayType=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GroupLogicPropertiesViewModel.prototype,"DisplayDirection",{get:function(){return this._groupLogic.DisplayDirection},set:function(value){this._groupLogic.DisplayDirection=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(GroupLogicPropertiesViewModel.prototype,"Watermark",{get:function(){return this._groupLogic.Watermark},set:function(value){this._groupLogic.Watermark=value;this._editor.wizChanged=true},enumerable:true,configurable:true});GroupLogicPropertiesViewModel.prototype.LoadDisplayTypes=function(){if(this._groupLogic.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelect||this._groupLogic.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelectToggleButton){this.DisplayTypes=[{name:'Checklist',value:Intelledox.Model.QuestionDisplayType.MultiSelect},{name:'ToggleButton',value:Intelledox.Model.QuestionDisplayType.MultiSelectToggleButton}]}else{this.DisplayTypes=[{name:'Optionlist',value:Intelledox.Model.QuestionDisplayType.MultiChoice},{name:'DropDownList',value:Intelledox.Model.QuestionDisplayType.Dropdown},{name:'LikertScale',value:Intelledox.Model.QuestionDisplayType.LikertScale},{name:'ToggleButton',value:Intelledox.Model.QuestionDisplayType.MultiChoiceToggleButton}]}};Object.defineProperty(GroupLogicPropertiesViewModel.prototype,"ShowDisplayDirection",{get:function(){return this._groupLogic.DisplayType===Intelledox.Model.QuestionDisplayType.MultiChoice||this._groupLogic.DisplayType===Intelledox.Model.QuestionDisplayType.MultiSelect},enumerable:true,configurable:true});Object.defineProperty(GroupLogicPropertiesViewModel.prototype,"ShowWatermark",{get:function(){return(this._groupLogic.DisplayType===Intelledox.Model.QuestionDisplayType.Dropdown)},enumerable:true,configurable:true});GroupLogicPropertiesViewModel.prototype.pickWatermarkRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editor.treeView.pickEvent=function(node){_this.Watermark=Design.HelperFunctions.onPickRef(_this._filterLocal,_this.Watermark,node,insertPoint)};this._editor.treeView.togglePickMode()};return GroupLogicPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.GroupLogicPropertiesViewModel=GroupLogicPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var TabPagePropertiesViewModel=(function(_super){__extends(TabPagePropertiesViewModel,_super);function TabPagePropertiesViewModel(editorViewModel,tab,$filter,lists){var _this=_super.call(this)||this;_this._editorViewModel=editorViewModel;_this._tab=tab;_this.styleModel=new Design.StylePropertiesViewModel(editorViewModel,tab,$filter,lists);return _this}Object.defineProperty(TabPagePropertiesViewModel.prototype,"Title",{get:function(){return this._tab.Title},set:function(value){this._tab.Title=value;this._editorViewModel.wizChanged=true;this._editorViewModel.treeView.selectedNode.text=value},enumerable:true,configurable:true});return TabPagePropertiesViewModel}(Design.PropertiesViewModel));Design.TabPagePropertiesViewModel=TabPagePropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var TabGroupPropertiesViewModel=(function(_super){__extends(TabGroupPropertiesViewModel,_super);function TabGroupPropertiesViewModel(editorViewModel,tabGroup,$filter,lists){var _this=_super.call(this)||this;_this._editorViewModel=editorViewModel;_this._tabGroup=tabGroup;_this.styleModel=new Design.StylePropertiesViewModel(editorViewModel,tabGroup,$filter,lists);return _this}Object.defineProperty(TabGroupPropertiesViewModel.prototype,"IsAccordion",{get:function(){return(this._tabGroup.DisplayType===Intelledox.Model.TabGroupDisplayType.Accordion)},set:function(value){this._tabGroup.DisplayType=value?Intelledox.Model.TabGroupDisplayType.Accordion:Intelledox.Model.TabGroupDisplayType.Classic;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});return TabGroupPropertiesViewModel}(Design.PropertiesViewModel));Design.TabGroupPropertiesViewModel=TabGroupPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var UserPromptPropertiesViewModel=(function(_super){__extends(UserPromptPropertiesViewModel,_super);function UserPromptPropertiesViewModel(editorViewModel,question,designApi,$filter,lists){var _this=_super.call(this,editorViewModel,question,$filter,lists)||this;_this._symbols=[];_this._hasLoadedCurrency=false;_this.DataTypes=[{name:'Text',value:Intelledox.Model.ValidationType.Text},{name:'DateString',value:Intelledox.Model.ValidationType.Date},{name:'Number',value:Intelledox.Model.ValidationType.Numeric},{name:'Email',value:Intelledox.Model.ValidationType.Email},{name:'Password',value:Intelledox.Model.ValidationType.Password},{name:'Currency',value:Intelledox.Model.ValidationType.Currency},{name:'PhoneNumber',value:Intelledox.Model.ValidationType.PhoneNumber},{name:'Time',value:Intelledox.Model.ValidationType.Time}];_this.DisplayTypes=[{name:'DatePicker',value:Intelledox.Model.QuestionDisplayType.DatePicker},{name:'Fields',value:Intelledox.Model.QuestionDisplayType.DateFields}];_this._filterLocal=$filter;_this._editor=editorViewModel;_this._userPrompt=question;_this._designApi=designApi;return _this}Object.defineProperty(UserPromptPropertiesViewModel.prototype,"CurrencySymbols",{get:function(){var vm=this;if(this._symbols.length===0){this._symbols.push({name:'(None)',value:'',symbol:'',positivePattern:0,negativePattern:1});this._symbols.push({name:'$',value:'$',symbol:'$',positivePattern:0,negativePattern:1});this._designApi.getCurrencySymbols().then(function(data){vm._symbols=vm._symbols.concat(data);vm._hasLoadedCurrency=true})}return this._symbols},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"DataType",{get:function(){return this._userPrompt.ValidationType},set:function(value){this._userPrompt.ValidationType=value;this._editor.wizChanged=true;if(value===Intelledox.Model.ValidationType.Date){this._userPrompt.DisplayType=Intelledox.Model.QuestionDisplayType.DatePicker}},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"DisplayType",{get:function(){if(this._userPrompt.DisplayType===Intelledox.Model.QuestionDisplayType.DatePicker||this._userPrompt.DisplayType===Intelledox.Model.QuestionDisplayType.DateFields){return this._userPrompt.DisplayType}else{return Intelledox.Model.QuestionDisplayType.DatePicker}},set:function(value){this._userPrompt.DisplayType=value;if(!this.ShowWeekdaysOnly){this.WeekdaysOnly=false}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"MaxLength",{get:function(){if(this._userPrompt.MaxLength===0){return''}return this._userPrompt.MaxLength.toString()},set:function(value){this._userPrompt.MaxLength=parseInt(value,10);if(isNaN(this._userPrompt.MaxLength)){this._userPrompt.MaxLength=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"Width",{get:function(){if(this._userPrompt.TextBoxWidth===0){return''}return this._userPrompt.TextBoxWidth.toString()},set:function(value){this._userPrompt.TextBoxWidth=parseInt(value,10);if(isNaN(this._userPrompt.TextBoxWidth)){this._userPrompt.TextBoxWidth=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"TextRows",{get:function(){if(this._userPrompt.TextRows===0){return''}return this._userPrompt.TextRows.toString()},set:function(value){this._userPrompt.TextRows=parseInt(value,10);if(isNaN(this._userPrompt.TextRows)){this._userPrompt.TextRows=0}else if(this._userPrompt.TextRows>1){this._userPrompt.MaxLength=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"DecimalPlaces",{get:function(){if(this._userPrompt.DecimalPlaces===0){return''}return this._userPrompt.DecimalPlaces.toString()},set:function(value){this._userPrompt.DecimalPlaces=parseInt(value,10);if(isNaN(this._userPrompt.DecimalPlaces)){this._userPrompt.DecimalPlaces=0}this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"CurrencyCode",{get:function(){if(!this._hasLoadedCurrency){return undefined}return this._userPrompt.CurrencyCode},set:function(value){for(var i=0;i<this.CurrencySymbols.length;i++){if(value===this.CurrencySymbols[i].value){this._userPrompt.CurrencySymbol=this.CurrencySymbols[i].symbol;this._userPrompt.CurrencyNegativePattern=this.CurrencySymbols[i].negativePattern;this._userPrompt.CurrencyPositivePattern=this.CurrencySymbols[i].positivePattern;break}}this._userPrompt.CurrencyCode=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"IsRightAligned",{get:function(){return this._userPrompt.IsRightAligned},set:function(value){this._userPrompt.IsRightAligned=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"Watermark",{get:function(){return this._userPrompt.Watermark},set:function(value){this._userPrompt.Watermark=value;this._editor.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"WeekdaysOnly",{get:function(){return this._userPrompt.WeekdaysOnly},set:function(value){this._userPrompt.WeekdaysOnly=value;this._editor.wizChanged=true},enumerable:true,configurable:true});UserPromptPropertiesViewModel.prototype.pickWatermarkRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editor.treeView.pickEvent=function(node){_this.Watermark=Design.HelperFunctions.onPickRef(_this._filterLocal,_this.Watermark,node,insertPoint)};this._editor.treeView.togglePickMode()};Object.defineProperty(UserPromptPropertiesViewModel.prototype,"ShowMaxLength",{get:function(){return(this._userPrompt.ValidationType!==Intelledox.Model.ValidationType.Date&&this._userPrompt.ValidationType!==Intelledox.Model.ValidationType.Currency&&this._userPrompt.ValidationType!==Intelledox.Model.ValidationType.Time)},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"ShowTextRows",{get:function(){return this._userPrompt.ValidationType===Intelledox.Model.ValidationType.Text},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"ShowWidth",{get:function(){return(this._userPrompt.ValidationType!==Intelledox.Model.ValidationType.Date)},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"ShowDecimalPlaces",{get:function(){return this._userPrompt.ValidationType===Intelledox.Model.ValidationType.Currency},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"ShowSymbol",{get:function(){return this._userPrompt.ValidationType===Intelledox.Model.ValidationType.Currency},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"ShowAlignment",{get:function(){return this._userPrompt.ValidationType===Intelledox.Model.ValidationType.Numeric||this._userPrompt.ValidationType===Intelledox.Model.ValidationType.Currency},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"ShowWatermark",{get:function(){return(this._userPrompt.ValidationType!==Intelledox.Model.ValidationType.Password&&this._userPrompt.DisplayType!==Intelledox.Model.QuestionDisplayType.DateFields)},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"ShowWeekdaysOnly",{get:function(){return this._userPrompt.ValidationType===Intelledox.Model.ValidationType.Date&&this._userPrompt.DisplayType===Intelledox.Model.QuestionDisplayType.DatePicker},enumerable:true,configurable:true});Object.defineProperty(UserPromptPropertiesViewModel.prototype,"ShowDisplayType",{get:function(){return(this._userPrompt.ValidationType===Intelledox.Model.ValidationType.Date)},enumerable:true,configurable:true});return UserPromptPropertiesViewModel}(Design.QuestionPropertiesViewModel));Design.UserPromptPropertiesViewModel=UserPromptPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var SectionPropertiesViewModel=(function(_super){__extends(SectionPropertiesViewModel,_super);function SectionPropertiesViewModel(editorViewModel,section,$filter,$uibModal,lists){var _this=_super.call(this)||this;_this._filter=$filter;_this._editorViewModel=editorViewModel;_this._section=section;_this.repeatModel=new Design.RepeatPropertiesViewModel(editorViewModel,section,$filter,$uibModal,lists,'icon-section','icon-section icon-repeatingsection');_this.repeatModel.repeatNameChanged=function(){return _this.onNameChanged()};_this.styleModel=new Design.StylePropertiesViewModel(editorViewModel,section,$filter,lists);return _this}Object.defineProperty(SectionPropertiesViewModel.prototype,"title",{get:function(){return this._section.Title},set:function(value){this._section.Title=value;this._editorViewModel.wizChanged=true;this.onNameChanged()},enumerable:true,configurable:true});Object.defineProperty(SectionPropertiesViewModel.prototype,"description",{get:function(){return this._section.Description.toString()},set:function(value){this._section.Description=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});Object.defineProperty(SectionPropertiesViewModel.prototype,"displayImportOptions",{get:function(){return this._section.DisplayImportOptions},set:function(value){this._section.DisplayImportOptions=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});SectionPropertiesViewModel.prototype.onNameChanged=function(){this._editorViewModel.treeView.selectedNode.text=SectionPropertiesViewModel.getTreeNodeText(this._filter,this._section)};SectionPropertiesViewModel.getTreeNodeText=function($filter,sect){var sectTitle=Design.TranslationHelper.KeywordValueToTranslation($filter,sect.Title);if(System.String.IsNullOrEmpty(sectTitle)){if(System.String.IsNullOrEmpty(sect.RepeatName)){sectTitle=System.String.Format($filter('translate')('LayoutDefaultFormat'),$filter('translate')('Section'))}else{sectTitle=System.String.Format($filter('translate')('LayoutDefaultFormat'),sect.RepeatName+' '+$filter('translate')('Section'))}}return sectTitle};return SectionPropertiesViewModel}(Design.PropertiesViewModel));Design.SectionPropertiesViewModel=SectionPropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}));var Intelledox;(function(Intelledox){var Design;(function(Design){var PagePropertiesViewModel=(function(_super){__extends(PagePropertiesViewModel,_super);function PagePropertiesViewModel(editorViewModel,page,$filter,$uibModal,lists){var _this=_super.call(this)||this;_this._filter=$filter;_this._editorViewModel=editorViewModel;_this._page=page;_this.repeatModel=new Design.RepeatPropertiesViewModel(editorViewModel,page,$filter,$uibModal,lists,'icon-page','icon-page icon-repeatingpage');_this.styleModel=new Design.StylePropertiesViewModel(editorViewModel,page,$filter,lists);return _this}Object.defineProperty(PagePropertiesViewModel.prototype,"canRepeat",{get:function(){return this._editorViewModel.wizard.TypeId!==Intelledox.Model.ProjectType.Dashboard},enumerable:true,configurable:true});Object.defineProperty(PagePropertiesViewModel.prototype,"name",{get:function(){return this._page.Name},set:function(value){this._page.Name=value;this._editorViewModel.wizChanged=true;this._editorViewModel.treeView.selectedNode.text=value},enumerable:true,configurable:true});Object.defineProperty(PagePropertiesViewModel.prototype,"repeatTitle",{get:function(){return this._page.RepeatTitle},set:function(value){this._page.RepeatTitle=value;this._editorViewModel.wizChanged=true},enumerable:true,configurable:true});PagePropertiesViewModel.prototype.pickTitleRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.name=Design.HelperFunctions.onPickRef(_this._filter,_this.name,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};PagePropertiesViewModel.prototype.pickRepeatTitleRef=function(id){var _this=this;var insertPoint=document.getElementById(id).selectionStart;this._editorViewModel.treeView.pickEvent=function(node){_this.repeatTitle=Design.HelperFunctions.onPickRef(_this._filter,_this.repeatTitle,node,insertPoint)};this._editorViewModel.treeView.togglePickMode()};return PagePropertiesViewModel}(Design.PropertiesViewModel));Design.PagePropertiesViewModel=PagePropertiesViewModel})(Design=Intelledox.Design||(Intelledox.Design={}))})(Intelledox||(Intelledox={}))